(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = {
  'CONSTANTS': {
    //公司类型
    'COMPANY_TYPE': {
      COMPANY_PAY_MODE: '1',
      EMP_PAY_MODE: '2',
      DESC: {
        '1': '企业总包',
        '2': '员工自费'
      }
    },
    //客户类别
    'CUSTOMER_TYPE': {
      COMPANY: '1',
      HOTEL: '2',
      INTERNET_BAR: '3',
      DESC: {
        '1': '企业',
        '2': '酒店',
        '3': '网吧'
      }
    },
    //客户状态
    'CUSTOMER_STATUS': {
      BEING_COOPERATE: '0',
      PAUSE_COOPERATE: '1',
      STOP_COOPERATE: '2',
      DESC: {
        '0': '合作中',
        '1': '暂停合作',
        '2': '停止合作'
      }
    },
    //拣货类型
    'PICKING_TYPE': {
      RANDOM: '2',
      SELF: '1',
      OTHER: '3',
      DESC: {
        '2': '小二可随机配',
        '1': '完全自选',
        '3': '其他'
      }
    },
    //坏账抵扣类型
    'COMPANY_DEDUCTION_TYPE': {
      IN_TRADE_PAID: '1', //溢价支付收入
      IN_PLAT: '3', //平台发放收入
      OUT_SETTLEMENT_PAY: '2', //结算抵扣支出
      DESC: {
        '1': '溢价支付收入',
        '2': '结算抵扣支出',
        '3': '平台发放收入'
      }
    },
    //货架类型
    'SHELF_TYPE': {
      SNACKS: '0',
      FRIDGE: '1',
      FREEZER: '2',
      DESC: {
        '0': '零食',
        '1': '冰箱',
        '2': '冰柜'
      }
    },
    //单据类型
    'ORDER_TYPE': {
      DELIVERY: '1',
      REFUND: '2',
      INVENTORY: '3',
      SETTLEMENT: '4',
      HOLIDAY: '100',
      TEAORDER: '99',
      PROMOTION: '98',
      SUITEDYNAMIC: '97',
      ISSUEDYNAMIC: '96',
      DESC: {
        '1': '送货单',
        '2': '退货单',
        '3': '盘点单',
        '4': '结算单',
        '100': '节假日福利单',
        '99': '下午茶',
        '98': '营销单',
        '97': '套餐动态',
        '96': '期号动态'
      }
    },
    'IN_STORAGE_ORDER_TYPE': {
      DELIVERY_MODIFY_CONFIRM: '1',
      REFUND_CONFIRM: '2',
      DESC: {
        '1': '送货修改确认单',
        '2': '退货入库确认单',
      }
    },
    //货架状态
    'SHELF_STATE': {
      WAIT_SEND: '0',
      WAIT_COMFIRM: '1',
      WAIT_ONLINE: '2',
      UNORDER: '3',
      DESC: {
        '0': '已下单待发送',
        '1': '已下单待确认',
        '2': '已确认待上架',
        '3': '未下单'
      }
    },
    //入库修改确认单状态
    // 'IN_STORAGE_STATE': {
    //     IN_STORAGE_NO: 1,
    //     IN_STORAGE_YES: 2,
    //     DESC: {
    //         1: '未入库',
    //         2: '已入库'
    //     }
    // },
    'IN_STORAGE_STATE': {
      IN_STORAGE_NO: '0',
      IN_STORAGE_YES: '1',
      DESC: {
        '0': '未入库',
        '1': '已入库'
      }
    },
    //入库修改确认单是否修改
    'IN_STORAGE_MODIFYSTATE': {
      IN_STORAGE_MODIFYSTATE_NO: '0',
      IN_STORAGE_MODIFYSTATE_YES: '1',
      DESC: {
        '0': '否',
        '1': '是'
      }
    },
    //送货单状态
    'DELIVERY_STATE': {
      INIT: '0',
      WAIT_PICK: '4',
      PICKING: '5',
      RETURN_INIT: '6',
      WAIT_COMFIRM: '1',
      WAIT_SHELVE: '2',
      COMPLETED: '3',
      DESC: {
        '0': '仅保存',
        '4': '待拣货',
        '5': '正在拣货',
        '6': '仓库返回',
        '7': '客户退单',
        '1': '等待确认',
        '2': '等待上架',
        '3': '上架完成'
      }
    },
    //退货单状态
    'REFUND_STATE': {
      INIT: '0',
      WAIT_COMFIRM: '1',
      COMPLETED: '2',
      DESC: {
        '0': '保存未发送',
        '1': '等待确认',
        '2': '已确认'
      }
    },
    //盘点单状态
    'INVENTORY_STATE': {
      INIT: '0',
      WAIT_COMFIRM: '1',
      WAIT_SETTLEMENT: '2',
      COMPLETED: '3',
      DESC: {
        '0': '待结算',
        '1': '待结算',
        '2': '待结算',
        '3': '已结算'
      }
    },
    //结算单状态
    'SETTLEMENT_STATE': {
      IN_INVENTORY: '0',
      WAIT_SEND: '1',
      WAIT_COMFIRM: '2',
      WAIT_SETTLEMENT: '3',
      COMPLETED: '4',
      DESC: {
        '0': '盘点中',
        '1': '未发送',
        '2': '发送待确认',
        '3': '待付款',
        '4': '已付款'
      }
    },
    //选品单状态
    'GOODSCHOOSE_ORDER_STATE': {
      WAIT_VERIFY: '1',
      VERIFIED: '5',
      FINISH: '6',
      COMPANY_CANCLED: '8',
      SYS_CANCLED: '9',
      DESC: {
        '1': '待接收',
        '5': '已接收',
        '6': '已完成',
        '8': '已删除', //企业取消
        '9': '已取消' //好品取消
      }
    },
    //商品页面模式
    'PRODUCT_PAGE_MODE': {
      MANAGE: 0,
      SELECT: 1,
      DESC: {
        0: '管理',
        1: '选择'
      }
    },
    //送货单紧急度
    'DELIVERY_URGENCY': {
      COMMON: '0',
      URGENCY: '1',
      DESC: {
        '0': '正常',
        '1': '紧急'
      }
    },
    //数字增减标志
    'NUM_MODIFY_MODE': {
      ADD: '0',
      REDUCE: '1',
      DESC: {
        '0': '增',
        '1': '减'
      }
    },
    //利润等级
    'PROFIT_LEVEL': {
      UNKNOWN: '0',
      LOW_PROFIT: '1',
      MEDIUM_PROFIT: '5',
      HIGH_PROFIT: '9',
      DESC: {
        '0': '未知',
        '1': '低利润',
        '5': '中等利润',
        '9': '高利润'
      }
    },
    //商品特殊标识
    'PRODUCT_TAG': {
      NEW: '1',
      INACTIVE: '2',
      SHIELD: '3',
      DESC: {
        '1': '新品',
        '2': '滞销',
        '3': '屏蔽'
      }
    },
    'STOCK_MODIFY_TYPE': {
      IMPORT: '1',
      EXPIRE: '4',
      WASTE: '6',
      DESC: {
        '1': '进货',
        '4': '过期',
        '6': '损耗'
      }
    },
    'WELFARE_STATE': {
      WAIT_AUDIT: '0',
      PASSED: '1',
      REFUSED: '2',
      WAIT_SETTLE: '3',
      PAIED: '4',
      DESC: {
        '0': '待审核',
        '1': '待结算',
        '2': '审核未通过',
        '3': '待结算',
        '4': '已结算'
      },
      STYLE: {
        '0': 'primary',
        '1': 'success',
        '2': 'danger',
        '4': 'warning'
      }
    },
    'WEEK_TYPE': {
      DESC: {
        '1': '周一',
        '2': '周二',
        '3': '周三',
        '4': '周四',
        '5': '周五',
        '6': '周六',
        '7': '周日',
      }
    },
    //财务系统状态
    'INVOICE_NEED_STATE': {
      NONEED: '0',
      NEED: '1',
      DESC: {
        '0': '不需要',
        '1': '需要'
      }
    },
    'INVOICE_STATE': {
      UNINVOICED: '0',
      INVOICED: '1',
      DESC: {
        '0': '未开票',
        '1': '已开票'
      }
    },
    'INVOICE_TIME_TYPE': {
      CREATETIME: '0',
      UPDATETIME: '1',
      DESC: {
        '0': '生成时间',
        '1': '更新时间'
      }
    },
    'EXPRESS_COMPANY_TYPE': {
      YUNDA: '0',
      SHUNFENG: '1',
      XIEDAI: '2',
      YOUZHENG: '3',
      DESC: {
        '0': '韵达快递',
        '1': '顺丰快递',
        '2': '配送携带',
        '3': '邮政'
      }
    },
    'CATEGORY_LEVEL': {
      ONE: '1',
      TWO: '2',
      DESC: {
        '1': '一级品类',
        '2': '二级品类'
      }
    },
    'PRODUCT_DIC_TYPE': {
      ORIGIN_PLACE: '1',
      BRAND_AWARENESS: '2',
      BRAND_GRADE: '3',
      DESC: {
        '1': '原产地',
        '2': '品牌认知度',
        '3': '品牌档次'
      }
    },
    'PRODUCT_STOCK_CHANGE_TYPE': {
      PURCHASE: '1',
      DELIVERY: '2',
      RETURN: '3',
      EXPIRE: '4',
      DELIVERY_RETURN: '5',
      OTHER_LOSS: '6',
      DESC: {
        '1': '进货',
        '2': '出货',
        '3': '退货',
        '4': '过期',
        '5': '出货退回',
        '6': '其他损耗'
      }
    },
    /**
     *  全部结算
     *  微信支付
     *  对公账号支付
     */
    'PAYMENT_STATUS': {
      WECHAT_PAY: '1',
      ALIPAY_APP: '2',
      BALANCE: '5',
      WECHAT_APP: '7',
      BANK_CARD: '8',
      DESC: {
        '1': '微信公众号',
        '2': '支付宝',
        '5': '余额支付',
        '7': '微信APP支付',
        '8': '对公账号支付'
      }
    },
    /**
     * 全部订单
     * 待付款
     * 待配送
     * 已完成
     */
    'ORDER_STATUS': {
      WAITING_PAYMENT: '1',
      WAITING_DISTRIBUTION: '2',
      COMPLETE: '3',
      CANCEL: '4',
      DESC: {
        '1': '待付款',
        '2': '待配送',
        '3': '已完成',
        '4': '已取消'
      }
    },
    /**
     * 购买类型
     * 预定
     */
    'BUY_TYPE': {
      RESERVATION: '0',
      SELLING: '1',
      DESC: {
        '0': '预定',
        '1': '热卖'
      }
    },
    'PAY_TYPE': {
      UNKNOW: '0',
      WX_PAY: '1',
      ALI_PAY: '2',
      CASH: '3',
      BANK_CARD: '4',
      POCKET_MONEY: '5',
      WX_MICROPAY: '6',
      WX_APPPAY: '7',
      DESC: {
        '0': '未知',
        '1': '微信公众号',
        '2': '支付宝',
        '3': '现金',
        '4': '银行卡',
        '5': '余额支付',
        '6': '微信刷卡',
        '7': '微信APP'
      }
    },
    'Tea_ORDER_TYPE': {
      FINIORDER: '0',
      NEXTORDER: '1',
      CANCELORDER: '2',
      DESC: {
        '0': '未知',
        '1': 'daijiesong',
        '2': '已取消',
      }
    },
    'Time_Period': {
      MORNING: '1',
      AFTERNOON: '2',
      DESC: {
        '1': '上午',
        '2': '下午'
      }
    },
    'Tea_Period_Type': {
      ACCEPT: '1',
      WAIT: '2',
      CANCEL: '3',
      DESC: {
        '1': '已接单',
        '2': '待接单',
        '3': '已取消'
      }
    },
    'Promotion_Search_Type': {
      TEL: '1',
      COMPANY: '2',
      Name: '3',
      DESC: {
        '1': '按手机号搜索',
        '2': '按企业名称搜索',
        '3': '按联系人搜索'

      }
    },
    'PROMOTION_ORDER_STATUS': {
      WAIT_PAY_DEPOSIT: '1',
      WAIT_COMFIRM: '2',
      WAIT_PAY_FULL: '3',
      WAIT_SEND: '4',
      SEND: '5',
      RECEIVED: '6',
      CANCEL: '7',
      CANCEL_8: '8',
      CANCEL_9: '9',
      DESC: {
        '1': '待付定金',
        '2': '待确认',
        '3': '待付尾款',
        '4': '待发货',
        "5": "已发货",
        '6': '已收货',
        "7": "已取消",
        '8': '已取消', //(等待退款)
        '9': "已取消" //(已退款)
      }
    },
    'PRMOTION_PRODUCT_ACTIVE': {
      ACTIVE: '1',
      NOTACTIVE: '0',
      DESC: {
        '1': '架上商品',
        '0': '已下架商品'

      }
    },
    'ISSUE_STATUS': {
      WAITING_ONLINE: '0',
      ALREADY_ONLINE: '1',
      ALREADY_OFFLINE: '2',
      DESC: {
        '0': '待上线',
        '1': '已上线',
        '2': '已下线'
      }
    },
    'ISSUE_ACTIVE': {
      CLOSE: '0',
      OPEN: '1',
      DESC: {
        false: '关闭',
        true: '开启'
      }
    },

    'SUITE_TYPE': {
      FEATURES: '0',
      STANDARD: '1',
      DESC: {
        '0': '特色',
        '1': '标准'
      }
    },
    'SUITE_STATUS': {
      NOT_RELEASE: '0',
      ALREADY_RELEASE: '1',
      DESC: {
        '0': '未发布',
        '1': '已发布'
      }
    },
    'PROMOTION_PAY_TYPE': {
      PAY_DEPOSIT: '1',
      PAY_ALL: '2',
      DESC: {
        1: '定金支付',
        2: '全额支付'
      }
    },
    'TEMPLATE_TYPE': {
      ENTERPRISE: '1',
      HOTEL: '2',
      INTERNET_BAR: '3',
      GUEST: '4',
      DESC: {
        1: '企业',
        2: '酒店',
        3: '网吧',
        4: '自由人'
      }
    },
    'TEMPLATE_STATUS': {
      UNPUBLIC: '0',
      PUBLIC: '1',
      DESC: {
        '0': '未发布',
        '1': '发布'
      }
    },
    'CONTENT_TYPE': {
      BANNER: '0',
      COMMON: '1',
      DESC: {
        '0': '轮播图',
        '1': '普通'
      }
    },
    //拣货单商品 上架原因
    'PICK_PRODUCT_REASON': {
      CHOSEN: '0', //选购单
      WISHLIST: '1', //心愿单
      REPLACEMENT_ADVICE: '2', //下架商品同类替换推荐
      SHELF_BEST_SALES: '3', //货架最近60日出货率TOP3&销售额TOP2
      GLOBAL_BEST_SALES: '4', //全库最近60日出货率TOP3&销售额TOP2
      RECOMMENDED: '5', //单品推荐
      SUPPLEMENT_ADVICE: '6', //补货建议
      ICON: {
        '0': './img/icon-goodschoose-red.png',
        '1': './img/icon-like.png',
        '2': './img/icon-replacement-advice.png',
        '3': './img/icon-shelf-best-sales.png',
        '4': './img/icon-global-best-sales.png',
        '5': './img/icon-recommend.png',
        '6': './img/icon-supplement-advice.png'
      },
      KEY_WORD: {
        '0': '选',
        '1': '愿',
        '2': '替',
        '3': '架',
        '4': '全',
        '5': '单',
        '6': '补'
      },
      KEY: {
        'wishlist': '1',
        'replacements': '2',
        'shelfSalesChart': '3',
        'globalSalesChart': '4',
        'recommended': '5',
        'replenishment': '6'
      }
    },
    //拣货单商品 来源
    'PICK_PRODUCT_FROM_TYPE': {
      FROM_SUITE: 1,
      FROM_NEW: 2,
      FROM_SHELF: 3,
      FROM_REFER: 4,
      FROM_CHOOSE: 5,
      FROM_EDIT: 6
    },
    /*@Params
    options(必填，若为对象则所有参数都在该值设置,一旦以对象形式设置该值，后面参数失效。若为字符串，则表示取哪个enum,如 ‘PROFIT_LEVEL’)
    支持以下设置项
    clsOrName(必填,表示取哪个enum,如 ‘PROFIT_LEVEL’)
    hasDefault(非必填，不填将有默认值，该默认值特指 所有类型 或 不填 等)
    codeKey(非必填)
    valueKey(非必填)
    defaultObj(非必填 填写格式为{'-1':'所有类型'})
    */
    getList: function(options, hasDefault, codeKey, valueKey, defaultObj,
      isCodeNum) {
      var clsOrName;
      if (options.clsOrName) { //若options为对象,后面参数将从options中取值
        clsOrName = options.clsOrName;
        hasDefault = options.hasDefault;
        codeKey = options.codeKey;
        valueKey = options.valueKey;
        defaultObj = options.defaultObj;
        isCodeNum = options.isCodeNum;
      } else {
        clsOrName = options;
      }
      if (!clsOrName) {
        return [];
      }
      var ck = codeKey || 'code';
      var vk = valueKey || 'desc';

      var l = _.map(this[clsOrName].DESC, function(val, code) {
        // return { code: key, desc: val };
        var o = {};
        o[ck] = isCodeNum ? parseInt(code) : code;
        o[vk] = val;
        return o;
      });
      hasDefault = typeof(hasDefault) != 'undefined' ? hasDefault : true;
      if (hasDefault) {
        var dOjb = {};
        dOjb[ck] = isCodeNum ? -1 : '-1';
        dOjb[vk] = '全部';
        if (defaultObj) {
          if (_.pairs(defaultObj).length > 0) {
            dOjb[ck] = _.pairs(defaultObj)[0][0];
            dOjb[vk] = _.pairs(defaultObj)[0][1];
          }
        }
        l.splice(0, 0, dOjb);
      }
      return l;
    }
  }
};
},{}],2:[function(require,module,exports){
module.exports = function(app) {
  app.controller('account', function($scope, $mdDialog, modalService,
    utilService, accountService, NgTableParams, roleService) {
    $scope.searchName = "";
    $scope.heads = [{
      title: '序号',
      width: '6%',
      field: 'index',
    }, {
      title: '用户名',
      width: '16%',
      field: 'name',
    }, {
      title: '手机号',
      width: '24%',
      field: 'mobile',
    }, {
      title: '创建者',
      width: '16%',
      field: 'creator',
      getValue: function(creator) {
        return creator.name;
      }
    }, {
      title: '创建时间',
      width: '16%',
      field: 'createTime',
      getValue: function(createTime) {
        return utilService.parseTimeByLong(createTime,
          'yyyy-MM-dd hh:mm');
      }
    }, {
      title: '管理者',
      width: '16%',
      field: 'supervisor',
      getValue: function(supervisor) {
        return supervisor.name;
      }
    }, {
      title: '操作',
      width: '6%',
      getValue: function() {
        return '<button class="btn btn-default btn-sm" ng-click="editAccount(row)" ><span class="glyphicon glyphicon-pencil"></span></button>' +
          '&nbsp&nbsp&nbsp' +
          '<button class="btn btn-danger btn-sm" ng-click="deleteClick(row)"><span class="glyphicon glyphicon-trash"></span></button>';
      },
    }];
    $scope.createAccount = function() {
      $mdDialog.show(addOrEditAccountModalOptions($scope)).then(update);
    };

    $scope.manageRoles = function() {
      window.location.hash = "#/role"
    };

    /* 编辑*/
    $scope.editAccount = function(account) {
      $mdDialog.show(addOrEditAccountModalOptions($scope, account)).then(
        update);
    };

    /*删除*/
    $scope.deleteClick = function(account) {
      $scope.account = angular.copy(account);
      $scope.modal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'account')),
        scope: $scope,
        templateUrl: 'deleteUserModel'
      });
    };

    /*删除用户确认*/
    $scope.deleteUser = function(account) {
      accountService.deleteManager({
        id: $scope.account.managerId
      }).then(function(res) {
        update();
        $scope.modal.close();
      });
    };

    /*给table赋值*/
    var findAll = function() {
      if ($scope.searchName) {
        $scope.tableParams = new NgTableParams({}, {
          counts: [],
          getData: function(params) {
            return accountService.searchName($scope.searchName).then(
              function(res) {
                params.total(res.lenght);
                return accountService.indexAccount(res, 1);
              });
          }
        });
        $scope.offset = 0; // 重置
      } else {
        if (!$scope.offset) {
          $scope.offset = 0;
        }
        $scope.limit = 15;
        $scope.tableParams = new NgTableParams({
          count: $scope.limit
        }, {
          counts: [],
          paginationMaxBlocks: 25,
          paginationMinBlocks: 2,
          getData: function(params) {
            $scope.offset = $scope.limit * (params.page() - 1);
            return accountService.findAllManager({}, $scope.offset,
              $scope.limit).then(function(res) {
              params.total(res.totalElements);
              return accountService.indexAccount(res.content,
                $scope.offset + 1);
            });
          }
        });
      }
    };
    // 当前登陆账户
    $scope.currentAccount = {};
    // 特殊权限
    $scope.critialPermissions = [];
    // 所有管理者
    $scope.supervisors = [];
    // 所有角色
    $scope.role = {};

    function update() {
      findAll();
      accountService.loadSupervisors().then(function(res) {
        $scope.supervisors = res;
      });
    }

    (function() {
      accountService.loadSelf().then(function(res) {
        angular.extend($scope.currentAccount, res);
      });
      roleService.getCriticalPermissions().then(function(res) {
        angular.extend($scope.critialPermissions, res);
      });
      roleService.getRoles().then(function(res) {
        angular.extend($scope.role, res);
      });
      update();
    })();

    $scope.search = function() {
      $scope.searchName = $scope.searchName.trim();
      if ($scope.searchName) {
        findAll();
      }
    };
    $scope.clear = function() {
      $scope.searchName = "";
      findAll();
    };
    $scope.downloadExcel = function() {
      accountService.downloadExcel().then(function(data) {
        var a = document.createElement("a");
        document.body.appendChild(a);
        a.style = "display: none";
        var blob = new Blob([data], {
            type: "octet/stream"
          }),
          url = window.URL.createObjectURL(blob);
        a.href = url;
        a.download = "permissions.xls";
        a.click();
        window.URL.revokeObjectURL(url);
      });
    };
    $scope.uploadPermissions = function() {
      uploadExcel(accountService.uploadPermissions);
    };
    $scope.uploadPermissionGroups = function() {
      uploadExcel(accountService.uploadPermissionGroups);
    };
    var uploadExcel = function(uploader) {
      $mdDialog.show(uploadExcelModalOptions(uploader)).then(function(
        data) {
        $mdDialog.show(
          $mdDialog.alert()
          .clickOutsideToClose(true)
          .title('上传成功')
          .textContent(data.runMsg)
          .ok('确定')
        );
      });
    };
  });
};

function addOrEditAccountModalOptions(scope, account) {
  return {
    templateUrl: 'views/account/addOrEditAccountModal.html',
    controller: AddOrEditAccountCtrl,
    locals: {
      account: account,
      context: scope
    }
  };
};

function AddOrEditAccountCtrl($scope, $mdDialog, $mdPanel, accountService,
  context, account) {
  var currentAccount = context.currentAccount;
  var editMode = typeof(account) != 'undefined';
  $scope.editMode = editMode;
  $scope.allPermissions = [{
    id: "自定义",
    name: "特殊权限",
    permissions: context.critialPermissions
  }];
  $scope.account = account ? angular.copy(account) : {
    creator: currentAccount,
    supervisor: currentAccount,
  };
  if (!$scope.account.permissionIds) $scope.account.permissionIds = [];
  $scope.picUrl = window.cfg.picUrl;
  $scope.creatorName = $scope.account.creator.name;
  $scope.pickedSupervisor = $scope.account.supervisor;
  $scope.supervisors = [$scope.pickedSupervisor].concat(context.supervisors.filter(
    function(supervisor) {
      // 从管理者列表中过滤掉当前编辑的用户（如果有的话）和 pickedSupervisor（已放在第一位）
      var id = supervisor.managerId;
      return id !== $scope.account.managerId && id !== $scope.pickedSupervisor
        .managerId;
    }));
  $scope.ok = function() {
    var result = $scope.account;
    var checkRoleIds = $scope.checkedRoles.map(function(role) {
      return role.id;
    });
    if (editMode) {
      accountService.modifyManager({
          id: result.managerId,
          name: result.name,
          psw: result.password ? $.hex_md5(result.password) : null,
          supervisorId: $scope.pickedSupervisor.managerId,
          permissionIds: result.permissionIds,
          roleIds: checkRoleIds,
          avatar: result.avatar
        })
        .then(function() {
          $mdDialog.hide();
        });
    } else {
      accountService.createManager({
          name: result.name,
          mobile: result.mobile,
          psw: $.hex_md5(result.password),
          supervisorId: $scope.pickedSupervisor.managerId,
          permissionIds: result.permissionIds,
          roleIds: checkRoleIds,
          avatar: result.avatar
        })
        .then(function() {
          $mdDialog.hide();
        });
    }
  };
  $scope.cancel = function() {
    $mdDialog.cancel();
  };
  $scope.pickRole = function() {
    $mdPanel.open(pickRoleOptions($mdPanel, context.role, $scope.checkedRoles,
      currentAccount));
  };
  $scope.checkedRoles = [];
  var checkedRoleIds = $scope.account.roleIds;
  if (checkedRoleIds) {
    findCheckedRoles(context.role);
  }

  function findCheckedRoles(role) {
    if (checkedRoleIds.indexOf(role.id) > -1) {
      $scope.checkedRoles.push(role);
    }
    angular.forEach(role.children, function(child) {
      findCheckedRoles(child);
    });
  };
};

function pickRoleOptions($mdPanel, role, checkedRoles, currentAccount) {
  return {
    attachTo: angular.element(document.body),
    controller: PanelDialogCtrl,
    controllerAs: 'ctrl',
    templateUrl: 'views/account/pickRolePanel.html',
    hasBackdrop: true,
    panelClass: 'pick-role-panel',
    position: $mdPanel.newPanelPosition().absolute().center(),
    trapFocus: true,
    zIndex: 10002,
    escapeToClose: true,
    focusOnOpen: true,
    locals: {
      role: role,
      checkedRoles: checkedRoles,
      currentAccount: currentAccount
    }
  };
};

function PanelDialogCtrl($scope, mdPanelRef, role, checkedRoles, currentAccount) {
  var checkedInfos = [];
  var currentRoleInfos = [];
  (function() {
    var ids = checkedRoles.map(function(role) {
      return role.id
    });

    function wrap(role, parentInfo) {
      var info = {
        _enabled: 0,
        role: role,
        parent: parentInfo,
      }
      info.children = !role.children ? [] : role.children.map(function(child) {
        return wrap(child, info);
      })
      if (ids.indexOf(role.id) > -1) checkedInfos.push(info);
      if (currentAccount.roleIds.indexOf(role.id) > -1) currentRoleInfos.push(
        info);
      return info;
    }
    $scope.roleInfo = wrap(role, null);
  }());
  var root = role;
  var result = [];
  var checkedRoleIds = [];
  var self = this;
  self.ok = function() {
    checkedRoles.splice(0, checkedRoles.length);
    angular.forEach(result, function(role) {
      checkedRoles.push(role);
    });
    self.closePanel();
  };
  self.closePanel = function() {
    mdPanelRef.close().then(function() {
      mdPanelRef.destroy();
    });
  };
  self.pickable = function(info) {
    var role = info.role;
    return role !== root && info._enabled == 0;
  };
  self.isChecked = function(info) {
    return checkedRoleIds.indexOf(info.role.id) > -1;
  };
  self.toggle = function(info) {
    var role = info.role;
    var index = checkedRoleIds.indexOf(role.id);
    if (index < 0) {
      checkedRoleIds.push(role.id);
      result.push(role);
      setParentEnable(info, false);
      setChildrenEnable(info, false);
    } else {
      checkedRoleIds.splice(index, 1);
      result.splice(index, 1);
      setParentEnable(info, true);
      setChildrenEnable(info, true);
    }
  };

  function setParentEnable(info, disable) {
    if (info.parent) {
      var parent = info.parent;
      var delta = disable ? -1 : 1;
      parent._enabled = parent._enabled + delta;
      setParentEnable(parent, disable);
    }
  };

  function setChildrenEnable(info, disable) {
    var children = info.children;
    if (children) {
      angular.forEach(children, function(child) {
        var delta = disable ? -1 : 1;
        child._enabled = child._enabled + delta;
        setChildrenEnable(child, disable);
      });
    }
  };
  // 1. 先将所有节点禁止
  setChildrenEnable($scope.roleInfo, false);
  // 2. 再开放当前账户所拥有角色的子角色
  angular.forEach(currentRoleInfos, function(currentRoleInfo) {
    setChildrenEnable(currentRoleInfo, true);
  });
  angular.forEach(checkedInfos, function(checkedInfo) {
    self.toggle(checkedInfo); // 选中已选角色
  });
}

function uploadExcelModalOptions(uploader) {
  return {
    templateUrl: 'views/account/uploadExcelModal.html',
    controller: UploadExcelCtrl,
    locals: {
      uploader: uploader
    }
  };
};

function UploadExcelCtrl($scope, $mdDialog, $timeout, accountService, uploader) {
  $scope.cancel = function() {
    $mdDialog.cancel();
  };
  $scope.ok = function() {
    var comment = $scope.comment;
    var file = $("#file_input")[0].files[0];
    uploader(comment, file).then(function(data) {
      $mdDialog.hide(data);
    });
  };
};
},{}],3:[function(require,module,exports){
/*
 *总控
 *appContrller
 */
module.exports = function(app) {
    app.controller('app', function($scope) {
        //开始路由回调
        //成功路由回调
        $scope.$on('$routeChangeSuccess', function(e,r) {
            var route=r.$$route;
            var path=route.name;
            $scope.$emit('sidebar.active',path);
        });

        $scope.tabs = [{
                title: 'Dynamic Title 1',
                content: ''
            },
            { title: 'Dynamic Title 2', content: 'Dynamic content 2' }
        ];
        $scope.selectEvent = function(item) {

        };
        //添加tab 
        $scope.$on('AddTab', function(e, obj) {
            var id = obj.id;
            if (!_.findWhere(id, { id: id })) {
                $scope.tabs.push({
                    title: obj.name,
                    id: id,
                    content: '<div ui-view="' + id + '"></div>'
                });
            }
        });

    });
};

},{}],4:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/11/25.
 */
/**
 * 商品标签管理
 * labelsManagement
 */
module.exports = function (app) {
    app.controller('commentsManage', function ($scope, $uibModal, $compile, modalService, orderService, NgTableParams, suiteService, CONSTANTS, utilService) {

        $scope.ORDER_STATUS = CONSTANTS.ORDER_STATUS;//订单状态
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE; //订单类型
        $scope.queryParams = {
            suiteName: '',//套餐名称
            suiteId: '',//套餐ID
            companyName: '', //公司名称
            companyId: '', //公司ID
            customerName: '', //用户名称
            content: '', //评论内容
            createTimeStart: '',//评论创建时间
            createTimeEnd: ''//评论创建时间
        };

        //根据企业搜索
        $scope.searchByCompany = function (company) {
            $scope.queryParams.companyName = company.companyName;
            $scope.commentsList();
        };

        //清空企业搜索
        $scope.emptyCompanySearch = function() {
            delete $scope.queryParams.companyName;
        };

        /**
         * 评论列表
         */
        $scope.commentsList = function (queryParams) {
            // debugger
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.tableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    // var search = getParams();
                    /*var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        customerName: $scope.customerName,
                        content: $scope.content,
                    };*/
                    var queryParam = angular.extend( getParams(),{
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit
                    });
                    return suiteService.queryComment(queryParam).then(function (res) {
                        // debugger
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            })
        };
        $scope.commentsList();
        var getParams = function () {
            // debugger
            var temp = $scope.queryParams;
            temp[temp.markId] = temp.fuzzy;
            return _.omit(temp, 'markId', 'fuzzy');
        };


        /*打印*/
        //打印单据列表
        var printOrderArray = [];
        var checkInfo = function (data) {
            // debugger
            angular.forEach(data, function (item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        /**
         * 勾选
         */
        $scope.updateSelection = function (e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function (e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };

        //选择
        $scope.queryChoose = {
            nameTypeData: [{
                markId: '',
                desc: '无'
            }, {
                markId: 'customerName',
                desc: '用户名'
            }, {
                markId: 'content',
                desc: '内容'
            }],
            selectItem: function (item) {
                $scope.queryParams["markId"] = item.markId;
            }
        };

        /**
         * 回复评论
         */
        $scope.replyComment = function (cm) {
            // debugger
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementById('commentsManage')),
                scope: $scope,
                templateUrl: 'suite/replyCommentsTemplate.html'
            });
            $scope.comments = cm;
        };

        /**
         * 确定回复
         *determineReply()
         */
        $scope.determineReply = function (comments) {
            var me = this;
            // debugger
            console.log(comments.content);
            var params = {
                suiteId: comments.suiteId,
                companyId: comments.companyId,
                content: comments.reply,
                parentId: comments.id,

            };
            suiteService._createComment(params).then(function (res) {
                $scope.commentsList();
                alert('回复成功！');
                me.$close();
            });
        };

        /**
         * 取消回复
         * cancelReply()
         */
        $scope.cancelReply = function () {
            // debugger
            this.$close();
        };

        /**
         * 删除评论
         */
        $scope.deleteComment = function (cm) {
            // debugger
            var params = {
                suiteCommentId: cm.id
            };
            suiteService._deleteComment(params).then(function (res) {
                alert('评论删除成功。');
                $scope.commentsList();
            });
        }

    });
};



},{}],5:[function(require,module,exports){
/*
 *企业库控制器
 *companyController
 */
module.exports = function(app) {
  app.controller('company', function($scope, $mdSidenav, $mdDialog, $sce,
    $element, $compile, $templateCache, $filter, NgTableParams,
    printService, utilService,
    modalService, companyService, CONSTANTS) {
    $scope.CONSTANTS = CONSTANTS;
    $scope.queryParams = {}; //企业查询参数
    $scope.selectedCompanyList = []; //选中的企业列表

    // 下面代码为导出Excel做准备
    var excelTemplate = $compile($templateCache.get(
      'company/companyTableTemplate.html'))($scope);
    angular.element(document.getElementById(
      'exportExcelWrap')).append(excelTemplate);

    /*定义*/
    $scope.companyCreateModal;
    var getRecordById = function(record) {
      var value;
      angular.forEach($scope.company.contacts, function(item) {
        if (record.id == item.id) {
          value = item;
        }
      });
      return value;
    };
    var defaultConcat = {
      mobile: '',
      tel: '',
      qq: '',
      wechat: '',
      command: '',
      contactName: '',
      isEditing: true
    };
    $scope.companys = [];
    $scope.contactTableData = [];
    $scope.company = {
      companyId: '',
      companyManagerId: '',
      staffNum: '',
      companyName: '',
      shelfType: '',
      pickingType: CONSTANTS.PICKING_TYPE.RANDOM,
      pickingRemark: '',
      des: '',
      address: '',
      limitFee: '',
      lng: '',
      lat: '',
      change: '',
      followPeople: '',
      status: '',
      isPremium: false,
      contacts: [],
      sendWeek: [],
      balance: 0,
      superAdmin: '',
      customerType: '',
      reset: function() {
        this.companyId = '';
        this.companyManagerId = '';
        this.staffNum = '';
        this.companyName = '';
        this.shelfType = '';
        this.pickingType = CONSTANTS.PICKING_TYPE.RANDOM;
        this.pickingRemark = '';
        this.des = '';
        this.address = '';
        this.limitFee = '';
        this.contacts = [];
        this.sendWeek = [];
        this.lng = '';
        this.lat = '';
        this.isPremium = false;
        this.followPeople = '';
        this.status = '';
        this.change = '';
        this.balance = 0;
        this.superAdmin = '';
        this.customerType = '';
      }, //CompanyContactInfo[]  企业联系人列表
      viewFormate: function() {
        this.limitFee = this.limitFee >= 0 ? parseInt(this.limitFee /
          100) : '';
      }
    };
    //客户货架类型 设置
    $scope.formConfig = {
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'COMPANY_TYPE',
          hasDefault: false,
          codeKey: 'value',
          valueKey: 'desc'
        });
      },
      getDefaultItem: function(value) {
        var options = this.getList();
        return _.findWhere(options, {
          value: value
        }) || options[1];
      },
      selectItem: function(record) {
        this.defaultItem = record;
        $scope.company.shelfType = record.value;
      }
    };
    //客户类别(如企业，网吧等)
    $scope.customerType = {
      getList: function(mode) {
        var listOpts = {
          clsOrName: 'CUSTOMER_TYPE',
          codeKey: 'customerType',
          valueKey: 'name'
        };
        if (mode == 1) { //筛选模式
          listOpts.defaultObj = {
            '-1': '所有客户类别'
          };
        } else {
          listOpts.hasDefault = false;
        }
        return CONSTANTS.getList(listOpts);
      },
      getDefaultItem: function(mode, value) {
        var options = this.getList(mode);
        return _.findWhere(options, {
          customerType: value
        }) || options[0];
      },
      selectItem: function(mode, record) {
        if (mode == 1) { //筛选模式
          if (record.customerType != -1) {
            $scope.queryParams.customerType = record.customerType;
          } else {
            delete $scope.queryParams.customerType;
          }
          $scope.searchCompany();
        } else { //设置模式
          this.defaultItem = record;
          $scope.company.customerType = record.customerType;
        }
      }
    };
    //客户状态
    $scope.customerStatus = {
      getList: function(mode) {
        var listOpts = {
          clsOrName: 'CUSTOMER_STATUS',
          codeKey: 'customerStatus',
          valueKey: 'name'
        };
        if (mode == 1) { //筛选模式
          listOpts.defaultObj = {
            '-1': '所有企业状态'
          };
        } else {
          listOpts.hasDefault = false;
        }
        return CONSTANTS.getList(listOpts);
      },
      getDefaultItem: function(mode, value) {
        var options = this.getList(mode);
        return _.findWhere(options, {
          customerStatus: value
        }) || options[0];
      },
      selectItem: function(mode, record) {
        if (mode == 1) { //筛选模式
          if (record.customerStatus != -1) {
            $scope.queryParams.status = record.customerStatus;
          } else {
            delete $scope.queryParams.status;
          }
          $scope.searchCompany();
        } else {
          this.defaultItem = record;
          $scope.company.status = record.customerStatus;
        }
      }
    };
    //客户查询类别 设置
    $scope.queryCompanyTypeConfig = {
      nameTypeData: [{
        markId: 'companyName',
        desc: '名称'
      }, {
        markId: 'address',
        desc: '地址'
      }],
      selectItem: function(item) {
        $scope.queryParams["markId"] = item.markId;
        $scope.queryTypeName = item.desc;
      }
    };
    //回车键查询 
    $scope.companyKeyup = function(e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.searchCompany();
      }
    };
    //表格设置
    $scope.offset = 0;
    $scope.limit = 20;
    $scope.companyTable = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      paginationMaxBlocks: 20,
      paginationMinBlocks: 2,
      getData: function(params) {
        $scope.offset = $scope.limit * (params.page() - 1);
        var p = getParams();
        p.offset = $scope.offset;
        p.limit = $scope.limit;
        return companyService.queryCompanyList(p).then(function(res) {
          params.total(res.totalElements);
          return companyService.parseCompanyList(res.content,
            $scope.offset);
        });
      }
    });
    var getParams = function() {
      var temp = $scope.queryParams;
      _.each($scope.queryCompanyTypeConfig.nameTypeData, function(item) {
        delete temp[item.markId];
      });
      temp[temp.markId] = temp.queryName;
      return _.omit(temp, 'markId', 'queryName');
    };
    //勾选
    $scope.updateSelection = function(e, company) {
      var isChecked;
      if (_.isObject(e)) {
        isChecked = e.currentTarget.checked;
      } else {
        isChecked = e;
      }
      company.checked = isChecked;
      if (isChecked) {
        $scope.selectedCompanyList.push(company);
      } else {
        $scope.selectedCompanyList = _.without($scope.selectedCompanyList,
          company);
      }
    };

    // 选择星期
    var weekChoics = $filter('selection')('WEEK_TYPE', null, 'value',
      'desc', '', true);
    $scope.weekConfig = {
      choices: weekChoics,
      defaultItem: {
        value: '-1',
        desc: '选择星期'
      },
      getOptionByValue: function(value) {
        var options = this.choices;
        return _.findWhere(options, {
          value: value
        });
      },
      selectItem: function(record) {
        if (record.value == this.defaultItem.value) {
          return;
        } else {
          $scope.company.sendWeek = _.sortBy(_.union($scope.company.sendWeek, [
            record.value
          ]));
        }
      },
      delWeek: function(chip) {
        var value = $filter('value')(chip, 'WEEK_TYPE', true);
        $scope.company.sendWeek = _.without($scope.company.sendWeek,
          value);
      }
    };
    //查询企业列表
    $scope.searchCompany = function() {
      $scope.companyTable.settings({
        dataset: []
      });
    };
    //导出企业列表
    $scope.exportCompanyTableExcel = function() {
      if (!$scope.selectedCompanyList.length) {
        utilService.alertError('请先选择需导出的企业');
        return;
      }
      var dom = angular.element('<a></a>');
      dom[0].href = $('#export-company-table').excelexportjs({
        containerid: 'export-company-table',
        datatype: 'table',
        returnUri: 'true'
      });
      dom[0].download = '企业列表.xls';
      dom[0].click();
    };
    //打开企业 新增 编辑
    $scope.openCreateEditCompanyWin = function(companyId) {
      $scope.company.reset();
      if (!companyId) { //新增模式
        $scope.contactTable.settings({
          dataset: []
        });
        $scope.companyCreateModal = initModal('modelcontent', 'middle');
      } else {
        companyService.queryCompanyPremiumState({
          companyId: companyId
        }).then(function(res) {
          $scope.company.isPremium = !!parseInt(res.enable);
        });
        companyService.queryCompanyDeduction({
          companyId: companyId
        }).then(function(res) {
          $scope.company.balance = res.balance;
        });
        companyService.queryCompany({
          companyId: companyId
        }).then(function(res) {
          $scope.company = angular.extend($scope.company, res);
          $scope.company.viewFormate();
          $scope.contactTableData = angular.copy(res.contacts);
          $scope.contactTable.settings({
            dataset: $scope.contactTableData
          });
          $scope.companyCreateModal = initModal('modelcontent',
            'middle');
        });
      }

    };
    //Modal
    var initModal = function(templateUrl, size, appendToElement) {
      return modalService.initModal({
        appendTo: appendToElement || $element,
        templateUrl: templateUrl,
        scope: $scope,
        size: size
      });
    };
    //确定提交企业信息
    $scope.submitCompanyConfirm = function(company) {
      var errorMsg = '';
      if (!company.contacts.length) {
        errorMsg = '请添加联系方式';
      } else if (company.pickingType == CONSTANTS.PICKING_TYPE.OTHER) {
        if (!company.pickingRemark) {
          errorMsg = '请填写其他拣货类型';
        }
      }
      if (errorMsg.length) {
        utilService.alertError(errorMsg);
        return;
      }
      var companyParams = angular.copy(company);
      if (companyParams.pickingType != CONSTANTS.PICKING_TYPE.OTHER) {
        companyParams.pickingRemark = '';
      }
      if (companyParams.limitFee == '') {
        companyParams.limitFee = -1;
      } else {
        companyParams.limitFee = utilService.getPointInt(
          companyParams.limitFee || 0);
      }
      if (!company.companyId) { //新增模式
        $scope.createCompanyConfirm(companyParams);
      } else { //修改模式
        $scope.editCompanyConfirm(companyParams);
      }
    };
    //确认创建企业
    $scope.createCompanyConfirm = function(companyParams) {
      return companyService.createCompany(companyParams).then(function(
        res) {
        if (parseInt($scope.company.change)) {
          companyService.setCompanyDeduction({
            companyId: res.companyId,
            change: $filter('points')($scope.company.change)
          });
        }
        $scope.companyCreateModal.close();
        $scope.companyTable.reload();
      });
    };
    //确认编辑企业
    $scope.editCompanyConfirm = function(companyParams) {
      var promise = companyService.editCompany(companyParams)
        .then(function() {
          if (parseInt($scope.company.change)) {
            companyService.setCompanyDeduction({
              companyId: $scope.company.companyId,
              change: $filter('points')($scope.company.change)
            });
          }
          $scope.companyCreateModal.close();
          $scope.companyTable.reload();
        }, function() {});
      return promise;
    };
    //添加联系人
    $scope.confirmAdd = function() {
      $scope.contactTable.settings().dataset.push(angular.copy(
        defaultConcat));
      $scope.contactTable.reload();
    };

    //修改联系人
    $scope.confirmEdit = function(row, rowForm, scope) {
      row.isEditing = false;
      rowForm.$setPristine();

      if (row.id) { //修改联系人
        companyService.editCompanyContact(row).then(function(res) { //成功
          $scope.companyTable.reload();
        }, function() { //失败
          row = angular.extend(row, getRecordById(row));
        });
      } else { //添加联系人
        if (scope.company.companyId) { //修改企业时添加联系人
          row.companyId = scope.company.companyId;
          companyService.addCompanyContact(row).then(function(res) { //成功
            companyService.queryCompany({
              companyId: scope.company.companyId
            }).then(function(res) {
              $scope.company = angular.extend($scope.company,
                res);
              $scope.company.formate();
              $scope.contactTableData = angular.copy(res.contacts);
              $scope.contactTable.settings({
                dataset: $scope.contactTableData
              }); /*$scope.companyTable.reload();*/
            });
          }, function(error) { //失败
            $scope.contactTableData = _.without($scope.contactTableData,
              row);
            $scope.contactTable.settings({
              dataset: $scope.contactTableData
            });
            $scope.contactTable.reload();
          });
        } else { //创建企业时添加联系人
          $scope.company.contacts.push(row);
        }
      }
    };
    $scope.startEdit = function(row, rowForm) {
      row.isEditing = true;
      //rowForm.originRow = angular.copy(row);
    };
    //取消修改联系人
    $scope.cancelEdit = function(row, rowForm) {
      row.isEditing = false;
      rowForm.$setPristine();
      if (row.id) { //修改
        row = angular.extend(row, getRecordById(row));
      } else { //删除
        $scope.contactTable.settings().dataset = _.without($scope.contactTable
          .settings().dataset, row);
        $scope.contactTable.reload();
      }
    };
    //删除联系人
    $scope.confirmDelete = function(row) {
      if ($scope.contactTable.data.length == 1) {
        $mdDialog.show($mdDialog.alert({
          title: '失败',
          textContent: '无法删除,必须有1位联系人!',
          ok: '关闭'
        }));
        return;
      }
      companyService.deleteCompanyContact({
        contactId: row.id
      }).then(function() {
        $scope.contactTable.settings().dataset = _.without($scope.contactTable
          .settings().dataset, row);
        $scope.contactTable.reload();
      });
    };
    //重置密码
    $scope.resetPWD = function() {
      companyService.resetCompanyPassword({
        companyId: $scope.company.companyId
      }).then(function() {
        $mdDialog.show($mdDialog.alert({
          title: '成功',
          textContent: '重置密码成功',
          ok: '关闭'
        }));
      }, function() {
        $mdDialog.show($mdDialog.alert({
          title: '请求失败',
          textContent: '重置密码失败',
          ok: '关闭'
        }));
      });
    };

    //状态更改日志
    $scope.companyChangeLogCrl;
    $scope.companyChangeLogTableHeads = [{
      title: '序号',
      field: 'index'
    }, {
      title: '操作时间',
      field: 'optTime',
      getValue: function(value) {
        return '<span>' + $filter('date')(value, 'yyyy.MM.dd') +
          '</span>';
      },
      show: true
    }, {
      title: '姓名',
      field: 'optName',
      show: true,
      getValue: function(v) {
        return '<span  style="width:180px;display:inline-block;">' +
          v + '</span>';
      }
    }, {
      title: '操作前状态',
      field: 'preStatusAlias',
      show: true
    }, {
      title: '操作后状态',
      field: 'sufStatusAlias',
      show: true
    }];
    $scope.companyChangeLogTable = new NgTableParams({
      counts: 10
    }, {
      counts: [],
      paginationMaxBlocks: 13,
      paginationMinBlocks: 2,
      dataset: []
    });
    $scope.getCompanyStateChangeLog = function(companyId) {
      companyService.queryCompanyStateChangeLog({
        companyId: companyId
      }).then(function(res) {
        $scope.companyChangeLogTable.settings({
          dataset: utilService.indexArray(res, 1)
        });
        $scope.$applyAsync(function() {
          $scope.companyChangeLogCtrl.showDialog($scope);
        });
      });
    };
    $scope.changeCompanyPremiumState = function(company) {
        var state = company.isPremium;
        var companyId = company.companyId;
        if (state) {
          $mdDialog.show($mdDialog.confirm()
            .title('提示')
            .textContent('企业溢价功能开启后无法关闭，确定要开启？')
            .ok('确定')
            .cancel('取消')
          ).then(function(f) {
            companyService.setCompanyPremium({
              companyId: companyId
            }).then(function() {}, function() {
              company.isPremium = false;
            });
          }, function() {
            company.isPremium = false;
          });
        } else {
          $mdDialog.show($mdDialog.alert()
            .clickOutsideToClose(true)
            .title('提示')
            .textContent('企业溢价不支持关闭功能！')
            .ok('确定'));
          company.isPremium = true;
        }
      }
      //坏账抵扣
    $scope.companyDeductionCtrl;
    $scope.companyDeductionFlow = [];
    $scope.companyDeductionTableHeads = [{
      title: '坏账抵扣余额',
      field: 'balance',
      show: true,
      getValue: function(value) {
        return '<span>' + $filter('rmb')(value) + '</span>';
      }
    }, {
      title: '变化金额',
      field: 'change',
      show: true,
      getValue: function(value) {
        return '<span>' + $filter('rmb')(value) + '</span>';
      },
    }, {
      title: '类型',
      field: 'optType',
      show: true,
      getValue: function(value) {
        return '<span>' + $filter('desc')(value,
          'COMPANY_DEDUCTION_TYPE') + '</span>';
      }
    }, {
      title: '操作人',
      field: 'managerName',
      show: true
    }, {
      title: '操作时间',
      field: 'createTime',
      show: true,
      getValue: function(value) {
        return '<span>' + $filter('date')(value,
          'yyyy.MM.dd HH:mm:ss') + '</span>';
      },
    }];
    $scope.companyDeductionOffset = $scope.offset;
    $scope.companyDeductionTable;
    $scope.getCompanyDeductionList = function() {
      $scope.companyDeductionTable = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        getData: function(params) {
          var p = {};
          $scope.companyDeductionOffset = $scope.limit * (params.page() -
            1);
          p = {
            offset: $scope.companyDeductionOffset,
            limit: $scope.limit,
            companyId: $scope.company.companyId
          };
          return companyService.queryCompanyDeductionFlow(p).then(
            function(res) {
              $scope.companyDeductionFlow = res.content;
              params.total(res.totalElements);
              return companyService.indexCompany(res.content,
                $scope.companyDeductionOffset + 1);
            });
        }
      });
      $scope.$applyAsync(function() {
        $scope.companyDeductionCtrl.showDialog($scope);
      });
      /*            $scope.companyDeductionTable.reload().then(function() {
                      $scope.$applyAsync(function() {
                          $scope.companyDeductionCtrl.showDialog($scope);
                      });
                  });*/
    };
    //联系方式相关
    $scope.contactHeads = [{
      title: '联系人',
      field: 'contactName',
      dataType: 'text',
      required: true
    }, {
      title: '手机',
      field: 'mobile',
      dataType: 'text',
      required: true,
      relatedField: 'tel'
    }, {
      title: '座机',
      field: 'tel',
      dataType: 'text',
      required: true,
      relatedField: 'mobile'
    }, {
      title: 'QQ',
      field: 'qq',
      dataType: 'text'
    }, {
      title: '微信号',
      field: 'wechat',
      dataType: 'text'
    }, {
      title: '操作',
      field: 'command',
      dataType: 'command'
    }];
    $scope.block = {
      companyId: "",
      productId: "",
      reason: "",
      modifyReason: "",
      productName: "",
      modifyId: "",
      addBox: ""
    };
    $scope.getBlockList = function() {
      return companyService.getBlockCompany({
        companyId: $scope.block.companyId
      }).then(function(res) {
        $scope.blockConpanyList = res;
      });
    };
    $scope.seeBlock = function(companyId) {
      $scope.block.addBox = false;
      $scope.block.companyId = companyId;
      companyService.getZeroProduct({
        companyId: '714987242665279488'
      }).then(function(res) {
        $scope.blockZeroProduct = res;
      });
      $scope.getBlockList().then(function() {
        $scope.companyBlockModal = modalService.initModal({
          appendTo: $element,
          scope: $scope,
          templateUrl: "blockManage",
          backdrop: 'static',
          size: 'lg'
        });
      })

    };
    $scope.showAddBox = function() {
      $scope.block.addBox = true;
    }
    $scope.addBlock = function(productId, reason, callback) {
      companyService.addBlockCompany({
        companyId: $scope.block.companyId,
        productId: productId,
        reason: reason
      }).then(function(res) {
        $scope.getBlockList().then(function() {
          callback();
        })
      });

    };
    $scope.modifyBlock = function(id, name, reason) {
      $scope.block.modifyId = id;
      $scope.block.name = name;
      $scope.block.modifyReason = reason;
      $scope.deleteBlockModal = modalService.initModal({
        appendTo: $element,
        scope: $scope,
        templateUrl: "modifyDialog",
        backdrop: 'static',
        size: 'sm'
      });
    };
    $scope.modifyBlockSure = function() {
      var me = this;
      companyService.modifyBlockCompany({
        id: $scope.block.modifyId,
        reason: $scope.block.modifyReason
      }).then(function(res) {
        $scope.getBlockList().then(function() {
          me.$close();
        })
      });
    };
    $scope.deleteCancel = function() {
      var me = this;
      companyService.deleteBlockCompany({
        id: $scope.blockDeleteId,
      }).then(function(res) {

        $scope.getBlockList().then(function() {
          me.$close()
        })
      });
    };

    $scope.deleteBlock = function(id) {
      $scope.blockDeleteId = id;
      $scope.deleteBlockModal = modalService.initModal({
        appendTo: $element,
        scope: $scope,
        templateUrl: "blockDelete",
        backdrop: 'static',
        size: 'sm'
      });


    };
    $scope.contactTable = new NgTableParams({
      count: 5
    }, {
      counts: [],
      dataset: $scope.contactTableData
    });
  });
};
},{}],6:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/10/18.
 * 信息配置
 * configurationInformation
 */
module.exports = function(app) {
  app.controller('configurationInformation', function($scope,
    configurationInformationService, $filter, holidayWelfareService,
    utilService) {


    $scope.queryParams = {};
    $scope.totalFee = [];
    $scope.showTime;
    $scope.depositAmount = [];
    $scope.welfareTime = {};


    /**
     * 获取零花钱审核基数默认值
     */
    $scope.getPocketMoneyAudit = function() {
      configurationInformationService.getPocketMoneyAudit().then(
        function(res) {
          $scope.totalFee = $filter('rmb')(res);
        });
    };
    $scope.getPocketMoneyAudit();


    /**
     * 零花钱审核基数
     */
    $scope.pocketMoneyAudit = function(totalFee) {
      configurationInformationService.pocketMoneyAudit($filter('points')
        (totalFee)).then(function() {
        alert("恭喜你,设置成功!!!");
      });
    };


    /**
     * 获取心愿单商检标识显示时效配置
     */
    $scope.getAging = function() {
      configurationInformationService.getWishListConfiguration().then(
        function(res) {
          $scope.showTime = res;
        });
    };
    $scope.getAging();

    /**
     * 心愿单上架标识显示时效配置
     */
    $scope.showTimeList = {
      showTimeArr: [{
        showTime: 0,
        name: '10天'
      }, {
        showTime: 1,
        name: '5分钟'
      }, {
        showTime: 2,
        name: '15分钟'
      }, {
        showTime: 3,
        name: '1天'
      }, {
        showTime: 4,
        name: '3天'
      }, {
        showTime: 5,
        name: '5天'
      }],
      getDefaultItem: function(showTime) {
        var s = parseInt(showTime);
        var options = this.showTimeArr;
        return _.findWhere(options, {
          showTime: s
        }) || options[0];
      },
      wishListLimitation: function(item) {
        var params = item.showTime;
        configurationInformationService.wishListConfiguration(params)
          .then(function() {

          });
      }
    };
    /***
     * 获取默认的(预定时间、热卖时间、结束时间)
     */
    $scope._getHolidayDefaultTime = function(scope) {
      holidayWelfareService.getHolidayDefaultTime().then(function(res) {
        // debugger
        console.log($scope.welfareTime.scheduledTimeDate = res.preSale);
        console.log($scope.welfareTime.scheduledTime = utilService.parseTimeByLong(
          res.preSale));
        console.log($scope.welfareTime.sellingTimeDate = res.hotSale);
        console.log($scope.welfareTime.sellingTime = utilService.parseTimeByLong(
          res.hotSale));
        console.log($scope.welfareTime.overTimeDate = res.endSale);
        console.log($scope.welfareTime.overTime = utilService.parseTimeByLong(
          res.endSale));
      })
    };
    $scope._getHolidayDefaultTime($scope);


    /***
     * 设置  更新节假日福利 活动时间
     * 截止时间到小时
     */

    //时间戳转换成八位日期 例如:2014-5-5
    function convertDate(cData) {
      var myDate = new Date(cData);
      var year = myDate.getFullYear();
      var month = myDate.getMonth() + 1;
      var day = myDate.getDate();
      return year + '-' + month + '-' + day;
    }

    //时间戳转换成四位时间 例如: 10:10:00
    function convertTime(cTime) {
      var myDate = new Date(cTime);
      var hours = myDate.getHours();
      var minutes = myDate.getMinutes();
      var second = myDate.getSeconds();
      return hours + ':' + minutes + ':' + second;
    }

    $scope.setWelfareTime = function(welfareTime) {
      // var scheduledConversion = new Date();
      var scheduledTimeDate = convertDate(welfareTime.scheduledTimeDate);
      var sellingTimeDate = convertDate(welfareTime.sellingTimeDate);
      var overTimeDate = convertDate(welfareTime.overTimeDate);
      var scheduledTime = convertTime(Date.parse((welfareTime.scheduledTime)));
      var sellingTime = convertTime(Date.parse((welfareTime.sellingTime)));
      var overTime = convertTime(Date.parse((welfareTime.overTime)));
      var preSale = Date.parse(scheduledTimeDate + ' ' + scheduledTime);
      var hotSale = Date.parse(sellingTimeDate + ' ' + sellingTime);
      var endSale = Date.parse(overTimeDate + ' ' + overTime);
      console.log(preSale);
      if (welfareTime.scheduledTime == "" || welfareTime.sellingTime ==
        "" || welfareTime.overTime == "") {
        alert("时间格式有误,请设置准确时间!!!")
      } else {
        var params = { preSale: preSale, hotSale: hotSale, endSale: endSale };
        holidayWelfareService.updateHolidayTime(params).then(function(
          res) {
          alert("设置成功。");
        });
      }
    };

    /**
     *营销商品/组合定金额度
     */
    //获取默认的营销商品/组合定金额度
    $scope._getMarketingActivitiesDepositInfo = function() {
      // debugger
      configurationInformationService.getMarketingActivitiesDepositInfo()
        .then(function(res) {
          $scope.depositAmount = $filter('rmb')(res);
        });
    };
    $scope._getMarketingActivitiesDepositInfo();

    $scope.marketingActivitiesDeposit = function(depositAmount) {
      // debugger
      configurationInformationService.marketingActivitiesDepositInfo(
        $filter('points')(depositAmount)).then(function(res) {
        alert('设置成功！！！');
      });
    };
    /**
     * 获取选购单选购上限配置设置
     */
    var limitNumConstant = {
      oneShelf: '1',
      twoShelf: '2',
      threeShelf: '3',
      fourShelf: '4',
      allShelf: '5'
    };
    $scope._getChooseOrderInfoCeiling = function() {
      configurationInformationService.getChooseOrderInfoCeiling().then(
        function(res) {
          $scope.limitNumConfig = {};
          var limitNumConstatInvert = _.invert(limitNumConstant);
          _.each(res, function(item) {
            var temp = {
              id: item.id,
              limitNum: item.limitNum
            };
            $scope.limitNumConfig[limitNumConstatInvert[item.shelfNumType]] =
              temp;
          });

        })
    };
    $scope._getChooseOrderInfoCeiling();
    /**
     * 选购单选购上限配置设置
     */
    $scope.chooseOrderInfo = function(limitNumConfig) {
      var params = _.map(_.pairs(limitNumConfig), function(item) {
        return {
          id: item[1].id || null,
          shelfNumType: limitNumConstant[item[0]],
          limitNum: item[1].limitNum
        }
      });

      configurationInformationService.createChooseOrderInfo(params).then(
        function(res) {
          utilService.alertSuccess('配置成功!');
        })
    }
  });
};
},{}],7:[function(require,module,exports){
module.exports = function(app) {
  app.controller('deadStock', function($scope, $mdPanel, productService,
    utilService, NgTableParams, modalService, CONSTANTS, positionService,
    deadStockService) {
    $scope.CONSTANTS = CONSTANTS;
    var CATEGORY_LEVEL = CONSTANTS.CATEGORY_LEVEL;
    var PRODUCT_DIC_TYPE = CONSTANTS.PRODUCT_DIC_TYPE;
    //表格设置
    $scope.queryParams = {
      productName: ''
    };
    $scope.offset = 0;
    $scope.limit = 20;
    $scope.deadStockProductList = [];
    $scope.tableParams = new NgTableParams({
      count: $scope.limit
    }, {
      counts: []
    });
    $scope.getDeadStockProductList = function(sortType) {
      var params = {
        productName: $scope.queryParams.productName
      };
      if (sortType) {
        params.sortType = sortType;
      }
      deadStockService.getDeadStockProductList(params).then(function(res) {
        $scope.deadStockProductList = res.list;
        $scope.tableParams.settings().dataset = $scope.deadStockProductList;
        $scope.tableParams.reload();
      });
    };
    $scope.delDeadStockProduct = function(product) {
      deadStockService.removeDeadStockProduct({
        productId: product.id
      }).then(function() {
        $scope.getDeadStockProductList();
      });
    };
    $scope.sort = function(sortObj, sortType) {
      var sortCode = sortObj.sortCode;
      var r;
      switch (sortType) {
        case 'price':
          r = sortCode * 1;
          break;
        case 'overStockRate':
          r = sortCode * 5;
          break;
        case 'distribShelfCount':
          r = sortCode * 6;
          break;
        case 'reBuyRateDeviate':
          r = sortCode * 8;
          break;
        case 'shipmentRateDeviate':
          r = sortCode * 10;
          break;
        case 'salesCountAvg':
          r = sortCode * 11;
          break;
        case 'salesFeeAvg':
          r = sortCode * 12;
          break;
        case 'stock':
          r = sortCode * 13;
          break;
      }
      $scope.getDeadStockProductList(r);
    };
    $scope.getDeadStockProductList();
  });
};

},{}],8:[function(require,module,exports){
/*拣货单编辑*/
module.exports = function(app) {
  app.controller('deliveryEditCtrl', function($scope, $compile,
    $templateCache, $routeParams, shelfService, companyService,
    productService, orderService, goodsChooseService, suiteService,
    modalService, NgTableParams, CONSTANTS, utilService) {
    $scope.CONSTANTS = CONSTANTS;
    $scope.PICK_PRODUCT_REASON = CONSTANTS.PICK_PRODUCT_REASON;
    var COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    $scope.utilService = utilService;
    $scope.picUrl = window.cfg.picUrl;
    $scope.pickOrder = {};
    $scope.orderId = $routeParams.orderId;
    $scope.goodsChooseOrderId = $routeParams.goodsChooseOrderId || 0;
    $scope.company = {};
    $scope.cateotyList = [];
    $scope.selectedListConfig = {};
    $scope.shelfProductList = [];
    var tmpNewProductList = [];
    var maxProductsCount = 50; //员工自费企业,商品数量极限值
    var goodsChooseProductList = [];
    var blackList = [];
    $scope.disableEdit = true;
    $scope.pickReferBtnDisable = true;
    //参考页打开方式
    $scope.REFER_OPEN_MODE = {
      auto: 1, //自动
      manual: 2 //手动
    };
    $scope.localLang = {
      selectAll: "全选",
      selectNone: "全不选",
      reset: "重置",
      search: "输入关键字搜索",
      nothingSelected: "请选择需关联的本期套餐"
    };
    var PRODUCT_FROM_TYPE = CONSTANTS.PICK_PRODUCT_FROM_TYPE;
    $scope.PRODUCT_FROM_TYPE = PRODUCT_FROM_TYPE;
    var initView = function() {
      if ($scope.orderId > 0) { //修改模式
        initEditView();
      } else {
        $scope.openPickRefer($scope.REFER_OPEN_MODE.auto);
        if ($scope.goodsChooseOrderId > 0) { //选购单转化过来
          initGoodsChooseView();
        } else { //新增模式
        }
      }
    };
    var initEditView = function() {
      //下面代码为导出Excel做准备
      var excelTemplate = $compile($templateCache.get(
        'pickOrder/pickOrderTemplate.html'))($scope);
      angular.element(document.getElementById(
        'exportDeliveryExcelWrap')).append(excelTemplate);
      var queryParams = { orderId: $scope.orderId };
      orderService.queryDeliveryDetail(queryParams).then(function(res) {
        $scope.pickOrder = angular.copy(res);
        $scope.order = angular.copy(res); //excel中的order(由于与送货单共用同一个excel)
        _.each(res.items, function(item, i) {
          item.itemNum = parseInt(item.itemNum);
          if (item.suiteId && item.suiteId != 0) {
            item.issueId = res.issueId;
          }
          item.from = [PRODUCT_FROM_TYPE.FROM_EDIT];
          if (item.itemType == 1) {
            item.from = _.union(item.from, [PRODUCT_FROM_TYPE.FROM_NEW]);
          } else if (item.itemType == 2) {
            item.from = _.union(item.from, [PRODUCT_FROM_TYPE.FROM_SHELF]);
          }
          if (item.itemType != 3) {
            $scope.selectedListConfig.pushItem(item,
              PRODUCT_FROM_TYPE.FROM_EDIT);
          }
        });
        loadShelfProducts(res.shelfId);
        loadCompanyDetail(res.companyId);
        loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
      });
    };
    //加载货架商品
    var loadShelfProducts = function(shelfId) {
      var queryParams = { shelfId: shelfId };
      shelfService.queryShelfProducstsByShelfId(queryParams).then(
        function(res) {
          $scope.shelfProductList = shelfService._parseShelfProductsInDeliveryEdit(
            res);
          loadShelfAvgSale(shelfId);
          loadDeliveryRecomm($scope.company.companyId, shelfId);
          loadOnlineSuites();
          if ($scope.goodsChooseOrderId) { //若是选购单转换过来
            judgeGoodsChooseListFrom();
            judgeSelectOnOpenRefer();
          }
        });
    };
    //读取日均销量数据
    var loadShelfAvgSale = function(shelfId) {
      var queryParams = { shelfId: shelfId };
      shelfService.queryShelfAvgSale(queryParams).then(function(res) {
        _.each(res.content, function(item) {
          _.each($scope.shelfProductList, function(product) {
            if (product.shelfProductId == item.shelf_product_id) {
              product.shelfAvgSale = item;
            }
          });
        });
      });
    };
    //加载本期套餐
    var loadOnlineSuites = function() {
      suiteService.queryOnlineSuites().then(function(res) {
        var productIdsInShelf = _.pluck($scope.shelfProductList,
          'productId');
        onlineIssue = suiteService._parseOnlineSuitesInDeliveryEdit(
          res, productIdsInShelf);
        $scope.suiteList = onlineIssue.suites;
      });
    };
    //加载拣货参考
    var loadDeliveryRecomm = function(companyId, shelfId) {
      orderService.queryDeliveryRecomm({
        companyId: companyId,
        shelfId: shelfId
      }).then(function(res) {
        var productIdsInShelf = _.pluck($scope.shelfProductList,
          'productId');
        $scope.referData = orderService._parseDeliveryRecomm(res,
          productIdsInShelf);
        $scope.pickReferBtnDisable = false;
        $scope.disableEdit = false;
        incrProductRecommend();
      });
    };
    //增加单品推荐期间展示次数
    var incrProductRecommend = function() {
      var productIds = _.pluck($scope.referData.recommended,
        'productId');
      if (productIds.length) {
        productService.incrProductRecommend({
          productIds: productIds
        }).then(function(res) {});
      }
    };
    //根据商品ids获取商品最近10次拣货均值
    var loadLatestDeliveryCountAvgs = function(productIds) {
      orderService.queryLatestDeliveryCountAvgs({
        productIds: productIds
      }).then(function(res) {
        $scope.selectedListConfig.setLatestDeliveryCountAvgs(res);
      });
    };
    //加载黑名单商品
    var loadBlacklist = function() {
      companyService.getBlockCompany({
        companyId: $scope.company.companyId
      }).then(function(res) {
        blackList = res;
      });
    };
    //加载企业详情
    var loadCompanyDetail = function(companyId) {
      companyService.queryCompany({
        companyId: companyId
      }).then(function(res) {
        $scope.selectCompanyCallback(res);
      });
    };
    //初始化 选购单转换过来的界面
    var initGoodsChooseView = function() {
      goodsChooseService.queryManagerOrderDetail({
        orderId: $scope.goodsChooseOrderId
      }).then(function(res) {
        res.managerOrderId = res.orderId;
        delete res.orderId;
        shelfService.queryShelfListByCompanyId({
          companyId: res.companyId
        }).then(function(shelfRes) {
          if (!shelfRes.length) {
            window.history.back(-1);
            utilService.alertError('该企业暂无货架，无法创建拣货单!');
          }
          _.each(res.items, function(product) {
            product.reasons = [CONSTANTS.PICK_PRODUCT_REASON
              .CHOSEN
            ];
            product.from = [CONSTANTS.PICK_PRODUCT_FROM_TYPE
              .FROM_CHOOSE
            ];
            product.itemNum = product.itemNum > 0 ? product
              .itemNum : '';
            goodsChooseProductList.push(product);
          });
          $scope.pickOrder = angular.copy(res);
          loadCompanyDetail(res.companyId);
        });
      });
    };
    //判断选购单商品是新品上架还是补货
    var judgeGoodsChooseListFrom = function() {
      var shelfProductIds = _.pluck($scope.shelfProductList,
        'productId');
      _.each(goodsChooseProductList, function(item) {
        if (_.contains(shelfProductIds, item.productId)) {
          item.from = _.union(item.from, [CONSTANTS.PICK_PRODUCT_FROM_TYPE
            .FROM_SHELF
          ]);
        } else {
          item.from = _.union(item.from, [CONSTANTS.PICK_PRODUCT_FROM_TYPE
            .FROM_NEW
          ]);
        }
        $scope.selectedListConfig.pushItem(item, CONSTANTS.PICK_PRODUCT_FROM_TYPE
          .FROM_CHOOSE);
      });
      loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
    };
    /*主面板*/
    //选择公司
    $scope.selectCompanyCallback = function(company) {
      var GOODSCHOOSE_ORDER_STATE = CONSTANTS.GOODSCHOOSE_ORDER_STATE;
      $scope.company = company;
      loadBlacklist();
      if ($scope.orderId > 0 || $scope.goodsChooseOrderId > 0) {
        $scope.shelfSelectDisable = $scope.orderId > 0;
        loadShelfList(company);
      } else {
        goodsChooseService.queryManagerOrderList({
          offset: 0,
          limit: 1,
          companyId: company.companyId,
          orderStates: [GOODSCHOOSE_ORDER_STATE.WAIT_VERIFY,
            GOODSCHOOSE_ORDER_STATE.VERIFIED
          ]
        }).then(function(res) {
          if (res.content.length) {
            utilService.alertError('该企业存在未完成选购单，请从选购单模块进行创建拣货单!');
            $scope.disableEdit = true;
            $scope.shelfSelectDisable = true;
          } else {
            $scope.shelfSelectDisable = false;
            loadShelfList(company);
          }
        });
      }
    };
    //关联套餐
    $scope.relateSuites = function() {
      $scope.selectedListConfig.removeSuiteItems();
      _.each($scope.selectedSuiteList, function(suite) {
        _.each(suite.products, function(product) {
          $scope.selectedListConfig.pushItem(product,
            PRODUCT_FROM_TYPE.FROM_SUITE);
        });
      });
      loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
    };
    //判断是否显示 新品上架/补货/下架
    $scope.isShowWrap = function(fromType) {
      return $scope.selectedListConfig.getList(fromType).length;
    };
    // 清空数据
    $scope.cleardata = function() {
      $scope.cateotyList = [];
      $scope.selectedListConfig.clearList();
    };
    //导出Excel
    $scope.exportExcel = function() {
      var dom = angular.element('<a></a>');
      dom[0].href = $('#pick-order-table').excelexportjs({
        containerid: 'pick-order-table',
        datatype: 'table',
        returnUri: 'true'
      });
      dom[0].download = '拣货单' + '-' + $scope.order.companyName + '-' +
        $scope.order.shelfName + '(' + utilService.parseTimeByLong(
          $scope.order.updateTime, 'yyyyMMddhhmmss') + ').xls';
      dom[0].click();
    };
    $scope.filterItems = function(item) {
      return item.itemType != 3;
    };
    //保存送货单
    $scope.saveDelivery = function(sendWarehouse) {
      var selectedNewProducts = $scope.selectedListConfig.getList(
        PRODUCT_FROM_TYPE.FROM_NEW);
      var selectedSupplementProducts = $scope.selectedListConfig.getList(
        PRODUCT_FROM_TYPE.FROM_SHELF);
      var selectedProducts = _.union(selectedNewProducts,
        selectedSupplementProducts);
      if (!selectedProducts.length) {
        utilService.alertError('请选择上架或补货商品!');
        return;
      }
      var itemNumFlag = true; //itemNum未填写标识
      var blackFlag = false; //黑名单标识
      var items = [];
      var blackIds = _.pluck(blackList, 'productId');
      _.each(selectedProducts, function(item) {
        if (!item.itemNum) {
          itemNumFlag = false;
        }
        item.black = _.contains(blackIds, item.productId);
        blackFlag = item.black;
        var itemType;
        if (_.contains(item.from, PRODUCT_FROM_TYPE.FROM_NEW)) {
          itemType = 1;
        } else if (_.contains(item.from, PRODUCT_FROM_TYPE.FROM_SHELF)) {
          itemType = 2;
        }
        items.push({
          productId: item.productId,
          itemNum: item.itemNum,
          itemType: itemType,
          shelfProductId: item.shelfProductId || 0,
          suiteId: item.suiteId,
          issueId: item.issueId,
          reasons: item.reasons
        });
      });
      var adviceOutList = $scope.selectedListConfig.getAdviceOutList();
      _.each(adviceOutList, function(item) {
        items.push({
          productId: item.productId,
          itemType: 3,
          shelfProductId: item.shelfProductId || 0
        });
      });
      if (!itemNumFlag) {
        utilService.alertError('请完善货品数量!');
        return;
      }
      var shelfType = $scope.company.shelfType;
      if (shelfType == COMPANY_TYPE.EMP_PAY_MODE && selectedProducts.length >
        maxProductsCount) {
        utilService.alertError('员工自费企业，商品不得超过' + maxProductsCount +
          '样!');
        return;
      }
      if ($scope.selectedListConfig.getCategorieNames().length <= 2) {
        if (!confirm('所涉及品类≤2,是否继续?')) {
          return;
        }
      }
      if (blackFlag) {
        if (!confirm('存在黑名单商品,是否继续?')) {
          return;
        }
      }
      //整合提取suiteIds issueId
      var suiteIds = _.union(_.without(_.pluck(items, 'suiteId'),
        null,
        undefined, '0'));
      var issueIds = _.union(_.without(_.pluck(items, 'issueId'),
        null,
        undefined, '0'));
      var issueId = -1;
      if (issueIds.length) {
        issueId = issueIds.length > 1 ? onlineIssue.issue.id :
          issueIds[0]; //若有关联本期套餐则issueId设为本期，否则始终取商品上关联的issueId
      }
      $scope.disableEdit = true;
      if ($scope.orderId > 0) { //编辑模式
        editDeliveryForServer(items, issueId, suiteIds, sendWarehouse);
      } else { //新增模式
        createDeliveryForServer(items, issueId, suiteIds, sendWarehouse);
      }
    };
    //发送到仓库
    $scope.sendWarehouse = function() {
      $scope.saveDelivery(true);
    };
    //新建(server交互)
    var createDeliveryForServer = function(items, issueId, suiteIds,
      sendWarehouse) {
      var params = {
        shelfId: $scope.pickOrder.shelfId,
        urgent: $scope.pickOrder.urgent,
        items: items,
        issueId: issueId,
        suiteIds: suiteIds
      };
      orderService.createDeliveryOrder(params).then(function(res) {
        $scope.disableEdit = false;
        $scope.orderId = res.orderId;
        if (sendWarehouse) { //发送给仓库
          sendWarehouseForServer();
        } else { //仅保存
          if ($scope.goodsChooseOrderId > 0) {
            setGoodsChooseOrderFinish();
          } else {
            alert('保存成功!');
            window.history.back(-1);
          }
        }
      }, function(res) {
        $scope.disableEdit = false;
      });
    };
    //编辑(server交互)
    var editDeliveryForServer = function(items, issueId, suiteIds,
      sendWarehouse) {
      var params = {
        orderId: $scope.pickOrder.orderId,
        orderState: $scope.pickOrder.orderState,
        urgent: $scope.pickOrder.urgent,
        items: items,
        issueId: issueId,
        suiteIds: suiteIds
      };
      orderService.modifyDeliveryOrder(params).then(function(res) {
        if (sendWarehouse) { //发送给仓库
          sendWarehouseForServer();
        } else { //仅保存
          utilService.alertSuccess('保存成功!');
          window.history.back(-1);
        }
      }, function(res) {
        $scope.disableEdit = false;
      });
    };
    //发送到仓库(server交互)
    var sendWarehouseForServer = function() {
      var sendWarehouseParams = {
        orderId: $scope.orderId,
        orderState: CONSTANTS.DELIVERY_STATE.WAIT_PICK
      };
      orderService.modifyDeliveryState(sendWarehouseParams).then(
        function(res) {
          if ($scope.goodsChooseOrderId > 0) {
            setGoodsChooseOrderFinish();
          } else {
            utilService.alertSuccess('发送成功!');
            window.history.back(-1);
          }
        });
    };
    //设置选购单为已完成 
    var setGoodsChooseOrderFinish = function() {
      goodsChooseService.modifyOrderState({
        orderId: $scope.goodsChooseOrderId,
        orderState: CONSTANTS.GOODSCHOOSE_ORDER_STATE.FINISH
      }).then(function(res) {
        utilService.alertSuccess('保存成功!');
        window.history.back(-1);
      });
    };
    /*新品上架*/
    var setNewProductsTable = function() {
      $scope.offset = 0;
      $scope.limit = 10;
      $scope.newProdcutsTable = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        paginationMaxBlocks: 13,
        paginationMinBlocks: 2,
        getData: function(params) {
          return shelfService.queryOtherShelfProducts({
            offset: $scope.limit * (params.page() - 1),
            limit: $scope.limit,
            shelfId: $scope.pickOrder.shelfId,
            productName: $scope.newProductsQueryParams.productName,
            categoryId: $scope.newProductsQueryParams.categoryId,
            profitLevel: $scope.newProductsQueryParams.profitLevel,
            isDeleted: 0
          }).then(function(res) {
            params.total(res.totalElements);
            return shelfService._parseOtherShelfProducts(res.content,
              _.pluck(tmpNewProductList, 'productId'));
          });
        }
      });
    };
    //查询商品类别列表
    var queryProductCategoryList = function() {
      productService.queryProductCategoryList().then(function(res) {
        $scope.cateotyList = [{
          code: '-1',
          desc: "全部品类"
        }];
        angular.forEach(res, function(category, index) {
          var item = { 'code': category.id, 'desc': category.categoryName };
          $scope.cateotyList.push(item);
        });
      });
    };
    $scope.profitList = CONSTANTS.getList({
      clsOrName: 'PROFIT_LEVEL',
      defaultObj: { '-1': '全部利润等级' }
    });
    //打开 新品上架
    $scope.putSale = function() {
      var newProductList = $scope.selectedListConfig.getList(
        PRODUCT_FROM_TYPE.FROM_NEW);
      tmpNewProductList = angular.copy(newProductList);
      $scope.modal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'delivery-edit')),
        scope: $scope,
        templateUrl: 'modalProductList',
        size: 'lg'
      });
      $scope.newProductsQueryParams = {};
      setNewProductsTable();
      queryProductCategoryList();
    };
    //品类选择
    $scope.selectCategoryCallback = function(item) {
      if (item.code) {
        item.code !== '-1' ? $scope.newProductsQueryParams.categoryId =
          item.code : $scope.newProductsQueryParams.categoryId =
          undefined;
        setNewProductsTable();
      }
    };
    //利润等级选择
    $scope.selectProfitCallback = function(item) {
      if (item.code) {
        item.code !== '-1' ? $scope.newProductsQueryParams.profitLevel =
          item.code : $scope.newProductsQueryParams.profitLevel =
          undefined;
        setNewProductsTable();
      }
    };
    //搜索商品
    $scope.searchProduct = function(queryParams) {
      $scope.newProductsQueryParams.productName = queryParams.productName;
      setNewProductsTable();
    };
    $scope.keyPressSearchProduct = function(e, queryParams) {
      if (e.keyCode == 13) { //回车键
        $scope.searchProduct(queryParams);
      }
    };
    //商品选择
    $scope.chkboxChange = function(product) {
      if (product.select) {
        product.productId = product.id;
        tmpNewProductList.push(product);
      } else {
        tmpNewProductList = _.reject(tmpNewProductList, function(item) {
          return item.productId == product.productId;
        });
      }
    };
    //新品上架 确认
    $scope.confirmPutSale = function() {
      $scope.selectedListConfig.removeNewItemsWithoutIds(_.pluck(
        tmpNewProductList, 'productId'));
      _.each(tmpNewProductList, function(item) {
        $scope.selectedListConfig.pushItem(item, PRODUCT_FROM_TYPE.FROM_NEW);
      });
      loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
      $scope.modal.close();
    };
    //新品上架 删除
    $scope.removePutSaleProduct = function(product) {
      $scope.selectedListConfig.removeItemByProductId(product.productId);
    };
    /*补货*/
    //打开 补货
    $scope.supplement = function() {
      judgeSelectOnOpenSupplement();
      $scope.modal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'delivery-edit')),
        scope: $scope,
        templateUrl: 'modalShelfProductListForSupplement',
        size: 'lg'
      });
    };
    //打开 补货时 判断是否选中
    var judgeSelectOnOpenSupplement = function() {
      _.each($scope.shelfProductList, function(item) {
        var selectedProduct = $scope.selectedListConfig.getByProductId(
          item.productId);
        item.tmpSelect = typeof selectedProduct != 'undefined';
        item.itemNum = item.tmpSelect ? selectedProduct.itemNum :
          '';
      });
    };
    $scope.selectOnChckbox = function(shelfProduct) {
      if (!shelfProduct.tmpSelect) {
        addRemoveProductOnSupplement(shelfProduct, false);
      } else {
        addRemoveProductOnSupplement(shelfProduct, true);
      }
    };
    //选中补货(填写数字时)
    $scope.selectOnInputNum = function(shelfProduct) {
      if (!shelfProduct.itemNum) {
        addRemoveProductOnSupplement(shelfProduct, false);
      } else {
        addRemoveProductOnSupplement(shelfProduct, true);
      }
    };
    //补货中 选中/移除
    var addRemoveProductOnSupplement = function(item, select) {
      _.each($scope.shelfProductList, function(p) {
        if (p.productId == item.productId) {
          p.tmpSelect = select;
          p.itemNum = item.itemNum;
        }
      });
    };
    //补货 确认
    $scope.supplementConfirm = function() {
      _.each($scope.shelfProductList, function(item) {
        if (item.tmpSelect) {
          $scope.selectedListConfig.pushItem(item,
            PRODUCT_FROM_TYPE.FROM_SHELF);
        } else {
          $scope.selectedListConfig.removeItemByProductId(item.productId);
        }
      });
      loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
      $scope.modal.close();
    };
    //补货 删除
    $scope.removeSupplementProduct = function(product) {
      $scope.selectedListConfig.removeItemByProductId(product.productId);
    };
    /*拣货信息参考页面相关*/
    //打开拣货数据参考页
    $scope.openPickRefer = function(mode) {
      $scope.referOpenMode = mode;
      judgeSelectOnOpenRefer();
      $scope.modal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'delivery-edit')),
        scope: $scope,
        templateUrl: 'pickOrder/pickReferTemplate.html',
        size: 'xxlg'
      });
    };
    //打开 拣货数据参考页 判断是否选中
    var judgeSelectOnOpenRefer = function() {
      _.each(_.keys($scope.referData), function(key, i) {
        _.each($scope.referData[key], function(item) {
          var selectedProduct = $scope.selectedListConfig.getByProductId(
            item.productId);
          item.tmpSelect = typeof selectedProduct !=
            'undefined';
        });
      });
    };
    //保留小数
    $scope.reserveNum = function(num, pointNum) {
      pointNum = pointNum || 2;
      return parseFloat(num).toFixed(pointNum);
    };
    //返回
    $scope.goBack = function() {
      window.history.back();
    };
    //将套餐 加入 拣货单
    $scope.addSuiteToPickOrder = function() {
      _.each($scope.referData.wishlist, function(item) {
        $scope.addToPickOrder(item);
      });
    };
    //加入 拣货单
    $scope.addToPickOrder = function(item) {
      addRemoveProInRefer(item, true);
    };
    //移除 拣货单
    $scope.removeFromPickOrder = function(item) {
      addRemoveProInRefer(item, false);
    };
    /**
     * 商品加入或移除 参考页面
     * item   商品
     * select true(加入),false(移除)
     */
    var addRemoveProInRefer = function(item, select) {
      _.each(_.keys($scope.referData), function(key, i) {
        _.each($scope.referData[key], function(p) {
          if (p.productId == item.productId) {
            p.tmpSelect = select;
          }
        });
      });
    };
    //修改企业备注
    $scope.modifyCompanyDes = function(company) {
      companyService.editCompany(company).then(function(res) {
        utilService.alertSuccess('修改成功!');
      });
    };
    //完成
    $scope.finish = function() {
      _.each(_.keys($scope.referData), function(key, i) {
        if (key == 'zeroShipmentRate' || key == 'lowShipmentRate') {
          return;
        }
        _.each($scope.referData[key], function(item) {
          if (item.tmpSelect) {
            $scope.selectedListConfig.pushItem(item,
              PRODUCT_FROM_TYPE.FROM_REFER);
          } else {
            $scope.selectedListConfig.removeItemByProductId(
              item.productId);
          }
        });
      });
      loadLatestDeliveryCountAvgs($scope.selectedListConfig.getIdList());
      $scope.modal.close();
    };
    //自动添加
    $scope.autoAdd = function(item) {
      //心愿单商品：5个全选
      _.each($scope.referData.wishlist, function(item, index) {
        if (index < 5) {
          $scope.addToPickOrder(item);
        }
      });
      //下架同类替换：5个（每个品类出货率TOP1&销售额TOP1随机选择）
      _.each($scope.referData.replacements, function(item, index) {
        if (!index % 2) {
          $scope.addToPickOrder(item);
        }
      });
      //货架TOP5:5个全选
      _.each($scope.referData.shelfSalesChart, function(item, index) {
        $scope.addToPickOrder(item);
      });
      //全局TOP5:5个全选
      _.each($scope.referData.globalSalesChart, function(item, index) {
        $scope.addToPickOrder(item);
      });
      //单品推荐：全选（3~5个）
      _.each($scope.referData.recommended, function(item, index) {
        $scope.addToPickOrder(item);
      });
      //建议补货：5个全选
      _.each($scope.referData.replenishment, function(item, index) {
        $scope.addToPickOrder(item);
      });
      $scope.finish();
    };
    //货架选择
    $scope.shelfConfig = {
      list: [],
      setList: function(list) {
        this.list = angular.copy(list);
      },
      getDefaultItem: function(value) {
        var options = this.list;
        return _.findWhere(options, {
          id: value
        }) || options[0];
      },
      selectItem: function(record) {
        $scope.pickOrder.shelfId = record.id;
      },
      reset: function() {
        this.list = [];
      }
    };
    //紧急度
    $scope.urgencyConfig = {
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'DELIVERY_URGENCY',
          hasDefault: false
        });
      },
      getDefaultItem: function(value) {
        var options = this.getList();
        return _.findWhere(options, {
          code: value
        }) || options[0];
      },
      selectItem: function(record) {
        $scope.pickOrder.urgent = record.code;
      }
    };
    //加载货架列表
    var loadShelfList = function(company) {
      var queryParams = { companyId: company.companyId };
      shelfService.queryShelfListByCompanyId(queryParams).then(function(
        res) {
        $scope.shelfConfig.setList(res);
      });
    };
    //选中商品list
    $scope.selectedListConfig = {
      list: [],
      pushItem: function(item, fromType) {
        var temp = angular.copy(item);
        var t = _.find(this.list, function(p) {
          return p.productId == temp.productId;
        });
        if (t) {
          var from = _.union(temp.from, t.from);
          var reasons = _.union(temp.reasons, t.reasons);
          _.extend(t, temp);
          t.from = from;
          t.reasons = reasons;
        } else {
          t = temp;
          t.from = _.union(temp.from || [], [fromType]);
          this.list.push(t);
        }
      },
      removeSuiteItems: function() {
        var PICK_PRODUCT_REASON = CONSTANTS.PICK_PRODUCT_REASON;
        this.list = _.reject(this.list, function(item) {
          return _.contains(item.from, PRODUCT_FROM_TYPE.FROM_SUITE) &&
            !_.contains(item.from, PRODUCT_FROM_TYPE.FROM_REFER);
        });
        _.each(this.list, function(item) {
          if (_.contains(item.reasons, PICK_PRODUCT_REASON.WISHLIST) &&
            !_.contains(item.from, PRODUCT_FROM_TYPE.FROM_REFER)) {
            item.reasons = _.without(item.reasons,
              PICK_PRODUCT_REASON.WISHLIST);
            item.from = _.without(item.from, PRODUCT_FROM_TYPE.FROM_SUITE);
          }
        });
      },
      removeItemByProductId: function(productId) {
        this.list = _.reject(this.list, function(item) {
          return item.productId == productId;
        });
      },
      //删除不在指定IDs中的商品
      removeNewItemsWithoutIds: function(productIds) {
        this.list = _.reject(this.list, function(item) {
          return !_.contains(productIds, item.productId) && _.contains(
            item.from, PRODUCT_FROM_TYPE.FROM_NEW);
        });
      },
      getByProductId: function(productId) {
        var product = _.find(this.list, function(item) {
          return item.productId == productId;
        });
        return product;
      },
      getByShelfProductId: function(shelfProductId) {
        var product = _.find(this.list, function(item) {
          if (_.contains(item.from, PRODUCT_FROM_TYPE.FROM_SHELF)) {
            return item.product.shelfProductHeader.id ==
              shelfProductId;
          } else {
            return false;
          }
        });
        return product;
      },
      getList: function(fromType) {
        if (fromType) {
          return _.filter(this.list, function(item) {
            return _.contains(item.from, fromType);
          });
        } else {
          return this.list;
        }

      },
      getIdList: function(fromType) {
        var selectedList = [];
        if (fromType) {
          selectedList = _.filter(this.list, function(item) {
            return _.contains(item.from, fromType);
          });
        } else {
          selectedList = this.list;
        }
        return _.pluck(selectedList, 'productId');
      },
      //获取建议下架商品
      getAdviceOutList: function() {
        var me = this;
        var adviceOutProductIds = [];
        //实时计算除去货架商品，并且通过productId去重
        var adviceOutList = _.reject($scope.shelfProductList,
          function(item) {
            var t = _.find(me.list, function(selectedObj) {
              return selectedObj.productId == item.productId;
            });
            if (_.contains(adviceOutProductIds, item.productId)) {
              return true;
            } else {
              adviceOutProductIds.push(item.productId);
              return t;
            }
          });
        return adviceOutList;
      },
      getCategorieNames: function() {
        var a = _.uniq(_.pluck(_.pluck(this.list, 'category'),
          'categoryName'));
        return a;
      },
      clearList: function() {
        this.list = [];
      },
      calculateTotalFee: function() {
        var totalFeeInt = 0;
        _.each($scope.selectedListConfig.list, function(item) {
          totalFeeInt += parseInt(item.price, 10) * item.itemNum;
        });
        $scope.pickOrder.orderFee = totalFeeInt;
      },
      //设置最近10日拣货均值
      setLatestDeliveryCountAvgs: function(avgList) {
        var list = angular.copy(this.list);
        _.each(list, function(item, index) {
          item.latestDeliveryCountAvgs = avgList[index];
        });
        this.list = list;
      }
    };
    //监听list改变
    $scope.$watch('selectedListConfig.list', function(newValue, oldValue) {
      if (newValue == oldValue) {
        return;
      }
      $scope.selectedListConfig.calculateTotalFee();
    }, true);
    //监听货架选择
    $scope.$watch('pickOrder.shelfId', function(newValue, oldValue) {
      if (newValue == oldValue) {
        return;
      }
      if ($scope.orderId > 0) { //修改模式
        $scope.disableEdit = false;
      } else { //新增模式
        //还原
        $scope.cleardata();
        $scope.pickOrder.urgent = $scope.urgencyConfig.getList()[0].code;
        if (typeof newValue != 'undefined') {
          judgeUnfinishedDelivery(newValue);
        } else {
          $scope.disableEdit = true;
        }
      }
    }, true);
    //查询该货架是否有未完成的送货单
    var judgeUnfinishedDelivery = function(shelfId) {
      var DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
      var params = {
        offset: 0,
        limit: 1,
        shelfId: shelfId,
        orderStates: [DELIVERY_STATE.INIT, DELIVERY_STATE.WAIT_PICK,
          DELIVERY_STATE.PICKING, DELIVERY_STATE.RETURN_INIT,
          DELIVERY_STATE.WAIT_COMFIRM, DELIVERY_STATE.WAIT_SHELVE
        ]
      };
      orderService.queryDeliveryList(params).then(function(res) {
        if (res.totalElements > 0) {
          utilService.alertError('该货架存在一个未完成的送货单，将无法创建送货单!');
          $scope.disableEdit = true;
        } else {
          loadShelfProducts(shelfId);
        }
      });
    };
    initView();
  });
};
},{}],9:[function(require,module,exports){
module.exports = function (app) {
    app.controller('finance', function ($scope, $mdSidenav, $mdDialog, $sce, $element, CONSTANTS, $compile, $filter, NgTableParams, orderService, printService, utilService, modalService, financeService) {
        $scope.CONSTANTS = CONSTANTS;
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        $scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        $scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        $scope.limit = 20;
        $scope.finances = [];
        $scope.selectedOrders = [];
        $scope.isInvoice = true;
        $scope.settlementOrder = {};
        $scope.orderStateList = [{
            desc: '全部付款状态',
            code: ''
        }, {
            desc: '待付款',
            code: CONSTANTS.SETTLEMENT_STATE.WAIT_SETTLEMENT
        }, {
            desc: '已付款',
            code: CONSTANTS.SETTLEMENT_STATE.COMPLETED
        }];
        $scope.invoiceNeedStateList = CONSTANTS.getList('INVOICE_NEED_STATE', true, undefined, undefined, {'': '全部开票需求'});
        $scope.invoiceStateList = CONSTANTS.getList('INVOICE_STATE', true, undefined, undefined, {'': '全部票号'});
        $scope.queryFinanceConfig = {
            queryFinanceKey: '',
            companyName: '',
            financeStartTime: '',
            financeEndTime: '',
            orderStates: '',
            isInvoice: '',
            isUpdateTime: 0,
            isInvoiceNum: '',
            choices: CONSTANTS.getList('INVOICE_TIME_TYPE', false),
            companyKeyup: function (e) {
                var keycode = window.event ? e.keyCode : e.which;
                if (keycode == 13) {
                    $scope.financeTable.reload();
                    $scope.financeTable.page(1);
                }
            },
            selectIsUpadate: function (timeType) {
                $scope.queryFinanceConfig.isUpdateTime = timeType.code;
            }
        };

        $scope.getFinanceList = function () {
            $scope.financeTable = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                getData: function (params) {
                    var p = {};
                    $scope.offset = $scope.limit * (params.page() - 1);
                    p = {
                        offset: $scope.offset,
                        limit: $scope.limit,
                        companyName: $scope.queryFinanceConfig.companyName
                    };
                    if ($scope.queryFinanceConfig.financeStartTime !== '') { //非空字符串
                        p.financeStartTime = $scope.queryFinanceConfig.financeStartTime;
                    }
                    if ($scope.queryFinanceConfig.financeEndTime !== '') { //非空字符串
                        p.financeEndTime = new Date($scope.queryFinanceConfig.financeEndTime.getTime()+24*60*60*1000);
                    }
                    if ($scope.queryFinanceConfig.orderStates != '') { //3 4
                        p.orderStates = $scope.queryFinanceConfig.orderStates;
                    }
                    if ($scope.queryFinanceConfig.isInvoice !== '') { // 0  1
                        p.isInvoice = $scope.queryFinanceConfig.isInvoice;
                    }
                    if ($scope.queryFinanceConfig.isUpdateTime) { //1
                        p.isUpdateTime = $scope.queryFinanceConfig.isUpdateTime;
                    }
                    if ($scope.queryFinanceConfig.isInvoiceNum !== '') { //0 1
                        p.isInvoiceNum = $scope.queryFinanceConfig.isInvoiceNum;
                    }
                    return financeService.queryFinanceList(p).then(function (res) {
                        $scope.finances = res.content;
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.offset + 1));
                    });
                }
            });
        };
        $scope.getFinanceList();
        $scope.confirmPaymentDialog;
        $scope.invoiceDialog;
        $scope.confirmPaymentParam = {
            refId: '',
            dueFee: '', //企业应付款
            badDebtFee: '', //坏账抵扣额
            receiveFee: '', //企业到账金额
            receiveFeeTime: '', //到账时间
            receiveFeeTimeHour: ''
        };
        $scope.invoiceParam = {
            refId: '',
            invoiceFee: 0,
            invoiceNumber: '',
            expressNumber: '',
            expressCompany: {},
            needExpressNumber: true
        };
        $scope.expressCompanyChoice = CONSTANTS.getList('EXPRESS_COMPANY_TYPE', false);
        $scope.currentOrder = {};
        $scope.queryFinanceList = function () {
            $scope.financeTable.reload();
        };

        $scope.openFinanceDetail = function (order) {
            $scope.currentOrder = order;
            orderService.checkOrderDetail(CONSTANTS.ORDER_TYPE.SETTLEMENT, order.orderId, $scope);
        };
        $scope.selectFinanceCompany = function (company) {
            $scope.queryFinanceConfig.company = company;
            $scope.financeTable.reload();
        };
        //表格中导出excel
        $scope.exportExcel = function (order) {
            $scope.currentOrder = order;
            orderService.exportExcel(CONSTANTS.ORDER_TYPE.SETTLEMENT, order.orderId, $scope);
        };
        $scope.showInoviceAndPaymentWin = function (order, scope, type) {
            if (type) {
                scope.confirmPaymentParam.refId = order.orderId;
                scope.confirmPaymentParam.dueFee = $filter('rmb')(scope.currentOrder.orderFee);
                scope.confirmPaymentParam.badDebtFee = $filter('rmb')(order.orderDiscount);
                scope.confirmPaymentParam.receiveFee = '';
                scope.confirmPaymentParam.receiveFeeTime = new Date().getTime();
                scope.confirmPaymentParam.receiveFeeTimeHour = new Date().getTime();
                scope.confirmPaymentDialog.showDialog($scope);
            } else {
                scope.invoiceParam.refId = order.orderId;
                scope.invoiceParam.invoiceNumber = '';
                scope.invoiceParam.invoiceFee = '';
                scope.invoiceParam.expressCompany = $scope.expressCompanyChoice[0];
                scope.invoiceParam.expressNumber = '';
                scope.invoiceDialog.showDialog($scope);
            }
        };
        $scope.printOrder = function (orderType) {
            var html = orderService.getPrintHtmlInOrderModule(orderType);
            $scope.$applyAsync(function () {
                console.log(html);
                printService.printByDefaultPrinter(html);
            });
        };
        $scope.closeConfirmPaymentWin = function () {
            $scope.confirmPaymentDialog.closeDialog();
        };
        $scope.closeInvoiceWin = function () {
            $scope.invoiceDialog.closeDialog();
        };
        $scope.confirmPayment = function () {
            financeService.confirmPayment(angular.copy($scope.confirmPaymentParam)).then(function () {
                $scope.closeConfirmPaymentWin();
                orderService.checkOrderDetail(CONSTANTS.ORDER_TYPE.SETTLEMENT, $scope.currentOrder.orderId, $scope, true);
            });
        };
        $scope.createInvoice = function () {
            financeService.createInvoice(angular.copy($scope.invoiceParam)).then(function () {
                $scope.closeInvoiceWin();
                orderService.checkOrderDetail(CONSTANTS.ORDER_TYPE.SETTLEMENT, $scope.currentOrder.orderId, $scope, true);
            });
        };
        $scope.selectExpressCompany = function (expressCompany) {
            $scope.invoiceParam.expressCompany = expressCompany;
            if (expressCompany.code == CONSTANTS.EXPRESS_COMPANY_TYPE.XIEDAI) {
                $scope.invoiceParam.needExpressNumber = false;
            } else {
                $scope.invoiceParam.needExpressNumber = true;
            }
        };
        $scope.selectOrderState = function (choice) {
            $scope.queryFinanceConfig.orderStates = choice.code;
            $scope.financeTable.reload();
            $scope.financeTable.page(1);
        };
        $scope.selectInvoiceNeedState = function (choice) {
            $scope.queryFinanceConfig.isInvoice = choice.code;
            $scope.financeTable.reload();
            $scope.financeTable.page(1);
        };
        $scope.selectInvoiceState = function (choice) {
            $scope.queryFinanceConfig.isInvoiceNum = choice.code;
            $scope.financeTable.reload();
            $scope.financeTable.page(1);
        };

        //导出单据列表
        var checkInfo = function (data) {
            angular.forEach(data, function (item) {
                var t = _.findWhere($scope.selectedOrders , {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };

        /**
         * 勾选
         */
        $scope.updateSelection = function (e, order) {
            // debugger
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                $scope.selectedOrders.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                $scope.selectedOrders = _.without($scope.selectedOrders, order);
            }
        };
        $scope.selectAllOrder = function (e, data, checkall) {
            // debugger
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };

        $scope.exportOrder = function () {

            /*selectedOrders=selectedOrders.concat(orders);*/

            var dom = angular.element('<a></a>');
            var containerId = 'finance-table';
            var myDate = new Date();
            var mytime=myDate.toLocaleString();
            dom[0].href = $('#' + containerId).excelexportjs({
                containerid: containerId,
                datatype: 'table',
                returnUri: 'true'
            });
            dom[0].download = '财务管理' + '（' + mytime + '）' + '.xls';
            dom[0].click();
        };

  
        /**
         * 批量导出excel
         */
        $scope.batchExportExcel = function () {
            // debugger
            if ($scope.selectedOrders.length) {
                $scope.exportOrder($scope.selectedOrders);
            } else {
                alert('请先确定需要导出的数据!!!');
            }
        };

        $scope.filterItems = function (item) {
            // debugger
            return item.checked == true;
        };
    });
};

},{}],10:[function(require,module,exports){
/*选品单历史*/
module.exports = function(app) {
  app.controller('goodsChooseHistoryCtrl', function($scope, $compile,
    $templateCache, CONSTANTS, modalService, utilService, NgTableParams,
    goodsChooseService) {
    $scope.ORDER_STATE = CONSTANTS.GOODSCHOOSE_ORDER_STATE;
    $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    $scope.orderStates = CONSTANTS.getList('GOODSCHOOSE_ORDER_STATE');
    $scope.curOrderState = $scope.orderStates[0];

    $scope.queryParams = {};
    $scope.offset = 0;
    $scope.limit = 10;

    $scope.setOrderTable = function(queryParams) {
      $scope.queryParams.startTime = $scope.queryParams.startTime;
      $scope.queryParams.endTime = $scope.queryParams.endTime;
      $scope.orderTable = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        paginationMaxBlocks: 13,
        paginationMinBlocks: 2,
        getData: function(params) {
          return goodsChooseService.queryManagerOrderList({
            offset: (params.page() - 1) * $scope.limit,
            limit: $scope.limit,
            companyId: $scope.queryParams.companyId,
            startTime: $scope.queryParams.startTime ? $scope.queryParams
              .startTime.getTime() : null,
            endTime: $scope.queryParams.endTime ? $scope.queryParams
              .endTime.getTime() : null,
            orderStates: [$scope.ORDER_STATE.FINISH, $scope.ORDER_STATE
              .SYS_CANCLED
            ]
          }).then(function(res) {
            params.total(res.totalElements);
            return res.content;
          });
        }
      });

    };
    $scope.setOrderTable();

    //根据企业搜索
    $scope.searchByCompany = function(company) {
      $scope.queryParams.companyId = company.companyId;
      $scope.setOrderTable();
    };
    //清空企业搜索
    $scope.emptyCompanySearch = function() {
      delete $scope.queryParams.companyId;
    };
    //获取选购单详细
    var getOrderDetail = function(opts) {
      goodsChooseService.queryManagerOrderDetail({
        orderId: opts.orderId
      }).then(function(res) {
        $scope.order = res;
        $scope.order.name = '选购单' + '-' + res.companyName + '(' +
          utilService.parseTimeByLong(res.createTime,
            "yyyyMMddhhmmss") + ')';
        opts.didLoadData(res) || function() {

        };
      });
    };
    //查看选购单详细
    $scope.checkOrderDetail = function(order) {
      getOrderDetail({
        orderId: order.orderId,
        didLoadData: function(res) {
          $scope.orderModal = modalService.initModal({
            appendTo: angular.element(document.getElementsByClassName(
              'goods-choose-history')),
            scope: $scope,
            templateUrl: 'goodsChooseOrder/goodsChooseOrderTemplate.html'
          });
        }
      });
    };
    //打印
    $scope.print = function() {
      $scope.$applyAsync(function() {
        printService.printByDefaultPrinter($(
          '#goods-choose-order-table').parent().html());
      });
    };
    //详情页面导出Excel
    $scope.exportExcelOnDetail = function() {
      $scope.uri = $("#goods-choose-order-table").excelexportjs({
        containerid: 'goods-choose-order-table',
        datatype: 'table',
        returnUri: 'true'
      });
    };
    //在列表中导出Excel
    $scope.exportExcelOnList = function(order) {
      var excelTemplate = $compile($templateCache.get(
        'goodsChooseOrder/goodsChooseOrderTemplate.html'))($scope);
      angular.element(document.getElementById('exportExcelWrap')).append(
        excelTemplate);

      getOrderDetail({
        orderId: order.orderId,
        didLoadData: function(res) {
          $scope.$applyAsync(function() {
            var dom = angular.element('<a></a>');
            dom[0].href = $('#goods-choose-order-table').excelexportjs({
              containerid: "goods-choose-order-table",
              datatype: 'table',
              returnUri: 'true'
            });
            dom[0].download = $scope.order.name + '.xls';
            dom[0].click();
          });
        }
      });
    };
  });
}
},{}],11:[function(require,module,exports){
/*选品单*/
module.exports = function(app) {
  app.controller('goodsChooseOrderCtrl', function($scope, $state, $compile,
    $templateCache, CONSTANTS, modalService, utilService,
    goodsChooseService, NgTableParams, printService, shelfService) {
    $scope.ORDER_STATE = CONSTANTS.GOODSCHOOSE_ORDER_STATE;
    var ORDER_STATE = CONSTANTS.GOODSCHOOSE_ORDER_STATE;
    $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    $scope.orderStates = CONSTANTS.getList('GOODSCHOOSE_ORDER_STATE');
    $scope.curOrderState = $scope.orderStates[0];


    $scope.queryParams = {};
    $scope.offset = 0;
    $scope.limit = 10000;

    $scope.recordParams = {};

    $scope.setOrderTable = function() {
      $scope.orderTable = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        paginationMaxBlocks: 13,
        paginationMinBlocks: 2,
        getData: function(params) {
          return goodsChooseService.queryManagerOrderList({
            offset: (params.page() - 1) * $scope.limit,
            limit: $scope.limit,
            companyId: $scope.queryParams.companyId,
            startTime: $scope.queryParams.startTime ? $scope.queryParams
              .startTime.getTime() : null,
            endTime: $scope.queryParams.endTime ? $scope.queryParams
              .endTime.getTime() : null,
            orderStates: $scope.curOrderState.code != -1 ? [
              $scope.curOrderState.code
            ] : [ORDER_STATE.WAIT_VERIFY, ORDER_STATE.VERIFIED]
          }).then(function(res) {
            params.total(res.totalElements);
            return res.content;
          });
        }
      });

    };
    $scope.setOrderTable();
    //根据企业搜索
    $scope.searchByCompany = function(company) {
      $scope.queryParams.companyId = company.companyId;
      $scope.setOrderTable();
    };
    //清空企业搜索
    $scope.emptyCompanySearch = function() {
      delete $scope.queryParams.companyId;
    };
    //切换订单状态
    $scope.selectOrderState = function(item) {
      $scope.curOrderState = item;
      $scope.setOrderTable();
    };
    //获取选购单详细
    var getOrderDetail = function(opts) {
      goodsChooseService.queryManagerOrderDetail({
        orderId: opts.orderId
      }).then(function(res) {
        $scope.order = res;
        $scope.order.name = '选购单' + '-' + res.companyName + '(' +
          utilService.parseTimeByLong(res.createTime,
            "yyyyMMddhhmmss") + ')';
        opts.didLoadData(res) || function() {

        };
      });
    };
    //查看选购单明细
    $scope.checkOrderDetail = function(order) {
      getOrderDetail({
        orderId: order.orderId,
        didLoadData: function(res) {
          $scope.orderModal = modalService.initModal({
            appendTo: angular.element(document.getElementsByClassName(
              'goods-choose-order')),
            scope: $scope,
            templateUrl: 'goodsChooseOrder/goodsChooseOrderTemplate.html'
          });
        }
      });
    };
    //详情页面导出Excel
    $scope.exportExcelOnDetail = function() {
      $scope.uri = $("#goods-choose-order-table").excelexportjs({
        containerid: 'goods-choose-order-table',
        datatype: 'table',
        returnUri: 'true'
      });
    };
    //在列表中导出Excel
    $scope.exportExcelOnList = function(order) {
      var excelTemplate = $compile($templateCache.get(
        'goodsChooseOrder/goodsChooseOrderTemplate.html'))($scope);
      angular.element(document.getElementById('exportExcelWrap')).append(
        excelTemplate);

      getOrderDetail({
        orderId: order.orderId,
        didLoadData: function(res) {
          $scope.$applyAsync(function() {
            var dom = angular.element('<a></a>');
            dom[0].href = $('#goods-choose-order-table').excelexportjs({
              containerid: "goods-choose-order-table",
              datatype: 'table',
              returnUri: 'true'
            });
            dom[0].download = $scope.order.name + '.xls';
            dom[0].click();
          });
        }
      });
    };
    //打印
    $scope.print = function() {
      $scope.$applyAsync(function() {
        printService.printByDefaultPrinter($(
          '#goods-choose-order-table').parent().html());
      });
    };
    //批量打印
    $scope.batchPrint = function() {

    };
    //取消此单
    $scope.cacelOrder = function(order) {
      openRecordModal(order, CONSTANTS.GOODSCHOOSE_ORDER_STATE.SYS_CANCLED);
    };
    //接收
    $scope.receiveOrder = function(order) {
      openRecordModal(order, CONSTANTS.GOODSCHOOSE_ORDER_STATE.VERIFIED);
    };
    //创建选购单
    $scope.createPickOrder = function(order) {

      shelfService.queryShelfListByCompanyId({
        companyId: order.companyId
      }).then(function(res) {
        if (res.length) {
          window.location.href = '#deliveryEdit/0/' + order.orderId;
        } else {
          alert('该企业暂无货架，无法创建拣货单!');
        }
      });

    };
    //打开客满备注 填写框
    var openRecordModal = function(order, recordType) {
      $scope.recordParams.type = recordType;
      $scope.recordParams.orderId = order.orderId;
      $scope.recordParams.optRecord = '';
      $scope.recordModal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'goods-choose-order')),
        scope: $scope,
        templateUrl: 'modalRecord'
      });
    };
    //客满备注 确定
    $scope.confirmRecord = function(params) {
      goodsChooseService.modifyOrderState({
        orderId: params.orderId,
        orderState: params.type,
        optRecord: params.optRecord
      }).then(function(res) {
        $scope.orderModal.close();
        $scope.recordModal.close();
        $scope.orderTable.reload();
      });
    };
  });


};
},{}],12:[function(require,module,exports){
module.exports = function (app) {
    app.controller('holidayWelfare', function ($scope, NgTableParams, holidayWelfareService, $uibModal, modalService, utilService, printService, CONSTANTS, $mdDialog, orderService) {
        $scope.holidayWelfare = {};
        $scope.welfareTime = {
            scheduledTime: '',
            scheduledTimeDate: '',
            sellingTime: '',
            sellingTimeDate: '',
            overTime: '',
            overTimeDate: ''
        };
        $scope.order = {};
        $scope.settlementOrder = {};
        $scope.PAYMENT_STATUS = CONSTANTS.PAYMENT_STATUS;   // 支付状态
        $scope.ORDER_STATUS = CONSTANTS.ORDER_STATUS;   //订单状态
        $scope.BUY_TYPE = CONSTANTS.BUY_TYPE; //购买类型
        var ORDER_STATUS = $scope.ORDER_STATUS;
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE; //订单类型
        $scope.payment;
        $scope.primaryBtnTexts = {
            1: '收到款项',
            2: '完成配送'
        };
        $scope.orderStatus = {};
        $scope.settlementWay = {};
        $scope.queryWelfareOrderParams = {};
        $scope.queryParams = {
            payChannels: '', // 支付状态
            status: '', // 订单状态
            startTime: '', //开始时间
            endTime: '', //结束时间
            companyIds: '' //公司ID
        };
        $scope.searchByCompany = function (company) {
            $scope.queryParams.companyIds = company.companyId;
            $scope.getHolidayWelfareList();
        };
        //选择支付状态
        $scope.selectPaymentStatus = function (choice) {
            $scope.queryParams.payChannels = choice.code;
            $scope.tableParams.reload();
            $scope.tableParams.page(1);
        };
        //选订单状态
        $scope.selestOrderStatus = function (choice) {
            $scope.queryParams.status = choice.code;
            $scope.tableParams.reload();
            $scope.tableParams.page(1);
        };
        /***
         * 获取节假日福利全部订单
         */
        $scope.getHolidayWelfareList = function (queryParams) {
            // debugger
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.tableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    // debugger
                    var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        status: $scope.orderStatus.code,
                        payChannels: $scope.settlementWay.code,
                        type: 1
                    };
                    if ($scope.queryParams.companyIds !== '') {
                        p.companyIds = $scope.queryParams.companyIds;
                    }
                    var Sdate = new Date($scope.queryParams.startTime);

                    var Edate = new Date($scope.queryParams.endTime);
                    // debugger
                    if (!isNaN($scope.queryParams.startTime)) {
                        p.startTime = new Date(Sdate.getFullYear(), Sdate.getMonth(), Sdate.getDate(), 0, 0, 0).getTime();
                    }
                    if (!isNaN($scope.queryParams.endTime)) {

                        p.endTime = new Date(Edate.getFullYear(), Edate.getMonth(), Edate.getDate(), 23, 59, 59).getTime();
                    }
                    return holidayWelfareService.getAllWelfareOrders(angular.copy(p)).then(function (res) {
                        // debugger
                        var a = holidayWelfareService.parseData(res.content);
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(a, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            });
        };
        $scope.getHolidayWelfareList();

        /*打印*/
        //打印单据列表
        var printOrderArray = [];
        var checkInfo = function (data) {
            // debugger
            angular.forEach(data, function (item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        /**
         * 勾选
         */
        $scope.updateSelection = function (e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function (e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };

        /***
         * 批量打印
         */

        //打印
        $scope.printOrder = function (orders) {
            var temps = [];
            var aTemps = [];
            if (Object.prototype.toString.call(orders) == '[object Array]') {
                aTemps = orders;
            } else {
                aTemps = [orders];
            }
            angular.forEach(aTemps, function (item) {
                temps.push(item.id);
            });
            holidayWelfareService.getAllWelfareOrders({
                // ids:_.pluck(orders,'id')
                ids: temps
            }).then(function (res) {
                var holidayOrderDetails = res.content || [];
                $scope.isPrint = true;
                temps = orderService.printOrderDoms(holidayOrderDetails, $scope.ORDER_TYPE.HOLIDAY, $scope);
                // debugger
                console.log(temps);
                $scope.$applyAsync(function () {
                    var htmls = [];
                    console.log(temps);
                    angular.forEach(temps, function (item) {
                        // debugger
                        console.log(item[0].innerHTML);
                        htmls.push(item[0].innerHTML);
                    });
                    printService.printByDefaultPrinter(htmls);
                    console.log(htmls);
                });
            });
        };
        $scope.bathMultiPrint = function () {
            if (printOrderArray.length) {
                $scope.printOrder(printOrderArray);
            } else {
                $mdDialog.show($mdDialog.alert({
                    title: '提示',
                    textContent: '请选择需要打印的票据',
                    ok: '确认'
                }));
            }
        };
        /***
         * 明细
         */
        $scope.orderDetail = function (order) {
            // debugger
            /*if (order.order.status == "2") {
             $scope.payment = true;
             }*/
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementById('holidayWelfare')),
                scope: $scope,
                templateUrl: 'order/holidayWelfareParticularsTemplate.html'
            });
            $scope.order = order;
            $scope.order.name = order.address.contactName + '-' + order.order.eventTitle;
        };

        /***
         * 明细 --> 打印
         */
        $scope.holidayWelfareDetailPrint = function (orderType) {
            // debugger
            var html = orderService.getPrintHtmlInOrderModule(orderType);
            $scope.$applyAsync(function () {
                console.log(html);
                printService.printByDefaultPrinter(html);
            });
        };


        /***
         * 节假日订购单明细导出Excel表格
         */
        $scope.exportExcelOnDetail = function () {
            $scope.uri = $("#holiday-welfare-order-detail-table").excelexportjs({
                containerid: 'holiday-welfare-order-detail-table',
                datatype: 'table',
                returnUri: 'true'
            });

        };
        /***
         * 修改订单状态
         */
        //
        $scope.modifyOrderStatus = function (order) {
            var params = {orderId: order.order.id, notes: ''};
            switch (order.order.status) {
                case ORDER_STATUS.WAITING_PAYMENT://待收款
                    _receivePayment(params, order);
                    break;
                case ORDER_STATUS.WAITING_DISTRIBUTION://待配送
                    _completeDelivery(params);
                    break;
            }
        };
        /***
         * 收到款项
         */
        var _receivePayment = function (params, order) {
            // debugger
            holidayWelfareService.receivePayment(params).then(function (res) {
                // order.order.payChannel = CONSTANTS.PAYMENT_STATUS.BANK_CARD;
                $scope.modal.close();
                $scope.getHolidayWelfareList();
            });
        };

        /**
         * 完成配送
         */
        var _completeDelivery = function (params) {
            holidayWelfareService.completeDelivery(params).then(function (res) {
                $scope.modal.close();
                $scope.getHolidayWelfareList();
            });
        };
        /***
         * 明细 --> 取消此单
         */
        $scope.cacelOrder = function (order) {
            var params = {orderId: order.order.id, notes: ''};
            holidayWelfareService.cancelOrder(params).then(function (res) {
                $scope.modal.close();
                $scope.getHolidayWelfareList();
            });
        };

        /***
         * 全部结算下拉筛选
         */
        $scope.settlementStatusList = CONSTANTS.getList({
            clsOrName: 'PAYMENT_STATUS',
            defaultObj: {
                '': '全部结算'
            }
        });
        $scope._settlementWay = function (item) {
            // debugger
            $scope.settlementWay = item;
            $scope.getHolidayWelfareList();
        };

        /***
         * 全部订单下拉筛选
         */
        $scope.orderStatusList = CONSTANTS.getList({
            clsOrName: 'ORDER_STATUS',
            defaultObj: {
                '': '全部订单'
            }
        });
        $scope._orderStatus = function (item) {
            $scope.orderStatus = item;
            $scope.getHolidayWelfareList();
        };
    })
};


},{}],13:[function(require,module,exports){
/*
 *首页
 *homeController
 */
module.exports = function (app) {
  app.controller('home', function ($scope) {
    $scope.ports = [{
      name: '信息配置',
      route: '#configurationInformation',
      img: './img/configurationInformation.png'
    }, {
      name: '企业库',
      route: '#company',
      img: './img/icon-company.png'
    }, {
      name: '企业货架管理',
      route: '#shelfManage',
      img: './img/icon-shelf.png'
    }, {
      name: '新品推荐',
      route: '#newProductRecommend',
      img: './img/icon-product.png'
    }, {
      name: '商品管理',
      route: '#product',
      img: './img/icon-product.png'
    }, {
      name: '商品标签管理',
      route: '#labelsManagement',
      img: './img/labelsManagement.png'
    }, {
      name: '商品数据统计',
      route: '#salesStatistics',
      img: './img/icon-marketing.png'
    }, {
      name: '企业营销数据',
      route: '',
      img: './img/icon-marketing.png'
    }, {
      name: '货架巡查',
      route: '#shelf',
      img: './img/icon-check.png'
    }, {
      name: '单据中心',
      route: '',
      img: './img/icon-ticket.png'
    }, {
      name: '账号管理',
      route: '#account',
      img: './img/icon-account.png'
    }, {
      name: '回仓单',
      route: '#inStorage',
      img: './img/icon-in-storage.png'
    }, {
      name: '信息收集',
      route: '',
      img: './img/icon-in-storage.png'
    }, {
      name: '节假日福利',
      route: '#holidayWelfare',
      img: './img/holidayWelfare.png'
    }, {
      name: '期号实时动态',
      route: '#issueDynamic',
      img: './img/icon-issueDynamic.png'
    }, {
      name: '套餐配送动态',
      route: '#suiteDistributionDynamic',
      img: './img/icon-suiteDistributionDynamic.png'
    }, {
      name: '套餐配置管理',
      route: '#suiteCfgManage',
      img: './img/icon-suiteCfgManage.png'
    }, {
      name: '后续更多哦',
      route: '',
      img: './img/icon-marketing.png'
    }];
  });
};
},{}],14:[function(require,module,exports){
module.exports = function(app) {
	app.controller('inStorage', function($scope, $compile, $templateCache, CONSTANTS, modalService, NgTableParams, inStorageService, utilService, companyService, productService, accountService,orderService) {
		$scope.utilService = utilService;
		$scope.CONSTANTS = CONSTANTS;
		$scope.ticketType = CONSTANTS.IN_STORAGE_ORDER_TYPE;
		$scope.profitLevel = CONSTANTS.PROFIT_LEVEL;
		$scope.queryParams = {};
		$scope.offset = 0;
		$scope.limit = 25;
		$scope.queryParams.startTime = new Date(utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd') + ' 00:00:00');
		$scope.queryParams.endTime = new Date(utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd') + " 23:59:59");
		var initView = function() {
			var excelTemplate1 = $compile($templateCache.get('inStorage/deliveryInStorageTemplate.html'))($scope);
			angular.element(document.getElementById('exportExcelWrap')).append(excelTemplate1);
			var excelTemplate2 = $compile($templateCache.get('inStorage/refundInStorageTemplate.html'))($scope);
			angular.element(document.getElementById('exportExcelWrap')).append(excelTemplate2);
		};
		initView();
		//查询
		$scope.searchInStorage = function(params) {
			var startTime = params.startTime.getTime(),
				endTime = params.endTime.getTime();
			// $scope.tableParams.reload();
			$scope.tableParams.settings({
				dataset: []
			});
		};
		$scope.getParams = function() {
			var params = {
				// pageNo: $scope.pageNo,
				offset: $scope.offset,
				limit: $scope.limit,
				startTime: $scope.queryParams.startTime.getTime(),
				endTime: $scope.queryParams.endTime.getTime(),
				companyName: $scope.queryParams.companyName,
				orderTypes: $scope.queryParams.orderType,
				creatorId: $scope.queryParams.creatorId,
				orderStates: $scope.queryParams.orderStates,
				updateStatus: $scope.queryParams.updateStatus,
				companyId: $scope.queryParams.companyId,
				confirmId: $scope.queryParams.confirmId,
				modified: $scope.queryParams.modified
			};

			angular.forEach(params, function(v, k) {
				if (v == '-1') {
					delete params[k];
				}
			});
			if (!params.companyName) {
				delete params['companyId'];
			}
			return params;
		};
		$scope.typeHeadConfigs = {
			//不知道什么意思
			debounce: {
				'default': 500,
				'blur': 250
			},
			getterSetter: true
		};
		//搜索加载
		$scope.getTypeHeadOptions = function(value) {
			$scope.queryParams.companyId = '';
			return companyService.queryCompanyList({
				pageNo: 0,
				delState: 0,
				companyName: value
			}).then(function(res) {
				return res.content;
			});
		};
		//搜索选择
		$scope.selectTypeHeadOptions = function(item, model, label, event) {
			$scope.queryParams.companyId = item.companyId;
			$scope.tableParams.settings({
				dataset: []
			});
		};

		$scope.tableParams = new NgTableParams({
			count: $scope.limit
		}, {
			counts: [],
			paginationMaxBlocks: 25,
			paginationMinBlocks: 2,
			getData: function(params) {
				$scope.offset = (params.page() - 1) * $scope.limit;
				var params1 = $scope.getParams();
				return inStorageService.getInStorageList(params1).then(function(res) {
					params.total(res.totalElements);
					$scope.inStorageData = res.content;
					return accountService.indexAccount($scope.inStorageData, $scope.offset + 1);
				});
			}
		});
		//单据类型
		$scope.ticketData = [{
			markId: '-1',
			name: '全部单据类型'
		}, {
			markId: '1',
			name: '送货修改确认单'
		}, {
			markId: '2',
			name: '退货确认单'
		}];
		$scope.curTicketData = $scope.ticketData[0];
		$scope.localLang = {
			selectAll: "全选",
			selectNone: "全不选",
			reset: "重置",
			search: "请输入搜索内容...",
			nothingSelected: "12312"
		};
		$scope.orderTypeSelect = function(data) {
			$scope.offset = 0;
			$scope.limit = 25;
			$scope.queryParams.orderType = data.markId;
			// $scope.tableParams.reload();
			$scope.tableParams.settings({
				dataset: []
			});
		};

		//单据操作人
		$scope.opeaterData = [{
			managerId: '-1',
			name: '全部单据操作人'
		}];
		$scope.curOpeaterData = $scope.opeaterData[0];
		$scope.opeaterDataFun = function() {
			inStorageService.getAllManager().then(function(res) {
				$scope.opeaterData = _.union($scope.opeaterData, res.content);
				$scope.stockManagerData = angular.copy($scope.opeaterData);
				$scope.stockManagerData[0].name = '全部入库确认人';
			});
		}();

		$scope.managerSelect = function(data) {
			$scope.queryParams.creatorId = data.managerId;
			// $scope.tableParams.reload();
			$scope.tableParams.settings({
				dataset: []
			});
		};
		//状态
		$scope.orderStateData = [{
			markId: '-1',
			name: '全部状态'
		}, {
			markId: '0',
			name: '未入库'
		}, {
			markId: '1',
			name: '已入库'
		}];
		$scope.curOrderStateData = {
			markId: '-1',
			name: '全部状态'
		};
		$scope.orderStatusSelect = function(data) {
			$scope.queryParams.orderStates = data.markId;
			// $scope.tableParams.reload();
			$scope.tableParams.settings({
				dataset: []
			});
		};
		//入库确认人
		$scope.stockManagerData = angular.copy($scope.opeaterData);
		$scope.stockManagerSelect = function(data) {

			$scope.queryParams.confirmId = data.managerId;
			// $scope.tableParams.reload();
			$scope.tableParams.settings({
				dataset: []
			});
		};
		$scope.stockManagerData[0].name = '全部入库确认人';
		$scope.curStockManagerData = $scope.stockManagerData[0];
		//是否修改

		$scope.modifiedData = [{
			markId: '-1',
			name: '全部修改状态'
		}, {
			markId: '0',
			name: '否'
		}, {
			markId: '1',
			name: '是'
		}];
		$scope.curModifiedData = $scope.modifiedData[0];
		$scope.modifiedSelect = function(data) {
			$scope.queryParams.modified = data.markId;
			$scope.tableParams.settings({
				dataset: []
			});
		};

		/**
		查看明细
		*/
		$scope.stockOrderInfoData = {};
		$scope.productItems = [];
		$scope.viewDetail = function(obj) {
			var orderType = obj.orderType,
				orderState = obj.orderState;
			$scope.selectedObj = [];
			inStorageService.getInStorageDetail({
				orderId: obj.orderId
			}).then(function(res) {
				$scope.stockOrderInfoData = res;
				$scope.productItems = angular.copy(res.items);
				_.each($scope.productItems, function(v, k) {
					v.positionItem = v.positions[0] && v.positions[0].name;
					if ($scope.stockOrderInfoData.orderType == 1) {
						v.oldConfirmNum = parseInt(v.refItemNum) - parseInt(v.refConfirmNum);
					}
				});
				$scope.productItems = _.sortBy($scope.productItems, 'positionItem');

				if (orderType == 2) {
					//退货确认单详情Modal
					$scope.inStorageInitModal('modal-refund-confirm-ticket');
				} else if (orderType == 1) {

					$scope.inStorageInitModal('modal-delivery-modify-confirm-ticket');
				}
			});
		};
		$scope.getPositions = function(data) {
			var arr = [];
			_.each(data, function(v, k) {
				arr.push("'"+v.name);
			});
			return arr.join('<br/>');
		};

		$scope.errorTypeData = [{
			markId: 'A',
			name: '单据录错',
			selected: false
		}, {
			markId: 'B',
			name: '仓库错发',
			selected: false
		}, {
			markId: "C",
			name: "仓库漏发",
			selected: false
		}, {
			markId: "D",
			name: "仓库多发",
			selected: false
		}, {
			markId: "E",
			name: "客户不要",
			selected: false
		}, {
			markId: "F",
			name: "产品破损",
			selected: false
		}, {
			markId: "G",
			name: "产品临期",
			selected: false
		}, {
			markId: "H",
			name: "产品过期",
			selected: false
		}, {
			markId: "I",
			name: "其它",
			selected: false
		}];
		//打开库存修改框
		$scope.stockQueryParams = {};
		$scope.stockDeltaWin = function(item, index) {
			if ($scope.stockOrderInfoData.orderState == 0) {
				$scope.errorTypeSelectMarkId = '';
				_.each($scope.errorTypeData, function(v, k, obj) {
					v.selected = false;
				});
				$scope.stockQueryParams = {
					mode: item.confirmNum >= 0 ? 'add' : 'minus',
					confirmRecord: item.confirmRecord
				};
				$scope.inStorageInitModal('modal-modifystock', 'sm', 'row');
				$scope.stockDeltaWinItem = item;
			}
		};
		$scope.localLang = {
			selectAll: "全选",
			selectNone: "全不选",
			reset: "重置",
			search: "Type here to search...",
			nothingSelected: "无"
		};

		$scope.errorTypeSelectMarkId = '';
		$scope.stockDeltaWinConfirm = function(params) {
			if (params.typeOutPutData.length == 0) {
				alert('请选择原因！');
				return;
			}
			var index = _.findIndex($scope.productItems, $scope.stockDeltaWinItem);
			$scope.stockDeltaWinItem.confirmRecord = params.confirmRecord;
			$scope.stockDeltaWinItem.oldConfirmNum = $scope.stockDeltaWinItem.confirmNum;
			$scope.stockDeltaWinItem.confirmNum = params.mode == 'add' ? params.number : '-' + params.number;
			this.$close();
		};
		//选择错误类型
		$scope.errorTypeSelect = function(item) {
			$scope.errorTypeSelectMarkId = item.markId;
			if (item.markId == 'I') {
				$scope.stockQueryParams.confirmRecord = '';
			} else {
				$scope.stockQueryParams.confirmRecord = item.name;
			}

		};
		$scope.inStorageInitModal = function(templateUrl, size, parentClass) {
			parentClass = parentClass ? parentClass : 'inStorage';
			size = size ? size : 'lg';
			modalService.initModal({
				appendTo: angular.element(document.getElementsByClassName(parentClass)),
				templateUrl: templateUrl,
				scope: $scope,
				size: size
			});
		};
		/*新增商品*/
		var tmpPutSaleProductList = [],
			tmpPutSaleProductIdList = [];
		var getProductParams = function(params) {
			return _.pick(params, function(value, key) {
				// return value >= 0 && value != -1;
				return value != -1;
			});
		};
		$scope.productOffset = 0;
		$scope.productLimit = 5;
		var setNewProductsTable = function() {
			$scope.newProdcutsTable = new NgTableParams({
				count: $scope.productLimit
			}, {
				counts: [],
				paginationMaxBlocks: 13,
				paginationMinBlocks: 2,
				getData: function(params) {
					$scope.productOffset = $scope.productLimit * (params.page() - 1);
					var search = getProductParams($scope.productQueryParams);
					search.offset = $scope.productOffset;
					search.limit = $scope.productLimit;
					return productService.queryProductByKey(search).then(function(res) {
						params.total(res.totalElements);
						var data = [];
						angular.forEach(res.content, function(d, i, a) {
							d.header.category = d.category;
							d.header.positions = d.positions;
							data.push(d.header);
						});
						angular.forEach($scope.productItems, function(v, k) {

							index = _.findIndex(data, {
								id: v.id || v.productId
							});

							if (index >= 0) {
								data[index].select = true;
								data[index].isAddSelect = 'isAddSelect';
								// data.splice(index, 1);
							}
						});

						return data;
					});

				}
			});
		};

		var queryProductCategoryList = function() {
			$scope.categoryList = [{
				id: '-1',
				categoryName: '全部品类'
			}];
			$scope.curCateotyList = $scope.categoryList[0];
			productService.queryProductCategoryList().then(function(res) {
				angular.forEach(res, function(category, index) {
					$scope.categoryList.push(category);
				});
			});
		};
		/*
		 * 利润等级
		 */
		$scope.profitLevelData = [{
			profitLevel: -1,
			name: '全部利润等级'
		}, {
			profitLevel: 1,
			name: '低利润等级'
		}, {
			profitLevel: 5,
			name: '中等利润等级'
		}, {
			profitLevel: 9,
			name: '高利润等级'
		}, {
			profitLevel: 0,
			name: '未知'
		}];

		$scope.curProfitLevelData = {
			profitLevel: '-1',
			name: '全部利润等级'
		};

		//打开 新品新增商品
		$scope.addProductWin = function() {
			$scope.productQueryParams = {};
			queryProductCategoryList();
			$scope.inStorageInitModal('modalProductList', '', 'row');
		};

		//品类选择
		$scope.selectCategoryCallback = function(item) {
			if (item.id) {
				$scope.productQueryParams.categoryId = item.id;
				setNewProductsTable();
			}
		};
		//利润等级选择
		$scope.profitSelectCallback = function(item) {
			$scope.productQueryParams.profitLevel = item.profitLevel;
			setNewProductsTable();
		};
		//搜索商品
		$scope.searchProduct = function(queryParams) {
			$scope.productQueryParams.productName = queryParams.productName;
			setNewProductsTable();
		};
		$scope.keyPressSearchProduct = function(e, queryParams) {
			if (e.keyCode == 13) { //回车键
				$scope.searchProduct(queryParams);
			}
		};
		$scope.selected = [];
		$scope.selectedObj = [];
		var updateSelected = function(action, id, name) {
			if (action == 'add' && $scope.selected.indexOf(id) == -1) {
				$scope.selected.push(id);
				$scope.selectedObj.push(name);
			}
			if (action == 'remove' && $scope.selected.indexOf(id) != -1) {
				var idx = $scope.selected.indexOf(id);
				$scope.selected.splice(idx, 1);
				$scope.selectedObj.splice(idx, 1);
			}
		};

		//商品选择
		$scope.chkboxChange = function(product, $event) {

			var checkbox = $event.target;
			var action = (checkbox.checked ? 'add' : 'remove');
			updateSelected(action, product.id, product);
		};
		//新增商品 确认
		$scope.oldSelectedObj = [];
		$scope.confirmPutSale = function() {
			var pItems = $scope.productItems;
			var sObj = $scope.selectedObj;
			var vId, v1Id, elem;
			if (pItems.length > 0) {
				_.each(sObj, function(v, k, obj) {
					vId = v.id || v.productId;
					elem = _.findWhere(pItems, {
						productId: vId
					});
					if (!elem) {
						elem = angular.copy(v);
						elem.productId = elem.id;
						elem.itemId = '';
						elem.confirmNum = 0;
						elem.confirmRecord = '';

						$scope.productItems.push(elem);
					}
				});
			} else {
				$scope.productItems = angular.copy($scope.selectedObj);

			}
			$scope.selectedObj = [];
			$scope.selected = [];

			this.$close();
		};

		//新增商品 删除
		$scope.removePutSaleProduct = function(i, item) {
			var id = item.id || item.productId;
			var index = _.findWhere($scope.selectedObj, {
				id: id
			});
			$scope.productItems.splice(i, 1);
		};
		//修改明细
		$scope.stockConfirmDetail = function() {
			var orderDetail = $scope.stockOrderInfoData,
				newItems = [],
				me = this;
			angular.forEach($scope.productItems, function(v, k) {
				newItems.push({
					itemId: v.itemId || '',
					confirmNum: v.confirmNum,
					confirmRecord: v.confirmRecord,
					productId: v.id || v.productId
				});
			});
			inStorageService.updateInStorageDetail({
				orderId: orderDetail.orderId,
				orderState: 1,
				items: newItems,
			}).then(function() {
				me.$close();
				$scope.tableParams.reload();
			});
		};
		//导出Excel
		$scope.exportExcel = function(order) {
			var orderType = order.orderType;
			var containerid;
			switch (orderType) {
				case $scope.ticketType.DELIVERY_MODIFY_CONFIRM:
					containerid = 'delivery-in-storage-table';
					break;
				case $scope.ticketType.REFUND_CONFIRM:
					containerid = 'refund-in-storage-table';
					break;
			}
			var dom = angular.element('<a></a>');
			dom[0].href = $("#" + containerid).excelexportjs({
				containerid: containerid,
				datatype: 'table',
				returnUri: 'true'
			});
			dom[0].download = $scope.ticketType.DESC[orderType] + '-' + order.companyName + '-' + order.shelfName + '(' + utilService.parseTimeByLong(order.createTime, 'yyyyMMddhhmmss') + ').xls';
			dom[0].click();
		};
		//查看关联送货单
		$scope.checkDeliveryOrder = function(refId){
            orderService.queryDeliveryDetail({'orderId': refId}).then(function(res) {
                $scope.deliveryOrder = res;
                $scope.deliveryOrder.name = '送货单' + '-' + $scope.deliveryOrder.companyName + '-' + $scope.deliveryOrder.shelfName + 
                                            '(' + utilService.parseTimeByLong($scope.deliveryOrder.createTime, 'yyyyMMddhhmmss') + ')';
                $scope.deliveryOrder.putSaleProductList = [];
                $scope.deliveryOrder.supplementProductList = [];
                $scope.deliveryOrder.pullSaleProductList = [];

                angular.forEach($scope.deliveryOrder.items, function(item, i) {
                    switch (item.itemType) {
                        case 1:
                            $scope.deliveryOrder.putSaleProductList.push(item);
                            break;
                        case 2:
                            $scope.deliveryOrder.supplementProductList.push(item);
                            break;
                        case 3:
                            $scope.deliveryOrder.pullSaleProductList.push(item);
                            break;
                    }
                });
                $scope.deliveryOrderModal = modalService.initModal({
                    appendTo: angular.element(document.getElementsByClassName('inStorage')),
                    scope: $scope,
                    templateUrl: 'order/deliveryOrderTemplate.html'
                });
            });
		};
	});
};
},{}],15:[function(require,module,exports){
/*
 *信息收集ljl
 *informationController
 */
module.exports = function(app) {
    app.controller('information', function($scope, $compile, $element, NgTableParams, shelfService, companyService, modalService) {
        var companyInformationCreateModal;
        $scope.infoModel = {
            staffNumber: [
                { desc: '空', value: 0 },
                { desc: '0-30人', value: 1 },
                { desc: '30-50人', value: 2 },
                { desc: '50-100人', value: 3 },
                { desc: '100-300人', value: 4 },
                { desc: '300-500人', value: 5 },
                { desc: '500人以上', value: 6 }
            ],
            genderRatio: [
                { desc: '空', value: 0 },
                { desc: '男生偏多', value: 1 },
                { desc: '女生偏多', value: 2 },
                { desc: '男女均衡', value: 3 }
            ],
            officeTime: [
                { desc: '空', value: 0 },
                { desc: '965', value: 1 },
                { desc: '995', value: 2 },
                { desc: '966', value: 3 },
                { desc: '996', value: 4 }
            ],
            staffType: [
                { desc: '空', value: 0 },
                { desc: '技术类', value: 1 },
                { desc: '销售类', value: 2 },
                { desc: '混合类', value: 3 }
            ],
            overtime: [
                { desc: '空', value: 0 },
                { desc: '多', value: 1 },
                { desc: '少', value: 2 }
            ],
            deliveryTime: [
                { desc: '空', value: 0 },
                { desc: '工作日', value: 1 },
                { desc: '工作日+周六', value: 2 },
                { desc: '工作日+周末', value: 3 }
            ],
            deliveryCycle: [
                { desc: '空', value: 0 },
                { desc: '一周两次', value: 1 },
                { desc: '一周一次', value: 2 },
                { desc: '两周一次', value: 3 },
                { desc: '一月一次', value: 4 }
            ],
            singlePrice: [
                { desc: '空', value: 0 },
                { desc: '0-2元', value: 1 },
                { desc: '2-4元', value: 2 },
                { desc: '4-10元', value: 3 }
            ],
            pricePrefer: [
                { desc: '空', value: 0 },
                { desc: '价格不敏感', value: 1 },
                { desc: '中等混搭', value: 2 },
                { desc: '低价', value: 3 }
            ],
            brandLevel: [
                { desc: '空', value: 0 },
                { desc: '无所谓', value: 1 },
                { desc: '大品牌', value: 2 },
                { desc: '进口', value: 3 },
                { desc: '国产', value: 4 }
            ],
            companyAtmosphere: [
                { desc: '空', value: 0 },
                { desc: '保守', value: 1 },
                { desc: '开放', value: 2 },
                { desc: '激情', value: 3 }
            ],
            companyLevel: [
                { desc: '空', value: 0 },
                { desc: '低档', value: 1 },
                { desc: '中档', value: 2 },
                { desc: '高档', value: 3 }
            ],
            welfareConsist: [
                { desc: '空', value: 0 },
                { desc: '无福利', value: 1 },
                { desc: '提供免费零食', value: 2 },
                { desc: '补贴零食费用', value: 3 }
            ],
            fivemeter: [
                { desc: '空', value: 0 },
                { desc: '没有', value: 1 },
                { desc: '有', value: 2 }
            ],
            foodPrefers: [
                { desc: '空', value: 0 },
                { desc: '饼干', value: 1 },
                { desc: '糕点', value: 2 },
                { desc: '膨化', value: 3 },
                { desc: '油炸', value: 4 },
                { desc: '糖果', value: 5 },
                { desc: '蜜饯', value: 6 },
                { desc: '坚果', value: 7 },
                { desc: '加工-肉类', value: 8 },
                { desc: '加工-豆类', value: 9 },
                { desc: '加工-植物', value: 10 },
                { desc: '冲泡', value: 11 },
                { desc: '其他', value: 12 }
            ],
            drinkPrefers: [
                { desc: '空', value: 0 },
                { desc: '碳酸', value: 1 },
                { desc: '果汁', value: 2 },
                { desc: '茶类', value: 3 },
                { desc: '咖啡', value: 4 },
                { desc: '冲饮', value: 5 },
                { desc: '乳制品', value: 6 }
            ],
            productFunctions: [
                { desc: '空', value: 0 },
                { desc: '早餐类', value: 1 },
                { desc: '加班类', value: 2 },
                { desc: '解馋类', value: 3 },
                { desc: '解渴类', value: 4 },
                { desc: '充饥类', value: 5 },
                { desc: '充电类', value: 6 }
            ]
        };
        $scope.company = {
            companyName: '',
            companyId: ''
        };
        $scope.createPreferCompany = {
            companyName: '',
            companyId: ''
        };
        $scope.typeHeadOptions = [{ companyName: '123', companId: '123' }, { companyName: '12345', companId: '12345' }, { companyName: '1234567', companId: '1234567' }];
        $scope.typeHeadConfigs = {
            debounce: {
                'default': 500,
                'blur': 250
            },
            getterSetter: true
        };
        $scope.info = {
            companyId: $scope.createPreferCompany.companyId,
            companyName: '',
            staffNumber: '',
            genderRatio: '',
            officeTime: '',
            staffType: '',
            overtime: '',
            deliveryPrice: '',
            monthBudget: '',
            deliveryTime: '',
            deliveryCycle: '',
            fivemeter: '',
            shelfPositions: [],
            foodPrefers: [],
            foodPreferType: [],
            foodPreferName: [],
            drinkPrefers: [],
            drinkPreferType: '',
            drinkPreferName: '',
            productFunctions: [],
            productFunctionType: '',
            ProductFunctionStr: '',
            singlePrice: '',
            pricePrefer: '',
            brandLevel: '',
            companyAtmosphere: '',
            companyLevel: '',
            welfareConsist: '',
            note: ''
        };
        $scope.informationHeads_alpha = [{
            title: '公司名称',
            field: 'companyName'
        }, {
            title: '合作模式',
            field: 'statusAlias'
        }, {
            title: '食物偏好',
            field: 'foodPrefers',
            getValue: function(v, r, index, scope, field) {
                var html = [];
                angular.forEach(v, function(item) {
                    html.push(_.findWhere($scope.infoModel[field], { value: item.value }).desc + '-' + item.name);
                });
                return html.join(' | ');
            }
        }, {
            title: '饮料偏好',
            field: 'drinkPrefers',
            getValue: function(v, r, index, scope, field) {
                var html = [];
                angular.forEach(v, function(item) {
                    html.push(_.findWhere($scope.infoModel[field], { value: item.value }).desc + '-' + item.name);
                });
                return html.join(' | ');
            }
        }, {
            title: '商品功能',
            field: 'productFunctions',
            getValue: function(v, r, index, scope, field) {
                var html = [];
                angular.forEach(v, function(item) {
                    html.push(_.findWhere($scope.infoModel[field], { value: item.value }).desc + '-' + item.name);
                });
                return html.join(' | ');

            }
        }, {
            title: '单品价格',
            field: 'singlePrice',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, {
            title: '价格偏好',
            field: 'pricePrefer',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, {
            title: '品牌度',
            field: 'brandLevel',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, {
            title: '公司氛围',
            field: 'companyAtmosphere',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, {
            title: '公司档次',
            field: 'companyLevel',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, {
            title: '福利组成',
            field: 'welfareConsist',
            getValue: function(v, r, index, scope, field) {
                return _.findWhere($scope.infoModel[field], { value: v }).desc;
            }
        }, { title: '备注', field: 'note' }, {
            title: '操作',
            field: 'command',
            getValue: function() {
                return '<button class="btn btn-default btn-sm"><span class="glyphicon glyphicon-pencil"></span></button>';
            }
        }];
        $scope.informationHeads = [{
                title: '公司名称',
                field: 'companyName'
            }, {
                title: '货架位置',
                field: 'shelfPositions',
                getValue: function(v, r, index, scope, field) {
                    var str = [];
                    angular.forEach(v, function(item) {
                        var string = item.shelfName;
                        if (item.positionImg) {
                            string += (':<img style="width:26px;height26px;" src="' + window.cfg.picUrl + item.positionImg + '"/>');
                        }
                        str.push(string);
                    });
                    return '<span>' + str.join('') + '</span>';
                }
            }, {
                title: '公司人数',
                field: 'staffNumber',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '男女比例',
                field: 'genderRatio',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '上班时间',
                field: 'officeTime',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '人员类型',
                field: 'staffType',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '加班情况',
                field: 'overtime',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            },
            { title: '建议送货金额/次', field: 'deliveryPrice' },
            { title: '每月预算', field: 'monthBudget' }, {
                title: '送货时间',
                field: 'deliveryCycle',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '送货周期',
                field: 'deliveryTime',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '周边0.5km是否有店',
                field: 'fivemeter',
                getValue: function(v, r, index, scope, field) {
                    return _.findWhere($scope.infoModel[field], { value: v }).desc;
                }
            }, {
                title: '操作',
                field: 'command',
                getValue: function() {
                    return '<button class="btn btn-default btn-sm"><span class="glyphicon glyphicon-pencil"></span></button>';
                }
            }
        ];
        $scope.informationTable = new NgTableParams({}, {
            counts: [],
            dataset: []
        });
        $scope.resetCreateCompanyModel = function() {
            $scope.createPreferCompany = {
                companyName: '',
                companyId: ''
            };
            $scope.info.foodPrefers = [];
            $scope.info.drinkPrefers = [];
            $scope.info.productFunctions = [];
        };
        $scope.getTypeHeadOptions = function(value) { //搜索加载
            return companyService.queryCompanyList({
                pageNo: 0,
                delState: 0,
                companyName: value
            }).then(function(res) {
                return res.content;
            });
        };
        $scope.selectTypeHeadOptions = function(item, model, label, event, type) { //搜索选择
            if (type == 'create') {
                $scope.createPreferCompany = item;
                shelfService.queryShelfListByCompanyId({
                    companyId: $scope.createPreferCompany.companyId
                }).then(function(res) {
                    angular.forEach(res, function(item) {
                        $scope.info.shelfPositions.push({
                            shelfName: item.shelfName,
                            shelfId: item.id
                        });
                    });
                });
            } else {
                $scope.company = item;
                companyService.queryCompanyInformation({
                    companyId: $scope.company.companyId
                }).then(function(res) {
                    var data = [];
                    angular.forEach(res, function(item) {
                        item.detailInfo.companyName = item.companyName;
                        data.push(angular.extend(item, item.detailInfo));
                    });
                    $scope.informationTable.settings({
                        dataset: data
                    });
                });
            }
        };
        //创建企业信息
        $scope.openCreateCompanyInformationWin = function() {
            $scope.resetCreateCompanyModel();
            companyInformationCreateModal = modalService.initModal({
                templateUrl: 'informationCreateModal',
                appendTo: $element,
                scope: $scope,
                ok: $scope.createCompanyInformationConfirm
            });
        };
        $scope.createCompanyInformationConfirm = function() {
            if (!$scope.createPreferCompany.companyId) {
                window.alert('请选择公司！');
                return;
            }
            return companyService.createCompanyInformation({
                companyId: $scope.createPreferCompany.companyId,
                info: $scope.info
            });
        };
        //创建喜好
        $scope.addPrefer = function(type) {
            $scope.info[type].push({
                value: '',
                name: ''
            });
        };
        //删除洗好
        $scope.deletePrefer = function(type, index) {
            var prefers = $scope.info[type];
            $scope.info[type] = _.without(prefers, prefers[index]);
        };
        //下拉框选择
        $scope.selectOption = function(obj, type, index) {
            var infos = $scope.info[type];
            if (angular.isArray(infos)) {
                infos[index].value = obj.value;
            } else {
                $scope.info[type] = obj.value;
            }
        };

    });
};

},{}],16:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/11/23.
 */
module.exports = function (app) {
    app.controller('issueDynamic', function ($scope, NgTableParams, $uibModal, modalService, utilService, suiteService, CONSTANTS, $mdDialog, orderService, printService) {

        $scope.SUITE_STATUS = CONSTANTS.SUITE_STATUS;//套餐状态
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;//订单类型
        $scope.DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;//送货单状态
        $scope.ISSUE_ACTIVE = CONSTANTS.ISSUE_ACTIVE;//期号类型
        $scope.queryParams = {
            issueId: '', //期号ID
            companyName: '',    //企业名称
            issueStartTime: '', //创建期号开始时间
            issueEndTime: '',    //创建期号结束时间
            companyId: '', //公司ID
            sortType: ''  //排序
        };
        /**
         * 期号实时动态列表
         */
        $scope.issueDynamicList = function (queryParams) {
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.tableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        sortType:$scope.queryParams.sortType
                    };
                    if ($scope.queryParams.companyName !== '') {
                        p.companyName = $scope.queryParams.companyName;
                    }
                    if (!isNaN($scope.queryParams.issueStartTime)) {
                        p.issueStartTime = $scope.queryParams.issueStartTime;
                    }
                    if (!isNaN($scope.queryParams.issueEndTime)) {
                        p.issueEndTime = $scope.queryParams.issueEndTime;
                    }
                    return suiteService.queryIssueDynamic(angular.copy(p)).then(function (res) {
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            })
        };
        $scope.issueDynamicList();



        //根据企业搜索
        $scope.searchByCompany = function(company) {
            $scope.queryParams.companyName = company.companyName;
            $scope.issueDynamicList();
        };

        //清空企业搜索
        $scope.emptyCompanySearch = function() {
            delete $scope.queryParams.companyName;
        };


        /**
         * 打印
         * 打印单据列表
         */
        var printOrderArray = [];
        var checkInfo = function (data) {
            angular.forEach(data, function (item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        /**
         * 勾选
         */
        $scope.updateSelection = function (e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function (e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };

        /**
         * 批量打印
         */
        $scope.printOrder = function (orders) {
            var temps = [];
            var aTemps = [];
            if (Object.prototype.toString.call(orders) == '[object Array]') {
                aTemps = orders;
            } else {
                aTemps = [orders];
            }
            angular.forEach(aTemps, function (item) {
                temps.push(item.id);
            });
            // var ids = temps;
            var ids = {
                ids:temps
            };
            suiteService.issueDynamicPrint(
                // ids:_.pluck(orders,'id')
                angular.copy(ids)
            ).then(function (res) {
                var orderDetails = res || [];
                $scope.isPrint = true;
                temps = orderService.printOrderDoms(orderDetails, $scope.ORDER_TYPE.ISSUEDYNAMIC, $scope);
                console.log(temps);
                $scope.$applyAsync(function () {
                    var htmls = [];
                    console.log(temps);
                    angular.forEach(temps, function (item) {
                        console.log(item[0].innerHTML);
                        htmls.push(item[0].innerHTML);
                    });
                    printService.printByDefaultPrinter(htmls);
                    console.log(htmls);
                });
            });
        };
        $scope.bathMultiPrint = function () {
            if (printOrderArray.length) {
                $scope.printOrder(printOrderArray);
            } else {
                $mdDialog.show($mdDialog.alert({
                    title: '提示',
                    textContent: '请选择需要打印的票据',
                    ok: '确认'
                }));
            }
        };

        /**
         * 订单明细打印
         */
        $scope.orderDetailPrint = function (orderType) {
            var html = orderService.getPrintHtmlInOrderModule(orderType);
            $scope.$applyAsync(function () {
                console.log(html);
                printService.printByDefaultPrinter(html);
            });
        };
        /**
         * 期号订单明细
         */
        $scope.issueOrderDetail = function (iss) {
            $scope.modal = modalService.initModal({
                //appendTo:将modal 加载到指定id的DOM页面
                appendTo: angular.element(document.getElementById('issueDynamic')),
                scope: $scope,
                //templateUrl属性值是一个url路径,路径指向一个html模板
                templateUrl: 'suite/issueDynamicTemplate.html'
            });
            // $scope.iss = iss;
            var params = {issueId: iss.issueId, companyId: iss.companyId};
            suiteService.queryIssueChanges(params).then(function (res) {
                // res的值赋值给 issueDetail ，用于HTML 中的数据源
                $scope.issueDetail = res;
            });
        };

        //排序
        /*$scope.sortByIssue = function (item) {
            $scope.issueDynamicList(
                $scope.sortType = item.sortCode //通过参数传给服务端
            );
        };*/
        $scope.sortByIssue = function (item) {
            $scope.queryParams.sortType = item.sortCode;
            $scope.issueDynamicList();
        };
    })
};



},{}],17:[function(require,module,exports){
/**
 * 商品标签管理
 * labelsManagement
 */
module.exports = function (app) {
    app.controller('labelsManagement', function ($scope, $uibModal, $compile, modalService, labelsManagementService, NgTableParams) {
        $scope.paths = [{
            name: '首页',
            route: '#home'
        }, {
            name: '商品管理',
            active: true
        }];


        $scope.tags;
        $scope.labelName;
        $scope.label = {};
        $scope.addLabel = {};
        $scope.tagsList = [];
        $scope.labelsManagementTableData = [];
        $scope.newLabelsManagement = {};
        $scope.labelsManagementId = '';
        $scope.queryParams = {};

        /**
         * 商品标签 - 列表查询
         * 接口名 /company/label
         * 请求方法 GET
         * labelName  标签名称   offset 条目偏移 limit   \当前页显示数据个数
         */

        $scope.obtainLabesList = function (typeSort) {
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.tableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    return labelsManagementService.getLabelsList({
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        labelName: $scope.labelName,
                        // typeSort:$scope.typeSort  // $scope.typeSort  取 赋值
                        typeSort: typeSort // 取 typeSort 参数值
                    }).then(function (res) {
                        params.total(res.totalElements);
                        return res.content;
                    });
                }
            })
        };
        $scope.obtainLabesList();

        /**
         * 根据商品标签名称 查询
         */
        $scope.labelQuery = function (labelName) {
            labelsManagementService.getLabelsList(labelName).then(function () {
                $scope.obtainLabesList();
            });
        };

        /**
         * 添加标签   编辑标签
         *
         */
        $scope.tagEdit = function (tType) {
            /**
             * 判断打开modal时是编辑还是添加
             */
            if (tType) {//编辑
                $scope.addLabel = {
                    id: tType.id,
                    tagsName: tType.name,
                    type: tType.type,
                    noteName: tType.remark
                };
                $scope.defaultItem = { //设置下拉选项 默认值
                    id: tType.id,
                    type: tType.type
                };
            } else { //新增
                $scope.addLabel = {};
                $scope.defaultItem = { //设置下拉选项 默认值
                    id: 0,
                    type: '无'
                };
            }
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName('labelsManagement')),
                scope: $scope,
                templateUrl: 'addTagsModal'
            });
            /**
             * 添加/编辑标签 - 下拉列表-选择标签类型
             */
            $scope.selectTagType = function (item) {
                $scope.addLabel.type = item.type;
            };
        };

        /**
         * 商品标签 - 删除商品标签名称
         * 接口名 /company/label/delete_name/这里填写labelId
         * 请求方法 DELETE
         * 请求参数: id    主键id
         */

        $scope.tagDeleteClick = function (id, name) {
            $scope.labelsManagement = {};
            $scope.id = id;
            $scope.name = name;
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName('labelsManagement')),
                scope: $scope,
                templateUrl: 'deleteTagModel'
            });
        };
        $scope.deleteTable = function () {
            var me = this;
            labelsManagementService.deleteCommodityLabelName({
                id: $scope.id
            }).then(function (res) {
                $scope.obtainLabesList();
                me.$close();
            });
        };

        /**
         * 商品标签 - 创建商品标签名称
         * 添加标签确认
         * addLabel
         */
        $scope.addTagsConfirm = function (addLabel, scope) {
            if (addLabel.id) { //编辑
                var me = this;
                var params = {id: addLabel.id, type: addLabel.type, name: addLabel.tagsName, remark: addLabel.noteName};
                labelsManagementService.modifylabelsName(params).then(function (res) {
                    $scope.obtainLabesList();
                    me.$close();
                });
            } else { //新增
                var me2 = this;
                if (addLabel.type == "无") {
                    alert("标签类型不能为'无',请选择标签类型!!!");
                } else {
                    var params2 = {type: addLabel.type, name: addLabel.tagsName, remark: addLabel.noteName};
                    labelsManagementService.createLabelsName(params2).then(function (res) {
                        $scope.obtainLabesList();
                        me2.$close();
                    });
                }

            }
        };

        /**
         * 商品标签 - 获取标签类型列表
         */
        $scope.queryTagTypeList = function () {
            labelsManagementService.obtainLabelTypeList().then(function (res) {
                $scope.tagsList = res;
            });
        };
        $scope.queryTagTypeList();

        /**
         * 管理标签类型
         */
        $scope.tagsType = function () {
            $scope.labelsManagement = {};
            $scope.queryTagTypeList();
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName('labelsManagement')),
                scope: $scope,
                templateUrl: 'managementTagType',
                tagsList: $scope.tagsList
            });

            /**
             * 商品标签 - 创建标签类型
             * 接口名 /company/label/create_type
             * 请求方法 POST
             * 请求参数: type 标签类型
             * newTypeName  ==  type
             */
            $scope.addTagsType = function (newTypeName) {
                var type = newTypeName.type;
                labelsManagementService.createLabelsType(type).then(function (res) {
                    newTypeName.type = "";//新增后清除input
                    $scope.queryTagTypeList();
                });
            };

            /**
             * 商品标签 - 更新标签类型
             * 接口名 /company/label/modify_type
             * 请求方法 PUT
             * 请求参数 : id 主键id   type 标签类型
             */
            $scope.modifyType = function (tags) {
                var params = {type: tags.type, id: tags.id};
                labelsManagementService.updateLabelType(params).then(function () {
                    $scope.queryTagTypeList();
                    tags.inEdit = !tags.inEdit;
                });
            };

            /**
             * 商品标签 - 删除标签类型
             * 接口名 /company/label/delete_type/这里填写labelId
             * 请求方法 DELETE
             * 请求参数: id  主键id
             */
            $scope.deleteTableTyleClick = function (id, type) {
                $scope.labelsManagement = {};
                $scope.id = id;
                $scope.type = type;
                $scope.modal = modalService.initModal({
                    appendTo: angular.element(document.getElementsByClassName('labelsManagement')),
                    scope: $scope,
                    templateUrl: 'deleteTagTypeModel'
                });
            };
            $scope.deleteLabelType = function () {
                var me = this;
                labelsManagementService.deleteLabelType({
                    id: $scope.id
                }).then(function (res) {
                    $scope.queryTagTypeList();
                    $scope.obtainLabesList();
                    me.$close();
                });
            };


            /**
             * 选择标签回调
             * @param tags
             */
            $scope.selectTagsCallback = function (tags) {
                $scope.tags = tags;
                $scope.queryTagTypeList(tags);
            };
        };
        /**
         * 标签类型排序
         * @param item
         */
        $scope.sortByTagsType = function (item) {
            // $scope.typeSort = item.sortCode; // 赋值 传给服务端
            $scope.obtainLabesList(
                $scope.typeSort = item.sortCode  // 通过参数传给服务端
            );
        };
    });
};


},{}],18:[function(require,module,exports){
module.exports = function(app) {
  app.controller('newProductRecommendCtrl', function($scope, newProductService, NgTableParams, modalService, newProductService,  productService, $element, $compile, $templateCache, utilService, CONSTANTS) {
    $scope.labelList = [];
    $scope.product = {};
    $scope.profitLevel = CONSTANTS.PROFIT_LEVEL;
    $scope.newProductsQueryParams = {};
    $scope.cateotyList = [];
    $scope.lastUpdateTime = ''; // 销售数据更新于

    //表格设置
    $scope.queryParams = {};
    $scope.offset = 0;
    $scope.limit = 20;
    var tmpPutSaleObj = {};

    $scope.tableParams = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      paginationMaxBlocks: 20,
      paginationMinBlocks: 2,
      getData: function(params) {
        $scope.offset = $scope.limit * (params.page() - 1);
        var search = getParams();
        search.offset = $scope.offset;
        search.limit = $scope.limit;
        return newProductService.queryProductByKey(search).then(function(res) {
          $scope.lastUpdateTime = res.lastUpdateTime;
          return newProductService.indexData(res.list, $scope.offset + 1);
        });
      }
    });
    var getParams = function() {
      var temp = $scope.queryParams;
      temp[temp.markId] = temp.queryName;
      return _.omit(temp, 'markId', 'queryName');
    };
    //选择
    $scope.queryProductConfig = {
      nameTypeData: [{
        markId: 'productName', desc: '商品'
      }, {
        markId: 'skuCode', desc: '商品编码'
      }],
      selectItem: function(item) {
        $scope.queryParams["markId"] = item.markId;
      }
    };

    //回车键查询
    $scope.productKeyup = function(e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.productSearch();
      }
    };
    //查询 商品名称
    $scope.productSearch = function() {
      $scope.tableParams.settings({
        dataset: []
      });
    };

    // 选中几条数据进行导出excel
    // 下面代码为导出Excel做准备
    var excelTemplate = $compile($templateCache.get('product/newProductTableTemplate.html'))($scope);
    angular.element(document.getElementById('exportExcelWrap')).append(excelTemplate);

    $scope.selectedProductList = []; //选中的商品列表
    $scope.updateSelection = function(e, product) {
      var isChecked = _.isObject(e) ? e.currentTarget.checked : e;
      product.checked = isChecked;
      if (isChecked) {
        $scope.selectedProductList.push(product);
      } else {
        $scope.selectedProductList = _.without($scope.selectedProductList,
          product);
      }
    };

    // 导出excel
    $scope.exportExcel = function () {
      if (!$scope.selectedProductList.length) {
        utilService.alertError('请先选择需导出的新品');
        return;
      }
      var dom = angular.element('<a></a>');
      dom[0].href = $('#export-company-table').excelexportjs({
        containerid: 'export-company-table',
        datatype: 'table',
        returnUri: 'true'
      });
      dom[0].download = '新品推荐列表.xls';
      dom[0].click();
    };

    // 添加新品，参考拣货单
    $scope.openAddModal = function (templateUrl) {
      $scope.addModel = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName('product')),
        templateUrl: templateUrl,
        scope: $scope,
        size: 'lg'
      });

      $scope.newProductsQueryParams = {};
      setNewProductsTable();
      queryProductCategoryList();
    };

    //查询商品类别列表
    var queryProductCategoryList = function() {
      productService.queryProductCategoryList().then(function(res) {
        $scope.cateotyList = [{
          code: '-1',
          desc: "全部品类"
        }];
        angular.forEach(res, function(category, index) {
          var item = { 'code': category.id, 'desc': category.categoryName };
          $scope.cateotyList.push(item);
        });
      });
    };
    $scope.profitList = CONSTANTS.getList({
      clsOrName: 'PROFIT_LEVEL',
      defaultObj: { '-1': '全部利润等级' }
    });

    // 新品上架modal中的表格数据
    var setNewProductsTable = function() {
      $scope.offset2 = 0;
      $scope.limit2 = 10;
      $scope.newProdcutsTable = new NgTableParams({
        count: $scope.limit2
      }, {
        counts: [],
        paginationMaxBlocks: 13,
        paginationMinBlocks: 2,
        getData: function(params) {
          // 每次取重新渲染表格的时候，清楚之前选择的数据
          $scope.selectedProducts = [];
          return newProductService.queryAllProduct({
            offset: $scope.limit2 * (params.page() - 1),
            limit: $scope.limit2,
            productTags: [-1], // 查询商品库中非新品的商品
            productName: $scope.newProductsQueryParams.productName,
            categoryId: $scope.newProductsQueryParams.categoryId,
            profitLevel: $scope.newProductsQueryParams.profitLevel,
            isDeleted: 0
          }).then(function(res) {
            params.total(res.totalElements);
            return newProductService._parseOtherShelfProducts(res.content,
              _.keys(tmpPutSaleObj));
          });
        }
      });
    };

    //商品选择
    $scope.selectedProducts = [];
    $scope.chkboxChange = function(product) {
      var productId = product.id;
      if (product.select) {
        $scope.selectedProducts.push(productId);
      } else {
        $scope.selectedProducts = _.without($scope.selectedProducts, productId);
      }
    };

    //品类选择
    $scope.selectCategoryCallback = function(item) {
      if (item.code) {
        item.code !== '-1' ? $scope.newProductsQueryParams.categoryId =
            item.code : $scope.newProductsQueryParams.categoryId =
            undefined;
        setNewProductsTable();
      }
    };
    //利润等级选择
    $scope.selectProfitCallback = function(item) {
      if (item.code) {
        item.code !== '-1' ? $scope.newProductsQueryParams.profitLevel =
            item.code : $scope.newProductsQueryParams.profitLevel =
            undefined;
        setNewProductsTable();
      }
    };
    //搜索商品
    $scope.searchProduct = function(queryParams) {
      $scope.newProductsQueryParams.productName = queryParams.productName;
      setNewProductsTable();
    };
    $scope.keyPressSearchProduct = function(e, queryParams) {
      if (e.keyCode == 13) { //回车键
        $scope.searchProduct(queryParams);
      }
    };

    // 确认添加新品
    $scope.confirmAddNewProduct = function () {
      newProductService.addNewProducts({
        productIds: $scope.selectedProducts
      }).then(function (res) {
        $scope.tableParams.reload();
        $scope.addModel.close();
      });
    };

    // 删除新品
    $scope.deleteForm = {};
    $scope.deleteNewProduct = function(id) {
      $scope.deleteForm = {};
      $scope.deleteForm.productId = id;
      modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName('product')),
        templateUrl: 'newProductDelete',
        scope: $scope
      });
    };
    $scope.newProductDeleteSave = function() {
      var me = this;
      newProductService.deleteNewProduct({
        id: $scope.deleteForm.productId
      }).then(function() {
        $scope.tableParams.reload();
        me.$close();
      });
    };

    // 切换新品推荐中 1，待推荐状态 0，
    $scope.toggleProductStatus = function (proId, newRecommend) {
      newRecommend = newRecommend == 1 ? 0 : 1;
      newProductService.changeNewProductStatus({
        id: proId,
        newRecommend: newRecommend
      }).then(function () {
        $scope.tableParams.reload();
      })
    };

    $scope.product = {
      id: '',
      productName: '',
      categoryId: '',
      skuCode: '',
      price: '',
      recommendTimes: '', // 推荐次数
      recommendRate: '', // 推荐拣货率
      deliveryBackRate: '',
      shipmentRate: '',
      stock: '',
      availableStock: '',

      reset: function() {
        this.id = '';
        this.productName = '';
        this.categoryId = '';
        this.skuCode = '';
        this.price = '';
        this.recommendTimes = '';
        this.recommendRate = '';
        this.deliveryBackRate = '';
        this.shipmentRate = '';
        this.stock = '';
        this.availableStock = '';
      }
    }
  });
};
},{}],19:[function(require,module,exports){
module.exports = function(app) {
    app.controller('orderCtrl', function($scope, $compile, $templateCache, $mdDialog, modalService, printService, orderService, NgTableParams, utilService, CONSTANTS) {
        $scope.utilService = utilService;
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        $scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        $scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;

        var DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        var COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        var ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        var DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
        var REFUND_STATE = CONSTANTS.REFUND_STATE;
        var INVENTORY_STATE = CONSTANTS.INVENTORY_STATE;
        var SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;

        $scope.offset;
        $scope.limit;
        $scope.curOrderType = { desc: '全部单据类型' };
        $scope.orderTypeList = [{ desc: '全部单据类型' },
            { desc: ORDER_TYPE.DESC[ORDER_TYPE.DELIVERY], orderType: ORDER_TYPE.DELIVERY },
            { desc: ORDER_TYPE.DESC[ORDER_TYPE.REFUND], orderType: ORDER_TYPE.REFUND },
            { desc: ORDER_TYPE.DESC[ORDER_TYPE.INVENTORY], orderType: ORDER_TYPE.INVENTORY },
            { desc: ORDER_TYPE.DESC[ORDER_TYPE.SETTLEMENT], orderType: ORDER_TYPE.SETTLEMENT }
        ];
        $scope.isUpdateTimeChoices = CONSTANTS.getList('INVOICE_TIME_TYPE', false);
        $scope.isPaidList = [{ desc: '全部付款状态', code: '' }, { desc: '未付款', code: '0' }, { desc: '已付款', code: '1' }];
        $scope.invoiceNeedStateList = CONSTANTS.getList('INVOICE_NEED_STATE', true, undefined, undefined, { '': '全部开票需求' });
        $scope.deliveryOrder = {};
        $scope.refundOrder = {};
        $scope.inventoryOrder = {};
        $scope.settlementOrder = {};

        $scope.queryParams = {
            createStartTime: '',
            createEndTime: '',
            updateStartTime: '',
            updateEndTime: '',
            isInvoice: '', //0 不需要开票  1需要开票
            isPaid: '', // 0 没有  1 已支付
            isUpateTime: 0,
        };
        $scope.selectIsUpadate = function(choice) {
            $scope.queryParams.isUpateTime = parseInt(choice.code);
        };
        $scope.selectIsPaid = function(choice) {
            $scope.queryParams.isPaid = choice.code;
            $scope.orderTable.reload();
            $scope.orderTable.page(1);
        };
        $scope.selectInvoicenNeedState = function(choice) {
            $scope.queryParams.isInvoice = choice.code;
            $scope.orderTable.reload();
            $scope.orderTable.page(1);
        };
        var setOrderTable = function(queryParams) {
            $scope.queryParams.startDay = $scope.queryParams.startDay || utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
            $scope.queryParams.endDay = $scope.queryParams.endDay || utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd');
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.orderTable = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 13,
                paginationMinBlocks: 2,
                getData: function(params) {
                    var p = {
                        offset: (params.page() - 1) * $scope.limit,
                        limit: $scope.limit,
                        orderType: $scope.curOrderType.orderType,
                        companyName: $scope.queryParams.companyName
                    };
                    if ($scope.queryParams.isInvoice !== '') {
                        p.isInvoice = $scope.queryParams.isInvoice;
                    }
                    if ($scope.queryParams.isPaid !== '') {
                        p.isPaid = $scope.queryParams.isPaid;
                    }
                    if ($scope.queryParams.isUpateTime) {
                        p.updateStartTime = new Date($scope.queryParams.startDay + ' 00:00:00').getTime();
                        p.updateEndTime = new Date($scope.queryParams.endDay + ' 23:59:59').getTime();
                    } else {
                        p.createStartTime = new Date($scope.queryParams.startDay + ' 00:00:00').getTime();
                        p.createEndTime = new Date($scope.queryParams.endDay + ' 23:59:59').getTime();
                    }

                    return orderService.queryOrderList(p).then(function(res) {
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            });
        };
        setOrderTable();
        //搜索单据
        $scope.searchOrders = function(queryParams) {
            queryParams = queryParams || {};
            $scope.queryParams.companyName = queryParams.companyName;
            $scope.queryParams.startDay = queryParams.startTime ? utilService.parseTimeByDate(queryParams.startTime, 'yyyy-MM-dd') :
                utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
            $scope.queryParams.endDay = queryParams.endTime ? utilService.parseTimeByDate(queryParams.endTime, 'yyyy-MM-dd') :
                utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd');
            $scope.queryParams.isUpateTime = queryParams.isUpateTime;
            setOrderTable();
        };
        //获取单据状态描述
        $scope.getOrderStateDesc = function(orderType, orderState) {
            var orderStateDesc = '';
            switch (orderType) {
                case ORDER_TYPE.DELIVERY:
                    orderStateDesc = DELIVERY_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.REFUND:
                    orderStateDesc = REFUND_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.INVENTORY:
                    orderStateDesc = INVENTORY_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.SETTLEMENT:
                    orderStateDesc = SETTLEMENT_STATE.DESC[orderState];
                    break;
            }
            return orderStateDesc;
        };
        //选择单据类型
        $scope.selectOrderType = function(item) {

            $scope.curOrderType = item;
            setOrderTable();
        };
        //明细
        $scope.checkOrderDetail = function(orderType, orderId) {
            orderService.checkOrderDetail(orderType, orderId, $scope);
        };
        //获取送货单详情
        var getDeliveryDetail = function(opts) {
            orderService.queryDeliveryDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.deliveryOrder = res;
                $scope.deliveryOrder.name = '送货单' + '-' + $scope.deliveryOrder.companyName + '-' + $scope.deliveryOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.deliveryOrder.createTime, 'yyyyMMddhhmmss') + ')';
                $scope.deliveryOrder.putSaleProductList = [];
                $scope.deliveryOrder.supplementProductList = [];
                $scope.deliveryOrder.pullSaleProductList = [];

                angular.forEach($scope.deliveryOrder.items, function(item, i) {
                    switch (parseInt(item.itemType)) {
                        case 1:
                            $scope.deliveryOrder.putSaleProductList.push(item);
                            break;
                        case 2:
                            $scope.deliveryOrder.supplementProductList.push(item);
                            break;
                        case 3:
                            $scope.deliveryOrder.pullSaleProductList.push(item);
                            break;
                    }
                });
                opts.didLoadData();
            });
        };
        //获取退货单详情
        var getRefundDetail = function(opts) {
            orderService.queryRefundDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.refundOrder = res;
                $scope.refundOrder.name = '退货单' + '-' + $scope.refundOrder.companyName + '-' + $scope.refundOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.refundOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();

            });

        };
        //获取盘点单详情
        var getInventoryDetail = function(opts) {
            orderService.queryInventoryDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.inventoryOrder = res;
                $scope.inventoryOrder.name = '盘点单' + '-' + $scope.inventoryOrder.companyName + '-' + $scope.inventoryOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.inventoryOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();
            });
        };
        //获取结算单详情
        var getSettlementDetail = function(opts) {
            orderService.querySettlementDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.settlementOrder = orderService._parseSettlementDetailData(res);
                $scope.settlementOrder.name = '结算单' + '-' + $scope.settlementOrder.companyName +
                    '(' + utilService.parseTimeByLong($scope.settlementOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();
            });
        };
        //详细Modal中导出Excel（移至service）
        //列表中导出Excel
        $scope.exportExcelOnList = function(orderType, orderId) {
            orderService.exportExcel(orderType, orderId, $scope);
        };
        /*打印*/
        //打印单据列表
        var printOrderArray = [];
        var checkInfo = function(data) {
            angular.forEach(data, function(item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        //勾选
        $scope.updateSelection = function(e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function(e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function(item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };
        //打印
        $scope.printOrder = function(orders) {
            var settlementOrderIds = [];
            var inventoryOrderIds = [];
            var deliveryOrderIds = [];
            var returnOrderIds = [];
            var orderArray = [];
            if (Object.prototype.toString.call(orders) == '[object Array]') {
                orderArray = orders;
            } else {
                orderArray = [orders];
            }
            angular.forEach(orderArray, function(item) {
                switch (item.orderType) {
                    case ORDER_TYPE.DELIVERY:
                        deliveryOrderIds.push(item.orderId);
                        break;
                    case ORDER_TYPE.REFUND:
                        returnOrderIds.push(item.orderId);
                        break;
                    case ORDER_TYPE.INVENTORY:
                        inventoryOrderIds.push(item.orderId);
                        break;
                    case ORDER_TYPE.SETTLEMENT:
                        settlementOrderIds.push(item.orderId);
                        break;
                }
            });
            orderService.queryOrderDetails({
                settlementOrderIds: settlementOrderIds,
                inventoryOrderIds: inventoryOrderIds,
                deliveryOrderIds: deliveryOrderIds,
                returnOrderIds: returnOrderIds
            }).then(function(res) {
                var settlementOrderDetails = res.settlementOrderDetails || [];
                var inventoryOrderDetails = res.inventoryOrderDetails || [];
                var deliveryOrderDetails = res.deliveryOrderDetails || [];
                var returnOrderDetails = res.returnOrderDetails || [];
                var orders = $([]).concat(settlementOrderDetails, inventoryOrderDetails, deliveryOrderDetails, returnOrderDetails);
                var temps = [];
                angular.forEach(settlementOrderDetails, function(detail) {
                    var orderType = ORDER_TYPE.SETTLEMENT;
                    var scope = orderService.parsePrintOrderScope(orderType, detail, $scope.$new(true));
                    scope.isPrint = true;
                    temps.push(angular.element('<div></div>').append(orderService.getTemplateDomByType(orderType, scope)));
                });
                angular.forEach(inventoryOrderDetails, function(detail) {
                    var orderType = ORDER_TYPE.INVENTORY;
                    var scope = orderService.parsePrintOrderScope(orderType, detail, $scope.$new(true));
                    scope.isPrint = true;
                    temps.push(angular.element('<div></div>').append(orderService.getTemplateDomByType(orderType, scope)));
                });
                angular.forEach(deliveryOrderDetails, function(detail) {
                    var orderType = ORDER_TYPE.DELIVERY;
                    var scope = orderService.parsePrintOrderScope(orderType, detail, $scope.$new(true));
                    scope.isPrint = true;
                    temps.push(angular.element('<div></div>').append(orderService.getTemplateDomByType(orderType, scope)));
                });
                angular.forEach(returnOrderDetails, function(detail) {
                    var orderType = ORDER_TYPE.REFUND;
                    var scope = orderService.parsePrintOrderScope(orderType, detail, $scope.$new(true));
                    scope.isPrint = true;
                    temps.push(angular.element('<div></div>').append(orderService.getTemplateDomByType(orderType, scope)));
                });
                $scope.$applyAsync(function() {
                    var htmls = [];
                    angular.forEach(temps, function(item) {
                        console.log(item[0].innerHTML);
                        htmls.push(item[0].innerHTML);
                    });
                    printService.printByDefaultPrinter(htmls);
                });
            });
        };
        $scope.bathMultiPrint = function() {
            if (printOrderArray.length) {
                $scope.printOrder(printOrderArray);
            } else {
                $mdDialog.show($mdDialog.alert({
                    title: '提示',
                    textContent: '请选择需要打印的票据',
                    ok: '确认'
                }));
            }
        };
    });
};

},{}],20:[function(require,module,exports){
module.exports = function(app) {
  app.controller('pickOrderCtrl', function($scope, $timeout, $interpolate,
    $compile, $templateCache, $mdDialog, NgTableParams, printService,
    orderService, CONSTANTS, utilService, modalService) {
    $scope.CONSTANTS = CONSTANTS;
    $scope.DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
    $scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
    $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    var DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
    var DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
    var COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    var offset = 0;
    var limit = 10000;
    var curActiveTab = 0;

    $scope.utilService = utilService;
    $scope.order;
    $scope.operateOrderQueryParams = {};
    $scope.warehouseOrderQueryParams = {};
    $scope.warehouseOrderStates = [{ desc: '所有状态', orderState: -1 }, {
      desc: DELIVERY_STATE
        .DESC[DELIVERY_STATE.WAIT_PICK],
      orderState: DELIVERY_STATE.WAIT_PICK
    }, {
      desc: DELIVERY_STATE.DESC[DELIVERY_STATE.PICKING],
      orderState: DELIVERY_STATE
        .PICKING
    }];
    $scope.curOrderState = $scope.warehouseOrderStates[0];

    $scope.operateOrdersTableParams = new NgTableParams({ count: limit }, {
      counts: []
    });
    $scope.warehouseOrdertableParams = new NgTableParams({ count: limit }, {
      counts: []
    });
    //删除 拣货单
    $scope.deleteDeliveryOrder = function(orderId) {
      if (confirm('您是否确认删除该单据?')) {
        var params = { 'orderId': orderId };
        orderService.deleteDeliveryOrder(params).then(function(res) {
          alert('删除成功');
          $scope.searchOperateOrders($scope.queryParams);

        });
      }
    };
    //查询 运营单据
    $scope.searchOperateOrders = function(queryParams) {
      $scope.operateOrderQueryParams = queryParams || $scope.operateOrderQueryParams;
      var params = {
        offset: offset,
        limit: limit,
        orderStates: [DELIVERY_STATE.INIT, DELIVERY_STATE.RETURN_INIT],
        companyId: $scope.operateOrderQueryParams.companyId
      };
      orderService.queryDeliveryList(params).then(function(res) {
        $scope.operateOrdersTableParams.settings({
          dataset: res.content
        });
      });
    };
    //清空运营页卡下的公司搜索
    $scope.emptyCompanySearchInOperate = function() {
      delete $scope.operateOrderQueryParams.companyId;
      $scope.searchOperateOrders();
    };

    //查询 仓库单据
    $scope.searchWarehouseOrders = function(queryParams) {
      queryParams = queryParams || {};
      if (queryParams.orderStates) {
        $scope.warehouseOrderQueryParams.orderStates = queryParams.orderStates;
      } else if (queryParams.companyId) {
        $scope.warehouseOrderQueryParams.companyId = queryParams.companyId;
      } else {
        $scope.warehouseOrderQueryParams = {};
      }
      var params = {
        offset: offset,
        limit: limit,
        orderStates: $scope.warehouseOrderQueryParams.orderStates || [
          DELIVERY_STATE.WAIT_PICK, DELIVERY_STATE.PICKING
        ],
        companyId: $scope.warehouseOrderQueryParams.companyId
      };
      orderService.queryDeliveryList(params).then(function(res) {
        $scope.warehouseOrdertableParams.settings({
          dataset: res.content
        });
      });
    };
    //清空仓库页卡下的公司搜索
    $scope.emptyCompanySearchInWarehouse = function() {
      delete $scope.warehouseOrderQueryParams.companyId;
      $scope.searchWarehouseOrders();
    };
    //当前记录行是否需要高亮
    $scope.shouldRowHighlight = function(order) {
      return parseInt(order.returnTimes);
    };
    $scope.tabActive = function(tabIndex) {
      curActiveTab = tabIndex;
      switch (tabIndex) {
        case 0:
          $scope.searchOperateOrders();
          break;
        case 1:
          $scope.curOrderState = $scope.warehouseOrderStates[0];
          $scope.searchWarehouseOrders();
          break;
      }
    };
    //根据拣货单状态 查询
    $scope.selectWarehouseOrderState = function(item) {
      if (!item.orderState) {
        return;
      }
      var orderStates = item.orderState > 0 ? [item.orderState] : [
        DELIVERY_STATE.WAIT_PICK, DELIVERY_STATE.PICKING
      ];
      $scope.searchWarehouseOrders({ orderStates: orderStates });

    };
    //选中拣货单
    $scope.selectPickOrder = function(order) {
      order.selected = !order.selected;
    };
    //打开拣货单详情
    $scope.openPickOrderModal = function(orderId, e) {
      e.stopPropagation();
      getPickOrderDetail({
        orderId: orderId,
        didLoadData: function() {
          $scope.pickOrderModal = modalService.initModal({
            appendTo: angular.element(document.getElementsByClassName(
              'pick-order')),
            scope: $scope,
            templateUrl: 'pickOrder/pickOrderTemplate.html',
            size: 'lg'
          });
        }
      });
    };
    $scope.filterItems = function(item) {
      return item.itemType != 3;
    };

    //打开退回理由 填写框
    $scope.openReturnReasonModal = function() {
      $scope.returnReasonModal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'pick-order')),
        scope: $scope,
        templateUrl: 'modalReturnReason'
      });
    };
    //填完退回理由 确认
    $scope.confirmReturn = function(returnParams) {
      returnParams.orderId = $scope.order.orderId;
      returnParams.orderState = DELIVERY_STATE.RETURN_INIT;
      orderService.modifyDeliveryState(returnParams).then(function(res) {
        $scope.pickOrderModal.close();
        $scope.returnReasonModal.close();
        $scope.tabActive(curActiveTab);
      });
    };
    //打印
    $scope.printPickOrder = function(scope, orderId) {
      $mdDialog.show($mdDialog.confirm({
        title: '提示',
        textContent: '是否确认打印并开始拣货？',
        ok: '确认',
        cancel: '取消'
      })).then(function() {
        var params = { orderState: DELIVERY_STATE.PICKING };
        if (orderId) {
          params.orderId = orderId;
        } else {
          params.orderId = $scope.order.orderId;
        }
        orderService.modifyDeliveryState(params).then(function(res) {
          var html = '';
          $scope.pickOrderModal && $scope.pickOrderModal.close();
          $scope.tabActive(curActiveTab);
          //打印
          var s = scope.$new();
          var temp;
          s.printOrder = scope.order;
          s.printOrder.productList = [];
          _.each(s.printOrder.items, function(item) {
            item.positionStr = _.pluck(item.positions,
              'name').join('<br/>');
            if (item.itemType != 3) {
              s.printOrder.productList.push(item);
            }
          });
          temp = angular.element('<div></div>').append(scope.compilePrintTemplate(
            s));
          scope.$applyAsync(function() {
            console.log(temp[0].innerHTML);
            printService.printByDefaultPrinter(temp[0].innerHTML,
              false);
          });
        });
      });
    };
    $scope.printPickOrderInTable = function(scope, order) {
      if (order.orderState == DELIVERY_STATE.WAIT_PICK) { //待捡货
        $scope.printPickOrder(scope, order.orderId);
      } else {
        $scope.batchPrint(scope, [order.orderId]);
      }
    };
    //确认出库
    $scope.confirmPicking = function() {
      var params = {
        orderState: DELIVERY_STATE.WAIT_COMFIRM,
        orderId: $scope.order.orderId,
        companyId: $scope.order.companyId
      };
      orderService.modifyDeliveryState(params).then(function() {
        $scope.pickOrderModal.close();
        $scope.tabActive(curActiveTab);
        // //打印
        // orderService.getCompiledDeliveryOrder({
        //     orderId: $scope.order.orderId,
        //     scope: $scope,
        //     success: function(temp) {
        //         $scope.$applyAsync(function() {
        //             printService.printByDefaultPrinter(temp.find('table').parent().html());
        //         });
        //     }
        // });
      });
    };
    //批量打印
    $scope.compilePrintTemplate = function(scope) {
      return $compile($templateCache.get('print/pickOrderTemplate.html'))
        (scope);
    };
    $scope.compileDeliveryTemplate = function(scope) {
      return $compile($templateCache.get(
        'order/deliveryOrderTemplate.html'))(scope);
    };
    $scope.batchPrint = function(scope, orderIds) {
      if ($scope.selectOrders.length == 0) {
        alert('请先选择需要处理的单据');
        return;
      }
      //获取批量选中节点
      //请求批量拣货单详情
      var params = {
        orderIds: [],
        orderState: DELIVERY_STATE.WAIT_COMFIRM
      };
      if (orderIds && orderIds.length) {
        params.orderIds = orderIds;
      } else {
        params.orderIds = _.pluck(_.where($scope.warehouseOrdertableParams
          .data, { selected: true }), 'orderId');
      }
      params.offset = 0;
      params.limit = params.orderIds.length;
      orderService.queryDeliveryDetailList(params).then(function(res) {
        //回调编译模板
        var orders = res.content;
        var temps = [];
        angular.forEach(orders, function(order) {
          var t;
          var s = scope.$new(true);
          s.DELIVERY_URGENCY = DELIVERY_URGENCY;
          s.COMPANY_TYPE = COMPANY_TYPE;
          s.utilService = utilService;
          s.printOrder = order;
          s.printOrder.productList = [];
          _.each(s.printOrder.items, function(item) {
            item.positionStr = _.pluck(item.positions,
              'name').join('<br/>');
            if (item.itemType != 3) {
              s.printOrder.productList.push(item);
            }
          });
          t = angular.element('<div></div>').append(scope.compilePrintTemplate(
            s));
          temps.push(t);
        });
        scope.$applyAsync(function() {
          var temp = [];
          angular.forEach(temps, function(item) {
            console.log(item[0].innerHTML);
            temp.push(item[0].innerHTML);
          });
          printService.printByDefaultPrinter(temp);
        });
      });
    };
    //批量切换状态
    $scope.batchModifyState = function() {
      if ($scope.selectOrders.length == 0) {
        alert('请先选择需要处理的单据');
        return;
      }
      var f = $scope.selectOrders[0];
      var r = _.find($scope.selectOrders, function(item) {
        return item.orderState != f.orderState;
      });
      if (r) {
        alert('拣货单状态不同，无法批量处理');
        return;
      }
      var confirmContent = f.orderState == DELIVERY_STATE.WAIT_PICK ?
        '是否确认所选拣货单开始拣货?' :
        '是否确认所选拣货单商品已出库，并切换为送货单?';

      if (confirm(confirmContent)) {
        orderService.batchUpdateDeliveryOrderState({
          orderIds: _.pluck($scope.selectOrders, 'orderId')
        }).then(function() {
          $scope.tabActive(curActiveTab);
        });
      }

    };
    //获取拣货单详情
    var getPickOrderDetail = function(opts) {
      orderService.queryDeliveryDetail({ orderId: opts.orderId }).then(
        function(res) {
          debugger
          $scope.order = res;
          $scope.order.name = '拣货单' + '-' + $scope.order.companyName +
            '-' + $scope.order.shelfName + '(' + utilService.parseTimeByLong(
              $scope.order.updateTime, 'yyyyMMddhhmmss') + ')';
          opts.didLoadData();
        });
    };
    //详情页面 导出
    $scope.exportExcelOnDetail = function() {
      var dom = angular.element('<a></a>');
      dom[0].href = $('#pick-order-table').excelexportjs({
        containerid: 'pick-order-table',
        datatype: 'table',
        returnUri: 'true'
      });
      dom[0].download = $scope.order.name + '.xls';
      dom[0].click();
    };
    //未加载详情页面的情况下 导出
    $scope.exportExcelNeedLoadDetail = function(orderId, e) {
      e.stopPropagation();

      var excelTemplate = $compile($templateCache.get(
        'pickOrder/pickOrderTemplate.html'))($scope);
      angular.element(document.getElementById('exportExcelWrap')).append(
        excelTemplate);
      getPickOrderDetail({
        orderId: orderId,
        didLoadData: function() {
          $scope.$applyAsync(function() {
            var dom = angular.element('<a></a>');
            dom[0].href = $('#pick-order-table').excelexportjs({
              containerid: "pick-order-table",
              datatype: 'table',
              returnUri: 'true'
            });
            dom[0].download = $scope.order.name + '.xls';
            dom[0].click();
          });
        }
      });
    };
    $scope.$watch('warehouseOrdertableParams.data', function(newValue,
      oldValue) {
      $scope.selectOrders = _.where($scope.warehouseOrdertableParams.data, { selected: true });
    }, true);
  });
}
},{}],21:[function(require,module,exports){
module.exports = function(app) {
    app.controller('positionManageCtrl', function($scope, NgTableParams, modalService, positionService, $mdDialog) {
        $scope.limit = 25;
        $scope.position = {};
        var loadPositionTable = function(queryParams) {
            queryParams = queryParams || {};
            $scope.positionTable = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 25,
                paginationMinBlocks: 2,
                getData: function(params) {
                    return positionService.queryPositionsByPage({
                        offset: (params.page() - 1) * $scope.limit,
                        limit: $scope.limit,
                        sortType: queryParams.sortType
                    }).then(function(res) {
                        params.total(res.totalElements);
                        return res.content;
                    });
                }
            });
        };
        loadPositionTable();
        //打开仓位编辑
        $scope.openPositionEditModal = function(mode, position) {
            $scope.position = {};
            if (mode == 'edit') { //编辑模式
                $scope.position = angular.copy(position);
            }
            $scope.positionEditModal = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName('position-manage')),
                scope: $scope,
                templateUrl: 'positionEditModal',
                size:'sm'
            });
        };
        //提交仓位编辑
        $scope.submitPositionEdit = function(position) {
            var errorMsg = '';
            if (position.row.length != 3) {
                errorMsg = '\'排\'需为3位整数';
            }else if (position.layer.length != 2) {
                errorMsg = '\'层\'需为2位整数';
            }else if (position.location.length != 3) {
                errorMsg = '\'位置\'需为3位整数';
            }
            if (errorMsg.length) {
                $mdDialog.show($mdDialog.alert({
                    title: '失败',
                    textContent: errorMsg,
                    ok: '关闭',
                    zIndex: 999999999
                }).clickOutsideToClose(true));
                return;
            }
            if (typeof position.id == 'undefined') { //新增
                positionService.createPosition(position).then(function(res) {
                    $scope.positionEditModal.close();
                    loadPositionTable();
                });
            } else { //编辑
                positionService.modifyPosition(position).then(function(res) {
                    $scope.positionEditModal.close();
                    loadPositionTable();
                });
            }
        };
        //按编码排序
        $scope.sortByName = function(item) {
            loadPositionTable({
                sortType: item.sortCode
            });
        };

    });
};
},{}],22:[function(require,module,exports){
module.exports = function(app) {
  app.controller('productCtrl', function($scope, $mdPanel, productService,
    utilService, NgTableParams, modalService, CONSTANTS, positionService,
    labelsManagementService,$compile,$templateCache,orderService) {
    $scope.levelOneCategoryList = [];
    $scope.levelTwoCategoryList = [];
    $scope.brandAwarenessList = [];
    $scope.brandGradeList = [];
    $scope.originPlaceList = [];
    $scope.labelList = [];
    $scope.product = {};
    $scope.productPositionData = [];
    $scope.imgPrefix = window.cfg.picUrl;
    $scope.CONSTANTS = CONSTANTS;
    var CATEGORY_LEVEL = CONSTANTS.CATEGORY_LEVEL;
    var PRODUCT_DIC_TYPE = CONSTANTS.PRODUCT_DIC_TYPE;
    $scope.productTagsData = CONSTANTS.getList({
      clsOrName: 'PRODUCT_TAG',
      hasDefault: false
    });
    //表格设置
    $scope.queryParams = {};
    $scope.offset = 0;
    $scope.limit = 20;
    $scope.tableParams = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      paginationMaxBlocks: 20,
      paginationMinBlocks: 2,
      getData: function(params) {
        return labelsManagementService.getAllLabelList().then(
          function(
            labelRes) {
            $scope.labelList = labelRes;
            $scope.labelConfig.setList(labelRes);
            $scope.offset = $scope.limit * (params.page() - 1);
            var search = getParams();
            search.offset = $scope.offset;
            search.limit = $scope.limit;
            return productService.queryProductByKey(search).then(
              function(res) {
                params.total(res.totalElements);
                var data = productService._parseProductListData(
                  res.content,
                  $scope.labelList);
                return checkInfo(productService.indexData(data, $scope.offset +
                  1));
              });
          });
      }
    });
    var getParams = function() {
      // debugger
      var temp = $scope.queryParams;
      temp[temp.markId] = temp.queryName;
      return _.omit(temp, 'markId', 'queryName');
    };
    //选择
    $scope.queryProductConfig = {
      nameTypeData: [{
        markId: 'productName',
        desc: '商品'
      }, {
        markId: 'positionName',
        desc: '仓位'
      }, {
        markId: 'skuCode',
        desc: '商品编码'
      }],
      selectItem: function(item) {
        $scope.queryParams["markId"] = item.markId;
      }
    };

    var excelTemplate = $compile($templateCache.get(
      'product/productListExcelTemplate.html'))($scope);
    angular.element(document.getElementById('exportExcelWrap')).append(
      excelTemplate);
    $scope.selectedProductList = [];
    var checkInfo = function(data) {
      // debugger
      angular.forEach(data, function(item) {
        var t = _.findWhere($scope.selectedProductList, {
          id: item.id
        });
        if (t) {
          item.checked = true;
        } else {
          item.checked = false;
        }
      });
      return data;
    };
    $scope.checkAllCfg = {
      flag: false
    };
    $scope.updateSelection = function(e, pro) {
      var isChecked;
      if (_.isObject(e)) {
        isChecked = e.currentTarget.checked;
      } else {
        isChecked = e;
      }
      pro.checked = isChecked;
      if (isChecked) {
        $scope.selectedProductList.push(pro);
      } else {
        $scope.checkAllCfg.flag = false;
        $scope.selectedProductList = _.without($scope.selectedProductList, pro);
      }
    };
    $scope.selectAllProduct = function(e, data) {
      var st = e.currentTarget.checked;
      angular.forEach(data, function(item) {
        if (item.checked !== st) {
          $scope.updateSelection(e.currentTarget.checked, item);
        }
      });
    };
    //回车键查询 
    $scope.productKeyup = function(e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.productSearch();
      }
    };

    $scope.exportExcel = function() {
      if ($scope.selectedProductList.length) {
        orderService.formExcel('exportExcelWrap', '商品列表');
      } else {
        window.alert('请选择导出项');
      }
    };
    //查询 商品名称
    $scope.productSearch = function() {
      $scope.tableParams.settings({
        dataset: []
      });
    };
    //排序
    $scope.sort = function(item) {
      $scope.queryParams.sortType = item.sortCode;
      $scope.tableParams.settings({
        dataset: []
      });
    };
    //利润等级 筛选
    $scope.profitLevelFilter = {
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'PROFIT_LEVEL',
          codeKey: 'profitLevel',
          valueKey: 'name',
          defaultObj: {
            '': '全部利润等级'
          }
        });
      },
      selectItem: function(item) {
        $scope.queryParams.profitLevel = item.profitLevel;
        $scope.tableParams.settings({
          dataset: []
        });
      }
    };
    //一级品类 筛选
    $scope.levelOneCategoryFilter = {
      list: [],
      defaultItem: {
        categoryName: '全部一级品类'
      },
      setList: function(list) {
        this.list = angular.copy(list);
        this.list.unshift(this.defaultItem);
      },
      selectItem: function(item) {
        $scope.queryParams.categoryId = item.id;
        $scope.tableParams.settings({
          dataset: []
        });
        $scope.levelTwoCategoryFilter.clearList();
        if (item.id) {
          productService.queryProductCategoryList({
            parentCategoryId: item.id
          }).then(function(res) {
            $scope.levelTwoCategoryFilter.setList(res);
          });
        }
      }
    };
    //二级品类 筛选
    $scope.levelTwoCategoryFilter = {
      list: [],
      defaultItem: {
        categoryName: '全部二级品类'
      },
      setList: function(list) {
        this.list = angular.copy(list);
        this.list.unshift(this.defaultItem);
      },
      clearList: function() {
        this.list = [];
      },
      selectItem: function(item) {
        $scope.queryParams.subCategoryId = item.id;
        $scope.tableParams.settings({
          dataset: []
        });
      }
    };
    //特殊标识 筛选
    $scope.productTagFilter = {
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'PRODUCT_TAG',
          codeKey: 'productTag',
          valueKey: 'name',
          defaultObj: {
            '': '全部'
          }
        });
      },
      selectItem: function(item) {
        delete $scope.queryParams.productTags;
        if (item.productTag) {
          $scope.queryParams.productTags = [item.productTag];
        }
        $scope.tableParams.settings({
          dataset: []
        });
      }
    };
    //Modal
    $scope.productInitModal = function(templateUrl, size) {
      modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'product')),
        templateUrl: templateUrl,
        scope: $scope,
        size: size
      });
    };
    /*
     *管理品类
     */
    //初始化品类
    var categoryInit = function() {
      loadCategoryList(0);
    };
    //加载品类
    var loadCategoryList = function(parentCategoryId) {
      productService.queryProductCategoryList({
        parentCategoryId: parentCategoryId
      }).then(function(res) {
        if (!parentCategoryId) { //一级品类
          $scope.levelOneCategoryList = angular.copy(res);
          $scope.levelOneCategoryFilter.setList(res);
          if ($scope.levelOneCategoryList.length > 0) {
            $scope.selectedLevelOneCategory = $scope.levelOneCategoryList[
              0];
            loadCategoryList($scope.selectedLevelOneCategory.id);
          }
        } else { //二级品类
          $scope.levelTwoCategoryList = [];
          for (var i = 0; i < res.length / 2; i++) {
            var temp = [];
            temp.push(res[i * 2]);
            if (res[i * 2 + 1]) {
              temp.push(res[i * 2 + 1]);
            }
            $scope.levelTwoCategoryList.push(temp);
          }
        }
      });
    };
    $scope.levelOneCategoryManageList = function(item) {
      return item.id != '0';
    };
    //打开一级品类编辑框
    $scope.openLevelOneEditWin = function() {
      $scope.productInitModal('levelOneCategoryEdit', 'lg');
    };
    //创建品类
    $scope.createCategory = function(category, categoryLevel) {
      var params = {
        categoryName: category.categoryName,
        categoryLevel: categoryLevel,
        pickingValue: category.pickingValue
      }
      if (categoryLevel == CATEGORY_LEVEL.TWO) { //二级品类
        params.id = $scope.selectedLevelOneCategory.id;
      }
      productService.createProductCategory(params).then(function(res) {
        //新增后清空input
        category.categoryName = "";
        category.pickingValue = "";
        if (categoryLevel == CATEGORY_LEVEL.ONE) { //一级品类
          loadCategoryList(0);
        } else if (categoryLevel == CATEGORY_LEVEL.TWO) { //二级品类
          loadCategoryList($scope.selectedLevelOneCategory.id);
          $scope.addLevelTwo = {};
        }
      });
    };
    //修改品类
    $scope.modifyCategory = function(category, categoryLevel) {
      var params = {
        id: category.id,
        categoryName: category.categoryName,
        categoryLevel: categoryLevel,
        pickingValue: category.pickingValue
      }
      productService.modifyProductCategory(params).then(function(res) {
        if (categoryLevel == CATEGORY_LEVEL.ONE) { //一级品类
          loadCategoryList(0);
        } else if (categoryLevel == CATEGORY_LEVEL.TWO) { //二级品类
          loadCategoryList($scope.selectedLevelOneCategory.id);
        }
      });
    };
    //删除品类
    $scope.deleteCategory = function(category, categoryLevel) {
      if (confirm('是否确认删除该品类')) {
        productService.deleteProductCategory({
          id: category.id
        }).then(function(res) {
          if (categoryLevel == CATEGORY_LEVEL.ONE) { //一级品类
            loadCategoryList(0);
          } else if (categoryLevel == CATEGORY_LEVEL.TWO) { //二级品类
            loadCategoryList($scope.selectedLevelOneCategory.id);
          }
        });
      }
    };
    //选择一级品类
    $scope.selectLevelOne = function(index) {
      $scope.selectedLevelOneCategory = $scope.levelOneCategoryList[
        index];
      loadCategoryList($scope.selectedLevelOneCategory.id);
    };
    //初始化仓位
    var positionInit = function() {
      positionService.queryAllPositions().then(function(res) {
        $scope.productPositionData = res;
      });
    };
    //弹出管理品类
    $scope.categoryManageWin = function() {
      $scope.productInitModal('productCategoryManage');
      categoryInit();
    };
    /*
     * 商品的修改，编辑，保存，删除
     */
    //添加商品 新增/修改
    $scope.productEditWin = function(id) {
      labelsManagementService.getAllLabelList().then(function(labelRes) {
        $scope.labelList = labelRes;
        $scope.labelConfig.setList(labelRes);
      });
      //重置多选
      resetMultiSelect($scope.productPositionData);
      resetMultiSelect($scope.productTagsData);
      if (typeof id == 'undefined') { //新增模式
        $scope.product.reset();
        $scope.productLevelTwoCategoryConfig.reset();
        $scope.productInitModal('productEdit', 'lg');
      } else { //修改模式
        productService.getProductById({
          id: id
        }).then(function(res) {
          var data = productService._parseProductData(res, $scope.labelList);
          $scope.product = angular.extend($scope.product, data);
          _.each(data.positionIds, function(value, key) { //仓位 默认选中
            _.findWhere($scope.productPositionData, {
              id: value.id
            }).selected = true;
          });
          _.each(data.productTags, function(tagId) { //特殊标识 默认选中
            _.findWhere($scope.productTagsData, {
              code: tagId
            }).selected = true;
          });
          $scope.productInitModal('productEdit', 'lg');
        });
      }
    };
    //重置多选
    var resetMultiSelect = function(list) {
      _.each(list, function(item) {
        item.selected = false;
      });
    };
    //获取商品数据字典
    var loadProductDictionary = function(type) {
      productService.queryProductDictionary({
        type: type
      }).then(function(res) {
        switch (type) {
          case PRODUCT_DIC_TYPE.ORIGIN_PLACE:
            $scope.originPlaceList = res;
            break;
          case PRODUCT_DIC_TYPE.BRAND_AWARENESS:
            $scope.brandAwarenessList = res;
            break;
          case PRODUCT_DIC_TYPE.BRAND_GRADE:
            $scope.brandGradeList = res;
            break;
        }
      });
    };
    //利润
    $scope.profitLevelConfig = {
      getDefaultItem: function(value) {
        var options = this.getList();
        return _.findWhere(options, {
          profitLevel: value
        }) || {
          name: '无'
        };
      },
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'PROFIT_LEVEL',
          hasDefault: false,
          codeKey: 'profitLevel',
          valueKey: 'name'
        });
      },
      selectItem: function(record) {
        if (typeof record.profitLevel != 'undefined') {
          $scope.product.profitLevel = record.profitLevel;
        }
      }
    };
    //原产地
    $scope.productOriginPlaceConfig = {
      getDefaultItem: function(value) {
        var options = $scope.originPlaceList;
        return _.findWhere(options, {
          id: value
        }) || {
          name: '无'
        };
      },
      selectItem: function(record) {
        $scope.product.originPlace = record.id;
      }
    };
    //品牌认知度
    $scope.productBrandAwarenessConfig = {
      getDefaultItem: function(value) {
        var options = $scope.brandAwarenessList;
        return _.findWhere(options, {
          id: value
        }) || {
          name: '无'
        };
      },
      selectItem: function(record) {
        $scope.product.brandAwareness = record.id;
      }
    };
    //品牌档次
    $scope.productBrandGradeConfig = {
      getDefaultItem: function(value) {
        var options = $scope.brandGradeList;
        return _.findWhere(options, {
          id: value
        }) || {
          name: '无'
        };
      },
      selectItem: function(record) {
        $scope.product.brandGrade = record.id;
      }
    };
    //一级品类 设置
    $scope.productLevelOneCategoryConfig = {
      getDefaultItem: function(value) {
        var options = $scope.levelOneCategoryList;
        return _.findWhere(options, {
          id: value
        }) || {
          categoryName: '无'
        };
      },
      selectItem: function(record) {
        // debugger
        if (record.id) {
          $scope.product.categoryId = record.id;
          productService.queryProductCategoryList({
            parentCategoryId: record.id
          }).then(function(res) {
            $scope.productLevelTwoCategoryConfig.setList(res);
          });
        }
      }
    };
    //二级品类 设置
    $scope.productLevelTwoCategoryConfig = {
      list: [],
      setList: function(list) {
        this.list = angular.copy(list);
      },
      getDefaultItem: function(value) {
        var options = this.list;
        if (options.length) {
          return _.findWhere(options, {
            id: value
          }) || {
            categoryName: '无'
          };
        } else {
          return value ? {
            categoryName: $scope.product.subCategoryName || '无',
          } : {
            categoryName: '无'
          };
        }
      },
      selectItem: function(record) {
        $scope.product.subCategoryId = record.id;
      },
      reset: function() {
        this.list = [];
      }
    };
    //标签 设置
    $scope.labelConfig = {
      lineslist: [],
      setList: function(list) {
        this.lineslist = [];
        for (var i = 0; i < list.length / 3; i++) {
          var temp = [];
          for (var j = 0; j < 3; j++) {
            if (list[i * 3 + j]) {
              var r = list[i * 3 + j];
              r.parentIndex = i * 3 + j;
              _.each(r.entries, function(item) {
                item.parentIndex = i * 3 + j;
              });
              temp.push(r);
            }
          }
          this.lineslist.push(temp);
        }
      },
      getDefaultItem: function(value, index) {
        var options = $scope.labelList[index].entries;
        return _.findWhere(options, {
          id: value
        }) || {
          name: '无'
        };
      },
      selectItem: function(record) {
        var t = _.reject($scope.product.labelDtos, function(item) {
          return item.type == record.type;
        });
        $scope.product.labelDtos = t;
        $scope.product.labelDtos.push(record);
      }
    };
    //进货 过期 损耗
    $scope.typeStr = '';
    $scope.tipStr = '';
    $scope.modalModifystock = function(strId, size, typeStr) {
      switch (typeStr) {
        case 'add': //1
          $scope.product.stockDeltaType = CONSTANTS.STOCK_MODIFY_TYPE.IMPORT;
          break;
        case 'expire': //4
          $scope.product.stockDeltaType = CONSTANTS.STOCK_MODIFY_TYPE.EXPIRE;
          break;
        case 'waste': //6
          $scope.product.stockDeltaType = CONSTANTS.STOCK_MODIFY_TYPE.WASTE;
          break;
      }
      $scope.typeStr = typeStr;
      $scope.tipStr = CONSTANTS.STOCK_MODIFY_TYPE.DESC[$scope.product.stockDeltaType];
      $scope.productInitModal(strId, size);
    };
    $scope.operateStock = function(data) {
      var stock = $scope.product.stock;
      if ($scope.product.stockDeltaType == CONSTANTS.STOCK_MODIFY_TYPE.IMPORT) {
        $scope.product.stock = $scope.product.stock + data;
        $scope.product.stockDelta = data;
      } else {
        if (stock < data) {
          window.alert('库存不够！请调整输入数据！');
          return;
        }
        $scope.product.stock = $scope.product.stock - data;
        $scope.product.stockDelta = -data;
      }
      this.$close();
    };
    //保存商品
    $scope.productSave = function(product) {
      var me = this;
      var errorMsg = $scope.product.checkComplete();
      if (errorMsg.length) {
        alert(errorMsg);
        return;
      }
      //仓位
      product.positionIds = _.pluck(product.positionOutPutData, 'id');
      //标签
      product.labelIdList = _.pluck(product.labelDtos, 'id');
      //特殊标识
      product.productTags = _.pluck(product.selectProductTagsData,
        'code');
      var saveParams = angular.copy(product);
      saveParams.originPrice = utilService.getPointInt(saveParams.originPrice);
      saveParams.price = utilService.getPointInt(saveParams.price);
      if (saveParams.id) {
        productService.saveOldProduct(saveParams).then(function() {
          $scope.tableParams.reload();
          me.$close();
        });
      } else {
        saveParams.stockAlarm = 999999;
        saveParams.intro = '-';
        saveParams.detail = '-';
        saveParams.imgs = ['-'];
        productService.saveNewProduct(saveParams).then(function() {
          $scope.tableParams.reload();
          me.$close();
        });
      }
    };
    //删除商品
    $scope.deleteForm = {};
    $scope.productDeleteWin = function(id) {
      $scope.deleteForm = {};
      $scope.deleteForm.productId = id;
      $scope.productInitModal('productDelete');
    };
    $scope.productDeleteSave = function() {
      var me = this;
      productService.deleteProduct({
        id: $scope.deleteForm.productId
      }).then(function() {
        $scope.tableParams.reload();
        me.$close();
      });
    };
    $scope.showBigImage = function(cover) {};
    $scope.inputData = [{
      name: 'Opera'
    }, {
      name: 'Internet Explorer'
    }, {
      name: 'Firefox'
    }];
    $scope.localLang = {
      selectAll: "全选",
      selectNone: "全不选",
      reset: "重置",
      search: "输入关键字搜索",
      nothingSelected: "无"
    };
    categoryInit();
    positionInit();
    //原产地
    loadProductDictionary(PRODUCT_DIC_TYPE.ORIGIN_PLACE);
    //品牌认知度
    loadProductDictionary(PRODUCT_DIC_TYPE.BRAND_AWARENESS);
    //品牌档次
    loadProductDictionary(PRODUCT_DIC_TYPE.BRAND_GRADE);
    /**
     * 按编码排序
     * @param item
     */
    $scope.sortByPosition = function(item) {
      $scope.queryParams.sortType = item.sortCode;
      $scope.tableParams.settings({
        dataset: []
      });
    };
    $scope.productStockChangeLogPanel;
    $scope.productStockChangeLogs = [];
    $scope.productStockChangeLogId;
    var stockChangeLogLimit = 10;
    $scope.productStockChangeLogTable = new NgTableParams({
      count: stockChangeLogLimit
    }, {
      counts: [],
      getData: function(params) {
        var p = {};
        var offset = stockChangeLogLimit * (params.page() - 1);
        p = {
          offset: offset,
          limit: stockChangeLogLimit,
          id: $scope.productStockChangeLogId
        };
        return productService.getProductStockChangeLog(p).then(
          function(res) {
            $scope.productStockChangeLogs = res.content;
            params.total(res.totalElements);
            return utilService.indexArray(res.content, offset +
              1);
          });
      }
    });;
    //库存修改记录
    $scope.showProductStockChangeLog = function(product, e) {
      e.stopPropagation();
      e.preventDefault();
      $scope.productStockChangeLogId = product.id;
      $scope.productInitModal('modal-productstockchangelogpanel', 'md');
    };
    $scope.product = {
      id: '',
      skuCode: '',
      productName: '',
      net: '',
      netUnit: '',
      profitLevel: '',
      originPlace: '',
      originPrice: '',
      price: '',
      expiryDate: '',
      brandAwareness: '',
      brandGrade: '',
      categoryId: '',
      subCategoryId: '',
      labelIdList: [],
      showLabelIdList: [],
      labelDtos: [],
      stock: 0,
      cover: '',
      reset: function() {
        this.id = '';
        this.skuCode = '';
        this.productName = '';
        this.net = '';
        this.netUnit = '';
        this.profitLevel = '';
        this.originPlace = '';
        this.originPrice = '';
        this.price = '';
        this.expiryDate = '';
        this.brandAwareness = '';
        this.brandGrade = '';
        this.categoryId = '';
        this.subCategoryId = '';
        this.labelIdList = [];
        this.showLabelIdList = [];
        this.labelDtos = [];
        this.stock = 0;
        this.cover = '';
      },
      checkComplete: function() {
        var errorMsg = "";
        if (typeof this.profitLevel == 'undefined') {
          errorMsg = '请选择利润等级';
        } else if (!this.originPlace) {
          errorMsg = '请选择原产地';
        } else if (!this.brandAwareness) {
          errorMsg = '请选择品牌认知度';
        } else if (!this.brandGrade) {
          errorMsg = '请选择品牌档次';
        } else if (!this.categoryId) {
          errorMsg = '请选择品类';
        }
        return errorMsg;
      }
    }
  });
};

},{}],23:[function(require,module,exports){
module.exports = function(app) {
  app.controller('promotionOrderCtrl', function($scope, $compile,
    orderService,
    $templateCache, $mdDialog, modalService, printService, orderService,
    NgTableParams, utilService, CONSTANTS, companyService,
    promotionService,
    $filter) {
    $scope.utilService = utilService;
    $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
    $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    $scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
    $scope.PROMOTION_ORDER_STATUS = CONSTANTS.PROMOTION_ORDER_STATUS;
    $scope.Tea_Period_Type = CONSTANTS.Tea_Period_Type;
    $scope.currentOrderId;

    var COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
    var ORDER_TYPE = CONSTANTS.ORDER_TYPE;
    var DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
    var REFUND_STATE = CONSTANTS.REFUND_STATE;
    var INVENTORY_STATE = CONSTANTS.INVENTORY_STATE;
    var SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
    var Tea_Period_Type = CONSTANTS.Tea_Period_Type;
    var Promotion_Search_Type = CONSTANTS.Promotion_Search_Type
    $scope.offset;
    $scope.limit;
    $scope.isUpdateTimeChoices = [{ desc: '下单时间', code: '0' }, {
      desc: '预约送货时间',
      code: '1'
    }];
    $scope.SearchChoices = [{ desc: '手机号', code: '1' }, { desc: '企业名称',
        code: '2' },
      { desc: '联系人', code: '3' }
    ];
    $scope.orderTypeList = [{ desc: '全部订单', code: '0' }, { desc: '待确认',
        code: '1' },
      { desc: '待付尾款', code: '2' }, { desc: '待发货', code: '3' }, {
        desc: '已发货',
        code: '4'
      }, { desc: '已收货', code: '5' }, { desc: '已取消', code: '6' }
    ];


    $scope.queryParams = {
      createStartDay: '',
      createEndDay: '',
      updateStartDay: '',
      updateEndDay: '',
      isPaid: '', // 0 没有  1 已支付
      isUpateTime: 0,
      tel: "",
      name: "",
      status: "",
      curOrderType: "",
      searchSelect: Promotion_Search_Type.TEL
    };

    var setOrderTable = function(queryParams) {
      $scope.queryParams.startDay = $scope.queryParams.startDay ||
        utilService
        .parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
      $scope.queryParams.endDay = $scope.queryParams.endDay ||
        utilService.parseTimeByDate(
          new Date(), 'yyyy-MM-dd');
      $scope.offset = 0;
      $scope.limit = 20;
      $scope.orderTable = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        paginationMaxBlocks: 13,
        paginationMinBlocks: 2,
        getData: function(params) {
          var p = {
            offset: (params.page() - 1) * $scope.limit,
            limit: $scope.limit
          };
          if ($scope.queryParams.searchSelect ==
            Promotion_Search_Type.TEL) {
            if (/^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/i.test(
                $scope.queryParams
                .name) || $scope.queryParams.name === "") {
              p.contactPhone = $scope.queryParams.name
            } else {
              alert('请输入正确格式的手机号码');
              $scope.queryParams.name = ''
            }

          } else if ($scope.queryParams.searchSelect ==
            Promotion_Search_Type
            .COMPANY) {
            p.companyName = $scope.queryParams.name
          } else if ($scope.queryParams.searchSelect ==
            Promotion_Search_Type
            .Name) {
            p.contactName = $scope.queryParams.name
          }
          if ($scope.queryParams.curOrderType) {
            p.status = $scope.queryParams.curOrderType;
          }


          if ($scope.queryParams.isUpateTime) {

            p.deliveryTimeStart = Date.parse($scope.queryParams.startDay
              .replace(
                /-/g, '/'));
            p.deliveryTimeEnd = Date.parse($scope.queryParams.endDay
              .replace(
                /-/g, '/') + ' 23:59:59');
          } else {
            p.createTimeStart = Date.parse($scope.queryParams.startDay
              .replace(
                /-/g, '/'));
            p.createTimeEnd = Date.parse($scope.queryParams.endDay
              .replace(/-/g,
                '/') + ' 23:59:59');
          }

          return orderService.queryPromotionList(p).then(function(
            res) {
            params.total(res.totalElements);
            var data = $scope.addRefundType(res.content);
            return checkInfo(utilService.indexArray(data,
              $scope.limit * (
                params.page() - 1) + 1));
          });
        }
      });
    };

    setOrderTable();
    // 下午茶类型转换
    $scope.addRefundType = function(data) {
        if (Object.prototype.toString.call(data) == '[object Array]') {
          teaArray = data;
        } else {
          teaArray = [data];
        }
        angular.forEach(teaArray, function(item, i) {
          if (item.order.status == 7 || item.order.status == 8) {
            item.order.refund = '未退款'
          } else if (item.order.status == 9) {
            item.order.refund = '已退款'
          } else {
            item.order.refund = '--'

          }

        })
        return teaArray;
      }
      //搜索单据searchTea
    $scope.searchTea = function(queryParams) {
      queryParams = queryParams || {};
      $scope.queryParams.name = queryParams.name || "";
      $scope.queryParams.searchSelect = queryParams.searchSelect;
      $scope.queryParams.startDay = queryParams.startTime ? utilService
        .parseTimeByDate(
          queryParams.startTime, 'yyyy-MM-dd') :
        utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
      $scope.queryParams.endDay = queryParams.endTime ? utilService.parseTimeByDate(
          queryParams.endTime, 'yyyy-MM-dd') :
        utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd');
      $scope.queryParams.isUpateTime = queryParams.isUpateTime;
      $scope.queryParams.searchSelect = queryParams.searchSelect;
      setOrderTable();
    };
    //选择单据类型
    $scope.selectOrderType = function(item) {
      if (item.code == 0) {
        $scope.queryParams.curOrderType = [2, 3, 4, 5, 6, 8, 9];
      } else if (item.code == 6) {
        $scope.queryParams.curOrderType = [8, 9];
      } else {
        $scope.queryParams.curOrderType = parseInt(item.code) + 1;
      }

      setOrderTable();
    };
    $scope.showDetail = function(order) {
      $scope.currentOrder = order;
      $scope.currentOrderId = order.order.id;
      $scope.checkOrderDetail(ORDER_TYPE.PROMOTION, order.order.id);
    };
    //明细
    $scope.checkOrderDetail = function(orderType, orderId, scope,
      isUpdate) {
      //$scope.companyName=companyName;
      orderService.checkOrderDetail(orderType, orderId, $scope,
        isUpdate);
    };
    /*打印*/
    //打印单据列表
    var printOrderArray = [];
    var checkInfo = function(data) {
      angular.forEach(data, function(item) {
        var t = _.findWhere(printOrderArray, {
          orderId: item.orderId
        });
        if (t) {
          item.checked = true;
        } else {
          item.checked = false;
        }
      });
      return data;
    };
    $scope.checkAllCfg = {
      flag: false
    };
    //勾选
    $scope.updateSelection = function(e, order) {
      var isChecked;
      if (_.isObject(e)) {
        isChecked = e.currentTarget.checked;
      } else {
        isChecked = e;
      }
      order.checked = isChecked;
      if (isChecked) {
        printOrderArray.push(order);
      } else {
        $scope.checkAllCfg.flag = false;
        printOrderArray = _.without(printOrderArray, order);
      }
    };
    $scope.selectAllOrder = function(e, data, checkall) {
      var st = e.currentTarget.checked;
      angular.forEach(data, function(item) {
        if (item.checked !== st) {
          $scope.updateSelection(e.currentTarget.checked, item);
        }
      });
    };
    //批量打印
    $scope.printOrder = function(orders) {
      // debugger
      var promotionOrderIds = [];
      var orderArray = [];
      if (Object.prototype.toString.call(orders) == '[object Array]') {
        orderArray = orders;
      } else {
        orderArray = [orders];
      }
      angular.forEach(orderArray, function(item) {
        promotionOrderIds.push(item.order.id);
      });
      orderService.queryPromotionList({
        ids: promotionOrderIds
      }).then(function(res) {
        var promotionOrderDetails = res.content || [];
        var temps = [];
        angular.forEach(promotionOrderDetails, function(detail) {
          var scope = orderService.promotionOrderScope(
            ORDER_TYPE.PROMOTION,
            detail, $scope.$new(true));
          scope.isPrint = true;
          temps.push(angular.element('<div></div>').append(
            orderService.getTemplateDomByType(
              ORDER_TYPE.PROMOTION, scope)));
        });
        $scope.$applyAsync(function() {
          var htmls = [];
          angular.forEach(temps, function(item) {
            console.log(item[0].innerHTML);
            htmls.push(item[0].innerHTML);
          });
          printService.printByDefaultPrinter(htmls);
        });
      });
    };
    // 详情页打印
    $scope.printTeaHtml = function(orderType) {
      var html = orderService.getPrintHtmlInOrderModule(orderType);
      $scope.$applyAsync(function() {
        console.log(html);
        printService.printByDefaultPrinter(html);
      });
    };
    $scope.bathMultiPrint = function() {
      if (printOrderArray.length) {
        $scope.printOrder(printOrderArray);
      } else {
        $mdDialog.show($mdDialog.alert({
          title: '提示',
          textContent: '请选择需要打印的票据',
          ok: '确认'
        }));
      }
    };
    $scope.keyremark = function(e, remark, id) {
      if (e.keyCode == 13) { //回车键
        orderService.modifyRemark({
          orderId: id,
          remark: remark
        }).then(function(res) {

        });
      }
    };

    $scope.payFullDialog;
    $scope.sendDialog;
    $scope.refundDialog;
    $scope.payFullParams = {
      note: ''
    };
    $scope.sendParams = {
      expressName: '',
      expressNumber: ''
    };
    $scope.recordModal;
    $scope.recordParams = {};
    $scope.openRecordModal = function(order, recordType) {
      $scope.recordParams.type = recordType;
      $scope.recordParams.orderId = order.order.id;
      $scope.recordParams.optRecord = '';
      $scope.recordModal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'promotion')),
        scope: $scope,
        templateUrl: 'modalRecord'
      });
    };
    $scope.refreshModel = function(orderId) {
      $scope.checkOrderDetail(ORDER_TYPE.PROMOTION, orderId, $scope,
        true);
    };
    //取消此单
    $scope.cacelOrder = function(order) {
      var status = order.order.status;
      promotionService.cancelPaymentOrder({
        orderId: order.order.id
      }).then(function() {
        $scope.promotion.close();
        setOrderTable();
      });
    };

    //接收
    $scope.receiveOrder = function(order) {
      $scope.openRecordModal(order, CONSTANTS.GOODSCHOOSE_ORDER_STATE.VERIFIED);
    };
    //付尾款
    $scope.payFullOrder = function(order) {
      $scope.payFullCount = parseFloat(parseInt(order.order.actualPrice) *
        100 - parseInt(order.order.deposit), 2);
      $scope.payFullDialog.showDialog($scope);
    };
    $scope.confirmPayFull = function() {
      promotionService.payFullPromotionOrder({
        orderId: $scope.currentOrderId,
        crmNotes: $scope.payFullParams.note
      }).then(function() {
        $scope.refreshModel($scope.currentOrderId);
        setOrderTable();
        $scope.payFullDialog.closeDialog();
      });
    };
    //发货
    $scope.sendOrder = function(order) {
      $scope.sendDialog.showDialog($scope);
    };
    $scope.confirmSend = function() {
      promotionService.deliveryPromotionOrder({
        orderId: $scope.currentOrderId,
        expressId: $scope.sendParams.expressNumber,
        expressType: $scope.sendParams.expressName
      }).then(function() {
        $scope.refreshModel($scope.currentOrderId);
        setOrderTable();
        $scope.sendDialog.closeDialog();
      });
    };
    //退款
    $scope.refundOrder = function(order) {
      $scope.refundDialog.showDialog($scope);
    };
    $scope.confirmRefund = function(order) {
      promotionService.refundPromotionOrder({
        orderId: $scope.currentOrderId
      }).then(function() {
        $scope.refreshModel($scope.currentOrderId);
        setOrderTable();
        $scope.refundDialog.closeDialog();
      });
    };

    //确认订单
    $scope.confirmAndEditOrder = function(order, scope) {
      openEditModal(order, scope);
    };

    //收货
    $scope.receiveOrder = function(order) {
      promotionService.receivePromotionOrder({
        orderId: $scope.currentOrderId
      }).then(function() {
        $scope.refreshModel($scope.currentOrderId);
        setOrderTable();
      });
    };
    $scope.getPromotionProduct = function() {
      return promotionService.queryPromotionProductList({
        offset: 0,
        limit: 10000,
        title: $scope.editData.search,
        status: 1,
        payType:1
      }).then(function(res) {
        $scope.products = res.content;
        return $scope.products;

      })

    };
    $scope.getSelectedProduct = function(ids) {
      return promotionService.queryPromotionProductList({
        offset: 0,
        limit: 10000,
        ids: ids
      }).then(function(res) {
        $scope.selectedProduct = res.content;
        angular.forEach($scope.selectedProduct, function(item) {
          var array = _.where($scope.editData.orderItems, { productId: item
              .id });
          item.itemNum = parseInt(array[0].itemNum);

        })
        return $scope.selectedProduct;

      })

    };
    var openEditModal = function(order, scope) {
      $scope.editData = order;

      $scope.selectedProduct = [];
      ids = _.pluck($scope.editData.orderItems, 'productId');;
      $scope.getPromotionProduct()
      $scope.getSelectedProduct(ids);

      $scope.recordModal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'promotion')),
        scope: $scope,
        templateUrl: 'modal-promotionEdit',
        size: 'plg'
      });
    };
    $scope.promotionSelect = function(product) {
      _.each($scope.products, function(item) {
        item.isSelect = false;
      });
      _.each($scope.selectedProduct, function(item) {
        item.isSelect = false;
      });
      product.isSelect = true;
      $scope.selectItem = product;
    };
    $scope.promotiondelect = function(product) {
      _.each($scope.products, function(item) {
        item.isSelect = false;
      });
      _.each($scope.selectedProduct, function(item) {
        item.isSelect = false;
      });

      product.isSelect = true;
      $scope.delectItem = product;
    };

    $scope.changeTotal = function() {
      $scope.editData.order.price = 0;
      angular.forEach($scope.selectedProduct, function(item) {
        if (item.itemNum === 0 || item.itemNum < 0) {
          var index = _.findIndex($scope.selectedProduct, { id: item
              .id });
          $scope.selectedProduct.splice(index, 1);
          return
        } else {
          if (item.itemNum > 999) {
            item.itemNum = 999;
          }
          $scope.editData.order.price += item.itemNum * item.price;
        }

      })
    };
    $scope.confirmEdit = function() {
      if (!parseFloat($scope.editData.order.actualPrice)) {
        alert("请正确输入实收金额！");
        return;
      }
      if (($scope.editData.order.actualPrice * 100) > parseInt($scope.editData
          .order.price)) {
        alert("实收金额不可超过订单金额！");
        return;
      }
      if (!$scope.editData.order.deliveryTime) {
        alert("请正确输入送货时间！");
        return;
      }

      var order = angular.copy($scope.editData.order);
      order.deliveryTime = order.deliveryTime.getTime();
      order.actualPrice = parseInt(parseFloat(order.actualPrice, 2) *
        100);
      promotionService.confirmOrder({
        orderId: $scope.editData.order.id,
        order: order,
        orderItems: $scope.selectedProduct
      }).then(function(res) {
        $scope.recordModal.close();
        $scope.refreshModel($scope.editData.order.id);
        setOrderTable();
      });

    };
    $scope.copy = function(item) {
      var array = {};
      angular.forEach(item, function(v, key) {
        if (v !== null) {
          array[key] = angular.copy(v);
        }
      });
      return array
    };
    $scope.itemAdd = function() {
      if ($scope.selectItem) {
        var item = _.where($scope.selectedProduct, { id: $scope.selectItem
            .id });
        if (item.length) {
          item[0].itemNum += 1;
        } else {

          $scope.selectItem.itemNum = 1
          $scope.selectItem.isSelect = false;
          $scope.selectedProduct.push(angular.copy($scope.selectItem));
        }
        var item = _.where($scope.selectedProduct, { id: $scope.selectItem
            .id });
        if (item.length) {
          item[0].itemNum += 1;
        } else {

          $scope.selectItem.itemNum = 1
          $scope.selectItem.isSelect = false;
          $scope.selectedProduct.push(angular.copy($scope.selectItem));
        }
      }


    };
    $scope.dblAdd = function(product) {
      var item = _.where($scope.selectedProduct, { id: product.id });
      if (item.length) {
        item[0].itemNum += 1;
      } else {

        $scope.selectItem.itemNum = 1
        $scope.selectItem.isSelect = false;
        $scope.selectedProduct.push(angular.copy($scope.selectItem));
      }

    };
    $scope.itemDelect = function() {
      if ($scope.delectItem) {
        var index = _.findIndex($scope.selectedProduct, {
          id: $scope.delectItem
            .id
        });
        if (index >= 0) {
          $scope.selectedProduct.splice(index, 1);
          $scope.selectedProduct.splice(index, 1);
        }
      }


    };
    $scope.dblDelect = function(product) {
      var index = _.findIndex($scope.selectedProduct, { id: product.id });
      $scope.selectedProduct.splice(index, 1);
    };
  });
};
},{}],24:[function(require,module,exports){
module.exports = function(app) {
  app.controller('promotionProductCtrl', function($scope, $mdDialog,
    promotionService, utilService, modalService, NgTableParams, CONSTANTS
  ) {
    $scope.PROMOTION_PAY_TYPE = CONSTANTS.PROMOTION_PAY_TYPE;
    $scope.utilService = utilService;
    $scope.picUrl = window.cfg.picUrl;
    $scope.queryParams = {
      status: 1
    };
    $scope.queryDesc = "";
    $scope.imgSizeLimit = {
      size: 500 * 1024,
      width: 1080,
      height: 1080
    }
    $scope.product = {
      imgDetails: [],
      desImgDetails: []
    };
    $scope.payTypeSelectDisabled = false; //标记支付方式是否可选
    /**
     * 列表
     */
    //表格设置
    $scope.offset = 0;
    $scope.limit = 20;
    var loadTable = function() {
      $scope.tableParams = new NgTableParams({
        count: $scope.limit
      }, {
        counts: [],
        paginationMaxBlocks: 20,
        paginationMinBlocks: 2,
        getData: function(params) {
          var searchParams = getQueryParams();
          $scope.offset = $scope.limit * (params.page() - 1);
          searchParams.offset = $scope.offset;
          searchParams.limit = $scope.limit;
          return promotionService.queryPromotionProductList(
            searchParams).then(function(res) {
            params.total(res.totalElements);
            return utilService.indexArray(promotionService._parsePromotionProductList(
                res.content),
              searchParams.offset);
          });
        }
      });
    };
    loadTable();
    //修改查询架上商品还是已下架商品
    $scope.changeActiveQueryParams = function(active) {
      $scope.queryParams = {};
      $scope.queryParams.status = active;
      $scope.queryProductConfig.selectItem($scope.queryProductConfig.nameTypeData[
        0]);
      loadTable();
    };
    //选择搜索条件
    $scope.queryProductConfig = {
      nameTypeData: [{
        markId: 'title',
        desc: '商品名称'
      }, {
        markId: 'sku',
        desc: '商品编码'
      }],
      selectItem: function(item) {
        var nameTypeData = $scope.queryProductConfig.nameTypeData;
        _.each(nameTypeData, function(t) {
          if (t.markId != item.markId) {
            delete $scope.queryParams[t.markId]; //去除非选中的查询字段
          }
        });
        $scope.queryParams["markId"] = item.markId;
        $scope.queryDesc = item.desc;
        $scope.queryConfigDefaultItem = item;
      }
    };
    $scope.queryConfigDefaultItem = $scope.queryProductConfig.nameTypeData[
      0];
    //回车键查询
    $scope.productKeyup = function(e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.productSearch();
      }
    };
    //商品搜索
    $scope.productSearch = function() {
      loadTable();
    };
    //按商品编码排序
    $scope.sortBySku = function(item) {
      $scope.queryParams.field = 'sku';
      $scope.queryParams.asc = item.sortCode;
      loadTable();
    };
    var getQueryParams = function() {
      var temp = $scope.queryParams;
      temp[temp.markId] = temp.queryName;
      return _.omit(temp, 'markId', 'queryName');
    };
    // 获取H5链接
    $scope.getLink = function(id) {
      promotionService.getPromotionProductLink({
        id: id
      }).then(function(res) {
        $scope.wechatLink = res;
        //后续用正则匹配
        $scope.internalLink = '#' + res.split('?route=')[1];
        openMadal('linkShow', 'lg');
      });
    };
    // 设置商品上下架
    $scope.modifyProductActive = function(product) {
      if (product.active) { //需设置为下架
        promotionService.offlinePromotionProduct({
          id: product.id
        }).then(function(res) {
          product.active = !product.active;
          utilService.alertSuccess('下架成功');
          $scope.tableParams.reload();
        });
      } else { //需设置为上架
        promotionService.onlinePromotionProduct({
          id: product.id
        }).then(function(res) {
          product.active = !product.active;
          utilService.alertSuccess('上架成功');
          $scope.tableParams.reload();
        });
      }
    };
    /*
     *商品的新增，修改
     */
    //打开编辑框
    $scope.productEditWin = function(id) {
      openMadal('productEdit', 'lg');
      $scope.product = {
        imgDetails: [],
        desImgDetails: []
      };
      if (typeof id != 'undefined') { //修改模式
        $scope.payTypeSelectDisabled = true;
        promotionService.queryPromotionProductDetail({
          id: id
        }).then(function(res) {
          promotionService.getPromotionProductLink({
            id: id
          }).then(function(link) {
            var product = promotionService._parsePromotionProductDetail(
              res);
            product.link = link;
            $scope.product = product;
          });
        });
      } else {
        $scope.payTypeSelectDisabled = false;
      }
    };
    //支付类型设置
    $scope.payTypeConfig = {
      getDefaultItem: function(value) {
        var options = this.getList();
        return _.findWhere(options, {
          payType: value
        }) || options[0];
      },
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'PROMOTION_PAY_TYPE',
          hasDefault: false,
          codeKey: 'payType',
          valueKey: 'name'
        });
      },
      selectItem: function(record) {
        if (typeof record.payType != 'undefined') {
          $scope.product.payType = record.payType;
        }
      }
    };
    var getImgs = function(type) {
      var imgs = type == 1 ? $scope.product.imgDetails : $scope.product
        .desImgDetails;
      return imgs;
    };
    //上传完图片
    $scope.didUploadImg = function(file, type) {
      var imgs = getImgs(type);
      file.index = imgs.length ? _.max(imgs, function(img) {
        return img.index;
      }).index + 1 : 1;
      imgs.push(file);
    };
    //轮播图排序
    $scope.sortImgs = function(type) {
      var imgs = getImgs(type);
      imgs = _.sortBy(imgs, function(img) {
        return img.index;
      });
      if (type == 1) {
        $scope.product.imgDetails = imgs;
      } else {
        $scope.product.desImgDetails = imgs;
      }
    };
    //预览图片
    $scope.imgPreview = function(img) {
      $scope.previewImg = img;
      openMadal('imgPreviewer', 'lg');
    };
    //删除图片
    $scope.deleteImg = function(i, type) {
      var imgs = getImgs(type);
      imgs.splice(i, 1);
    };
    //保存商品
    $scope.productSave = function(product) {
      if (!checkSaveProductValid(product)) {
        return;
      }
      var me = this;
      var saveParams = angular.copy(product);
      saveParams.images = _.pluck(product.imgDetails, 'path');
      saveParams.desImages = _.pluck(product.desImgDetails, 'path');
      saveParams.cover = saveParams.images[0];
      saveParams.price = utilService.getPointInt(saveParams.price);
      if (saveParams.originalPrice) {
        saveParams.originalPrice = utilService.getPointInt(saveParams.originalPrice);
      }
      delete saveParams.active;
      if (typeof product.id == 'undefined') { //新增模式
        promotionService.createPromotionProduct(saveParams).then(
          function(
            res) {
            $scope.tableParams.reload();
            me.$close();
          });
      } else { //编辑模式
        promotionService.modifyPromotionProduct(saveParams).then(
          function(
            res) {
            $scope.tableParams.reload();
            me.$close();
          });
      }
    };
    //验证保存商品有效性
    var checkSaveProductValid = function(product) {
      var maxTitleLength = 14,
        maxImgCount = 5,
        maxSubTitleLength = 35;
      var errorMsg = '';
      if (!product.payType) { //未选择支付类型
        errorMsg = '请选择支付类型';
      } else if (!product.imgDetails.length) { //未上传商品轮播图
        errorMsg = '请上传商品轮播图';
      } else if (product.title.length > maxTitleLength) {
        errorMsg = '标题不得大于' + maxTitleLength + '个字';
      } else if (product.imgDetails.length > maxImgCount) {
        errorMsg = '商品轮播图不得大于' + maxImgCount + '张';
      } else if (product.subtitle) {
        if (product.subtitle.length > maxSubTitleLength) {
          errorMsg = '副标题不得大于' + maxSubTitleLength + '个字';
        }
      }
      if (errorMsg.length) {
        utilService.alertError(errorMsg);
        return false;
      }
      return true;
    };
    //打开Modal
    var openMadal = function(templateUrl, size) {
      modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'promotion-product')),
        templateUrl: templateUrl,
        scope: $scope,
        size: size
      });
    };
  });
};
},{}],25:[function(require,module,exports){
module.exports = function(app) {
  app.controller('promotionSuiteCtrl', function($scope, $mdDialog,
    NgTableParams, CONSTANTS, modalService, promotionService, utilService
  ) {
    var PROMOTION_PAY_TYPE = CONSTANTS.PROMOTION_PAY_TYPE;
    $scope.PROMOTION_PAY_TYPE = PROMOTION_PAY_TYPE;
    $scope.picUrl = window.cfg.picUrl;
    $scope.imgSizeLimit = {
      size: 16 * 1024,
      width: 256,
      height: 256
    };
    $scope.products = [];
    $scope.suite = {
      selectedProducts: []
    };
    $scope.queryParams = {}; //查询参数
    /**
     * 列表
     */
    //表格设置
    $scope.offset = 0;
    $scope.limit = 20;
    var queryParams = {
      offset: $scope.offset,
      limit: $scope.limit,
    }
    $scope.tableParams = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      paginationMaxBlocks: 20,
      paginationMinBlocks: 2,
      getData: function(params) {
        $scope.offset = $scope.limit * (params.page() - 1);
        return promotionService.queryPromotionSuiteList(queryParams)
          .then(
            function(res) {
              console.log(queryParams)
              params.total(res.totalElements);
              var suiteList = promotionService._parsePromotionSuiteList(
                res.content);
              suiteList = utilService.indexArray(suiteList,
                queryParams.offset);
              return suiteList;
            });
      }
    });
    //搜索查询
    $scope.suiteSearch = function() {
      queryParams.name = $scope.queryParams.des;
      $scope.tableParams.settings({
        dataset: []
      });
    };
    //按回车 搜索查询
    $scope.suiteSearchKeyup = function(e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.productSearch();
      }
    };
    //支付方式 筛选
    $scope.payTypeFilter = {
      getList: function() {
        return CONSTANTS.getList({
          clsOrName: 'PROMOTION_PAY_TYPE',
          codeKey: 'payType',
          valueKey: 'name',
          defaultObj: {
            '': '全部支付方式'
          }
        });
      },
      selectItem: function(item) {
        console.log(item)
        if (item.payType) {
          queryParams.payType = item.payType;
        } else {
          delete queryParams.payType
        }

        $scope.tableParams.settings({
          dataset: []
        });
      }
    };
    //删除组合
    $scope.deleteSuite = function(id) {
      if (confirm('是否确认删除该组合?')) {
        promotionService.deletePromotionSuite({
          id: id
        }).then(function(res) {
          $scope.tableParams.reload();
        });
      }
    };
    //获取HTML5链接
    $scope.getLink = function(id) {
      promotionService.getPromotionSuiteLink({
        id: id
      }).then(function(res) {
        $scope.wechatLink = res;
        //后续用正则匹配
        $scope.internalLink = '#' + res.split('?route=')[1];
        openMadal('linkShow', 'lg');
      });
    };
    /**
     * 新建营销组合
     */
    //打开 营销组合新增
    $scope.suiteEditWin = function(suiteId) {
      openMadal('suiteEdit', 'lg');
      promotionService.queryPromotionProductList({
        offset: 0,
        limit: 10000,
        status: 1
      }).then(function(productsRes) {
        if (suiteId) { //编辑模式
          promotionService.queryPromotionSuiteDetail({
            id: suiteId
          }).then(function(res) {
            $scope.suite = res.suite;
            $scope.suite.selectedProducts = res.products;
            var selectedProductIds = _.pluck($scope.suite.selectedProducts,
              'id');
            //被选商品
            $scope.products = _.reject(productsRes.content,
              function(product) {
                return _.contains(selectedProductIds, product
                  .id);
              });
          });
        } else { //新增模式
          $scope.products = productsRes.content;
          $scope.suite = {
            selectedProducts: []
          };
        }
      });
    };
    //支付方式前缀
    $scope.getPayTypePrefix = function(product) {
      var preTxt = product.payType ? '(' + PROMOTION_PAY_TYPE.DESC[
        product.payType].substr(0, 1) + ')' : '';
      return preTxt;
    };
    //选中商品
    $scope.selectProduct = function(product, type) {
      _.each($scope.products, function(item) {
        item.isSelect = false;
      });
      _.each($scope.suite.selectedProducts, function(item) {
        item.isSelect = false;
      });
      product.isSelect = true;
    };
    //添加或移除商品
    $scope.modifySelectedProduct = function(mode) {
      var operateProducts = [];
      if (mode == 'add') {
        operateProducts = $scope.products;
      } else if (mode == 'remove') {
        operateProducts = $scope.suite.selectedProducts;
      }
      var operateProduct = _.find(operateProducts, function(item) {
        return item.isSelect == true;
      });
      if (!operateProduct) {
        utilService.alertError('请先选择商品!');
        return;
      }
      operateProduct.isSelect = false;
      if (mode == 'add') {
        $scope.products = _.without(operateProducts, operateProduct);
        $scope.suite.selectedProducts.push(operateProduct);
      } else if (mode == 'remove') {
        $scope.suite.selectedProducts = _.without(operateProducts,
          operateProduct);
        $scope.products.splice(0, 0, operateProduct);
      }
    };
    //保存组合
    $scope.suiteSave = function(suite) {
      if (!checkSaveSuiteValid(suite)) {
        return;
      }
      var me = this;
      suite.productIds = _.pluck(suite.selectedProducts, 'id');
      suite.productNames = _.pluck(suite.selectedProducts,
        'title');
      delete suite.selectedProducts;
      if (suite.id) { //编辑模式
        promotionService.modifyPromotionSuite(suite).then(function(res) {
          $scope.tableParams.reload();
          me.$close();
        });
      } else { //新增模式
        promotionService.createPromotionSuite(suite).then(function(res) {
          $scope.tableParams.reload();
          me.$close();
        });
      }
    };
    //验证保存套餐有效性
    var checkSaveSuiteValid = function(suite) {
      if (!suite.banner) {
        utilService.alertError('请上传微信转发ICON!');
        return false;
      }
      if (!suite.selectedProducts.length) {
        utilService.alertError('请添加商品!');
        return false;
      }
      var payTypes = _.union(_.pluck(suite.selectedProducts, 'payType'));
      if (payTypes.length > 1) {
        utilService.alertError('存在支付方式不一致的商品，请仔细检查!');
        return false;
      }
      return true;
    };
    //打开Modal
    var openMadal = function(templateUrl, size) {
      modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'promotion-suite')),
        templateUrl: templateUrl,
        scope: $scope,
        size: size
      });
    };
  });
};
},{}],26:[function(require,module,exports){
/*
 * 角色管理 Controller
 */
module.exports = function(app) {
  app.controller('RoleCtrl', function($scope, $uibModal, roleService) {
    var loadRoles = function() {
      roleService.getRoles().then(function(res) {
        $scope.role = res;
      });
    };
    $scope.roleService = roleService;
    $scope.role = null;
    $scope.editable = function(role) {
      // 只有非根节点节点才可以编辑
      return $scope.role !== role;
    };
    $scope.addRole = function(scope, parent) {
      $uibModal.open(addOrEditModalOptionFactory($scope.permissions))
        .result.then(function(res) {
          res.parentId = parent.id;
          roleService.addRole(res).then(loadRoles);
        });
    };
    $scope.editRole = function(scope, role) {
      $uibModal.open(addOrEditModalOptionFactory($scope.permissions, role))
        .result.then(function(res) {
          roleService.editRole(role.id, res).then(loadRoles);
        });
    };
    $scope.removeRole = function(scope, role) {
      $uibModal.open(removeModalOptionFactory(role))
        .result.then(function(roleToRemove) {
          roleService.removeRole(roleToRemove.id).then(function() {
            scope.remove();
          });
        });
    };
    loadRoles();
    roleService.getNormalPermissions().then(function(res) {
      $scope.permissions = res;
    });
  });

  function addOrEditModalOptionFactory(permissions, roleToEdit) {
    return {
      templateUrl: 'views/account/addOrEditRoleModal.html',
      resolve: {
        roleToEdit: function() {
          return roleToEdit;
        },
        allPermissions: function() {
          return permissions
        }
      },
      controller: AddOrEditModalController
    };
  };

  /**
   * 新增/添加角色对话框 Controller
   */
  function AddOrEditModalController($scope, $uibModalInstance, roleToEdit, allPermissions) {
    $scope.allPermissions = allPermissions;
    $scope.addRoleMode = !roleToEdit;
    $scope.result = {
      name: roleToEdit ? roleToEdit.name : "",
      permissionIds: roleToEdit ? roleToEdit.permissions.map(function(permission) {
        return permission.id
      }) : []
    };
    $scope.ok = function() {
      $uibModalInstance.close($scope.result);
    };
    $scope.cancel = function() {
      $uibModalInstance.dismiss();
    };
  };
};

function removeModalOptionFactory(roleToRemove) {
  return {
    templateUrl: 'views/account/removeRoleModal.html',
    size: 'sm',
    resolve: {
      roleToRemove: roleToRemove
    },
    controller: function($scope, $uibModalInstance, roleToRemove) {
      $scope.roleToRemove = roleToRemove;
      $scope.ok = function() {
        $uibModalInstance.close(roleToRemove);
      };
      $scope.cancel = function() {
        $uibModalInstance.dismiss();
      };
    }
  };
};

},{}],27:[function(require,module,exports){
/*销售数据统计*/
module.exports = function (app) {
  app.controller('salesCtrl', function ($scope, productService, utilService, salesService, NgTableParams, $element, $compile, $templateCache) {
    $scope.intervalHide = false;
    $scope.utilService = utilService;
    $scope.yearHide = true;
    $scope.monthHide = true;
    $scope.weekHide = true;
    $scope.levelOneCategoryList = [];

    $scope.years = [];
    $scope.months = [];
    $scope.weekList = [];//{startDate,endDate,weekNum}
    $scope.intervalList = [{ value: 1, interval: "昨日" }, {
      value: 2,
      interval: "最近7天"
    }, { value: 3, interval: "最近30天" }, { value: 4, interval: "最近90天" }];

    $scope.selectYear = '';
    $scope.selectWeek = '';
    $scope.selectMonth = 1;
    $scope.selectInterval = $scope.intervalList[0];

    $scope.productName = "";
    $scope.searchType = 1;
    $scope.salesList = [];
    var categoryId = 0;
    var sortType = 0;

    // 下面代码为导出Excel做准备
    var excelTemplate = $compile($templateCache.get(
      'dataStatistics/salesStatisticsTableTemplate.html'))($scope);
    angular.element(document.getElementById(
      'exportExcelWrap')).append(excelTemplate);

    $scope.setInterval = function () {//区间统计
      $scope.intervalHide = false;
      $scope.yearHide = true;
      $scope.monthHide = true;
      $scope.weekHide = true;
      $scope.searchType = 1;
    };
    $scope.setMonths = function () {
      $scope.yearHide = false;
      $scope.monthHide = false;
      $scope.intervalHide = true;
      $scope.weekHide = true;
      $scope.searchType = 2;

    };
    $scope.setWeeks = function () {
      $scope.yearHide = false;
      $scope.weekHide = false;
      $scope.monthHide = true;
      $scope.intervalHide = true;
      $scope.searchType = 3;

    };
    $scope.onYearChange = function () {
      $scope.months = $scope.selectYear.month;
      $scope.selectMonth = $scope.months[0];
      $scope.weekList = $scope.selectYear.week;
      $scope.selectWeek = $scope.weekList[0];
    };
    $scope.offset = 0;
    $scope.limit = 20;
    $scope.tableParams = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      paginationMaxBlocks: 20,
      paginationMinBlocks: 2,
      getData: function (params) {
        var searchParams = getQueryParams();
        $scope.offset = $scope.limit * (params.page() - 1);
        searchParams.offset = $scope.offset;
        searchParams.limit = $scope.limit;
        return salesService.getQuerySalesList(searchParams).then(function (res) {
          params.total(res.totalElements);

          return res.content;
        });
      }

    });

    $scope.onSearch = function () {//查询按钮
      $scope.tableParams.settings({
        dataset: []
      });
    };
    $scope.onProductNameSearch = function () {
      $scope.tableParams.settings({
        dataset: []
      });
    };
    $scope.exportExcel = function () {//导出excel

      if (!$scope.salesList.length) {
        utilService.alertError('请先选择需导出的数据');
        return;
      }
      var dom = angular.element('<a></a>');
      dom[0].href = $('#export-sales-table').excelexportjs({
        containerid: 'export-sales-table',
        datatype: 'table',
        returnUri: 'true'
      });
      dom[0].download = '商品销售数据.xls';
      dom[0].click();

    };
    //回车键查询
    $scope.productKeyup = function (e) {
      var keycode = window.event ? e.keyCode : e.which;
      if (keycode == 13) {
        $scope.onSearch();
      }
    };
    //勾选
    $scope.updateSelection = function (e, item) {
      var isChecked;
      if (_.isObject(e)) {
        isChecked = e.currentTarget.checked;
      } else {
        isChecked = e;
      }
      item.checked = isChecked;
      if (isChecked) {
        $scope.salesList.push(item);
      } else {
        $scope.salesList = _.without($scope.salesList,
          item);
      }
    };
    $scope.unsalableClick = function (item) {//加入滞销商品库
      if (item.isUnsalable == 1) {
        salesService.delUnsalable({
          id: item.id
        }).then(function (res) {
        });
      } else {
        var params = { productIds: [item.id] };
        salesService.addUnsalable(params).then(function (res) {
        });
      }
      $scope.tableParams.reload();
    };
    //新品推荐
    $scope.recommendClick = function (item) {
      var params = { productIds: [item.id] };
      if (item.isNew == 1) {
        salesService.delRecommend({
          id: item.id
        }).then(function (res) {

        });
      } else {
        salesService.addCommend(params).then(function (res) {

        });
      }
      $scope.tableParams.reload();

    }
    //组装参数
    var getQueryParams = function () {
      var queryParams = {};
      switch ($scope.searchType) {
        case 1:
          queryParams.range = $scope.selectInterval.value;
          break;
        case 2:
          queryParams.year = $scope.selectYear.year;
          queryParams.month = $scope.selectMonth;
          break;
        case 3:
          queryParams.startTime = utilService.parseTimeByLong($scope.selectWeek.startDate, "yyyy-MM-dd");
          queryParams.endTime = utilService.parseTimeByLong($scope.selectWeek.endDate, "yyyy-MM-dd");
          break;
      }
      ;
      queryParams.productName = $scope.productName;
      queryParams.type = $scope.searchType;
      queryParams.sortType = sortType;
      if (categoryId > 0) {
        queryParams.categoryId = categoryId;
      }
      return queryParams;
    };

    //初始化品类
    var categoryInit = function () {
      loadCategoryList(0);
    };
    //加载品类
    var loadCategoryList = function (parentCategoryId) {
      productService.queryProductCategoryList({
        parentCategoryId: parentCategoryId
      }).then(function (res) {
        if (!parentCategoryId) { //一级品类
          $scope.levelOneCategoryList = angular.copy(res);
          $scope.levelOneCategoryFilter.setList(res);
          if ($scope.levelOneCategoryList.length > 0) {
            $scope.selectedLevelOneCategory = $scope.levelOneCategoryList[0];
            loadCategoryList($scope.selectedLevelOneCategory.id);
          }
        }
      });
    };
    $scope.levelOneCategoryManageList = function (item) {
      return item.id != '0';
    };
    categoryInit();
    //一级品类 筛选
    $scope.levelOneCategoryFilter = {
      list: [],
      defaultItem: {
        categoryName: '全部品类'
      },
      setList: function (list) {
        productService.queryProductCategoryList({
          parentCategoryId: 0
        })
        this.list = angular.copy(list);
        this.list.unshift(this.defaultItem);
      },
      selectItem: function (item) {//一级品类选中后
        if (item.id) {
          categoryId = item.id;
        } else {
          categoryId = 0;
        }
        $scope.categoryName = item.categoryName;
        $scope.onSearch();
      }
    };
    /**
     * 一星期毫秒数
     * @returns {number}
     */
    var getWeekTime = function weekTime() {
      return 7 * 24 * 3600000;
    };
    /**
     * 获取星期数组
     * @param year
     * @returns {Array}
     */
    var getWeekList = function (startDay, endDay) {
      var date = startDay;
      var endDate = endDay;
      // 取得这个日期对象 date 的长整形时间 time
      var time = date.getTime();
      var weekday = date.getDay();//新年的第 一天是星期几
      if (weekday == 0) {
        weekday = 7;
      }
      var list = [];
      var i = 0;
      while (time < endDate.getTime()) {
        var weekItem = {};
        weekItem.weekNum = (i + 1);
        if (i == 0) {
          weekItem.startDate = time;
          time = time + (7 - weekday) * 24 * 3600000;
        } else {
          weekItem.startDate = time + (24 * 3600000);
          time = time + getWeekTime();
        }
        weekItem.endDate = time;
        if (time >= endDate.getTime()) {
          weekItem.endDate = endDate.getTime();
        }
        weekItem.selectOption = "第" + weekItem.weekNum + "周(" + utilService.parseTimeByLong(weekItem.startDate, "MM月dd日") + "-" + utilService.parseTimeByLong(weekItem.endDate, "MM月dd日") + ")";
        list.push(weekItem);
        i++;
      }
      return list;
    };
    /**
     * 开始时间
     * @returns {Date}
     */
    var getStartDate = function () {
      salesService.getStartTime().then(function (res) {
        var val = Date.parse(res.startTimeStr);
        var newDate = new Date(val);
        var list = getSelectTimeList(newDate);
        $scope.years = list;
        $scope.selectYear = $scope.years[0];
        $scope.months = $scope.selectYear.month;
        $scope.weekList = $scope.selectYear.week;
        $scope.selectWeek = $scope.weekList[0];
        $scope.selectMonth = $scope.months[0];
      });
    };
    /**
     * 获取选择某年的月份
     * @param startMonth
     * @param endMonth
     * @returns {Array}
     */
    var getMonthList = function (startMonth, endMonth) {
      var list = [];
      for (var i = startMonth; i <= endMonth; i++) {
        list.push(i + 1);
      }
      return list;
    };
    /**
     * 获取时间数组
     * @param startDate
     * @returns {Array}
     */
    var getSelectTimeList = function (startDate) {
      var today = new Date();
      var startYear = startDate.getFullYear();
      var endYear = today.getFullYear();
      var yearList = [];
      for (var i = startYear; i <= endYear; i++) {
        var yearItem = { year: '', week: [], month: [] };
        var startDay;
        var endDay;
        if (i == startYear) {
          startDay = startDate;
          endDay = new Date(startYear, "11", "31");
        } else if (i == endYear) {
          startDay = new Date(endYear, "0", "1");
          endDay = today;
        } else {
          startDay = new Date(i, "0", "1");
          endDay = new Date(i, "11", "31");
        }
        yearItem.week = getWeekList(startDay, endDay);
        yearItem.month = getMonthList(startDay.getMonth(), endDay.getMonth());
        yearItem.year = i;
        yearList.push(yearItem);
      }
      return yearList;
    };
    $scope.sortByPosition = function (item) {
      sortType = item.sortCode;
      $scope.tableParams.settings({
        dataset: []
      });
    };

    getStartDate();
  });
}
},{}],28:[function(require,module,exports){
/*
 *货架巡查
 *shelfController
 */
module.exports = function(app) {
    app.controller('shelf', function($scope, $mdSidenav, $sce, shelfService, companyService, authService, utilService, NgTableParams) {
        $scope.queryParams = {
            shelf_stock_percent: '',
            shelf_warn_count: '',
            shelf_type: '',
            last_update_interval: ''
        };
        $scope.companys = [];
        $scope.handleClickSearch = function() {
            shelfService.queryShelfList(_.omit($scope.queryParams, function(value) {
                return value === '';
            })).then(function(res) {
                var temp = [];
                $scope.companys = res.content;
                angular.forEach($scope.companys, function(item, index) {
                    $scope.companys.index = index;
                    temp.push({
                        companyName: item.company_name,
                        companyId: item.company_id
                    });
                });
                companyService.companyList = temp;
                $scope.tableParams.settings({
                    dataset: shelfService._parseShelfData($scope.companys)
                });
                $scope.hideFilterPanel();
            });
        };
        $scope.handleClickSearchAll = function() {
            shelfService.queryShelfList({}).then(function(res) {
                var temp = [];
                $scope.companys = res.content;
                angular.forEach($scope.companys, function(item, index) {
                    $scope.companys.index = index;
                    temp.push({
                        companyName: item.company_name,
                        companyId: item.company_id
                    });
                });
                companyService.companyList = temp;
                $scope.tableParams.settings({
                    dataset: shelfService._parseShelfData($scope.companys)
                });
            });
        };
        $scope.showFilterPanel = function() {
            $mdSidenav('right').toggle();
        };
        $scope.hideFilterPanel = function() {
            $mdSidenav('right').toggle();
        };
        $scope.heads = [{
            title: '序号',
            field: 'index',
            show: true,
            getValue: function(v, r, idx) {
                return '<span style="display:inline-block;width:40px;text-align:center">' + (v + 1) + '</span>';
            }
        }, {
            title: '公司名称',
            field: 'company_name',
            filter: { company_name: 'text' },
            getValue: function(v, r) {
                return '<a style="display:inline-block;width:150px" href="#shelf/' + r.company_id + '">' + v + '</a>';
            },
            show: true
        }, {
            title: '公司类型',
            field: 'company_type',
            filter: { company_type: 'text' },
            show: true
        }, {
            title: '公司地址',
            field: 'company_address',
            filter: { company_address: 'text' },
            getValue: function(v) {
                return '<span style="display:inline-block;width:150px">' + v + '</span>';
            },
            show: true
        }, {
            title: '货架数/货架总数',
            field: 'valid_sheld_countVSshelf_count',
            filter: { valid_sheld_countVSshelf_count: 'text' },
            show: true
        }, {
            title: '距离上次补货',
            field: 'last_update_interval',
            sortable: 'last_update_interval',
            filter: { last_update_interval: 'text' },
            show: true
        }, {
            title: '货架上货物总体占比',
            field: 'all_product_per',
            sortable: 'all_product_per',
            filter: { all_product_per: 'text' },
            show: true,
            getValue: function(v) {
                return '<span style="display:inline-block;width:150px">' + v + '</span>';
            }
        }];
        $scope.tableParams = new NgTableParams({
            count: 25
        }, {
            counts: [],
            paginationMaxBlocks: 13,
            paginationMinBlocks: 2,
            dataset: []
        });
        $scope.shelfStatusOptions = {
            choices: $([{ value: '', desc: '全部' }]).concat(utilService.getConstantJsonValue('SHELF_STATE')),
            getDefaultItem: function(value) {
                var v = value;
                var options = this.choices;
                return _.findWhere(options, { value: v }) || options[0];
            },
            selectItem: function(record) {
                this.defaultItem = record;
                $scope.queryParams.shelf_type = record.value;
            }
        };
        /*        shelfService.queryShelfList().then(function(res) {
                    var temp = [];
                    $scope.companys = res.content;
                    angular.forEach($scope.companys, function(item, index) {
                        $scope.companys.index = index;
                        temp.push({
                            companyName: item.company_name,
                            companyId: item.company_id
                        });
                    });
                    companyService.companyList = temp;
                    // = _.pluck($scope.companys, 'company_id');

                    $scope.tableParams.settings({
                        dataset: shelfService._parseShelfData($scope.companys)
                    });
                });*/
    });
};

},{}],29:[function(require,module,exports){
module.exports = function(app) {
    app.controller('shelfDetail', function($scope, $element, $routeParams, productService, companyService, NgTableParams, utilService, shelfService, modalService) {
        var summaryCreateModal;
        var companyList = companyService.companyList;
        $scope.offset = 0;
        $scope.limit = 25;
        $scope.strategy = '';
        $scope.prefer = { name: '', id: '' };
        $scope.refuse = { name: '', id: '' };
        $scope.prefers = [];
        $scope.refuses = [];
        $scope.showPreferSearch = false;
        $scope.totalItems = companyList.length;
        $scope.currentCompany = _.findWhere(companyList, { companyId: $routeParams.companyId });
        $scope.currentPage = _.indexOf(companyList, $scope.currentCompany) + 1;
        $scope.$watch('currentPage', function() {
            $scope.init();
        });
        //配置
        $scope.summaryHead = [{
            title: '序号',
            field: 'index',
            show: true,
            getValue: function(value, record, index, scope) {
                return '<span>' + index + '</span>';
            }
        }, {
            title: '偏爱商品',
            field: 'prefers',
            getValue: function(value, record, index, scope) {
                return '<span>' + _.pluck(value || [], 'name').join(' | ') + '</span>';
            },
            show: true
        }, {
            title: '拒绝商品',
            field: 'refuses',
            getValue: function(value, record, index, scope) {
                return '<span>' + _.pluck(value || [], 'name').join(' | ') + '</span>';
            },
            show: true
        }, {
            title: '选购策略',
            field: 'strategy',
            getValue: function(value) {
                return '</span>' + (value || '') + '</span>';
            },
            show: true
        }];
        $scope.preferSummaryTable = new NgTableParams();
        //方法
        //初始化
        $scope.init = function() {
            $scope.currentCompany = companyList[$scope.currentPage - 1];
            shelfService.queryShelfDetailByCompanyId({
                companyId: $scope.currentCompany.companyId
            }).then(function(res) {
                $scope.tables = shelfService._parseShelfDetailData(res[0]);
            });
            companyService.queryCompanyPreferSummary({
                companyId: $scope.currentCompany.companyId
            }).then(function(res) {
                $scope.companySummary = res;
            });
        };
        $scope.openCreatePreferSummaryWin = function() {
            summaryCreateModal = modalService.initModal({
                templateUrl: 'summarycontent',
                appendTo: $element,
                scope: $scope,
                ok: $scope.createCompanyPreferSummary
            });
        };
        $scope.getTdCls = function(td) {
            var product = td && td.productHeader || {
                stock: 0,
                maxStock: 0
            };
            var ratio = 0;
            var stock;
            var maxStock;
            var cls = '';
            if (!td || !product) {
                return '';
            }
            stock = parseInt(product.stock);
            maxStock = parseInt(product.maxStock);
            ratio = parseFloat((stock / maxStock).toFixed(1));
            if (ratio <= 0.2) {
                cls = 'red';
            } else if (ratio > 0.2 && ratio <= 0.5) {
                cls = 'yellow';
            } else {
                cls = 'green';
            }
            if (maxStock === 0) {
                cls = 'blue';
            }
            return cls;
        };
        $scope.add = function($scope, type) {
            if ($scope[type].name) {
                if ($scope[type].id) {
                    $scope[type + 's'].push(angular.copy($scope[type]));
                    $scope[type].id = '';
                } else {
                    $scope[type + 's'].push(angular.copy($scope[type]));
                    $scope[type].name = '';
                }
            }
        };
        $scope.remove = function($scope, index, type) {
            $scope[type + 's'].splice(index, 1);
        };
        $scope.createCompanyPreferSummary = function() {
            return companyService.createCompanyPreferSummary({
                companyId: $scope.currentCompany.companyId,
                info: {
                    prefers: $scope.prefers,
                    refuses: $scope.refuses,
                    strategy: $scope.strategy
                }
            });
        };
        $scope.typeHeadOptions = [];
        $scope.typeHeadConfigs = {
            debounce: {
                'default': 500,
                'blur': 250
            },
            getterSetter: true
        };
        $scope.getTypeHeadOptions = function(value) { //搜索加载
            return productService.queryProductByKey({
                offset: $scope.offset,
                limit: $scope.limit,
                productName: value
            }).then(function(res) {
                return res.content;
            });
        };
        $scope.selectTypeHeadOptions = function(item, model, label, event, type) { //搜索选择
            $scope[type] = {
                name: item.header.productName,
                id: item.header.id
            };
        };

    });
};

},{}],30:[function(require,module,exports){
/*货架管理*/
module.exports = function(app) {
  app.controller('shelfManageCtrl', function($scope, $compile, $templateCache,
    shelfService, NgTableParams, modalService, companyService,
    utilService, CONSTANTS) {
    $scope.PROFIT_LEVEL = CONSTANTS.PROFIT_LEVEL;
    $scope.paths = [{
      name: '首页',
      root: '#home'
    }, {
      name: '企业货架管理',
      active: true
    }];
    $scope.picUrl = window.cfg.picUrl;
    var defaultShelf = { desc: '暂无货架' };
    $scope.curShelf = defaultShelf;
    $scope.company;
    $scope.shelfList = [];
    $scope.shelfTypeList = CONSTANTS.getList('SHELF_TYPE', false, '', '',
      null, true);
    var salesChartDays = 14;

    var initView = function() {
      var excelTemplate = $compile($templateCache.get(
        'shelfmanage/shelfProductsTemplate.html'))($scope);
      angular.element(document.getElementById('exportExcelWrap')).append(
        excelTemplate);
    };
    initView();
    $scope.selectCompanyCallback = function(company) {
      $scope.company = company;
      $scope.queryShelfListByCompany(company);
    };
    $scope.queryShelfListByCompany = function(company) {
      $scope.shelfList = [];
      var queryParams = { companyId: company.companyId };
      shelfService.queryShelfListByCompanyId(queryParams).then(function(
        res) {
        if (res.length > 0) {
          angular.forEach(res, function(item, i) {
            var t = item;
            t.desc = item.shelfName;
            $scope.shelfList.push(t);
            if (i == 0) {
              $scope.curShelf = t;
            }

          });
        } else {
          $scope.curShelf = defaultShelf;
          $scope.shelfProducts = [];
        }
      });
    };
    $scope.selectShelfCallback = function(item) {
      $scope.curShelf = item;
      if (typeof item.id == 'undefined') {
        return;
      }
      var queryParams = { shelfId: item.id };
      shelfService.queryShelfProducstsByShelfId(queryParams).then(
        function(res) {
          var shelfProducts = shelfService._parseShelfProductsData(
            res);
          $scope.shelfProducts = shelfProducts;
        });
    };

    //获取位置信息
    $scope.getPositionName = function(shelfProduct) {
      var curShelfType = $scope.curShelf.shelfType;
      var marks = ['A', 'B', 'C', 'D', 'E'];
      var positionName = shelfProduct.header.row == 5 && curShelfType ==
        CONSTANTS.SHELF_TYPE.SNACKS ?
        '饮料栏/' + shelfProduct.header.col :
        '第' + shelfProduct.header.row + '层/' + marks[shelfProduct.header
          .row - 1] + shelfProduct.header.col;
      return positionName;
    };

    /*管理货架 modal相关*/
    //管理货架
    $scope.manageShelf = function() {
      $scope.createShelfObj = {};
      $scope.queryShelfListByCompany($scope.company);
      $scope.modal = modalService.initModal({
        appendTo: angular.element(document.getElementsByClassName(
          'shelf-manage')),
        scope: $scope
      });
    };
    $scope.getDefaultShelfType = function(shelf) {
      if (typeof shelf != 'undefined') {
        return _.findWhere($scope.shelfTypeList, { code: shelf.shelfType }) ||
          $scope.shelfTypeList[0];
      } else {
        return $scope.shelfTypeList[0];
      }
    };
    $scope.selectShelfTypeCallback = function(item, shelf) {
      if (typeof shelf != 'undefined') {
        shelf.shelfType = item.code;
      } else {
        $scope.createShelfObj.shelfType = item.code;
      }

    };
    //新建货架
    $scope.createShelf = function(e) {
      var shelf = $scope.createShelfObj;
      var params = {
        shelfName: shelf.shelfName,
        companyId: $scope.company.companyId,
        shelfType: shelf.shelfType
      };
      shelfService.createShelf(params).then(function(res) {
        $scope.queryShelfListByCompany($scope.company);
        e.target.reset();
      });
    };
    //更新货架
    $scope.modifyShelf = function(shelf) {
      if (shelf.number == 0) {
        alert('货架编号需为大于0的整数');
        return;
      }
      var params = {
        shelfName: shelf.shelfName,
        shelfId: shelf.id,
        shelfType: shelf.shelfType,
        number: shelf.number
      };
      shelfService.modifyShelf(params).then(function(res) {
        $scope.queryShelfListByCompany($scope.company);
        shelf.inEdit = !shelf.inEdit;
      });
    };


    /*销量走势图 modal相关*/
    $scope.checkSalesChart = function(shelfProductId) {
      var params = { shelfProductId: shelfProductId, days: salesChartDays };
      shelfService.queryShelfProductTrend(params).then(function(res) {
        var xAxisDataTmp = [];
        var seriesDataTmp = [];
        angular.forEach(res.content, function(item, i) {
          xAxisDataTmp.push(item.date.substring(5, item.date.length));
          seriesDataTmp.push(item.sales);
        });
        $scope.xAxisData = xAxisDataTmp;
        $scope.seriesData = seriesDataTmp;
        $scope.modal = modalService.initModal({
          appendTo: angular.element(document.getElementsByClassName(
            'shelf-manage')),
          scope: $scope,
          templateUrl: 'modalSalesLine',
          size: 'lg'
        });
      });

    };

    /*商品详情 modal相关*/
    $scope.checkProductDetail = function(shelfProduct) {
      var params = { shelfProductId: shelfProduct.header.id };
      shelfService.queryShelfProductDetail(params).then(function(res) {
        $scope.curProduct = res;
        $scope.modal = modalService.initModal({
          appendTo: angular.element(document.getElementsByClassName(
            'shelf-manage')),
          scope: $scope,
          templateUrl: 'modalProductDetail',
          size: 'lg'
        });
      });
    };
    //货架信息导出Excel
    $scope.exportShelfProducts = function() {
      $scope.$applyAsync(function() {
        var dom = angular.element('<a></a>');
        dom[0].href = $('#shelf-products-table').excelexportjs({
          containerid: "shelf-products-table",
          datatype: 'table',
          returnUri: 'true'
        });
        dom[0].download = $scope.company.companyName + '-' + $scope
          .curShelf.shelfName + '-' + utilService.parseTimeByDate(
            new Date(), 'yyyyMMddhhmmss') + '.xls';
        dom[0].click();
      });
    };

  });
};
},{}],31:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/11/24.
 */
module.exports = function (app) {
    app.controller('suiteCfgManage', function ($scope, NgTableParams, $uibModal,
                                               modalService, suiteService, utilService, CONSTANTS, productService,
                                               orderService) {

        $scope.ORDER_STATUS = CONSTANTS.ORDER_STATUS; //订单状态
        $scope.SUITE_TYPE = CONSTANTS.SUITE_TYPE; // 套餐类型
        $scope.ISSUE_STATUS = CONSTANTS.ISSUE_STATUS; //期号状态
        $scope.SUITE_STATUS = CONSTANTS.SUITE_STATUS; //套餐状态
        $scope.imgPrefix = window.cfg.picUrl;
        $scope.picUrl = window.cfg.picUrl;
        $scope.utilService = utilService;
        $scope.imgSizeLimit = {
            // size: 500 * 1024,
            width: 750,
            // height: 420
        };
        $scope.iss = {};
        $scope._suite = {};
        $scope.cSuite = {};

        //清空时间
        $scope.clearData = function () {
            $scope.queryIssueParams = {
                from: '',
                to: ''
            };
        };

        // 定义期号对象，组合创建期号数据
        $scope.q = {
            suites: [],
            reset: function () {
                this.suites = [];
                this.from = undefined;
                this.to = undefined;
            }
        };
        $scope.t = {};
        $scope.queryIssueParams = {
            from: '',
            to: '',
            sortType: ''
        };
        //创建期号 -->存储套餐的table
        $scope.issueTableData = [];
        $scope.suiteOfIssueTable = new NgTableParams({
            count: 10000
        }, {
            counts: [],
            dataset: $scope.issueTableData
        });
        //创建套餐 -->存储商品的table
        $scope.productTableData = [];
        $scope.productTable = new NgTableParams({
            count: 10000
        }, {
            counts: [],
            dataset: $scope.productTableData
        });

        $scope._suiteType = {};
        $scope._suiteStatus = {};

        //导出excel选择的数据
        $scope.suiteSelectedArray = [];
        $scope.suiteCheckAllCfg = {
            flag: false
        };
        $scope.suiteExportTableParams = new NgTableParams({
            count: 25
        }, {
            counts: [],
            dataset: $scope.suiteSelectedArray
        });


        // 获取期号列表: [GET] backend/issue?offset=0&limit=20&status=0&from=1480521600000&to=1481328000000
        $scope.issueCfgManageList = function (queryParams) {
            queryParams = queryParams || $scope.queryIssueParams;
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.issueTableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit
                    };
                    p = angular.extend(p, queryParams || {});
                    if (!p.from) {
                        p = _.omit(p, 'from');
                    }
                    if (!p.to) {
                        p = _.omit(p, 'to');
                    }
                    return suiteService.getAllIssueList(angular.copy(p)).then(function (res) {
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.limit *
                            (params.page() - 1) + 1));
                    });
                }
            });
        };


        // 期号订单状态
        $scope.issueStatusList = CONSTANTS.getList({
            clsOrName: 'ISSUE_STATUS',
            defaultObj: {
                '': '全部'
            }
        });
        $scope.exportExcel = function (containerId, title, arrayStr) {
            if ($scope[arrayStr].length) {
                orderService.formExcel(containerId, title);
            } else {
                window.alert('请选择导出项');
            }

        };
        $scope.createIssueModal;
        $scope.resetIssueForm = function () {
            $scope.iss = {};
            $scope.suiteOfIssueTable.settings().dataset = [];
        };
        // 创建期号
        $scope.createIssue = function (iss) {
            $scope.resetIssueForm();
            $scope.createIssueModal = modalService.initModal({
                appendTo: angular.element(document.getElementById('suiteCfgManage')),
                scope: $scope,
                templateUrl: 'suite/createIssueTemplate.html'
            });

        };
        // 打印单据列表
        $scope.issueSelectedArray = [];
        $scope.issueExportTableParams = new NgTableParams({
            count: 25
        }, {
            counts: [],
            dataset: $scope.issueSelectedArray
        });

        //创建期号 --> 添加套餐
        $scope.addSuiteOfIssue = function (addIssue) {
            if (addIssue != null && addIssue != undefined &&
                addIssue != '') {

                var params = {id: addIssue.suiteId};
                suiteService.getSuite(params).then(function (res) {
                    // 802007417859604480
                    if (res == "" || res == undefined || res == null) {
                        alert('套餐不存在或者套餐ID有误，请更换套餐ID。');
                        return
                    }
                    res.active = true;
                    res.suite.active = true;
                    res.suite.suiteId = res.suite.id;
                    //数据源 $data  dataset
                    $scope.suiteOfIssueTable.settings().dataset.splice(0, 0, res);
                    // $scope.suiteOfIssueTable.settings().dataset.push(res);
                    $scope.suiteOfIssueTable.reload();
                    addIssue.suiteId = '';
                    // 数据源 q.suites
                    /*suiteId
                     *active: boolean
                     */
                });
            } else {
                alert('请输入套餐ID!');
            }
        };

        // 创建期号 --> 变更已添加的套餐状态

        $scope.changeSuiteOfIssueStatus = function (iss) {
            iss.active = !iss.active;
            if ($scope.iss.issue) {
                suiteService.updateIssue($scope.iss.issue).then(function () {
                });
            }
        };

        // 创建期号 --> 删除已添加的套餐 iss
        $scope.deleteSuiteOfIssue = function (index) {
            this.suiteOfIssueTable.settings().dataset.splice(index, 1);
            this.suiteOfIssueTable.reload();
        };

        // 期号配置--> 编辑 --> 删除已添加的套餐 iss
        $scope.deleteEditorSuiteOfIssue = function (iss, index) {
            var delSuiteId = iss.suiteId;
            $scope.iss.issue.suites = _.reject($scope.iss.issue.suites, function (item) {
                return item.suiteId == delSuiteId;
            });
            suiteService.updateIssue($scope.iss.issue).then(function () {
                $scope.issueCfgManageList();
                $scope.suiteOfIssueTable.settings().dataset = $scope.iss.suite.suites;
            });
            this.suiteOfIssueTable.settings().dataset.splice(index, 1);
            this.suiteOfIssueTable.reload();
        };
        $scope.issueStatus = function (item) {
            $scope.issueCfgManageList({
                status: item.code
            });
        };
        var checkInfo = function (data) {
            angular.forEach(data, function (item) {
                var t = _.findWhere($scope.issueSelectedArray, {
                    id: item.issue.id
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.issueCheckAllCfg = {
            flag: false
        };

        $scope.updateIssueExportTable = function () {
            $scope.issueExportTableParams.settings().dataset = $scope.issueSelectedArray;
            $scope.issueExportTableParams.reload();
        };
        // 勾选
        $scope.updateSelection = function (e, item, selectedArrayStr, checkAllCfg,
                                           callback) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            item.checked = isChecked;
            if (isChecked) {
                $scope[selectedArrayStr].push(item);
            } else {
                checkAllCfg.flag = false;
                $scope[selectedArrayStr] = _.without($scope[selectedArrayStr], item);
            }
            callback && callback.call();
        };
        $scope.selectAllOrder = function (e, data, selectedArrayStr, flag, callback) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item,
                        selectedArrayStr,
                        flag, callback);
                }
            });
        };
        //编辑期号
        $scope.editIssue = function (iss) {
            $scope.resetIssueForm();
            $scope.iss = iss;
            suiteService.getIssue({
                id: iss.issue.id
            }).then(function (res) {
                $scope.iss.issue = res;
                $scope.modal = modalService.initModal({
                    appendTo: angular.element(document.getElementById('suiteCfgManage')),
                    scope: $scope,
                    templateUrl: 'suite/createIssueTemplate.html'
                });

            });
        };
        // 创建期号 --> 保存
        $scope.saveIssue = function (iss, active) {
            var suites = [];
            angular.forEach($scope.suiteOfIssueTable.settings().dataset, function (suite) {
                suites.push({
                    suiteId: suite.suite.id,
                    active: suite.suite.active
                });
            });
            suiteService.createIssue({
                startTime: $scope.q.startTime,
                endTime: $scope.q.endTime + 86399000,
                suites: suites,
                publishImmediately: active
            }).then(function (res) {
                if (res.suites.length < 1) {
                    alert('不可以创建空的期号，请添加套餐。');
                    return
                }
                $scope.createIssueModal.close();
                $scope.issueCfgManageList();
                $scope.q.reset();
            });
        };

        $scope.issueCfgManageList();

        //期号配置 --> 排序
        $scope.sortByIssue = function (item) {
            $scope.queryIssueParams.sortType = item.sortCode;
            $scope.issueCfgManageList();
        };

        /*************************************套餐*****************************************/

        $scope.suiteQueryParams = {
            sortType: '',
            type: '',
            status: '',
            // id: ''
        };
        $scope.disableEdit = false; //默认不允许操作
        /**
         * 获取套餐列表(SuiteWithStatistics[]): [GET] /backend/suite?offset=0&limit=20&type=0&status=0&id={id}
         * [Filter Params: type(NONE,0,1), status(NONE,0,1), id(NONE,{id})]
         */
        $scope.suiteCfgManageList = function (suiteQueryParams) {
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.suiteOfIssueTableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                getData: function (params) {
                    var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        sortType: $scope.suiteQueryParams.sortType,
                        type: $scope._suiteType.code,
                        status: $scope._suiteStatus.code,
                        id: $scope.suiteQueryParams.suiteId
                    };
                    return suiteService.getAllSuiteList(angular.copy(p)).then(function (res) {
                        params.total(res.totalElements);
                        return checkSuiteInfo(utilService.indexArray(res.content, $scope
                                .limit *
                            (params.page() - 1) + 1));
                    });
                }
            })
        };
        $scope.suiteCfgManageList();

        $scope.updateSuiteExportTable = function () {
            $scope.suiteExportTableParams.settings().dataset = $scope.suiteSelectedArray;
            $scope.suiteExportTableParams.reload();
        };
        var checkSuiteInfo = function (data) {
            angular.forEach(data, function (item) {
                var t = _.findWhere($scope.suiteSelectedArray, {
                    id: item.suiteId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        // 创建套餐
        $scope._createSuite = function (_suite) {
            $scope.images.imgDetails=[];
            $scope.disableEdit = false;
            $scope.productTable.settings().dataset = [];
            if (_suite) { //复制
                //拿到转换后的 images.imgDetails
                $scope.images.imgDetails = suiteService._getImageDetails(_suite.suite.images);
                $scope.cSuite = {
                    banner: _suite.suite.banner,
                    type: _suite.suite.type,
                    title: _suite.suite.title,
                    des: _suite.suite.des,
                    showProducts: !_suite.suite.showProducts
                };
                if (_suite.suite.type == "0") {
                    $scope.cSuite.features = true;
                }
                if (_suite.suite.type == "1") {
                    $scope.cSuite.standard = true;
                }
                angular.forEach(_suite.suite.productIds, function (id) {
                    $scope.addByProductId({
                        productId: id
                    });
                });
            } else { //新增
                $scope.cSuite = {};
            }
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementById('suiteCfgManage')),
                scope: $scope,
                templateUrl: 'suite/createSuiteTemplate.html'
            });
        };
        //添加图片
        $scope.images = {
            imgDetails: [],
            desImgDetails: []
        };
        var getImgs = function (type) {
            var imgs = type == 1 ? $scope.images.imgDetails : $scope.images
                .desImgDetails;
            return imgs;
        };
        //上传完图片
        $scope.didUploadImg = function (file, type) {
            var imgs = getImgs(type);
            file.index = imgs.length ? _.max(imgs, function (img) {
                return img.index;
            }).index + 1 : 1;
            imgs.push(file);
        };
        //轮播图排序
        $scope.sortImgs = function (type) {
            var imgs = getImgs(type);
            imgs = _.sortBy(imgs, function (img) {
                return img.index;
            });
            if (type == 1) {
                $scope.images.imgDetails = imgs;
            } else {
                $scope.images.desImgDetails = imgs;
            }
        };
        //预览图片
        $scope.imgPreview = function(img) {
            $scope.previewImg = img;
            modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName(
                    'suiteCfgManage')),
                templateUrl: 'imgPreviewer',
                scope: $scope,
                size: 'lg'
            });
        };
        //删除图片
        $scope.deleteImg = function(i, type) {
            var imgs = getImgs(type);
            imgs.splice(i, 1);
        };
        //验证保存商品有效性
        var checkSaveProductImg = function (images) {
            var errorMsg = '';
            if (images.length == 0) { //未上传商品轮播图
                // errorMsg = '请上传商品轮播图';
                alert('请添加图片');
                return
            }
            if (errorMsg.length) {
                utilService.alertError(errorMsg);
                return false;
            }
            return true;
        };
        //创建套餐 --> 添加 SkuCode
        $scope.addBySkuCode = function (addProduct) {
            if ($scope.productTable.settings().dataset.length >= 15) {
                alert('商品数量过多,请酌情添加。(可添加商品数量最多不能大于15个)');
                return;
            }
            //查找数组下面某个属性的值
            // var t = _.find(productData, function (item) {
            //     return item.header.id == addProduct.productId;
            // });
            /*if (t) {
             alert('该SKU ID已存在!');
             return;
             }*/
            if (addProduct == null || addProduct == undefined && addProduct == '') {
                alert('商品编码 不能为空！！！');
                return;
            }
            var params = {skuCode: addProduct.skuCode};
            productService.queryProductByKey(params).then(function (res) {
                // 数据源 $data  dataset
                if (res.totalElements != 1) {
                    alert('请输入正确的商品编码');
                    return;
                }
                $scope.productTable.settings().dataset.splice(0, 0, res.content[0]);
                // $scope.productTable.settings().dataset.push(res.content[0]);
                $scope.productTable.reload();
            });
            //添加成功后清空input
            addProduct.skuCode = "";
        };
        $scope.addByProductId = function (id) {
            var params = {id: id.productId};
            productService.getProductById(params).then(function (res) {
                // 数据源 $data  dataset
                $scope.productTable.settings().dataset.push(res);
                $scope.productTable.reload();
            });
        };
        //创建套餐 --> 删除商品
        $scope._deleteProduct = function (index) {
            //根据元素位置 删除当前行
            this.productTable.settings().dataset.splice(index, 1);
            //根据ID 删除商品
            /*this.productTable.settings().dataset = _.reject(productData, function (item) {
             return item.header.id == id;
             });*/
            this.productTable.reload();
        };
        //发布套餐
        $scope._publishSuite = function (_suite) {
            var params = {id: _suite.suite.id};
            suiteService.publishSuite(params).then(function (res) {
                $scope.suiteCfgManageList();
            })
        };
        // 套餐类型
        $scope.suiteTypeList = CONSTANTS.getList({
            clsOrName: 'SUITE_TYPE',
            defaultObj: {
                '': '全部类型'
            }
        });
        $scope.suiteType = function (item) {
            $scope._suiteType = item;
            $scope.suiteCfgManageList();
        };
        // 套餐状态
        $scope.suiteStatusList = CONSTANTS.getList({
            clsOrName: 'SUITE_STATUS',
            defaultObj: {
                '': '全部状态'
            }
        });
        $scope.suiteStatus = function (item) {
            $scope._suiteStatus = item;
            $scope.suiteCfgManageList();
        };
        //创建套餐 --> 保存
        $scope.saveSuite = function (cSuite) {
            /*if (!checkSaveProductImg($scope.images.imgDetails)) {
                return;
            }*/
            var images =  _.pluck($scope.images.imgDetails, 'path');
            console.log(images);
            var me = this;
            var productIds = [];
            var productData = $scope.productTable.settings().dataset;
            angular.forEach(productData, function (item) {
                productIds.push(item.header.id);
            });
            var params = {
                banner: cSuite.banner,
                // type:cSuite.type,
                title: cSuite.title,
                des: cSuite.des,
                productIds: productIds,
                images:images,
            };
            if (cSuite.showProducts == undefined || cSuite.showProducts == null || cSuite.showProducts == '') {
                params.showProducts = true
            } else {
                params.showProducts = !cSuite.showProducts
            }
            if (cSuite.features) {
                params.type = '0';
            }
            if (cSuite.standard) {
                params.type = '1';
            }
            if (cSuite.features && cSuite.standard) {
                alert('套餐类型选择有误(单选)。');
            }
            if (cSuite.title.length > 10) {
                alert('主标题字符数不能大于10个字符。');
                return;
            }
            if ($scope.productTable.settings().dataset.length < 1) {
                alert('请添加商品！！！');
            } else {
                suiteService.createSuite(params).then(function (res) {
                    $scope.suiteCfgManageList();
                    alert('添加成功！！！');
                    me.$close();
                });
            }
        };
        //删除套餐
        $scope._deleteSuite = function (id) {
            $scope.id = id;
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName(
                    'suiteCfgManage')),
                scope: $scope,
                templateUrl: 'deleteSuiteModel'
            });
        };
        $scope._deleteSuiteOk = function () {
            var me = this;
            suiteService.deleteSuite({id: $scope.id}).then(function (res) {
                $scope.suiteCfgManageList();
                me.$close();
            });
        };
        //查看详情
        $scope.suiteDetails = function (_suite) {
            // $scope.images.imgDetails=[];
            //拿到转换后的 images.imgDetails
            $scope.images.imgDetails = suiteService._getImageDetails(_suite.suite.images);

            $scope.productTable.settings().dataset = [];
            $scope.disableEdit = true;
            $scope.cSuite = {
                banner: _suite.suite.banner,
                type: _suite.suite.type,
                title: _suite.suite.title,
                des: _suite.suite.des,
                // images: _suite.suite.images,
                showProducts: !_suite.suite.showProducts,
            };
            if (_suite.suite.type == "0") {
                $scope.cSuite.features = true;
            }
            if (_suite.suite.type == "1") {
                $scope.cSuite.standard = true;
            }
            angular.forEach(_suite.suite.productIds, function (id) {
                $scope.addByProductId({
                    productId: id
                });
            });
            $scope.modal = modalService.initModal({
                appendTo: angular.element(document.getElementById('suiteCfgManage')),
                scope: $scope,
                templateUrl: 'suite/createSuiteTemplate.html'
            });

        };
        //排序
        $scope._sortSuite = function (item) {
            $scope.suiteQueryParams.sortType = item.sortCode;
            $scope.suiteCfgManageList();
            /*$scope.suiteCfgManageList(
             $scope.sortType = item.sortCode //通过参数传给服务端
             );*/
        };
    })
};

},{}],32:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/11/24.
 */
module.exports = function (app) {
    app.controller('suiteDistributionDynamic', function ($scope, NgTableParams, $uibModal, modalService, utilService, printService, CONSTANTS, $mdDialog, suiteService, orderService) {

        $scope.ORDER_STATUS = CONSTANTS.ORDER_STATUS;//订单状态
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE; //订单类型
        $scope.DELIVERY_STATE = CONSTANTS.DELIVERY_STATE; //送货单状态

        $scope.queryParams = {
            suiteName: '',//套餐名称
            startTime: '',//开始时间
            endTime: '',//结束时间
            companyId: '', //公司ID
        };
        //根据企业搜索
        $scope.searchByCompany = function (company) {
            $scope.queryParams.companyId = company.companyId;
            $scope.suiteDistributionDynamicList();
        };
        //清空企业搜索
        $scope.emptyCompanySearch = function () {
            delete $scope.queryParams.companyId;
        };


        /**
         * 套餐配送动态列表
         * 获取配送单列表接口：
         * logistics/order/delivery/findList
         */
        $scope.suiteDistributionDynamicList = function (queryParams) {
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.isSuiteOrderList = '1';//标记
            $scope.tableParams = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 20,
                paginationMinBlocks: 2,
                getData: function (params) {
                    var p = {
                        offset: $scope.limit * (params.page() - 1),
                        limit: $scope.limit,
                        typeSort: $scope.typeSort,  // $scope.typeSort  取 赋值
                        isSuiteOrderList: $scope.isSuiteOrderList,
                        orderStates: $scope.orderStates
                    };
                    if ($scope.queryParams.companyId !== '') {
                        p.companyId = $scope.queryParams.companyId;
                    }
                    if ($scope.queryParams.suiteName !== '') {
                        p.suiteName = $scope.queryParams.suiteName;
                    }
                    if (!isNaN($scope.queryParams.startTime)) {
                        p.startTime = $scope.queryParams.startTime;
                    }
                    if (!isNaN($scope.queryParams.endTime)) {
                        p.endTime = $scope.queryParams.endTime + 86399000;
                    }
                    return suiteService.getSuiteDistributionDynamicList(angular.copy(p)).then(function (res) {
                        params.total(res.totalElements);
                        return checkInfo(utilService.indexArray(res.content, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            })
        };
        $scope.suiteDistributionDynamicList();

        /**
         * 获取期号列表

         $scope.getSuiteList = function () {
                suiteService.getAllIssueList({}).then(function (res) {
                    $scope.issue.issueChoices = res;
                });
            };
         $scope.getSuiteList();

         /!**
         * 期号筛选
         *!/
         $scope.issue = {
                issue: [],
                getDefaultItem: function (value) {
                    // debugger
                    var options = $scope.issueList.list;
                    return _.findWhere(options, {
                            id: value
                        }) || {
                            issueName: '全部'
                        };
                },
                selectItem: function (record) {
                    // debugger
                    if (record.id) {
                        $scope.issue.issueId = record.issueId;
                    }
                }
            };*/
        /*打印*/
        //打印单据列表
        var printOrderArray = [];
        var checkInfo = function (data) {
            angular.forEach(data, function (item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        /**
         * 勾选
         */
        $scope.updateSelection = function (e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function (e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function (item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };

        /***
         * 批量打印
         */

        //打印
        $scope.printOrder = function (orders) {
            var temps = [];
            var aTemps = [];
            if (Object.prototype.toString.call(orders) == '[object Array]') {
                aTemps = orders;
            } else {
                aTemps = [orders];
            }
            angular.forEach(aTemps, function (item) {
                temps.push(item.orderId);
            });
            var deliveryOrderIds = {
                deliveryOrderIds:temps
            };
            orderService.queryOrderDetails(
                // ids:_.pluck(orders,'id')
                // deliveryOrderIds: temps
                angular.copy(deliveryOrderIds)
            ).then(function (res) {
                var orderDetails = res.deliveryOrderDetails || [];
                $scope.isPrint = true;
                temps = orderService.printOrderDoms(orderDetails, $scope.ORDER_TYPE.SUITEDYNAMIC, $scope);
                console.log(temps);
                $scope.$applyAsync(function () {
                    var htmls = [];
                    console.log(temps);
                    angular.forEach(temps, function (item) {
                        console.log(item[0].innerHTML);
                        htmls.push(item[0].innerHTML);
                    });
                    printService.printByDefaultPrinter(htmls);
                    console.log(htmls);
                });
            });
        };
        $scope.bathMultiPrint = function () {
            if (printOrderArray.length) {
                $scope.printOrder(printOrderArray);
            } else {
                $mdDialog.show($mdDialog.alert({
                    title: '提示',
                    textContent: '请选择需要打印的票据',
                    ok: '确认'
                }));
            }
        };

        /**
         * 订单明细打印
         */
        $scope.orderDetailPrint = function (orderType) {
            var html = orderService.getPrintHtmlInOrderModule(orderType);
            $scope.$applyAsync(function () {
                console.log(html);
                printService.printByDefaultPrinter(html);
            });
        };
        /**
         *本期配送次数
         */
        $scope.sortByCurrentDistributionNumber = function (item) {
            $scope.typeSort = item.sortCode;    // 赋值 传给服务端
        };
        /**
         *订单参与人数
         */
        $scope.sortByOrderParticipation = function (item) {
            $scope.typeSort = item.sortCode;    // 赋值 传给服务端
        };
        /**
         * 期号订单明细
         * 获取配送单详情接口：
         * logistics/order/delivery/{orderId}
         */
        $scope.suiteOrderDetail = function (sOrder) {
            $scope.modal = modalService.initModal({
                //appendTo:将modal 加载到指定id的DOM页面
                appendTo: angular.element(document.getElementById('suiteDistributionDynamic')),
                scope: $scope,
                //templateUrl属性值是一个url路径,路径指向一个html模板
                templateUrl: 'suite/suiteDistributionDynamicTemplate.html'
            });
            var params = {orderId: sOrder.orderId};
            orderService.queryDeliveryDetail(params).then(function (res) {
                suiteService.parseSuiteData(res);
                $scope.sOrder = res;
            });
        };
        /**
         * 修改订单状态接口：
         * logistics/order/delivery/{orderId}/state
         */
        $scope.orderFinished = function (sOrder) {
            var me = this;
            var params = {orderId: sOrder.orderId, orderState: sOrder.orderState};
            orderService.modifyDeliveryState(params).then(function (res) {
                me.$close();
            })
        };

        // 套餐状态
        $scope.shipmentStatusList = CONSTANTS.getList({
            clsOrName: 'DELIVERY_STATE',
            defaultObj: {
                '': '全部状态'
            }
        });
        $scope.shipmentStatus = function (item) {
            $scope.orderStates = item.code;
            $scope.suiteDistributionDynamicList();
        };

        /**
         * 套餐实时动态-->明细
         * 配货单商品名称过滤掉建议下架的
         */
        $scope.filterType = function (item) {
            return item.itemType != 3
        };
    })
};



},{}],33:[function(require,module,exports){
module.exports = function(app) {
    app.controller('teaCtrl', function($scope, $compile,orderService, $templateCache, $mdDialog, modalService, printService, orderService, NgTableParams, utilService, CONSTANTS,companyService) {
        $scope.utilService = utilService;
        $scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        $scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        $scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        $scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
         $scope.Tea_Period_Type=CONSTANTS.Tea_Period_Type;


        var DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        var COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        var ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        var DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;
        var REFUND_STATE = CONSTANTS.REFUND_STATE;
        var INVENTORY_STATE = CONSTANTS.INVENTORY_STATE;
        var SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        var Tea_Period_Type=CONSTANTS.Tea_Period_Type;
        $scope.offset;
        $scope.limit;
        $scope.curOrderType = { desc: '全部单据类型' };
        $scope.isUpdateTimeChoices=[{ desc: '下单时间', code: '0' }, { desc: '预约送货时间', code: '1' }];
        $scope.orderTypeList = [{ desc: '全部订单', code: '0' }, { desc: '已接单', code: '1' }, { desc: '待接单', code: '2' }, { desc: '已取消', code: '3' }];
        $scope.isPaidList = [{ desc: '全部付款状态', code: '' }, { desc: '未付款', code: '0' }, { desc: '已付款', code: '1' }];
        $scope.invoiceNeedStateList = CONSTANTS.getList('INVOICE_NEED_STATE', true, undefined, undefined, { '': '全部开票需求' });
        $scope.deliveryOrder = {};
        $scope.refundOrder = {};
        $scope.inventoryOrder = {};
        $scope.settlementOrder = {};

        $scope.queryParams = {
            createStartDay: '',
            createEndDay: '',
            updateStartDay: '',
            updateEndDay: '',
            isInvoice: '', //0 不需要开票  1需要开票
            isPaid: '', // 0 没有  1 已支付
            isUpateTime: 0,
        };
        $scope.selectIsUpadate = function(choice) {
            $scope.queryParams.isUpateTime = parseInt(choice.code);
        };
        $scope.selectIsPaid = function(choice) {
            $scope.queryParams.isPaid = choice.code;
            $scope.orderTable.reload();
            $scope.orderTable.page(1);
        };
        $scope.selectInvoicenNeedState = function(choice) {
            $scope.queryParams.isInvoice = choice.code;
            $scope.orderTable.reload();
            $scope.orderTable.page(1);
        };
        var setOrderTable = function(queryParams) {
            $scope.queryParams.startDay = $scope.queryParams.startDay || utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
            $scope.queryParams.endDay = $scope.queryParams.endDay || utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd');
            $scope.offset = 0;
            $scope.limit = 20;
            $scope.orderTable = new NgTableParams({
                count: $scope.limit
            }, {
                counts: [],
                paginationMaxBlocks: 13,
                paginationMinBlocks: 2,
                getData: function(params) {
                    var p = {
                        offset: (params.page() - 1) * $scope.limit,
                        limit: $scope.limit,
                        companyId: $scope.queryParams.companyName?$scope.queryParams.companyName:''
                    };
             switch (parseInt($scope.curOrderType.code)) {
                        case 0:
                            break;
                        case 1:
                            p.expressStatus=2;
                            break;
                        case 2:
                            p.expressStatus=1;
                            p.status=2;
                            break;
                        case 3:
                            p.status=4;
                          break;
                      }
                    if ($scope.queryParams.isInvoice !== '') {
                        p.isInvoice = $scope.queryParams.isInvoice;
                    }
                    if ($scope.queryParams.isPaid !== '') {
                        p.isPaid = $scope.queryParams.isPaid;
                    }
                    if ($scope.queryParams.isUpateTime) {

                        p.startTime = Date.parse($scope.queryParams.startDay.replace(/-/g,'/'));
                        p.endTime = Date.parse($scope.queryParams.endDay.replace(/-/g,'/')+' 23:59:59');
                        p.timeType=2;
                    } else {
                        p.startTime = Date.parse($scope.queryParams.startDay.replace(/-/g,'/'));
                        p.endTime = Date.parse($scope.queryParams.endDay.replace(/-/g,'/')+' 23:59:59');
                        p.timeType=1;
                    }

                    return orderService.queryTeaList(p).then(function(res) {
                        params.total(res.totalElements);
                        var data= $scope.addTeaType(res.content);
                        return checkInfo(utilService.indexArray(data, $scope.limit * (params.page() - 1) + 1));
                    });
                }
            });
        };
        //setOrderTable();
        // 下午茶类型转换
          $scope.addTeaType=function(data){
            if (Object.prototype.toString.call(data) == '[object Array]') {
                teaArray = data;
            } else {
                teaArray = [data];
            }
             angular.forEach(teaArray, function(item, i) {
              if(item.expressStatus==2){
                item.type=1
              }else if(item.expressStatus==1&&item.status==2){
               item.type=2
              }else if(item.status==4){
               item.type=3

              }else{}

             })
             return teaArray;
          }
        //搜索单据
        $scope.searchTea = function(queryParams) {
            queryParams = queryParams || {};
            $scope.queryParams.companyName = queryParams.companyName;
            $scope.queryParams.startDay = queryParams.startTime ? utilService.parseTimeByDate(queryParams.startTime, 'yyyy-MM-dd') :
                utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd');
            $scope.queryParams.endDay = queryParams.endTime ? utilService.parseTimeByDate(queryParams.endTime, 'yyyy-MM-dd') :
                utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd');
            $scope.queryParams.isUpateTime = queryParams.isUpateTime;
            setOrderTable();
        };
        //获取单据状态描述
        $scope.getOrderStateDesc = function(orderType, orderState) {
            var orderStateDesc = '';
            switch (orderType) {
                case ORDER_TYPE.DELIVERY:
                    orderStateDesc = DELIVERY_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.REFUND:
                    orderStateDesc = REFUND_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.INVENTORY:
                    orderStateDesc = INVENTORY_STATE.DESC[orderState];
                    break;
                case ORDER_TYPE.SETTLEMENT:
                    orderStateDesc = SETTLEMENT_STATE.DESC[orderState];
                    break;
            }
            return orderStateDesc;
        };
        //选择单据类型
        $scope.selectOrderType = function(item) {

            $scope.curOrderType = item;
            setOrderTable();
        };
        //明细
        $scope.checkOrderDetail = function(orderType, orderId,companyName) {
            //$scope.companyName=companyName;
            orderService.checkOrderDetail(orderType, orderId, $scope,false,companyName);
        };
        //获取送货单详情
        var getDeliveryDetail = function(opts) {
            orderService.queryDeliveryDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.deliveryOrder = res;
                $scope.deliveryOrder.name = '送货单' + '-' + $scope.deliveryOrder.companyName + '-' + $scope.deliveryOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.deliveryOrder.createTime, 'yyyyMMddhhmmss') + ')';
                $scope.deliveryOrder.putSaleProductList = [];
                $scope.deliveryOrder.supplementProductList = [];
                $scope.deliveryOrder.pullSaleProductList = [];

                angular.forEach($scope.deliveryOrder.items, function(item, i) {
                    switch (parseInt(item.itemType)) {
                        case 1:
                            $scope.deliveryOrder.putSaleProductList.push(item);
                            break;
                        case 2:
                            $scope.deliveryOrder.supplementProductList.push(item);
                            break;
                        case 3:
                            $scope.deliveryOrder.pullSaleProductList.push(item);
                            break;
                    }
                });
                opts.didLoadData();
            });
        };

        //获取退货单详情
        var getRefundDetail = function(opts) {
            orderService.queryRefundDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.refundOrder = res;
                $scope.refundOrder.name = '退货单' + '-' + $scope.refundOrder.companyName + '-' + $scope.refundOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.refundOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();

            });

        };
        //获取盘点单详情
        var getInventoryDetail = function(opts) {
            orderService.queryInventoryDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.inventoryOrder = res;
                $scope.inventoryOrder.name = '盘点单' + '-' + $scope.inventoryOrder.companyName + '-' + $scope.inventoryOrder.shelfName +
                    '(' + utilService.parseTimeByLong($scope.inventoryOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();
            });
        };
        //获取结算单详情
        var getSettlementDetail = function(opts) {
            orderService.querySettlementDetail({ 'orderId': opts.orderId }).then(function(res) {
                $scope.settlementOrder = orderService._parseSettlementDetailData(res);
                $scope.settlementOrder.name = '结算单' + '-' + $scope.settlementOrder.companyName +
                    '(' + utilService.parseTimeByLong($scope.settlementOrder.createTime, 'yyyyMMddhhmmss') + ')';
                opts.didLoadData();
            });
        };
        //详细Modal中导出Excel（移至service）
        //列表中导出Excel
        $scope.exportExcelOnList = function(orderType, orderId) {
            orderService.exportExcel(orderType, orderId, $scope);
        };
        /*打印*/
        //打印单据列表
        var printOrderArray = [];
        var checkInfo = function(data) {
            angular.forEach(data, function(item) {
                var t = _.findWhere(printOrderArray, {
                    orderId: item.orderId
                });
                if (t) {
                    item.checked = true;
                } else {
                    item.checked = false;
                }
            });
            return data;
        };
        $scope.checkAllCfg = {
            flag: false
        };
        //勾选
        $scope.updateSelection = function(e, order) {
            var isChecked;
            if (_.isObject(e)) {
                isChecked = e.currentTarget.checked;
            } else {
                isChecked = e;
            }
            order.checked = isChecked;
            if (isChecked) {
                printOrderArray.push(order);
            } else {
                $scope.checkAllCfg.flag = false;
                printOrderArray = _.without(printOrderArray, order);
            }
        };
        $scope.selectAllOrder = function(e, data, checkall) {
            var st = e.currentTarget.checked;
            angular.forEach(data, function(item) {
                if (item.checked !== st) {
                    $scope.updateSelection(e.currentTarget.checked, item);
                }
            });
        };
        //批量打印
        $scope.printOrder = function(orders) {
            // debugger
            var teaOrderIds = [];
            var orderArray = [];
            if (Object.prototype.toString.call(orders) == '[object Array]') {
                orderArray = orders;
            } else {
                orderArray = [orders];
            }
            angular.forEach(orderArray, function(item) {
                teaOrderIds.push(item.id);
            });
            orderService.teaOrderDetails({
                orderIds: teaOrderIds
            }).then(function(res) {
                var teaOrderDetails = res|| [];
                var temps = [];
                angular.forEach(teaOrderDetails, function(detail) {
                    var orderType=ORDER_TYPE.SETTLEMENT;
                    var scope = orderService.teaOrderScope(ORDER_TYPE.TEAORDER, detail, $scope.$new(true));
                    scope.isPrint = true;
                    temps.push(angular.element('<div></div>').append(orderService.getTemplateDomByType(ORDER_TYPE.TEAORDER, scope)));
                });
                $scope.$applyAsync(function() {
                    var htmls = [];
                    angular.forEach(temps, function(item) {
                        console.log(item[0].innerHTML);
                        htmls.push(item[0].innerHTML);
                    });
                    printService.printByDefaultPrinter(htmls);
                });
            });
        };
        // 详情页打印
        $scope.printTeaHtml= function(orderType) {
            var html = orderService.getPrintHtmlInOrderModule(orderType);
            $scope.$applyAsync(function() {
                console.log(html);
                printService.printByDefaultPrinter(html);
            });
        };
        $scope.bathMultiPrint = function() {
            if (printOrderArray.length) {
                $scope.printOrder(printOrderArray);
            } else {
                $mdDialog.show($mdDialog.alert({
                    title: '提示',
                    textContent: '请选择需要打印的票据',
                    ok: '确认'
                }));
            }
        };
       $scope.keyremark=function(e,remark,id){
             if (e.keyCode == 13) { //回车键
                  orderService.modifyRemark({
                        orderId: id,
                        remark:remark
                    }).then(function(res) {
                        
                    });    
                    }
            
               
      
         };
         $scope.cancelOrder=function(id){
            orderService.cancelTea({
                orderId:id

            }).then(function(res) {
                $scope.teaDetail.order.type=100
                    });    
         } ;
         $scope.acceptOrder=function(id){
            orderService.acceptTea({
                orderId:id

            }).then(function(res) {
                   $scope.teaDetail.order.type=100     
                    });    
         } ;

    });
};

},{}],34:[function(require,module,exports){
module.exports = function(app) {
  app.controller('template', function($scope, $mdDialog, $filter,
    NgTableParams, templateService, CONSTANTS, cacheService, utilService) {
    $scope.template = {
      name: ''
    };
    $scope.queryTemplateParams = {
      type: '',
      name: '',
      status: ''
    };
    $scope.queryTemplateConfig = {
      selectCompanyType: function(item) {
        $scope.queryTemplateParams.type = item.code;
        $scope.queryTemplateList();
      },
      selectTemplateStatus: function(item) {
        $scope.queryTemplateParams.status = item.code;
        $scope.queryTemplateList();
      },
      companyTypes: CONSTANTS.getList({
        clsOrName: 'TEMPLATE_TYPE',
        defaultObj: {
          '': '全部类型'
        }
      }),
      templateStatuses: CONSTANTS.getList({
        clsOrName: 'TEMPLATE_STATUS',
        defaultObj: {
          '': '全部状态'
        }
      })
    };

    $scope.limit = 25;
    $scope.templateList = [];
    $scope.templateTableHead = [];
    $scope.templateTable = new NgTableParams({
      count: $scope.limit
    }, {
      counts: [],
      getData: function(params) {
        var p = {};
        $scope.offset = $scope.limit * (params.page() - 1);
        p = {
          offset: $scope.offset,
          limit: $scope.limit
        };
        return templateService.queryTemplateList(angular.extend(p, $scope.queryTemplateParams))
          .then(function(res) {
            $scope.templateList = res.content;
            params.total(res.totalElements);
            return utilService.indexArray(res.content, $scope.offset +
              1);
          });
      }
    });
    $scope.queryTemplateList = function() {
      $scope.templateTable.reload();
      $scope.templateTable.page(1);
    };
    $scope.createTemplate = function() {
      window.location.hash = '#/templateEdit';
    };
    $scope.editTemplate = function(t) {
      window.location.hash = '#/templateEdit/' + t.id;
    };
    $scope.publishTemplate = function(t) {
      templateService.publishTemplate({
        id: t.id,
        type: t.type,
        status: CONSTANTS.TEMPLATE_STATUS.PUBLIC,
      }).then(function(res) {
        $scope.queryTemplateList();
      });
    };
    $scope.deleteTemplate = function(t) {
      templateService.deleteTemplate({
        id: t.id
      }).then(function() {
        $scope.templateTable.reload();
        $scope.templateTable.page(1);
      });
    };
  });
};

},{}],35:[function(require,module,exports){
module.exports = function(app) {
  app.controller('templateEdit', function($scope, $routeParams,
    $mdSidenav, uploadService, utilService, CONSTANTS,
    NgTableParams, templateService, $filter, $mdDialog) {
    var templateId = $routeParams.templateId || '';
    $scope.CONSTANTS = CONSTANTS;
    $scope.picUrl = window.cfg.picUrl;
    $scope.templateDefault = {
      name: '',
      creatTime: '',
      updateTime: '',
      type: '',
      status: '',
      module: []
    };
    $scope.template = {
      name: '',
      creatTime: '',
      updateTime: '',
      type: '',
      status: '',
      module: []
    };
    $scope.modules = $scope.template.module || [];
    $scope.fullWidth = 4;
    $scope.defaultModule = {
      width: '',
      height: '',
      mergeNext: false,
      isHide: false,
      contents: [{
        x: '',
        y: '',
        width: '',
        height: '',
        contentType: '',
        contentLink: [],
        contentImage: []
      }]
    };
    //侧边栏选中的内容元素
    $scope.newContent = {
      contentType: '',
      disableAlert: '',
      isDisable: false,
      isPop: false,
      noBorder: false,
      contentLink: [],
      contentImage: []
    };
    //所有模块类型及其布局
    $scope.allModules = [
      //1行
      {
        width: $scope.fullWidth,
        height: 1,
        contents: [{
          x: 0,
          y: 0,
          width: $scope.fullWidth,
          height: 1
        }]
      },
      //1行2列
      {
        width: $scope.fullWidth,
        height: 1,
        contents: [{
          x: 0,
          y: 0,
          width: 2,
          height: 1
        }, {
          x: 2,
          y: 0,
          width: 2,
          height: 1
        }]
      },
      //1行4列
      {
        width: $scope.fullWidth,
        height: 1,
        contents: [{
          x: 0,
          y: 0,
          width: 1,
          height: 1
        }, {
          x: 1,
          y: 0,
          width: 1,
          height: 1
        }, {
          x: 2,
          y: 0,
          width: 1,
          height: 1
        }, {
          x: 3,
          y: 0,
          width: 1,
          height: 1
        }]
      },
      //2行
      {
        width: $scope.fullWidth,
        height: 2,
        contents: [{
          x: 0,
          y: 0,
          width: $scope.fullWidth,
          height: 2
        }]
      },
      //2行2列
      {
        width: $scope.fullWidth,
        height: 2,
        contents: [{
          x: 0,
          y: 0,
          width: 2,
          height: 2
        }, {
          x: 2,
          y: 0,
          width: 2,
          height: 2
        }]
      },
      //2行，口田
      {
        width: $scope.fullWidth,
        height: 2,
        contents: [{
          x: 0,
          y: 0,
          width: 2,
          height: 2
        }, {
          x: 2,
          y: 0,
          width: 1,
          height: 1
        }, {
          x: 2,
          y: 1,
          width: 1,
          height: 1
        }, {
          x: 3,
          y: 0,
          width: 1,
          height: 1
        }, {
          x: 3,
          y: 1,
          width: 1,
          height: 1
        }]
      }
    ];
    $scope.allContentTypes = CONSTANTS.getList('CONTENT_TYPE', false);
    $scope.allTemplateTypes = CONSTANTS.getList('TEMPLATE_TYPE', false);
    $scope.allTemplateStatuses = CONSTANTS.getList('TEMPLATE_STATUS',
      false);
    $scope.disableChoices = [{
      name: '允许',
      value: false
    }, {
      name: '禁止',
      value: true
    }];
    $scope.popChoices = [{
      name: '无',
      value: false
    }, {
      name: '有',
      value: true
    }];
    $scope.borderChoices = [{
      name: '否',
      value: false
    }, {
      name: '是',
      value: true
    }];
    $scope.currentEditContent = $scope.newContent;

    var init = function() {
      //获取模板详情
      if (templateId) {
        templateService.queryTemplateDetail({
          id: templateId
        }).then(function(res) {
          $scope.template = res;
        });
      }
    };
    $scope.saveTemplate = function() {
      var params = angular.copy($scope.template);
      var fn = '';
      if (params.id) {
        fn = 'editTemplate';
      } else {
        fn = 'createTemplate';
      }
      if (!params.name || !params.type || !params.status) {
        $mdDialog.show($mdDialog.alert({
          title: '提示',
          textContent: '请完整填写模版信息',
          ok: '确认',
          cancel: '取消'
        }));
        return;
      }
      templateService[fn](params).then(function(res) {
        window.location.hash = '#template';
      });
    };
    $scope.resetEditTemplate = function() {
      if (templateId) {
        init();
      } else {
        $scope.template = angular.copy($scope.templateDefault);
        $scope.modules = $scope.template.module;
      }
    };
    //模块
    //delete module
    $scope.deleteModule = function(index) {
      $scope.modules.splice(index, 1);
    };
    $scope.moveModule = function(index, isUp) {
      var beforeIndex = isUp ? index - 1 : index;
      if ((isUp && !index) || (!isUp && index == $scope.modules.length -
          1)) {
        return;
      }
      $scope.modules[beforeIndex] = $scope.modules.splice(beforeIndex +
        1, 1,
        $scope.modules[beforeIndex])[0];
    };
    $scope.toggleModuleConfigWin = function() {
      $mdSidenav('right').toggle();
    };
    $scope.selectModule = function(m) {
      var module = angular.extend(angular.copy($scope.defaultModule),
        angular.copy(
          m));
      $scope.modules.push(module);
      $scope.toggleModuleConfigWin();
    };
    //内容
    $scope.editContent = function(moduleIndex, x, y) {
      $scope.currentEditModule = $scope.modules[moduleIndex];
      angular.forEach($scope.currentEditModule.contents, function(
        content,
        index) {
        if (content.x == x && content.y == y) {
          $scope.currentEditContentIndex = index;
          $scope.currentEditContent = angular.extend(angular.copy(
              $scope.newContent),
            angular.copy(content));
        }
      });
      console.log($scope.currentEditContent);
      $scope.toggleEditContentWin();
    };
    $scope.toggleEditContentWin = function() {
      $mdSidenav('left').toggle();
    };
    $scope.bannerContentElementPanel;
    $scope.bannerContent = {
      link: '',
      image: '',
      isEdit: false,
      index: '',
      reset: function() {
        this.link = '';
        this.image = '';
        this.isEdit = false;
        this.index = '';
      }
    };
    $scope.addBannerElement = function() {
      $scope.bannerContent.reset();
      $scope.bannerContentElementPanel.showDialog($scope);
    };
    $scope.editBannerElement = function(index) {
      $scope.bannerContent.isEdit = true;
      $scope.bannerContent.index = index;
      $scope.bannerContent.image = $scope.currentEditContent.contentImage[
        index];
      $scope.bannerContent.link = $scope.currentEditContent.contentLink[
        index];
      $scope.bannerContentElementPanel.showDialog($scope);
    };
    $scope.confirmBannerContent = function() {
      $scope.bannerContentElementPanel.closeDialog($scope);
      var index = $scope.bannerContent.index;
      if ($scope.bannerContent.isEdit) {
        $scope.currentEditContent.contentLink[index] =
          $scope.bannerContent.link;
        $scope.currentEditContent.contentImage[index] =
          $scope.bannerContent.image;
      } else {
        $scope.currentEditContent.contentLink.push($scope.bannerContent
          .link);
        $scope.currentEditContent.contentImage.push($scope.bannerContent
          .image);
      }
    };
    $scope.confirmEditContent = function() {
      $scope.currentEditModule.contents[$scope.currentEditContentIndex] =
        $scope.currentEditContent;
      $scope.toggleEditContentWin();
    };
    $scope.cancelEditContent = function() {
      $scope.toggleEditContentWin();
    };
    $scope.deleteCurrentEditContent = function(index) {
      $mdDialog.show($mdDialog.confirm({
        title: '提示',
        textContent: '删除后无法恢复，确认删除？',
        ok: '确认',
        cancel: '取消'
      })).then(function() {
        $scope.currentEditContent.contentImage.splice(index, 1);
        $scope.currentEditContent.contentLink.splice(index, 1);
      });
    };
    $scope.changeMergeNext = function(module) {
      if (module.mergeNext == 'true' || module.mergeNext == true) {
        module.mergeNext = false;
      } else {
        module.mergeNext = true;
      }
    };
    $scope.$watch('template', function(v) {
      $scope.modules = v.module || [];
    })
    init();
  });
};
},{}],36:[function(require,module,exports){
/*零钱发放*/
module.exports = function(app) {
    app.controller('welfare', function($scope, $mdDialog, $element, $mdSidenav, $filter, uploadService, NgTableParams, welfareService, staffService, modalService, companyService, utilService, modalService, CONSTANTS) {
        var offset = 0;
        var limit = 25;
        $scope.queryWelfareConfig = {
            queryWelfareKey: ''
        };
        $scope.queryStaffConfig = {
            queryStaffKey: ''
        };
        $scope.queryWelfareConfig = {
            choices: [{
                value: 0,
                desc: '全部'
            }, {
                value: 1,
                desc: '待审核'
            }, {
                value: 2,
                desc: '审核通过'
            }, {
                value: 3,
                desc: '审核未通过'
            }],
            defaultItem: {
                value: 0,
                desc: '全部'
            },
            queryWelfareType: 0,
            queryWelfareKey: '',
            getOptionByValue: function(value) {
                var options = this.choices;
                return _.findWhere(options, { value: value });
            },
            selectItem: function(record) {
                this.defaultItem = record;
                $scope.queryWelfareConfig.queryWelfareType = record.value;
            }
        };
        $scope.welfareOfCompany = {
            companyId: '',
            offset: offset,
            limit: limit,
            welfares: [],
            getQueryParams: function(companyId) {
                //公司不同
                if (this.companyId !== companyId) {
                    this.reset();
                    this.companyId = companyId;
                }
                return {
                    offset: this.offset,
                    limit: this.limit,
                    companyId: this.companyId
                }
            },
            setWelfareOfCompany: function(welfares) {
                this.offset += welfares.length;
                this.welfares = $(this.welfares).concat(welfares);
            },
            reset: function() {
                this.offset = offset;
                this.companyId = '';
                this.welfares = [];
            }
        },
        $scope.welfareHeads = [{
            title: '序号',
            field: 'index'
        }, {
            title: '发放时间',
            field: 'createTime',
            getValue: function(value) {
                return '<span>' + $filter('date')(value, 'yyyy.MM.dd HH:mm:ss') + '</span>';
            },
            show: true
        }, {
            title: '发放企业',
            field: 'companyName',
            show: true,
            getValue: function(v) {
                return '<span  style="width:180px;display:inline-block;">' + v + '</span>';
            }
        }, {
            title: '发放总金额',
            field: 'orderFee',
            show: true,
            getValue: function(value) {
                return '<span  style="width:180px;display:inline-block;">' + $filter('rmb')(value) + '</span>';
            }
        }, {
            title: '操作账号',
            field: 'companyManagerName'
        }, {
            title: '手机号',
            field: 'mobile'
        }, {
            title: '座机',
            field: 'tel'
        }, {
            title: '状态',
            field: 'orderState',
            getValue: function(value) {
                return '<span class="text text-' + $filter('style')(value, 'WELFARE_STATE') + ' state">' + $filter('desc')(value, 'WELFARE_STATE') + '</span>';
            }
        }, {
            title: '操作',
            field: 'command',
            getValue: function(v, record, index, scope, column) {
                return '<button class="btn btn-default btn-sm"  ng-click="showWelfareListOfCompany(' + "'" + record.companyId + "'" + ',$event)" ><span class="glyphicon glyphicon-list"></span></button>' +
                    '&nbsp&nbsp&nbsp' +
                    '<button class="btn btn-primary btn-sm" href="javascript:;" ng-disabled="(' + record.orderState + '!=CONSTANTS.WELFARE_STATE.WAIT_AUDIT)" ng-click="auditWelfare(' + "'" + record.orderId + "'" + ",'pass'" + ',$event)">通过</button>' +
                    '&nbsp&nbsp&nbsp' +
                    '<button class="btn btn-danger btn-sm" href="javascript:;" ng-disabled="(' + record.orderState + '!=CONSTANTS.WELFARE_STATE.WAIT_AUDIT)" ng-click="auditWelfare(' + "'" + record.orderId + "'" + ",'refuse'" + ',$event)">拒绝</button>';
            }
        }];

        $scope.welfareDetailTableHeads = [{
            title: '序号',
            field: 'index'
        }, {
            title: '手机号',
            field: 'mobile'
        }, {
            title: '备注名',
            field: 'remark'
        }, {
            title: '昵称',
            field: 'alias'
        }, {
            title: '金额',
            field: 'fee',
            getValue: function(value) {
                return '<span  style="width:180px;display:inline-block;">' + $filter('rmb')(value) + '</span>';
            }
        }];
        $scope.staffHeads = [{
            title: '序号',
            field: 'index'
        }, {
            title: '手机号',
            field: 'mobile'
        }, {
            title: '备注名',
            field: 'remark'
        }, {
            title: '昵称',
            field: 'alias'
        }, {
            title: '头像',
            field: 'avatar',
            getValue:function (v,record) {
                return '<img class="head-portrait" src='+record.avatar+'/>';
            }
        }, {
            title: '操作',
            field: 'command',
            getValue: function(v, record, index, scope, column) {
                return '<button class="btn btn-default btn-sm"  ng-click="openEditStaffWin(\'' + record.id + '\')" ><span class="glyphicon glyphicon-pencil"></span></button>' +
                    '&nbsp&nbsp&nbsp' +
                    '<button class="btn btn-danger btn-sm" href="javascript:;" ng-click="deleteStaff(\'' + record.id + '\')"><span class="glyphicon glyphicon-trash"></span></button>';
            }
        }];
        //零钱表格
        var welfareDetailModal;
        $scope.CONSTANTS = CONSTANTS;
        $scope.welfareList = [];
        $scope.welfareDetails = [];
        $scope.welfareDetailCompany = {};
        $scope.offset = offset;
        $scope.limit = limit;
        $scope.welfareTable = new NgTableParams({
            count: 25
        }, {
            counts: [],
            getData: function(params) {
                var pageParams = utilService.resetPagination($scope, $scope.limit * (params.page() - 1), limit);
                var p = $.extend(pageParams, { companyId: $scope.welfareDetailCompany.companyId });
                return welfareService.queryWelfareList(p).then(function(res) {
                    $scope.welfares = res.content;
                    params.total(res.totalElements);
                    return utilService.indexArray(res.content, $scope.offset + 1);
                });
            }
        });
        $scope.welfareDetailNote = '';
        $scope.welfareDetail = {
            remark: '',
            createTime: 0
        }
        $scope.welfareDetailTable = new NgTableParams({
            count: 10
        }, {
            counts: []
        });
        $scope.welfareDetailCtrl;
        $scope.selectWelfareCompany = function(company) {
            $scope.welfareDetailCompany = company;
            $scope.welfareTable.reload();
        };
        $scope.searchWelfareByKey = function() {
            //$scope.welfareTable.reload();
        };

        $scope.auditWelfare = function(orderId, type, e) {
            e.preventDefault();
            e.stopPropagation();
            var orderState = type == 'refuse' ? CONSTANTS.WELFARE_STATE.REFUSED : CONSTANTS.WELFARE_STATE.PASSED;
            welfareService.auditWelfare({
                orderId: orderId,
                orderState: orderState
            }).then(function() {
                $scope.welfareTable.reload();
                $mdSidenav('left').close();
            });
        };
        //公司零钱列表
        $scope.showWelfareListOfCompany = function(companyId, e) {
            //点击重置页码
            if (e) {
                $scope.welfareOfCompany.reset();
            }
            var params = $scope.welfareOfCompany.getQueryParams(companyId);
            welfareService.queryWelfareList(params).then(function(res) {
                $scope.welfareOfCompany.setWelfareOfCompany(res.content);
                if (e) {
                    $mdSidenav('left').toggle();
                }
            });
        };
        $element.find('md-list').on('scroll', _.debounce(function(e) {
            var height = $(this).height();
            var bottom = this.scrollHeight - this.scrollTop;
            if (height + 50 >= bottom) {
                $scope.showWelfareListOfCompany($scope.welfareOfCompany.companyId);
            }
        }, 300));
        //零钱详情

        $scope.showWelfareDetail = function(orderId, item) {
            $scope.welfareDetail.remark = item.remark;
            $scope.welfareDetail.createTime = item.createTime;
            welfareService.queryWelfareObjectList({
                orderId: orderId,
                offset: offset,
                limit: 100000
            }).then(function(res) {
                $scope.welfareDetails = res.content;
                $scope.welfareDetailTable.settings({
                    dataset: utilService.indexArray(res.content, 1)
                });
                $scope.$applyAsync(function() {
                    $scope.welfareDetailCtrl.showDialog($scope);
                });
            });
        };
        /*员工管理*/
        var staffEditModal;
        $scope.staffDetailCtrl;
        $scope.currentStaff = {
            mobile: '',
            alias: '',
            avatar: '',
            remark: ''
        };
        $scope.staff = {
            companyId: '',
            keyword: '',
            items: []
        };
        $scope.staffTable = new NgTableParams({
            count: 25
        }, {
            counts: [],
            getData: function(params) {
                if (!$scope.staff.companyId) {
                    return;
                }
                var pageParams = {
                    limit: $scope.limit,
                    offset: $scope.limit * (params.page() - 1)
                };
                var p = $.extend(pageParams, {
                    companyId: $scope.staff.companyId,
                    queryParam: $scope.staff.keyword
                });
                return staffService.queryStaffList(p).then(function(res) {
                    $scope.staff.items = res.content;
                    params.total(res.totalElements);
                return utilService.indexArray(res.content,  $scope.limit * (params.page() - 1) + 1);
                });
            }
        });
        $scope.searchStaffByKey = function(value) {
            $scope.staff.keyword = value;
            $scope.staffTable.reload();
        };
        $scope.selectStaffCompany = function(company) {
            $scope.staff.companyId = company.companyId;
            $scope.staffTable.reload();
        };
        $scope.showWelfareSendWin = function() {
            $mdSidenav('right').toggle();
        };
        $scope.getStaffList = function() {
            staffService.queryStaffList();
        };
        $scope.openEditStaffWin = function(staffId) {
            staffService.queryStaffDetail({
                staffId: staffId
            }).then(function(res) {
                $scope.currentStaff = res;
                staffEditModal = modalService.initModal({
                    appendTo: $element,
                    scope: $scope,
                    ok: $scope.editStaffConfirm
                });
            });
        };
        $scope.editStaffConfirm = function() {
            console.log($scope.currentStaff);
            return staffService.editStaff($scope.currentStaff).then(function() {
                $scope.staffTable.reload();
            });
        };
        $scope.importStaffExcel = function() {
            uploadService.uploadFile().then(function(file) {
                staffService.examinExcel({
                    companyId: $scope.staff.companyId,
                    file: file
                }).then(function(res) {
                    if (res.code == 200) {
                        $mdDialog.show($mdDialog.confirm()
                                .title('成功')
                                .textContent('excel校验成功，是否开始导入?')
                                .ok('确定')
                                .cancel('取消'))
                            .then(function() {
                                staffService.importStaffExcel({
                                    companyId: $scope.staff.companyId,
                                    file: file
                                }).then(function() {
                                    $scope.staffTable.reload();
                                    $mdDialog.show($mdDialog.alert()
                                        .clickOutsideToClose(true)
                                        .title('成功')
                                        .textContent('导入成功！')
                                        .ok('确定'));
                                });
                            })
                    } else {
                        $mdDialog.show(
                            $mdDialog.alert()
                            .clickOutsideToClose(true)
                            .title('失败')
                            .textContent(res.consoleLog.join(';'))
                            .ok('确定')
                        );
                    }
                });
            });
        };
        $scope.exportStaffExcel=function(){
            window.open('http://res.kingxique.com/hollpin/crm/template/%E5%91%98%E5%B7%A5%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF.xls','_blank');
        };
        $scope.deleteStaff = function(staffId) {
            staffService.deleteStaff({
                staffId: staffId
            }).then(function() {
                $scope.staffTable.reload();
            });
        };
    });
};

},{}],37:[function(require,module,exports){
module.exports=[require("./controller/account.js"),require("./controller/app.js"),require("./controller/commentsManage.js"),require("./controller/company.js"),require("./controller/configurationInformation.js"),require("./controller/deadStock.js"),require("./controller/deliveryEdit.js"),require("./controller/finance.js"),require("./controller/goodsChooseHistory.js"),require("./controller/goodsChooseOrder.js"),require("./controller/holidayWelfare.js"),require("./controller/home.js"),require("./controller/inStorage.js"),require("./controller/information.js"),require("./controller/issueDynamic.js"),require("./controller/labelsManagement.js"),require("./controller/newProductRecommend.js"),require("./controller/order.js"),require("./controller/pickOrder.js"),require("./controller/positionManage.js"),require("./controller/product.js"),require("./controller/promotionOrder.js"),require("./controller/promotionProduct.js"),require("./controller/promotionSuite.js"),require("./controller/role.js"),require("./controller/salesStatistics.js"),require("./controller/shelf.js"),require("./controller/shelfDetail.js"),require("./controller/shelfManage.js"),require("./controller/suiteCfgManage.js"),require("./controller/suiteDistributionDynamic.js"),require("./controller/teaInformation.js"),require("./controller/template.js"),require("./controller/templateEdit.js"),require("./controller/welfare.js")]
},{"./controller/account.js":2,"./controller/app.js":3,"./controller/commentsManage.js":4,"./controller/company.js":5,"./controller/configurationInformation.js":6,"./controller/deadStock.js":7,"./controller/deliveryEdit.js":8,"./controller/finance.js":9,"./controller/goodsChooseHistory.js":10,"./controller/goodsChooseOrder.js":11,"./controller/holidayWelfare.js":12,"./controller/home.js":13,"./controller/inStorage.js":14,"./controller/information.js":15,"./controller/issueDynamic.js":16,"./controller/labelsManagement.js":17,"./controller/newProductRecommend.js":18,"./controller/order.js":19,"./controller/pickOrder.js":20,"./controller/positionManage.js":21,"./controller/product.js":22,"./controller/promotionOrder.js":23,"./controller/promotionProduct.js":24,"./controller/promotionSuite.js":25,"./controller/role.js":26,"./controller/salesStatistics.js":27,"./controller/shelf.js":28,"./controller/shelfDetail.js":29,"./controller/shelfManage.js":30,"./controller/suiteCfgManage.js":31,"./controller/suiteDistributionDynamic.js":32,"./controller/teaInformation.js":33,"./controller/template.js":34,"./controller/templateEdit.js":35,"./controller/welfare.js":36}],38:[function(require,module,exports){
module.exports = function(app) {
  app.directive('blockAdd', function() {
    return {
      restrict: 'AE',
      templateUrl: 'directive/blockAdd.html',
      transclude: true,
      scope: {  'addBlock': '&' },
      controller: function($scope, $element, $attrs, companyService) {
       $scope.blockSelectChoices=[{ desc: '商品名称', code: '0' }, {desc: '商品id',code: '1'}];
       $scope.type=0;
       $scope.productName="";
       $scope.add=function(){
          $scope.addBlock({
          productId:$scope.productId,
          reason:$scope.reason,
          callback:$scope.init
        })
       };
       $scope.init=function(){
           $scope.productName="";
           $scope.productId="";
           $scope.reason="";
       };
       $scope.$watch('productId',function(v){
       })
      $scope.typeSelect=function(item){
        $scope.type=item.code;
        console.log( $scope.type)
      }
      }
    };
  });
};
},{}],39:[function(require,module,exports){
module.exports = function(app) {
  app.directive('companySearcher', function() {
    return {
      restrict: 'E',
      templateUrl: 'directive/companySearcher.html',
      transclude: true,
      scope: { 'selectCompany': '&', 'subclass': '@', 'emptyCallback': '&' },
      controller: function($scope, $element, $attrs, companyService) {

        $scope.subclass ? $scope.rootClass = $scope.subclass : $scope.rootClass =
          'col-md-2';
        $scope.typeHeadConfigs = {
          debounce: {
            'default': 500,
            'blur': 250
          },
          getterSetter: true
        };
        $scope.changeValue = function(str) {
          if (!str) {
            $scope.emptyCallback();
          }
        };
        $scope.getTypeHeadOptions = function(value) { //搜索加载
          return companyService.queryCompanyList({
            offset: 0,
            limit: 5,
            delState: 0,
            companyName: value
          }).then(function(res) {
            return res.content;
          });
        };
        $scope.selectTypeHeadOptions = function(item) { //搜索选择
          $scope.selectCompany({ 'company': item });
        };
      }
    };
  });
};
},{}],40:[function(require,module,exports){
/*
 *编译html
 * compile-html
 */
module.exports = function(app) {
    app.directive('compileHtml', function() {
        return {
            restrict: 'A',
            transclude: true,
            scope: false,
            controller: function($scope, $element, $attrs, $compile) {
                $scope.$watch($attrs.compileHtml, function(html) {
                    var str = '';
                    if (Object.prototype.toString.call(html) == '[object Object]') { //数组
                        str = html.$$unwrapTrustedValue();
                    } else { //字符串
                        str = html && html.toString();
                    }
                    $element.append($compile('<span>' + str + '</span>')($scope));
                });
            }
        };
    });
};

},{}],41:[function(require,module,exports){
module.exports = function(app) {
    app.directive('count', function($mdPanel, $templateCache, $compile) {
        return {
            restrict: 'E',
            replace: true,
            scope: {
                num: '=',
                onChange: '=',
            },
            templateUrl: 'directive/count.html',
            link: function($scope, $element) {
                $scope.plusCount = function() {
                    $scope.num = $scope.num + 1;
                     event.stopPropagation();
                };
                $scope.minCount = function() {
                    $scope.num = $scope.num - 1;
                     event.stopPropagation();
                };
                $scope.dblclick = function() {
                   event.stopPropagation(); 
                };

                $scope.$watch('num', function() {
                    $scope.onChange.call(this);
                   
                });
            }
        };
    });
};

},{}],42:[function(require,module,exports){
module.exports = function(app) {
    app.directive('dateFormate', function() {
        return {
            restrict: 'A',
            require: 'ngModel',
            link: function(scope, element, attrs, ctrl) {

                ctrl.$parsers.push(function(data) {
                    
                    //convert data from view format to model format
                    return data
                });
                ctrl.$formatters.push(function(data) {
                    
                    //convert data from model format to view format
                    return data; //converted
                });
            }
        };
    });
};

},{}],43:[function(require,module,exports){
module.exports = function(app) {
    app.directive('datePicker', function() {
        return {
            restrict: 'E',
            templateUrl: 'directive/datePicker.html',
            transclude: true,
            scope: {
                timeStamp: '=',
                ngModel:'='
            },
            link: function($scope) {
                $scope.dt = new Date(parseInt($scope.timeStamp));
                $scope.opened = false;
                /*                $scope.dateOptions = {
                                    dateDisabled: function(data) {
                                        var date = data.date,
                                            mode = data.mode;
                                        return mode === 'day' && (date.getDay() === 0 || date.getDay() === 6);
                                    },
                                    formatYear: 'yyyy',
                                    maxDate: new Date(2020, 5, 22),
                                    minDate: new Date(),
                                    startingDay: 1
                                };*/
                $scope.altInputFormats = ['M!/d!/yyyy'];
                $scope.open1 = function() {
                    $scope.opened = true;
                };
                $scope.$watch('timeStamp',function(){
                    $scope.dt = new Date(parseInt($scope.timeStamp));
                });
                $scope.$watch('dt', function(value) {
                    if(value!==undefined){
                        $scope.timeStamp = value.getTime();
                    }else{
                        $scope.timeStamp='';
                    }

                });
                /*$scope.formats = ['dd-MMMM-yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];*/
                /*$scope.clearData = function() {
                    $scope.dt = '';
                };*/
            }
        };
    });
};

},{}],44:[function(require,module,exports){
module.exports = function(app) {
    app.directive('dialog', function($mdPanel, $templateCache, $compile) {
        return {
            restrict: 'E',
            replace: false,
            scope: {
                title: '@',
                instance: '=instance'
            },
            controller: function($scope, $element) {
                var panel;
                console.log('controller');
                this.closeDialog = function(mdPanelRef) {
                    panel && panel.close();
                };
                this.showDialog = function(scope) {
                    var el = $element.children();
                    var tmp = $templateCache.get('directive/dialog.html');
                    var position = $mdPanel.newPanelPosition().absolute().center();
                    var config = {
                        attachTo: angular.element(document.body),
                        panelClass: 'dialog',
                        position: position,
                        template: tmp,
                        hasBackdrop: true,
                        clickOutsideToClose: true,
                        scope: $scope,
                        escapeToClose: true,
                        focusOnOpen: true,
                        zIndex: 1000001,
                        content: el,
                        origin: $element,
                        onDomAdded: function(doms) {
                            var dialog = doms[1];
                            dialog._panelEl.find('md-content').append(dialog._config.content);
                        },
                        onDomRemoved: function(doms) {
                            var dialog = doms[0];
                            dialog._config.origin.append(dialog._config.content)
                        }
                    };
                    $mdPanel.open(config).then(function(result) {
                        panel = result;
                    })
                };
                $scope.instance = this;
            }
        };
    });
};

},{}],45:[function(require,module,exports){
module.exports = function(app) {
  app.directive('dropDown', function() {
    return {
      restrict: 'E',
      templateUrl: 'directive/dropDown.html',
      transclude: true,
      scope: {
        'select': '&',
        'list': '@', //传入的选择项列表
        'descField': '@', //指定显示字段
        'defaultDesc': '@', //默认描述
        'defaultItem': '@', //默认选项 格式为{'code':'0','desc':'否'}(desc必须有,code自便)
        'btnStyle': '@', //btn-link:无框蓝色 btn-default:有框按钮
        'disabled': '@', //是否可用，true为不可用，false为可用
        'preventAutoSelected': '='
      },
      controller: function($scope, shelfService) {
        $scope.descField = $scope.descField || 'desc';
        $scope.$watch('defaultDesc', function(newValue, oldValue, scope) {
          if (newValue) {
            $scope.defaultDesc = newValue;
          }
        });
        $scope.selectItem = function(option) {
          $scope.defaultItem = option.item;

        };

        $scope.$watch('list', function(newValue, oldValue, scope) {
          if (!angular.isArray(newValue) && newValue != '') {
            $scope.list = JSON.parse(newValue);

          }
        });
      },
      link: function($scope) {
        var preventAutoSelected = $scope.preventAutoSelected;
        $scope.$watch('defaultItem', function(newValue, oldValue, scope) {
          var defaultItem;
          if ($scope.defaultItem && _.isString($scope.defaultItem)) {
            defaultItem = JSON.parse($scope.defaultItem);
          } else {
            defaultItem = scope.defaultItem || {};
          }
          $scope.defaultDesc = defaultItem[$scope.descField] ||
            $scope.defaultDesc;
          if (!preventAutoSelected) {
            $scope.select && $scope.select.call(this, {
              item: defaultItem
            });
          }
          preventAutoSelected = false;
        });
      }
    };
  });
};
},{}],46:[function(require,module,exports){
module.exports = function(app) {
    app.directive('echartsLine', function() {
        return {
            restrict: 'E',
            temlate: '<div style="height:100%;width:100%;"></div>',
            scope: {
                id: '@',
                xaxisdata: '=',
                seriesdata: '='
            },
            replace: true,
            link: function($scope) {
                // 指定图表的配置项和数据
                var option = {
                    title: {
                        text: '销量走势图'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['销量']
                    },
                    xAxis: {
                        data: $scope.xaxisdata
                    },
                    yAxis: {},
                    series: [{
                        name: '销量',
                        type: 'line',
                        data: $scope.seriesdata
                    }]
                };
                var myChart = echarts.init(document.getElementById($scope.id));
                myChart.setOption(option);
            }
        }
    });
};

},{}],47:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/11/22.
 */
module.exports = function (app) {
    /*app.directive('fixedTableHeaders', ['$timeout', function ($timeout) {
        return {
            link: function (scope, element, attrs) {
                $timeout(function () {
                    // debugger
                    container = element.parentsUntil(attrs.fixedTableHeaders);
                    element.stickyTableHeaders({scrollableArea: container, "fixedOffset": 2});

                }, 0);
            }
        }
    }]);*/
};

},{}],48:[function(require,module,exports){
module.exports = function(app) {
    app.directive('formRequired', function($compile) {
        return {
            restrict: 'A',
            compile: function($element, $attrs) {
                    var name = $attrs.formRequired;
                    $element.attr('ng-class', $attrs.class + ' {{' + name + '.$invalid&&!' + name + '.$pristine?' + "'" + 'has-error' + "'" + ':' + "''" + '}}');
                    return {
                        post: function(scope, elem, attrs) {
                            $compile(elem)(scope);
                        }
                    };
                }
                // link:function($scope, $element, $attrs){

            //     var str= $scope.$eval($attrs.formRequired);
            //     $element.addClass(str);
            //     $compile($element)($scope);

            // }
        };
    });
};

},{}],49:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 16/8/4.
 */
module.exports = function(app) {
    app.directive('labelsManagements', function() {
        return {
            restrict: 'EA',
            templateUrl: 'labelsManagements/labelsManagements.html',
            transclude: true,
            controller: function($scope, $element, $attrs) {

            }
        };
    });
};

},{}],50:[function(require,module,exports){
/*
 *Component login
 */
module.exports = function(app) {
    app.directive('login', function($location) {
        return {
            restrict: 'E',
            templateUrl: 'directive/login.html',
            transclude: true,
            replace: true,
            controller: function($scope, $element, $attrs, modalService, authService) {
                $scope.username = '';
                $scope.psw = '';
                $scope.isLogin = authService.isLogin();
                $scope.ok = function(scope) {
                    //登陆
                    authService.login({
                        username: scope.username,
                        psw: $.hex_md5(scope.psw)
                    }).then(function(res) {
                        //登陆成功视图变化
                        $scope.isLogin = true;
                        window.location.hash = '#home';
                    });
                };
                $element.ready(function() {
                    $('.login input[type=password]').val('');
                });
            }
        };
    });
};

},{}],51:[function(require,module,exports){
module.exports = function(app) {
  app.directive('mdImg', function($filter) {
    return {
      restrict: 'E',
      templateUrl: 'directive/mdImg.html',
      transclude: false,
      replace: true,
      scope: {
        bg: '@',
        path: '=',
        mdStyle: '@',
        imgClass: '@'
      },
      link: function($scope, $element, $attrs) {
        $scope.url = '';
        $scope.style = {};
        $scope.$watch('path', function(v) {
          $scope.url = $filter('img')(v);
          if ($scope.bg) {
            $scope.style.backgroundImage = 'url(' + $scope.url + ')';
          }
        });
      }
    };
  });
};

},{}],52:[function(require,module,exports){
module.exports = function(app) {
  app.directive('mdUploader', function(uploadService) {
    return {
      restrict: 'E',
      templateUrl: 'directive/mdUploader.html',
      transclude: false,
      replace: true,
      scope: {
        value: '=',
        ngModel: '=',
        index: '=',
        hideInput: '@', //是否隐藏输入框，默认不隐藏
        didUpload: '&', //完成上传回调事件
        sizeLimit: '@', //尺寸大小限制
        isUploadUpyun: '@' //是否需要上传又拍云，默认上传
      },
      link: function($scope, $element, $attrs) {
        $scope.filenames = '';
        $scope.files = [];
        $scope.path = $attrs.path;
        $scope.uploadTitle = $scope.uploadTitle || '上传';

        $scope.changeFile = function(dom) {
          var opts = {
            file_dom: dom,
            folder: angular.element(dom).attr('path'),
            size_limit: JSON.parse($scope.sizeLimit || '{}'),
            is_upload_upyun: $scope.isUploadUpyun || 'true'
          };
          var str_dom = angular.element(dom).next().find('input');
          uploadService.upload(opts).then(function(res) {
            $scope.value = res.path;
            $scope.filenames = res.path;
            var didUpload = $scope.didUpload || function() {};
            didUpload({
              file: res
            });
          });
        };
      }
    };
  });
};

},{}],53:[function(require,module,exports){
/*
 *Component login
 */
module.exports = function(app) {
    app.directive('module', function($filter) {
        return {
            restrict: 'E',
            templateUrl: 'directive/module.html',
            transclude: true,
            scope: {
                moduleLayout: '=',
                moduleIndex: '@',
                editContent: '=',
                isInTemplate: '@'
            },
            controller: function($scope, $element, $attrs, modalService, authService) {
                $scope.isArray = function(arry) {
                    return angular.isArray(arry);
                }
                $scope.col = _.range($scope.moduleLayout.width);
                $scope.row = _.range($scope.moduleLayout.height);
                $scope.cells = $scope.moduleLayout.contents;
                $scope.renderStyle = {};
                $scope.template = $scope.isInTemplate !== undefined ? true : false;
                $scope.hasContent = function(x, y) {
                    var content = _.find($scope.cells, function(item) {
                        return item.x == x && item.y == y;
                    });
                    if (content) {
                        $scope.renderStyle = {
                            width: content.width * 100 + '%',
                            height: content.height * 100 + '%'
                        };
                        
                        content.noBorder == 'true' ? $scope.renderStyle.border = 0 : '';
                        content.contentImage && content.contentImage[0] ? $scope.renderStyle
                            .backgroundImage =
                            'url(' + $filter('img')(content.contentImage[0]) + ')' : '';
                    }
                    return !!content;
                };
            }
        };
    });
};

},{}],54:[function(require,module,exports){
module.exports = function(app) {
    app.directive('msStepper', function() {
        return {
            restrict: 'A',
            require: ['form', 'msStepper'],
            priority: 1001,
            templateUrl: 'directive/msStepper.html',
            transclude: true,
            replace: false,
            scope: {
                model: "=ngModel"
            },
            controller: function($timeout) {
                var me = this;

                // Data
                me.mainForm = undefined;

                me.steps = [];
                me.currentStep = undefined;
                me.currentStepNumber = 1;

                // Methods
                me.registerMainForm = registerMainForm;
                me.registerStep = registerStep;
                me.setupSteps = setupSteps;
                me.resetForm = resetForm;

                me.setCurrentStep = setCurrentStep;

                me.gotoStep = gotoStep;
                me.gotoPreviousStep = gotoPreviousStep;
                me.gotoNextStep = gotoNextStep;
                me.gotoFirstStep = gotoFirstStep;
                me.gotoLastStep = gotoLastStep;

                me.isFirstStep = isFirstStep;
                me.isLastStep = isLastStep;

                me.isStepCurrent = isStepCurrent;
                me.isStepDisabled = isStepDisabled;
                me.isStepOptional = isStepOptional;
                me.isStepValid = isStepValid;
                me.isStepNumberValid = isStepNumberValid;

                me.isFormValid = isFormValid;

                //////////

                /**
                 * Register the main form
                 *
                 * @param form
                 */
                function registerMainForm(form) {
                    me.mainForm = form;
                }

                /**
                 * Register a step
                 *
                 * @param element
                 * @param scope
                 * @param form
                 */
                function registerStep(element, scope, form) {
                    var step = {
                        element: element,
                        scope: scope,
                        form: form,
                        stepNumber: scope.step || (me.steps.length + 1),
                        stepTitle: scope.stepTitle
                    };

                    // Push the step into steps array
                    me.steps.push(step);

                    // Sort steps by stepNumber
                    me.steps.sort(function(a, b) {
                        return a.stepNumber - b.stepNumber;
                    });
                }

                /**
                 * Setup steps for the first time
                 */
                function setupSteps() {
                    me.setCurrentStep(me.currentStepNumber);
                }

                /**
                 * Reset steps and the main form
                 */
                function resetForm() {
                    // Timeout is required here because we need to
                    // let form model to reset before setting the
                    // statuses
                    $timeout(function() {
                        // Reset all the steps
                        for (var x = 0; x < me.steps.length; x++) {
                            me.steps[x].form.$setPristine();
                            me.steps[x].form.$setUntouched();
                        }

                        // Reset the main form
                        me.mainForm.$setPristine();
                        me.mainForm.$setUntouched();

                        // Go to first step
                        gotoFirstStep();
                    })
                }

                /**
                 * Set current step
                 *
                 * @param stepNumber
                 */
                function setCurrentStep(stepNumber) {
                    // If the stepNumber is not a valid step number, bail...
                    if (!isStepNumberValid(stepNumber)) {
                        return;
                    }

                    // Update the current step number
                    me.currentStepNumber = stepNumber;

                    // Hide all steps
                    for (var i = 0; i < me.steps.length; i++) {
                        me.steps[i].element.addClass('hide');
                    }

                    // Show the current step
                    me.steps[me.currentStepNumber - 1].element.removeClass('hide');
                }

                /**
                 * Go to a step
                 *
                 * @param stepNumber
                 */
                function gotoStep(stepNumber) {
                    me.setCurrentStep(stepNumber);
                }

                /**
                 * Go to the previous step
                 */
                function gotoPreviousStep() {
                    me.setCurrentStep(me.currentStepNumber - 1);
                }

                /**
                 * Go to the next step
                 */
                function gotoNextStep() {
                    me.setCurrentStep(me.currentStepNumber + 1);
                }

                /**
                 * Go to the first step
                 */
                function gotoFirstStep() {
                    me.setCurrentStep(1);
                }

                /**
                 * Go to the last step
                 */
                function gotoLastStep() {
                    me.setCurrentStep(me.steps.length);
                }

                /**
                 * Check if the current step is the first step
                 *
                 * @returns {boolean}
                 */
                function isFirstStep() {
                    return me.currentStepNumber === 1;
                }

                /**
                 * Check if the current step is the last step
                 *
                 * @returns {boolean}
                 */
                function isLastStep() {
                    return me.currentStepNumber === me.steps.length;
                }

                /**
                 * Check if the given step is the current one
                 *
                 * @param stepNumber
                 * @returns {null|boolean}
                 */
                function isStepCurrent(stepNumber) {
                    // If the stepNumber is not a valid step number, bail...
                    if (!isStepNumberValid(stepNumber)) {
                        return null;
                    }

                    return me.currentStepNumber === stepNumber;
                }

                /**
                 * Check if the given step should be disabled
                 *
                 * @param stepNumber
                 * @returns {null|boolean}
                 */
                function isStepDisabled(stepNumber) {
                    // If the stepNumber is not a valid step number, bail...
                    if (!isStepNumberValid(stepNumber)) {
                        return null;
                    }

                    var disabled = false;

                    for (var i = 1; i < stepNumber; i++) {
                        if (!isStepValid(i)) {
                            disabled = true;
                            break;
                        }
                    }

                    return disabled;
                }

                /**
                 * Check if the given step is optional
                 *
                 * @param stepNumber
                 * @returns {null|boolean}
                 */
                function isStepOptional(stepNumber) {
                    // If the stepNumber is not a valid step number, bail...
                    if (!isStepNumberValid(stepNumber)) {
                        return null;
                    }

                    return me.steps[stepNumber - 1].scope.optionalStep;
                }

                /**
                 * Check if the given step is valid
                 *
                 * @param stepNumber
                 * @returns {null|boolean}
                 */
                function isStepValid(stepNumber) {
                    // If the stepNumber is not a valid step number, bail...
                    if (!isStepNumberValid(stepNumber)) {
                        return null;
                    }

                    // If the step is optional, always return true
                    if (isStepOptional(stepNumber)) {
                        return true;
                    }

                    return me.steps[stepNumber - 1].form.$valid;
                }

                /**
                 * Check if the given step number is a valid step number
                 *
                 * @param stepNumber
                 * @returns {boolean}
                 */
                function isStepNumberValid(stepNumber) {
                    return !(stepNumber < 1 || stepNumber > me.steps.length);
                }

                /**
                 * Check if the entire form is valid
                 *
                 * @returns {boolean}
                 */
                function isFormValid() {
                    return me.mainForm.$valid;
                }
            },
            compile: function(tElement) {
                tElement.addClass('ms-stepper');
                return function postLink(scope, iElement, iAttrs, ctrls)
                {
                    var FormCtrl = ctrls[0],
                        MsStepperCtrl = ctrls[1];
                    MsStepperCtrl.registerMainForm(FormCtrl);
                    MsStepperCtrl.setupSteps();
                };

            }
        };
    });
};

},{}],55:[function(require,module,exports){
module.exports = function(app) {
    app.directive('msStepperStep', function() {
        return {
            restrict: 'E',
            require: ['form', '^msStepper'],
            priority: 1000,
            replace: false,
            scope: {
                step: '=?',
                stepTitle: '=?',
                optionalStep: '=?'
            },
            compile: function(tElement) {
                tElement.addClass('ms-stepper-step');
                return function postLink(scope, iElement, iAttrs, ctrls) {
                    var FormCtrl = ctrls[0],
                        MsStepperCtrl = ctrls[1];

                    // Is it an optional step?
                    scope.optionalStep = angular.isDefined(iAttrs.optionalStep);

                    // Register the step
                    MsStepperCtrl.registerStep(iElement, scope, FormCtrl);

                    // Hide the step by default
                    iElement.addClass('hide');
                };
            }
        };
    });
};

},{}],56:[function(require,module,exports){
module.exports = function(app) {
    app.directive('navigator', function() {
        return {
            restrict: 'E',
            templateUrl: 'directive/navigator.html',
            transclude: true,
            controller: function($scope, $element, $attrs) {
            	
            }
        };
    });
};

},{}],57:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 16/7/28.
 */
/*
 *编译html
 * compile-html
 */
module.exports = function (app) {
    app.directive('account', function () {
        return {
            restrict: 'EA',
            // templateUrl:'account/account.html',
            transclude: true,
            scope: false,
            controller: function ($scope, $element, $attrs, $compile) {

            }
        }
    });
};



},{}],58:[function(require,module,exports){
module.exports = function(app) {
    app.directive('onFinishRenderFilters', function($timeout) {
        return {
            restrict: 'A',
            link: function(scope, element, attr) {
                if (scope.$last === true) { //判断是否是最后一条数据  
                    $timeout(function() {
                        scope.$emit('ngRepeatFinished'); //向父级scope传送ngRepeatFinished命令 
                    });
                }
            }
        };
    });
};

},{}],59:[function(require,module,exports){
module.exports = function(app) {
    app.directive('panel', function($mdPanel, $templateCache, $compile) {
        return {
            restrict: 'A',
            replace: false,
            scope: {
                title: '@',
                instance: '=instance'
            },
            link: function($scope, $element) {
                var panel;
                var container = $('#container');
                console.log('controller');

                this.closeDialog = function(mdPanelRef) {
                    panel && panel.close();
                };
                this.showDialog = function(scope) {
                    var el = $compile($element.html())(scope);
                    var tmp = $templateCache.get('directive/dialog.html');
                    var position = $mdPanel.newPanelPosition().absolute().center();
                    var config = {
                        attachTo: container,
                        panelClass: 'dialog',
                        position: position,
                        template: tmp,
                        hasBackdrop: true,
                        clickOutsideToClose: true,
                        scope: $scope,
                        escapeToClose: true,
                        focusOnOpen: true,
                        zIndex: 2055,
                        content: el,
                        origin: $element,
                        onDomAdded: function(doms) {
                            var dialog = doms[1];
                            dialog._panelEl.find('md-content').append(dialog._config.content);
                        },
                        onDomRemoved: function() {
                            container.css({
                                overflow: 'scroll'
                            });
                        }
                    };
                    container.css({
                        overflow: 'hidden'
                    });
                    scope.$applyAsync(function() {
                        $mdPanel.open(config).then(function(result) {
                            panel = result;
                        });
                    });
                };
                $scope.instance = this;
                $scope.closeDialog=this.closeDialog;
            }
        };
    });
};

},{}],60:[function(require,module,exports){
module.exports = function(app) {
  app.directive('permissions', function() {
    return {
      restrict: 'E',
      templateUrl: 'directive/permissions.html',
      scope: {
        all: '=',
        checked: '='
      },
      controller: function($scope) {
        if (typeof($scope.checked) == 'undefined') {
          throw "<permissions> Missing attribute 'checked'.";
        }
        $scope.checkedPermissions = new CheckedPermissions($scope.all, $scope.checked);
      }
    }
  });
};

function CheckedPermissions(allPermissions, checkedIds) {
  var dict = {};
  var toId = function(permission) {
    return permission.id;
  };
  // 初始化已经选择的权限
  angular.forEach(allPermissions, function(group) {
    if(!group.permissions) return;
    dict[group.id] = group.permissions.map(toId).filter(function(id) {
      return checkedIds.indexOf(id) > -1;
    });
  });
  var isChecked = function(group, permission) {
    var groupId = group.id;
    return dict.hasOwnProperty(groupId) && dict[groupId].indexOf(permission.id) > -1;
  };
  var toggle = function(group, permission) {
    var groupId = group.id;
    var permissionId = permission.id;
    // 更新字典
    if (dict.hasOwnProperty(groupId)) {
      var checkedInGroup = dict[groupId];
      var index = checkedInGroup.indexOf(permissionId);
      if (index > -1) {
        checkedInGroup.splice(index, 1);
      } else {
        checkedInGroup.push(permissionId);
      }
    } else {
      dict[groupId] = [permissionId];
    }
    // 更新数组
    var index = checkedIds.indexOf(permissionId);
    if (index > -1) {
      checkedIds.splice(index, 1);
    } else {
      checkedIds.push(permissionId);
    }
  };
  var selectAll = function(group) {
    var ids = group.permissions.map(toId);
    // 更新字典
    dict[group.id] = ids;
    // 更新数组
    angular.forEach(group.permissions, function(permission) {
      if (checkedIds.indexOf(permission.id) < 0) {
        checkedIds.push(permission.id);
      }
    });
  };
  var inverseSelection = function(group) {
    var permissions = group.permissions
      .filter(function(permission) {
        return !isChecked(group, permission);
      });
    var ids = permissions.map(toId);
    var oldIds = dict[group.id];
    // 更新字典
    dict[group.id] = ids;
    // 更新数组
    angular.forEach(oldIds, function(oldId) {
      var index = checkedIds.indexOf(oldId);
      if (index > -1) {
        checkedIds.splice(index, 1);
      }
    });
    checkedIds = checkedIds.concat(ids);
  };
  this.isChecked = isChecked;
  this.toggle = toggle;
  this.selectAll = selectAll;
  this.inverseSelection = inverseSelection;
};

},{}],61:[function(require,module,exports){
module.exports = function(app) {
  app.directive('productSearcher', function() {
    return {
      restrict: 'AE',
      templateUrl: 'directive/productSearcher.html',
      transclude: true,
      replace:true,
      scope: {productId:"=",productName:"="},
      controller: function($scope, $element, $attrs, productService) {
        $scope.typeHeadConfigs = {
          debounce: {
            'default': 500,
            'blur': 250
          },
          getterSetter: true
        };
        $scope.changeValue = function(str) {
           
        };
        $scope.getTypeHeadOptions = function(value) { //搜索加载
          return productService.queryProductByKey({
            offset: 0,
            limit: 5,
            delState: 0,
            productName: value
          }).then(function(res) {
            return res.content;
          });
        };
        $scope.selectTypeHeadOptions = function(item) { //搜索选择

        $scope.productId=item.header.id;
          console.log($scope.productId)
         
        };
      }
    };
  });
};
},{}],62:[function(require,module,exports){
module.exports = function(app) {
    app.directive('promotionSearcher', function(utilService, CONSTANTS) {
        return {
            restrict: 'E',
            templateUrl: 'directive/promotionSearch.html',
            transclude: true,
            scope: {
                'search': '&',
                'showTimeSelect': '@',
                'isUpdateTimeChoices': '=',
                'searchChoices': '='
            },
            controller: function($scope) {
            	console.log($scope.searchChoices)
                $scope.showTimeSelect = $scope.showTimeSelect || 'true';
                $scope.queryParams = {searchSelect:1};
                if ($scope.showTimeSelect == 'true') {
                    $scope.queryParams.startTime = new Date(utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd') + ' 00:00:00');
                    $scope.queryParams.endTime = new Date(utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd') + " 23:59:59");
                }
              //$scope.isUpdateTimeChoices=[{ desc: '下单时间', code: '0' }, { desc: '预约送货时间', code: '1' }];
                //console.log($scope.isUpdateTimeChoices)
                $scope.selectIsUpadate = function(choice) {
                    $scope.queryParams.isUpateTime = parseInt(choice.code);
                };
                $scope.searchSelect = function(choice) {
                    $scope.queryParams.searchSelect = parseInt(choice.code);
                    $scope.queryParams.companyName = "";
                    console.log($scope.queryParams.searchSelect)
                };
                $scope.keyPressSearch = function(e, queryParams) {
                    if (e.keyCode == 13) { //回车键
                        $scope.search({
                            queryParams: queryParams
                        });
                    }
                };
                $scope.selectWelfareCompany = function(company) {
                         $scope.queryParams.companyName= company.companyId;

                 };


            }
        };
    });
};

},{}],63:[function(require,module,exports){
module.exports = function(app) {
    app.directive('requiredInput', function() {
        return function(scope, element, attrs) {
            element.on("keyup",function(ev){
                var val = ev.target.value;
                var pEle = element.parent();
                if(val.length==0&&!pEle.hasClass('has-error')){
                	pEle.addClass('has-error');
                }else{
                	pEle.removeClass('has-error');
                }
                
            });
            

        }
    });
}

},{}],64:[function(require,module,exports){
module.exports = function(app) {
    app.directive('searchGroup', function() {
        return {
            restrict: 'E',
            templateUrl: 'directive/searchGroup.html',
            transclude: true,
            replace: true,
            scope: {
                key: '=',
                searchFn: '=',
                placeholder: '@',
                class:'@'
            },
            link: function($scope) {
                $scope.search = function(value) {
                    $scope.searchFn && $scope.searchFn.call(this, value);
                };
            }
        };
    });
};

},{}],65:[function(require,module,exports){
module.exports = function(app) {
  app.directive('sidebar', function(authService) {
    return {
      restrict: 'E',
      templateUrl: 'directive/sidebar.html',
      transclude: false,
      replace: true,
      controller: function($scope, $element, $attrs) {
        var cur;
        var curNodex;
        $scope.isLogin = authService.isLogin();
        $scope.version = window.cfg.version;
        $scope.isFolded = true;
        $scope.ports = [{
          name: '企业库',
          parent: true,
          icon: 'company',
          children: [{
            name: '企业基础信息',
            route: 'company'
          }, {
            name: '信息收集',
            route: 'information'
          }]
        }, {
          name: '商品管理',
          parent: true,
          icon: 'product',
          children: [{
            name: '货架商品',
            route: 'product'
          }, {
            name: '商品标签管理',
            route: 'labelsManagement'
          }, {
            name: '仓位管理',
            route: 'positionManage'
          }, {
            name: '新品推荐',
            route: 'newProductRecommend'
          }, {
            name: '滞销商品库',
            route: 'deadStock'
          }]
        }, {
          name: '货架管理',
          parent: true,
          icon: 'shelf',
          children: [{
            name: '企业货架管理',
            route: 'shelfManage'
          }, {
            name: '货架巡查',
            route: 'shelf'
          }]
        }, {
          name: '业务流程管理',
          parent: true,
          icon: 'business-process',
          children: [{
            name: '拣货单',
            route: 'pickOrder'
          }, {
            name: '单据中心',
            route: 'order'
          }, {
            name: '回仓单',
            route: 'inStorage'
          }, {
            name: '财务管理',
            route: 'finance',
          }, ]
        }, {
          name: '企业服务',
          parent: true,
          icon: 'enterprise-service',
          children: [{
            name: '零花钱',
            route: 'welfare'
          }, {
            name: '企业选购单',
            route: 'goodsChooseOrder'
          }]
        }, {
          name: '增值服务',
          parent: true,
          icon: 'value-added',
          children: [{
            name: '下午茶',
            route: 'teaInformation',
          }, {
            name: '节假日福利',
            route: 'holidayWelfare',
          }, {
            name: '营销商品',
            route: 'promotionProduct'
          }, {
            name: '营销商品组合',
            route: 'promotionSuite'
          }, {
            name: '营销订单',
            route: 'promotionOrder'
          }]
        }, {
          name: 'B端功能管理',
          parent: true,
          icon: 'B-client',
          children: [{
            name: '首页配置',
            route: 'template',
            icon: 'template'
          }]
        }, {
          name: 'C端功能管理',
          parent: true,
          icon: 'C-client',
          children: [{
            name: '期号实时动态',
            route: 'issueDynamic',
            icon: 'issueDynamic'
          }, {
            name: '套餐配送动态',
            route: 'suiteDistributionDynamic',
            icon: 'suiteDistributionDynamic'
          }, {
            name: '套餐配置管理',
            route: 'suiteCfgManage',
            icon: 'suiteCfgManage'
          }, {
            name: '评论管理',
            route: 'commentsManage',
            icon: 'commentsManage'
          }]
        }, {
          name: '数据统计',
          parent: true,
          icon: 'data',
          children: [{
            name: '商品营销数据',
            route: 'salesStatistics'
          }]
        }, {
          name: '账号管理',
          route: 'account',
          icon: 'account'
        }, {
          name: '信息配置',
          route: 'configurationInformation',
          icon: 'configurationInformation'
        }, {
          name: '模板管理',
          route: 'template',
          icon: 'template'
        }];
        $scope.handleLoginBtnClick = function(isLogin) {
          isLogin ? authService.exit() : (window.location.hash =
            '#/login');
        };
        $scope.active = function(options, e) {
          e && e.stopPropagation();
          var indexs = options.indexs;
          var len = indexs.length;
          var hasChildren = options.hasChildren;
          if (curNodex) {
            curNodex.active = false;
          }
          if (len <= 1) {
            cur = indexs;
            if ($scope.ports[indexs[0]]) {
              $scope.ports[indexs[0]].active = true;
              curNodex = $scope.ports[indexs[0]];
            }
          } else {
            cur = indexs;
            $scope.ports[indexs[0]].active = true;
            if ($scope.ports[indexs[0]].children[indexs[1]]) {
              $scope.ports[indexs[0]].children[indexs[1]].active =
                true;
              curNodex = $scope.ports[indexs[0]].children[indexs[1]];
            }
          }
        };
        $scope.activeParent = function(options, e) {
          e && e.stopPropagation();
          var indexs = options.indexs;
          $scope.ports[indexs[0]].active = !$scope.ports[indexs[0]].active;
        };
        $scope.fold = function() {
          angular.element(document.body).toggleClass('folded');
          $scope.isFolded = !$scope.isFolded;
        };
        //事件
        $scope.$on('sidebar.active', function(e, route) {
          var index = [];
          angular.forEach($scope.ports, function(port, idx) {
            var hasChildren = port.parent;
            var childrenRouters;
            if (hasChildren) {
              childrenRouters = _.pluck(port.children, 'route');
              i = childrenRouters.indexOf(route);
              if (i !== -1) {
                index.push(idx);
                index.push(i);
              }
            } else {
              if (route == port.route) {
                index.push(idx);
              }
            }
          });
          $scope.active({ indexs: index });
        });
      }
    };
  });
};
},{}],66:[function(require,module,exports){
module.exports = function(app) {
  app.directive('sortButton', function() {
    return {
      restrict: 'E',
      templateUrl: 'directive/sortButton.html',
      transclude: true,
      scope: {
        'title': '@', //标题
        'ascSortCode': '@', //升序代码
        'descSortCode': '@', //降序代码
        'sortCallback': '&' //排序回调
      },
      controller: function($scope) {
        $scope.descSortCode = typeof $scope.descSortCode !=
          'undefined' ?
          $scope.descSortCode : -$scope.ascSortCode;
        $scope.sort = function() {
          $scope.sortCode = $scope.sortCode == $scope.ascSortCode ?
            $scope.descSortCode : $scope.ascSortCode;
          $scope.sortCallback({
            item: {
              sortCode: $scope.sortCode
            }
          })
        };
      }
    }
  })
};
},{}],67:[function(require,module,exports){
module.exports = function(app) {
    app.directive('teaSearcher', function(utilService, CONSTANTS) {
        return {
            restrict: 'E',
            templateUrl: 'directive/teaSearcher.html',
            transclude: true,
            scope: {
                'search': '&',
                'showTimeSelect': '@',
                'isUpdateTimeChoices': '='
            },
            controller: function($scope) {
                $scope.showTimeSelect = $scope.showTimeSelect || 'true';
                $scope.queryParams = {};
                if ($scope.showTimeSelect == 'true') {
                    $scope.queryParams.startTime = new Date(utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd') + ' 00:00:00');
                    $scope.queryParams.endTime = new Date(utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd') + " 23:59:59");
                }
              //$scope.isUpdateTimeChoices=[{ desc: '下单时间', code: '0' }, { desc: '预约送货时间', code: '1' }];
                //console.log($scope.isUpdateTimeChoices)
                $scope.selectIsUpadate = function(choice) {
                    $scope.queryParams.isUpateTime = parseInt(choice.code);
                };
                $scope.keyPressSearch = function(e, queryParams) {
                    if (e.keyCode == 13) { //回车键
                        $scope.search({
                            queryParams: queryParams
                        });
                    }
                };
                $scope.selectWelfareCompany = function(company) {
                         $scope.queryParams.companyName= company.companyId;

                 };


            }
        };
    });
};

},{}],68:[function(require,module,exports){
module.exports = function(app) {
    app.directive('topSearcher', function(utilService, CONSTANTS) {
        return {
            restrict: 'E',
            templateUrl: 'directive/topSearcher.html',
            transclude: true,
            scope: {
                'search': '&',
                'showTimeSelect': '@'
            },
            controller: function($scope) {
                $scope.showTimeSelect = $scope.showTimeSelect || 'true';
                $scope.queryParams = {};
                if ($scope.showTimeSelect == 'true') {
                    $scope.queryParams.startTime = new Date(utilService.parseTimeByDateDis(new Date(), -7, 'yyyy-MM-dd') + ' 00:00:00');
                    $scope.queryParams.endTime = new Date(utilService.parseTimeByDate(new Date(), 'yyyy-MM-dd') + " 23:59:59");
                }
                $scope.isUpdateTimeChoices = CONSTANTS.getList('INVOICE_TIME_TYPE', false);
                console.log($scope.isUpdateTimeChoices)
                $scope.selectIsUpadate = function(choice) {
                    $scope.queryParams.isUpateTime = parseInt(choice.code);
                };
                $scope.keyPressSearch = function(e, queryParams) {
                    if (e.keyCode == 13) { //回车键
                        $scope.search({
                            queryParams: queryParams
                        });
                    }
                };
            }
        };
    });
};

},{}],69:[function(require,module,exports){
module.exports = function(app) {
  app.directive('uploader', function(uploadService) {
    return {
      restrict: 'E',
      templateUrl: 'directive/uploader.html',
      transclude: false,
      replace: false,
      scope: {
        value: '=',
        ngModel: '=',
        index: '=',
        uploadTitle: '@', //上传按钮的title,默认为'上传'
        hideInput: '@', //是否隐藏输入框，默认不隐藏
        didUpload: '&', //完成上传回调事件
        sizeLimit: '@', //尺寸大小限制
        isUploadUpyun: '@' //是否需要上传又拍云，默认上传
      },
      link: function($scope, $element, $attrs) {
        $scope.filenames = '';
        $scope.files = [];
        $scope.path = $attrs.path;
        $scope.uploadTitle = $scope.uploadTitle || '上传';

        $scope.changeFile = function(dom) {
          var opts = {
            file_dom: dom,
            folder: angular.element(dom).attr('path'),
            size_limit: JSON.parse($scope.sizeLimit || '{}'),
            is_upload_upyun: $scope.isUploadUpyun || 'true'
          }
          var str_dom = angular.element(dom).next().find('input');
          uploadService.upload(opts).then(function(res) {
            $scope.value = res.path;
            $scope.filenames = res.path;
            var didUpload = $scope.didUpload || function() {};
            didUpload({
              file: res
            });
          });
        };
      }
    };
  });
};
},{}],70:[function(require,module,exports){
module.exports = function(app) {
  app.directive('validFile', function() {
    return {
      require: 'ngModel',
      link: function(scope, el, attrs, ngModel) {
        el.bind('change', function() {
          scope.$apply(function() {
            ngModel.$setViewValue(el.val());
            ngModel.$render();
          });
        });
      }
    }
  });
};

},{}],71:[function(require,module,exports){
module.exports=[require("./directive/blockAdd.js"),require("./directive/companySearcher.js"),require("./directive/compileHtml.js"),require("./directive/count.js"),require("./directive/dateFormate.js"),require("./directive/datePicker.js"),require("./directive/dialog.js"),require("./directive/dropDown.js"),require("./directive/echartsLine.js"),require("./directive/fixedTableHeaders.js"),require("./directive/formRequired.js"),require("./directive/labelsManagements.js"),require("./directive/login.js"),require("./directive/mdImg.js"),require("./directive/mdUploader.js"),require("./directive/module.js"),require("./directive/msStepper.js"),require("./directive/msStepperStep.js"),require("./directive/navigator.js"),require("./directive/newUsers.js"),require("./directive/onFinishRenderFilters.js"),require("./directive/panel.js"),require("./directive/permissions.js"),require("./directive/productSearcher.js"),require("./directive/promotion.js"),require("./directive/requiredInput.js"),require("./directive/searchGroup.js"),require("./directive/sidebar.js"),require("./directive/sortButton.js"),require("./directive/teaSearcher.js"),require("./directive/topSearcher.js"),require("./directive/uploader.js"),require("./directive/validFileInput.js")]
},{"./directive/blockAdd.js":38,"./directive/companySearcher.js":39,"./directive/compileHtml.js":40,"./directive/count.js":41,"./directive/dateFormate.js":42,"./directive/datePicker.js":43,"./directive/dialog.js":44,"./directive/dropDown.js":45,"./directive/echartsLine.js":46,"./directive/fixedTableHeaders.js":47,"./directive/formRequired.js":48,"./directive/labelsManagements.js":49,"./directive/login.js":50,"./directive/mdImg.js":51,"./directive/mdUploader.js":52,"./directive/module.js":53,"./directive/msStepper.js":54,"./directive/msStepperStep.js":55,"./directive/navigator.js":56,"./directive/newUsers.js":57,"./directive/onFinishRenderFilters.js":58,"./directive/panel.js":59,"./directive/permissions.js":60,"./directive/productSearcher.js":61,"./directive/promotion.js":62,"./directive/requiredInput.js":63,"./directive/searchGroup.js":64,"./directive/sidebar.js":65,"./directive/sortButton.js":66,"./directive/teaSearcher.js":67,"./directive/topSearcher.js":68,"./directive/uploader.js":69,"./directive/validFileInput.js":70}],72:[function(require,module,exports){
module.exports = function(app) {
    app.filter('desc', function(CONSTANTS) {
        return function(value, field) {
            var f = CONSTANTS[field];
            var descs = f && f.DESC;
            return descs && descs[value] || '';
        }
    });
}

},{}],73:[function(require,module,exports){
module.exports = function(app) {
    app.filter('img', function(CONSTANTS) {
        return function(path) {
            return window.cfg.picUrl+path;
        }
    });
}

},{}],74:[function(require,module,exports){
module.exports = function(app) {
    app.filter('int', function() {
        return function(data, fields) {
    		var r=data;
    		angular.forEach(fields,function(field){
    			var fs=field.split('.');
    			var len=fs.length;
    			var lsf=fs[fs.length-1];
    			var t=data;
    			for(var i=0;i<len-1;i++){
    				t=t[fs[i]];
    			}
    			t[lsf]=parseInt(t[lsf]);
    		});
    		return r;
        }
    });
}

},{}],75:[function(require,module,exports){
module.exports = function(app) {
    app.filter('points', function() {
        return function(amt) {
            return parseInt((amt*100).toFixed(0)); 
        }
    });
}

},{}],76:[function(require,module,exports){
module.exports = function(app) {
	app.filter('rmb', function() {
		return function(amt) {
			if (isNaN(parseInt(amt))) {
				return amt
			} else {
				return amt ? (parseInt(amt / 100) + '.' + parseInt((amt / 10) % 10) +
					parseInt(amt % 10)) : '0';
			}

		}
	});
}

},{}],77:[function(require,module,exports){
module.exports = function(app) {
    app.filter('selection', function(CONSTANTS) {
        return function(field, hasDefault, codeKey, valueKey, defaultObj, isCodeNum) {
            if (Object.prototype.toString.call(field) == '[object Object]') {
                var codeKey = field.codeKey;
                var hasDefault = field.hasDefault;
                var valueKey = field.valueKey;
                var defaultObj = field.defaultObj;
                var isCodeNum = field.isCodeNuml;
                var clsOrName = field.clsOrName;
            } else {
                var clsOrName = field;
            }
            return CONSTANTS.getList(clsOrName, hasDefault, codeKey, valueKey, defaultObj, isCodeNum);
        }
    });
}

},{}],78:[function(require,module,exports){
module.exports = function(app) {
    app.filter('style', function(CONSTANTS) {
        return function(value, field) {
            var f = CONSTANTS[field];
            var descs = f && f.STYLE;
            return descs && descs[value] || '';
        }
    });
}

},{}],79:[function(require,module,exports){
module.exports = function(app) {
    app.filter('value', function(CONSTANTS) {
        return function(value, field, isValueNum) {
            var f = CONSTANTS[field];
            var descs = f && f.DESC;
            var result;
            angular.forEach(descs, function(va, key) {
                if (value == va) {
                    result = key;
                }
            });
            return parseInt(result);
        }
    });
}

},{}],80:[function(require,module,exports){
module.exports = function(app) {
    app.filter('week', function(CONSTANTS) {
        return function(value, field) {
            var f = CONSTANTS[field];
            var descs = f && f.STYLE;
            return descs && descs[value] || '';
        }
    });
}

},{}],81:[function(require,module,exports){
module.exports=[require("./filter/desc.js"),require("./filter/img.js"),require("./filter/int.js"),require("./filter/points.js"),require("./filter/rmb.js"),require("./filter/selection.js"),require("./filter/style.js"),require("./filter/value.js"),require("./filter/week.js")]
},{"./filter/desc.js":72,"./filter/img.js":73,"./filter/int.js":74,"./filter/points.js":75,"./filter/rmb.js":76,"./filter/selection.js":77,"./filter/style.js":78,"./filter/value.js":79,"./filter/week.js":80}],82:[function(require,module,exports){
;
(function() {
  var angular = window.angular;
  var app = angular.module('app', ['ngRoute', 'ngCookies', 'ngTable',
    'templateBundle', 'ui.bootstrap', 'ui.router', 'ui.tree',
    'isteven-multi-select', 'ngAnimate', 'ngAria', 'ngMaterial',
    'ngSanitize', 'ngMessages', 'infinite-scroll'
  ]).config([
    '$compileProvider', '$mdThemingProvider',
    function($compileProvider, $mdThemingProvider) {
      $compileProvider.aHrefSanitizationWhitelist(
        /^\s*(https?|ftp|mailto|file|data):/);
      $mdThemingProvider.theme("default").primaryPalette("blue").accentPalette(
        "light-blue").warnPalette("deep-orange").backgroundPalette(
        "grey");
    }
  ]);
  var routers = require('./routers.js');
  var services = require('./services.js');
  var directives = require('./directives.js');
  var constants = require('./constants.js');
  var controllers = require('./controllers.js');
  var filters = require('./filters.js');
  //注册router
  app.config(['$routeProvider', function($routeProvider) {
    angular.forEach(routers, function(route) {
      $routeProvider.when('/' + route.path, route);
    });
    $routeProvider.otherwise({
      redirectTo: '/home'
    });
  }]);
  // app.config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
  //     angular.forEach(routers, function(route) {
  //         var cfg = {
  //             url: '/' + route.path,
  //             views: {}
  //         };
  //         cfg.views[route.name] = {
  //             templateUrl: route.templateUrl
  //         };
  //         $stateProvider.state(route.name, cfg);
  //     });
  //     $urlRouterProvider.otherwise('/home');
  // }]);
  //注册constant
  angular.forEach(filters, function(fn) {
    fn.call(this, app);
  });
  //注册constant
  angular.forEach(constants, function(value, key) {
    app.constant(key, value);
  });
  //注册的service
  angular.forEach(services, function(fn) {
    fn.call(this, app);
  });
  //批量注册direcives
  angular.forEach(directives, function(fn) {
    fn.call(this, app);
  });
  //注册的controller
  angular.forEach(controllers, function(fn) {
    try {
      fn.call(this, app);
    } catch (e) {}

  });
}());
// app.run(function($rootScope) {
//     $rootScope.$on('$stateChangeStart', function(event, toState, toParams, fromState, fromParams) {
//     });
// });
},{"./constants.js":1,"./controllers.js":37,"./directives.js":71,"./filters.js":81,"./routers.js":83,"./services.js":115}],83:[function(require,module,exports){
module.exports = [{
  name: 'home',
  path: 'home',
  templateUrl: 'home/home.html'
}, {
  name: 'company',
  path: 'company',
  templateUrl: 'company/company.html'
}, {
  name: 'shelf',
  path: 'shelf',
  templateUrl: 'shelf/shelfPatrol.html'
}, {
  name: 'shelfManage',
  path: 'shelfManage',
  templateUrl: 'shelfmanage/shelfManage.html'
}, {
  name: 'order',
  path: 'order',
  templateUrl: 'order/order.html'
}, {
  name: 'pickOrder',
  path: 'pickOrder',
  templateUrl: 'pickOrder/pickOrder.html'
}, {
  name: 'goodsChooseOrder',
  path: 'goodsChooseOrder',
  templateUrl: 'goodsChooseOrder/goodsChooseOrder.html'
}, {
  name: 'goodsChooseHistory',
  path: 'goodsChooseHistory',
  templateUrl: 'goodsChooseOrder/goodsChooseHistory.html'
}, {
  name: 'deliveryEdit',
  path: 'deliveryEdit/:orderId',
  templateUrl: 'pickOrder/deliveryEdit.html'
}, {
  name: 'deliveryEdit2',
  path: 'deliveryEdit/:orderId/:goodsChooseOrderId',
  templateUrl: 'pickOrder/deliveryEdit.html'
}, {
  name: 'account',
  path: 'account',
  templateUrl: 'account/account.html'
}, {
  name: 'role',
  path: 'role',
  templateUrl: 'account/role.html',
  controller: 'RoleCtrl'
}, {
  name: 'inStorage',
  path: 'inStorage',
  templateUrl: 'inStorage/inStorage.html'
}, {
  name: 'product',
  path: 'product',
  templateUrl: 'product/product.html'
}, {
  name: 'salesStatistics',
  path: 'salesStatistics',
  templateUrl: 'dataStatistics/salesStatistics.html'
}, {
  name: 'promotionProduct',
  path: 'promotionProduct',
  templateUrl: 'promotion/promotionProduct.html'
}, {
  name: 'promotionSuite',
  path: 'promotionSuite',
  templateUrl: 'promotion/promotionSuite.html'
}, {
  name: 'shelfdetail',
  path: 'shelf/:companyId',
  templateUrl: 'shelf/shelfDetail.html'
}, {
  name: 'information',
  path: 'information',
  templateUrl: 'information/information.html'
}, {
  name: 'labelsManagement',
  path: 'labelsManagement',
  templateUrl: 'labelsManagement/labelsManagement.html'
}, {
  name: 'welfare',
  path: 'welfare',
  templateUrl: 'welfare/welfare.html'
}, {
  name: 'positionManage',
  path: 'positionManage',
  templateUrl: 'positionManage/positionManage.html'
}, {
  name: 'finance',
  path: 'finance',
  templateUrl: 'finance/finance.html'
}, {
  name: 'configurationInformation',
  path: 'configurationInformation',
  templateUrl: 'configurationInformation/configurationInformation.html'
}, {
  name: 'holidayWelfare',
  path: 'holidayWelfare',
  templateUrl: 'holidayWelfare/holidayWelfare.html'
}, {
  name: 'teaInformation',
  path: 'teaInformation',
  templateUrl: 'teaInformation/teaInformation.html'
}, {
  name: 'promotionOrder',
  path: 'promotionOrder',
  templateUrl: 'promotion/promotionOrder.html'
}, {
  name: 'issueDynamic',
  path: 'issueDynamic',
  templateUrl: 'suite/issueDynamic.html'
}, {
  name: 'suiteDistributionDynamic',
  path: 'suiteDistributionDynamic',
  templateUrl: 'suite/suiteDistributionDynamic.html'
}, {
  name: 'suiteCfgManage',
  path: 'suiteCfgManage',
  templateUrl: 'suite/suiteCfgManage.html'
}, {
  name: 'commentsManage',
  path: 'commentsManage',
  templateUrl: 'suite/commentsManage.html'
}, {
  name: 'template',
  path: 'template',
  templateUrl: 'template/template.html'
}, {
  name: 'templateEdit',
  path: 'templateEdit',
  templateUrl: 'template/templateEdit.html'
}, {
  name: 'templateEdit',
  path: 'templateEdit/:templateId',
  templateUrl: 'template/templateEdit.html'
}, {
  name: 'deadStock',
  path: 'deadStock',
  templateUrl: 'deadStock/deadStock.html'
}, {
  name: 'newProductRecommend',
  path: 'newProductRecommend',
  templateUrl: 'product/newProductRecommend.html'
}];
},{}],84:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 16/6/27.
 */
module.exports = function(app) {
  app.service('accountService', ['xhrService', '$q', function(xhrService, $q) {

    this._parseAccountData = function(data) {
      //拷贝一份，保持数据源不变
      var temp = [];
      angular.forEach(data, function(item, index) {
        var t = angular.copy(item);
        t.index = index;
        temp.push(t);
      });
      return temp;
    };

    /*进入账户管理页时,显示所有数据*/
    this.findAllManager = function(params, offset, limit) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      var str = '?offset=' + offset + '&limit=' + limit;
      xhrService.Get({
        path: 'manager' + str,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    this.indexAccount = function(data, offset) {
      angular.forEach(data, function(item, index) {
        item.index = index + offset;
      });
      return data;
    };

    /*新增用户*/
    this.createManager = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'manager',
        /*原接口: manager/manage/createManager*/
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        toastError: true // 用toast替代默认的dialog来显示错误消息
      });
      return promise;
    };

    /* 编辑用户*/
    this.modifyManager = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: "manager/" + params.id,
        /*原接口:manager/manage/modifyManager*/
        params: _.omit(params, 'id'), // _.omit :只过滤出除去keys(有效的键组成的数组)参数指定的属性值
        success: function(res) {
          deferred.resolve(res);
        },
        toastError: true
      });
      return promise;

    };

    /*删除用户*/
    this.deleteManager = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'manager/' + params.id,
        /*原接口:manager/manage/removeManager*/
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    this.loadSupervisors = function() {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'manager/supervisors',
          success: function(res) {
            resolve(res);
          }
        });
      });
    };

    this.loadSelf = function() {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'manager/self',
          success: function(res) {
            resolve(res);
          }
        });
      });
    };

    this.loadAccount = function(id) {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'manager/' + id,
          success: function(res) {
            resolve(res);
          }
        });
      });
    };

    this.searchName = function(name) {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'manager/search?name=' + name,
          success: function(res) {
            resolve(res);
          }
        });
      });
    };

    this.downloadExcel = function() {
      return $q(function(resolve) {
        xhrService.Get({
          headers: {
            Accept: 'application/octet-stream'
          },
          path: 'permission/export',
          responseType: 'arraybuffer',
          dataType: 'arraybuffer',
          success: function(res) {
            resolve(res);
          }
        });
      })
    };

    this.uploadPermissions = function(comment, file) {
      var fileEx = file.name.split('.').pop();
      var formData = new FormData();
      formData.append('comment', comment);
      formData.append('file', file);
      formData.append('workbookType', fileEx == 'xls' ? 'HSSF' : 'XSSF');
      return $q(function(resolve) {
        xhrService.Upload({
          path: 'permission',
          params: formData,
          success: function(res) {
            resolve(res);
          }
        });
      });
    };

    this.uploadPermissionGroups = function(comment, file) {
      var fileEx = file.name.split('.').pop();
      var formData = new FormData();
      formData.append('comment', comment);
      formData.append('file', file);
      formData.append('workbookType', fileEx == 'xls' ? 'HSSF' : 'XSSF');
      return $q(function(resolve) {
        xhrService.Upload({
          path: 'permission/group',
          params: formData,
          success: function(res) {
            resolve(res);
          }
        });
      });
    };
  }]);
};

},{}],85:[function(require,module,exports){
module.exports = function(app) {
    app.service('authService', ['xhrService', '$q', 'cacheService', function(xhrService, $q, cacheService) {
        //接口
        /*登陆
         *@Params
         *username
         *psw
         */
        this.login = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Post({
                path: 'auth/login',
                params: params,
                success: function(res, status, headers) {
                    var auth = headers('Authorization');
                    cacheService.setSession(auth);
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        this.exit = function() {
            cacheService.setSession('');
            window.location.reload();
        };
        this.isLogin = function() {
            return cacheService.getSession() ? true : false;
        };
    }]);
};

},{}],86:[function(require,module,exports){
/*
 *cacheService
 */
/*键
 *tk  token
 */

module.exports = function(app) {
    app.service('cacheService', function($cookies) {
        var CONSTANT = {
            SESSION: 'crm_s'
        };
        this.getItem = function(key) {
            return $cookies.get(key);
        };
        this.setItem = function(key, value) {
            return $cookies.put(key, value);
        };
        this.removeItem = function(key) {
            $cookies.remove(key);
        };
        this.getSession = function() {
            return this.getItem(CONSTANT.SESSION);
        };
        this.setSession = function(value) {
            this.setItem(CONSTANT.SESSION, value);
        };
    });
};

},{}],87:[function(require,module,exports){
/*
 *companyService
 */
module.exports = function(app) {
  app.service('companyService', ['xhrService', '$q', function(xhrService, $q) {
    var me = this;
    this.companyList = [];
    this.CompanyModel = [{
      name: 'companyId'
    }, {
      name: 'staffNum'
    }, {
      name: 'companyName'
    }, {
      name: 'shelfType'
    }, {
      name: 'des'
    }, {
      name: 'address'
    }, {
      name: 'limitFee'
    }, {
      name: 'contacts',
      model: 'ContactModel'
    }, {
      name: 'lng'
    }, {
      name: 'lat'
    }, {
      name: 'status'
    }, {
      name: 'followPeople'
    }, {
      name: 'sendWeek'
    }, {
      name: 'superAdmin'
    }, {
      name: 'pickingType'
    }, {
      name: 'pickingRemark'
    }, {
      name: 'customerType'
    }];
    this.ContactModel = [{
      name: 'id'
    }, {
      name: 'mobile'
    }, {
      name: 'companyId'
    }, {
      name: 'tel'
    }, {
      name: 'qq'
    }, {
      name: 'wechat'
    }, {
      name: 'contactName'
    }];
    this.formate = function(modelname, data) {
      var result;
      var me = this;
      me.recursion = arguments.callee;
      var u = function(item) {
        var obj = {};
        var temp = _.omit(item, function(value, key) {
          var mdname;
          var r = true;
          var index = _.pluck(me[modelname], 'name').indexOf(
            key);
          if (index !== -1) {
            mdname = me[modelname][index].model;
            mdname ? obj[key] = me.recursion(mdname, value) :
              false;
            r = false;
          }
          return r;
        });
        return angular.extend(temp, obj);
      };
      if (Object.prototype.toString.call(data) == '[object Array]') {
        result = [];
        angular.forEach(data, function(item) {
          result.push(u(item));
        });
      } else {
        result = u(data);
      }
      console.log(result);
      return result;
    };
    this.indexCompany = function(data, offset) {
      angular.forEach(data, function(item, index) {
        item.index = index + offset;
      });
      return data;
    };
    this.parseCompanyList = function(data, offset) {
      angular.forEach(data, function(item, index) {
        item.index = index + offset;
        item.lastContact = item.contacts[item.contacts.length -
          1];
      });
      return data;
    };
    //接口
    /*获取公司列表
    offset(条目偏移)
    limit(当前页显示数据个数)
    isDeleted(0:未删除 1:已删除 不传返回所有)
    companyName(无值可不传)
    address(无值可不传)
    */
    this.queryCompanyList = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      params.isDeleted = 0;
      xhrService.Post({
        path: 'company/_query',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*获取公司信息
     *@Params
     *companyId
     */
    this.queryCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/' + params.companyId,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*创建公司
     *@Params
     *companyName //公司名称
     *staffNum //企业员工数
     *shelfType //企业类型,1:企业总包；2:员工自费
     *address //企业地址
     *des //企业描述
     *limitFee//企业折扣上限
     *contacts {companyId,contactName,mobile,qq,wechat,tel}//企业联系人列表
     */
    this.createCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company',
        params: me.formate('CompanyModel', params),
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*修改公司
     *@Params
     *companyId
     *companyName
     *staffNum
     *shelfType
     *address
     *des
     */
    this.editCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;

      xhrService.Put({
        path: 'company',
        params: me.formate('CompanyModel', params),
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*获取企业溢价状态
     *companyId
     */
    this.queryCompanyPremiumState = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'premium/company/' + params.companyId,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*设置企业溢价
     *companyId
     */
    this.setCompanyPremium = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'premium',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /*添加企业联系人
     *@Params
     *companyId
     *contactName
     *mobile
     *qq
     *wechat
     *tel
     */
    this.addCompanyContact = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/contact',
        params: me.formate('ContactModel', params),
        floatToString: true,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*修改企业联系人
     *@Params
     *id
     *companyId
     *contactName
     *mobile
     *qq
     *wechat
     *tel
     */
    this.editCompanyContact = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'company/contact',
        params: me.formate('ContactModel', params),
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*删除企业联系人
     *@Params
     *contactId
     */
    this.deleteCompanyContact = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'company/contact' + '?contactId=' + params.contactId,
        params: {},
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /*新建企业信息
     *@Params
     *companyId
     *info
     */
    this.createCompanyInformation = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/survey',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;

    };
    /*获取企业信息列表
     *@Params
     *companyId
     */
    this.queryCompanyInformation = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/survey',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*重置企业密码
     *@Params
     *companyId
     */
    this.resetCompanyPassword = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'company/manager',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*企业状态变更日志
     *companyId
     */
    this.queryCompanyStateChangeLog = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/status/log/find_list',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*获取公司情报概览
     *@Params
     *companyId
     */
    this.queryCompanyPreferSummary = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/survey/summary',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*创建公司情报概览
     *@Params
     *companyId
     *info
     */
    this.createCompanyPreferSummary = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/survey/summary',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*创建/修改企业坏账抵扣
     *companyId
     *change
     */
    this.setCompanyDeduction = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'deduction/company/' + params.companyId,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*查询企业坏账抵扣信息
     *companyId
     */
    this.queryCompanyDeduction = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'deduction/company/' + params.companyId,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*查询企业坏账余额流水
     *companyId
     *offset
     *limit
     */
    this.queryCompanyDeductionFlow = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'deduction/company/' + params.companyId + '/logs',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    // 黑名单列表
    this.getBlockCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/blacklist/' + params.companyId,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    this.getZeroProduct = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/zerosell/' + params.companyId,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    // 添加黑名单
    this.addBlockCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/blacklist/',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    // 修改黑名单
    this.modifyBlockCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'company/blacklist/',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    //删除黑名单
    this.deleteBlockCompany = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'company/blacklist/' + params.id,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

  }]);
};
},{}],88:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 2016/10/19.
 */
module.exports = function (app) {
    app.service('configurationInformationService', ['xhrService', '$q', function (xhrService, $q) {

        /**
         * CRM信息配置 - 零花钱基数#
         * 接口名 /info/config/pocket_money
         * 请求方法 PUT
         * 请求参数 : totalFee  零花钱校验值   int类型
         */
        this.pocketMoneyAudit = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'info/config/pocket_money',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * CRM信息配置 - 零花钱基数 -- 获取默认的零花钱基数
         * 接口名 info/config/money_base
         * 请求方法 GET
         */
        this.getPocketMoneyAudit = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'info/config/money_base',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * CRM信息配置 - 想要商品爱心跳动时间配置
         * 接口名 /info/config/heart_show
         * 请求方法 PUT
         * 请求参数: showTime  int类型
         */
        this.wishListConfiguration = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'info/config/heart_show',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };


        /**
         * CRM信息配置 - 获取  想要商品爱心跳动时间配置
         * 接口名 info/config/heart_base
         * 请求方法 GET
         */
        this.getWishListConfiguration = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'info/config/heart_base',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         *  CRM信息配置 - 营销商品/组合定金额度
         *  接口名 company/promotion/config/deposit
         *  请求方法 Get
         */
        this.getMarketingActivitiesDepositInfo = function () {
            // debugger
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/promotion/config/deposit',
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        this.marketingActivitiesDepositInfo = function (params) {
            // debugger
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/promotion/config/deposit/' + params,
                // params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * CRM信息配置 - 获取选购单上限#
         * 接口名 /info/config/manager_order
         * 请求方法 GET
         */
        this.getChooseOrderInfoCeiling = function () {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'info/config/manager_order',
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * CRM信息配置 - 创建/修改选购上限值#
         * 接口名 /info/config/manager_order
         * 请求方法 POST
         * 请求参数: id   limitNum   shelfNumType
         */
        this.createChooseOrderInfo = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'info/config/manager_order',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        }
    }]);
};

},{}],89:[function(require,module,exports){
//productService
module.exports = function(app) {
  app.service('deadStockService', ['xhrService', '$q', '$filter', 'CONSTANTS',
    function(xhrService, $q, $filter, CONSTANTS) {
      this.query = function(url, type, params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService[type]({
          path: url,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*
       *查询滞销商品
       *{
       *productName
       *}
       */
      this.getDeadStockProductList = function(params) {
        return this.query('product/unsalable/_query', 'Post', params);
      };
      /*
       *删除滞销商品
       *{productId
       *}
       */
      this.removeDeadStockProduct = function(params) {
        return this.query('product/unsalable/del/'+params.productId, 'Delete', params);
      };


    }
  ]);
};

},{}],90:[function(require,module,exports){
/*
 *dialogService
 */
module.exports = function(app) {
  app.service('dialogService', ['$mdDialog', '$q', function($mdDialog, $q) {
    this.alert = function() {};
    this.confirm = function() {};
  }]);
};
},{}],91:[function(require,module,exports){
/*
 *companyService
 */
module.exports = function(app) {
    app.service('financeService', ['xhrService', '$q', '$filter', function(xhrService, $q, $filter) {
        /*财务列表
         *companyId
         *financeStartTime
         *financeEndTime
         *orderStates
         *isInvoice
         *isUpdateTime
         */
        this.queryFinanceList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            params.financeStartTime && (params.financeStartTime = params.financeStartTime.getTime());
            params.financeEndTime && (params.financeEndTime = params.financeEndTime.getTime());
            xhrService.Get({
                path: 'logistics/order/settlement/finance/findList',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*财务结算单开票
         *
         */
        this.createInvoice = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            params.invoiceFee = $filter('points')(params.invoiceFee);
            params.expressCompany = params.expressCompany.desc || params.expressCompany;
            xhrService.Put({
                path: 'logistics/order/settlement/finance/invoice',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*结算单确认收款
         *
         */
        this.confirmPayment = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            params.receiveFee = $filter('points')(params.receiveFee);
            params.dueFee = $filter('points')(params.dueFee);
            params.badDebtFee = $filter('points')(params.badDebtFee);
            var d = new Date(params.receiveFeeTime);
            var s = new Date(params.receiveFeeTimeHour);
            d.setHours(s.getHours());
            d.setMinutes(s.getMinutes());
            d.setSeconds(s.getSeconds());
            params.receiveFeeTime = d.getTime();
            xhrService.Put({
                path: 'logistics/order/settlement/finance/confirmPayment',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
    }]);
};

},{}],92:[function(require,module,exports){
module.exports = function(app) {
    app.service('goodsChooseService', ['xhrService', '$q', function(xhrService, $q) {
        /*分页查询选购单列表
        *offset R
        limit R
        companyId
        startTime
        endTime
        orderStates
        */
        this.queryManagerOrderList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'managerorder/orders',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*查询行政选购单明细
         *orderId
         */
        this.queryManagerOrderDetail = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'managerorder/' + params.orderId,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*修改行政选购单状态
        *orderId
        *orderState
        */
        this.modifyOrderState = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'managerorder/'+params.orderId+'/state',
                params:{
                    orderState:params.orderState,
                    optRecord:params.optRecord
                },
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
    }]);
}

},{}],93:[function(require,module,exports){
/**
 *
 */
module.exports = function (app) {
    app.service('holidayWelfareService', ['xhrService', '$q', '$filter', 'CONSTANTS', function (xhrService, $q, $filter, CONSTANTS) {

        /**
         * 显示待付款状态的订单 不显示支付方式
         */
        this.parseData = function (data) {
            // debugger
            var t = angular.copy(data);
            angular.forEach(t, function (order) {
                if (order.order.status == CONSTANTS.ORDER_STATUS.CANCEL) {
                    order.order.payChannel = '';
                }
                /*if (order.order.payChannel == CONSTANTS.PAYMENT_STATUS.WECHAT_PAY || order.order.payChannel == CONSTANTS.PAYMENT_STATUS.WECHAT_APP) {
                    order.order.status = CONSTANTS.ORDER_STATUS.WAITING_DISTRIBUTION;
                }*/
            });
            return t;
        };


        /**
         * 获取所有节假日福利订单
         */
        this.getAllWelfareOrders = function (params) {
            // debugger
            var deferred = $q.defer();
            var promise = deferred.promise;
            if(params.type){//获取默认
                // debugger
                params.endTime =  $filter('date')(params.endTime, 'yyyy-MM-dd HH:mm:ss');
                params.startTime = $filter('date')(params.startTime, 'yyyy-MM-dd HH:mm:ss');
                delete params.type;
            } else{
            }
            // params.limit=25;
            xhrService.Get({
                path: 'company/holiday/order/page',
                params: params,
                // remote:'holiday',
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /**
         * 明细 --> 备注 接口
         */
        this.setNotes = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/holiday/order/notes',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         *  取消订单
         *  params : id
         */
        this.cancelOrder = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/holiday/order/cancel',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 收到款项
         */
        this.receivePayment = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/holiday/order/confirm',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 完成配送
         */
        this.completeDelivery = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/holiday/order/finish',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 获取默认的(预定时间、热卖时间、结束时间)
         */
        this.getHolidayDefaultTime = function () {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'holiday/period/default',
                // params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 更新(预定时间、热卖时间、结束时间)
         */
        this.updateHolidayTime = function (params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'holiday/period/update',
                params: params,
                success: function (res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
    }]);
};
},{}],94:[function(require,module,exports){
//inStorageService
module.exports = function(app) {
    app.service('inStorageService', ['xhrService', '$q', function(xhrService, $q) {
        /*
         *获取回仓单列表
         */
        this.getInStorageList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                // path: 'company/stock/query?pageNo=' + params.pageNo,
                path: 'logistics/order/backstock/findList',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /**
         * 获取回仓单详情
         */
        this.getInStorageDetail = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                // path: 'company/stock/detail',
                path: 'logistics/order/backstock/' + params.orderId,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*
         * 获取管理员列表
         */
        this.getAllManager = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'manager',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /**
         * 修改回仓单信息
         */
        this.updateInStorageDetail = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'logistics/order/backstock',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
    }]);
};
},{}],95:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 16/8/4.
 */
module.exports = function(app) {
    app.service('labelsManagementService', ['xhrService', '$q', function(xhrService, $q) {
        /*获取所有标签
        */
        this.getAllLabelList = function() {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/label/find_all_list',
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /**
         * 商品标签 - 列表查询
         * 接口名 /company/label
         * 请求方法 GET
         * 请求参数: labelName   offset  limit
         */
        this.getLabelsList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/label/find_name_list',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 创建商品标签名称
         * 接口名 /company/label/create_name
         * 请求方法 POST
         * 请求参数: type  name   remark
         */
        this.createLabelsName = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Post({
                path: 'company/label/create_name',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 查看商品标签名称明细
         * 接口名 /company/label/这里传labelId
         * 请求方法 GET
         * 请求参数: labelId
         */
        this.getLabelsDetails = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/label/' + params.labelId,
                /*params: params,*/
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 修改商品标签名称
         * 接口名 /company/label/modify_name
         * 请求方法 PUT
         * 请求参数: id  type   name   remark
         */
        this.modifylabelsName = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/label/modify_name',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 删除商品标签名称
         * 接口名 /company/label/delete_name/这里填写labelId
         * 请求方法 DELETE
         * 请求参数: id
         */
        this.deleteCommodityLabelName = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Delete({
                path: 'company/label/delete_name/' + params.id,
                /*params: params,*/
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 获取标签类型列表
         * 接口名 /company/label/find_type_list
         * 请求方法 GET
         * 请求参数 : 无
         */
        this.obtainLabelTypeList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/label/find_type_list',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 创建标签类型
         * 接口名 /company/label/create_type
         * 请求方法 POST
         * 请求参数: type
         */
        this.createLabelsType = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Post({
                path: 'company/label/create_type',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };


        /**
         * 商品标签 - 更新标签类型
         * 接口名 /company/label/modify_type
         * 请求方法 PUT
         * 请求参数: id  type
         */
        this.updateLabelType = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/label/modify_type',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };

        /**
         * 商品标签 - 删除标签类型
         * 接口名 /company/label/delete_type/这里填写labelId
         * 请求方法 DELETE
         * 请求参数: id
         */
        this.deleteLabelType = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Delete({
                path: 'company/label/delete_type/' + params.id,
                /*params: params,*/
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
    }]);
};
},{}],96:[function(require,module,exports){
module.exports = function(app) {
    app.service('loaddingService', [ function() {
        var el = $('#loadding');
        el.on('click',function(e){
        	e.stopPropagation();
        	e.preventDefault();
        });
        this.show = function() {
            el.removeClass('hidden');
        };
        this.hide = function() {
            el.addClass('hidden');
        };
    }]);
};

},{}],97:[function(require,module,exports){
module.exports = function(app) {
  app.service('modalService', ['$uibModal', function($uibModal) {
    this.initModal = function(opts) {
      var config = angular.extend({
        templateUrl: opts.templateUrl || 'modelcontent', //指向上面创建的视图
        size: opts.size || '',
        backdrop: 'static',
        controller: function($scope) {
          //确定  取消
          $scope.confirm = function() {
            var me = this;
            if (opts.ok) { //关闭
              opts.ok.call(this, $scope).then(function() {
                me.$close() || me.modal.close();
              });
            } else if ($scope.ok) {
              $scope.ok.apply(this, [$scope]);
            } else { //不关闭

            }
          };
          $scope.cancel = function() {
            this.$close() || this.modal.close();
          };
        }
      }, opts);
      return $uibModal.open(config);
    };
  }]);
};
},{}],98:[function(require,module,exports){
//productService
module.exports = function(app) {
  app.service('newProductService', ['xhrService', '$q', function(
    xhrService, $q) {
    this.indexData = function(data, offset) {
      angular.forEach(data, function(item, index) {
        item.index = index + offset;
      });
      return data
    };

    // 查找新品表
    this.queryProductByKey = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'product/recommend/_query',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    //查看商品详情
    this.getProductById = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'product/' + params.id,
        params: params,
        success: function(res) {
          console.log($filter('int')(res, ['header.stock']))
          deferred.resolve($filter('int')(res, ['header.stock']));
        }
      });
      return promise;
    };

    // 修改新品推荐状态：推荐状态值 1:推荐中 2:待推荐
    this.changeNewProductStatus = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'product/recommend/changeState',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    //删除新品推荐
    this.deleteNewProduct = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'product/recommend/del/' + params.id,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    // 获取所有商品的数据，用于添加新品的对话框
    this.queryAllProduct = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'product/_query',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    // 确认添加新品
    this.addNewProducts = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      console.log('!!!!!! addNewProducts', params)
      xhrService.Post({
        path: 'product/recommend/add',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*
     *除当前货架上的其他商品
     */
    this._parseOtherShelfProducts = function(data, selectedIdList) {
      var temp = [];
      angular.forEach(data, function(item, i) {
        var t = angular.copy(item.header);
        t.positions = item.positions;
        if (selectedIdList.indexOf(item.header.id) > -1) {
          t.select = true;
        }
        t.categoryName = item.category.categoryName;
        temp.push(t);

      });
      return temp;
    };
  }]);
};

},{}],99:[function(require,module,exports){
module.exports = function(app) {
  app.service('orderService', ['xhrService', 'CONSTANTS', '$q', 'utilService',
    'modalService', '$compile', '$templateCache', 'printService',
    'suiteService',
    function(xhrService, CONSTANTS, $q, utilService, modalService,
      $compile, $templateCache, printService, suiteService) {
      var ORDER_TYPE = CONSTANTS.ORDER_TYPE;
      var PRODUCT_FROM_TYPE = CONSTANTS.PICK_PRODUCT_FROM_TYPE;
      var me = this;
      //服务
      /*结算单详情数据转换
       */
      this._parseSettlementDetailData = function(data) {
        var t = angular.copy(data);
        var opItems = [];
        angular.forEach(data.inventoryOrders, function(inventoryOrder,
          j) {
          angular.forEach(inventoryOrder.deliveryOrders, function(
            deliveryOrder, a) {
            var opItem = {
              opTime: deliveryOrder.updateTime,
              shelfName: deliveryOrder.shelfName,
              deliveryOrderFee: deliveryOrder.orderFee
            };
            opItems.push(opItem);
          });
          angular.forEach(inventoryOrder.returnOrders, function(
            returnOrder, b) {
            var opItem = {
              opTime: returnOrder.updateTime,
              shelfName: returnOrder.shelfName,
              returnOrderFee: returnOrder.orderFee
            };
            opItems.push(opItem);
          });
          if (inventoryOrder.orderFee || inventoryOrder.paidFee ||
            inventoryOrder.discountFee || inventoryOrder.premiumFee
          ) {
            var inventoryOpItem = {
              opTime: inventoryOrder.endTime,
              shelfName: inventoryOrder.shelfName,
              inventoryOrderFee: inventoryOrder.orderFee,
              inventoryPaidFee: inventoryOrder.paidFee,
              inventoryDiscountFee: inventoryOrder.discountFee,
              premiumFee: inventoryOrder.premiumFee
            };
            opItems.push(inventoryOpItem);
          }
        });
        t.opItems = opItems;
        var maxColNum = 8;
        t.tbColNum = t.premiumFee ? maxColNum : maxColNum - 1;
        var shouldPayDesc = (t.orderFee - t.orderDiscount) / 100.0 +
          '元';
        if (t.orderDiscount || t.pocketMoneyFee) {
          shouldPayDesc += '(';
          shouldPayDesc += t.orderDiscount ? '本次结算优惠:' + t.orderDiscount /
            100.0 + '元 ' : '';
          shouldPayDesc += t.pocketMoneyFee ? '企业零花钱:' + t.pocketMoneyFee /
            100.0 + '元' : '';
          shouldPayDesc += ')';
        }
        t.shouldPayDesc = shouldPayDesc;
        return t;
      };
      /**
       * 拣货信息参考数据转换
       * 
       */
      this._parseDeliveryRecomm = function(data, productIdsInShelf) {
        var temp = {};
        _.each(_.keys(data), function(key, i) {
          var tempList = [];
          _.each(data[key], function(item) {
            var t = item;
            var productKey = '';
            if (key == 'replenishment') {
              productKey = 'productDetail';
            } else {
              productKey = 'product';
            }
            _.extend(t, item[productKey].header);
            t.productId = item[productKey].header.id;
            t.positions = item[productKey].positions;
            t.category = item[productKey].category;
            t.reasons = _.union([item.reason], item.otherReasons);
            if (key == 'wishlist') {
              t.suiteId = t.suite.id;
              t.issueId = t.issue.id;
            }
            t.from = [PRODUCT_FROM_TYPE.FROM_REFER];
            if (_.contains(productIdsInShelf, t.productId)) {
              t.from = _.union(t.from, [PRODUCT_FROM_TYPE.FROM_SHELF]);
            } else {
              t.from = _.union(t.from, [PRODUCT_FROM_TYPE.FROM_NEW]);
            }
            tempList.push(t);
          });
          temp[key] = tempList;
        });
        return temp;
      };
      /*获取参考页面信息
      @Params
      companyId
      shelfId  
       */
      this.queryDeliveryRecomm = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/recomm/' + params.companyId + '/' +
            params.shelfId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*根据商品ids获取商品最近10次拣货均值
      @Params
      productId
       */
      this.queryLatestDeliveryCountAvgs = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'logistics/order/recomm/latestDeliveryCountAvgs',
          params: params.productIds,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*创建拣货单
       @Params
       shelfId
       urgent
       items{
       prductId
       itemNum
       itemType
       shelfProductId
       }
       */
      this.createDeliveryOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'logistics/order/delivery',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*修改送货单
       orderId B
       managerId B
       orderState B
       urgent B
       items B
       itemId
       productId
       itemNum
       deltaDes
       shelfProductId
       itemType
       */
      this.modifyDeliveryOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'logistics/order/delivery',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*查询送货单列表
       *offset R
       limit R
       startTime B
       endTime B
       companyId
       settlementId
       shelfId
       orderStates B
       */
      this.queryDeliveryList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/delivery/findList',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询送货单列表
       *offset R
       limit R
       startTime B
       endTime B
       companyId
       settlementId
       shelfId
       orderStates B
       */
      this.queryPromotionList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'company/promotion/order/page',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询送货单详细信息列表
       *@Params
       *orderIds
       *orderStates
       */

      this.queryDeliveryDetailList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/delivery/findDetailList',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*修改送货单状态
       *orderId P
       *orderState B
       *optRecord B
       */
      this.modifyDeliveryState = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'logistics/order/delivery/' + params.orderId +
            '/state',
          params: {
            orderState: params.orderState,
            optRecord: params.optRecord,
            companyId: params.companyId
          },
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*查询送货单
       *@Params
       *orderId P
       */
      this.queryDeliveryDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/delivery/' + params.orderId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*删除送货单
       *@Params
       *
       */
      this.deleteDeliveryOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Delete({
          path: 'logistics/order/delivery/' + params.orderId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*分页查询送货单模板
       */
      this.queryDeliveryTemplate = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/delivery/template/findList',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询单据列表*
       @Params
       companyName
       orderType
       startDay
       endDay
       pageSize
       offset
       */
      this.queryOrderList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'logistics/order/center',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询单据列表*
       @Params
       companyName
       orderType
       startDay
       endDay
       pageSize
       offset
       */
      this.queryTeaList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'tea/order',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询退货单详情
       @Params
       orderId
       */
      this.queryRefundDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/return/' + params.orderId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询盘点单详情
       orderId
       */
      this.queryInventoryDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/inventory/' + params.orderId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*查询结算单详情
       orderId
       */
      this.querySettlementDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/settlement/' + params.orderId,
          success: function(res) {
            var data = res;
            data.companyDiscount = parseInt(data.companyDiscount);
            data.deliveryFee = parseInt(data.deliveryFee);
            data.fullInvoice = parseInt(data.fullInvoice);
            data.inventoryFee = parseInt(data.inventoryFee);
            data.isInvoice = parseInt(data.isInvoice);
            data.orderDiscount = parseInt(data.orderDiscount);
            data.orderFee = parseInt(data.orderFee);
            data.paidFee = parseInt(data.paidFee);
            data.pocketMoneyFee = parseInt(data.pocketMoneyFee);
            data.preInventoryFee = parseInt(data.preInventoryFee);
            data.premiumFee = parseInt(data.premiumFee);
            data.returnFee = parseInt(data.returnFee);
            data.taxFee = parseInt(data.taxFee);
            deferred.resolve(data);
          }
        });
        return promise;
      };
      // 查询下午茶订单
      // @Params
      // orderIds
      this.teaOrderDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'tea/order/' + params.orderId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*批量更新拣货单状态
       @Params
       orderIds
       */
      this.batchUpdateDeliveryOrderState = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'logistics/order/delivery/batchUpdateState',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*根据送货单id获取送货单模板
       *orderId
       *scope
       *success
       */
      this.getCompiledDeliveryOrder = function(opts) {
        this.queryDeliveryDetail({ 'orderId': opts.orderId }).then(
          function(res) {
            var scope = opts.scope;
            scope.deliveryOrder = res;
            scope.deliveryOrder.name = '送货单' + '-' + scope.deliveryOrder
              .companyName + '-' + scope.deliveryOrder.shelfName +
              '(' + utilService.parseTimeByLong(scope.deliveryOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.deliveryOrder.putSaleProductList = [];
            scope.deliveryOrder.supplementProductList = [];
            scope.deliveryOrder.pullSaleProductList = [];
            angular.forEach(scope.deliveryOrder.items, function(item,
              i) {
              switch (parseInt(item.itemType)) {
                case 1:
                  scope.deliveryOrder.putSaleProductList.push(
                    item);
                  break;
                case 2:
                  scope.deliveryOrder.supplementProductList.push(
                    item);
                  break;
                case 3:
                  scope.deliveryOrder.pullSaleProductList.push(
                    item);
                  break;
              }
            });
            var temp = angular.element('<div></div>').append(scope.compileDeliveryTemplate(
              scope));
            opts.success && opts.success.call(this, temp);
          });
      };
      /*批量打印单
       *settlementOrderIds
       *inventoryOrderIds
       *deliveryOrderIds
       *returnOrderIds
       */
      this.queryOrderDetails = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'logistics/order/inventory/batchPrint',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*下午茶批量打印单
       *settlementOrderIds
       *inventoryOrderIds
       *deliveryOrderIds
       *returnOrderIds
       */
      this.teaOrderDetails = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'tea/order/findByIds',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*下午茶打印模板环境数据
       *
       */
      this.teaOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.teaDetail = data;
        scope.teaDetail.name = '下午茶订单详情' + '-' +
          '(' + utilService.parseTimeByLong(scope.teaDetail.order.createTime,
            'yyyyMMddhhmm') + ')';
        scope.orderTitle = scope.teaDetail.name;
        return scope;
      };
      /*
       * 节假日打印模板环境数据
       */
      this.holidayOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.holidayDetail = data;
        scope.holidayDetail.name = '节假日订单详情' + '-' +
          '(' + utilService.parseTimeByLong(scope.holidayDetail.order.createTime,
            'yyyyMMddhhmm') + ')';
        scope.orderTitle = scope.holidayDetail.name;
        return scope;
      };
      /*打印模板环境数据
       *
       */
      this.parsePrintOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.ORDER_STATUS = CONSTANTS.ORDER_STATUS;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.BUY_TYPE = CONSTANTS.BUY_TYPE;
        scope.ISSUE_ACTIVE = CONSTANTS.ISSUE_ACTIVE;
        scope.DELIVERY_STATE = CONSTANTS.DELIVERY_STATE;

        switch (orderType) {
          case ORDER_TYPE.DELIVERY:
            scope.deliveryOrder = data;
            scope.deliveryOrder.name = '送货单' + '-' + scope.deliveryOrder
              .companyName +
              '-' + scope.deliveryOrder.shelfName +
              '(' + utilService.parseTimeByLong(scope.deliveryOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.deliveryOrder.name;
            scope.deliveryOrder.putSaleProductList = [];
            scope.deliveryOrder.supplementProductList = [];
            scope.deliveryOrder.pullSaleProductList = [];
            angular.forEach(scope.deliveryOrder.items, function(item, i) {
              switch (parseInt(item.itemType)) {
                case 1:
                  scope.deliveryOrder.putSaleProductList.push(item);
                  break;
                case 2:
                  scope.deliveryOrder.supplementProductList.push(
                    item);
                  break;
                case 3:
                  scope.deliveryOrder.pullSaleProductList.push(item);
                  break;
              }
            });
            break;
          case ORDER_TYPE.REFUND:
            scope.refundOrder = data;
            scope.refundOrder.name = '退货单' + '-' + scope.refundOrder.companyName +
              '-' + scope.refundOrder.shelfName +
              '(' + utilService.parseTimeByLong(scope.refundOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.refundOrder.name;
            break;
          case ORDER_TYPE.INVENTORY:
            scope.inventoryOrder = data;
            scope.inventoryOrder.name = '盘点单' + '-' + scope.inventoryOrder
              .companyName +
              '-' + scope.inventoryOrder.shelfName +
              '(' + utilService.parseTimeByLong(scope.inventoryOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.inventoryOrder.name;
            break;
          case ORDER_TYPE.SETTLEMENT:
            scope.settlementOrder = me._parseSettlementDetailData(data);
            scope.settlementOrder.name = '结算单' + '-' + scope.settlementOrder
              .companyName +
              '(' + utilService.parseTimeByLong(scope.settlementOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.settlementOrder.name;
            break;
          case ORDER_TYPE.HOLIDAY:
            console.log(data);
            scope.order = data;
            // scope.settlementOrder = me._parseSettlementDetailData(data);
            // scope.settlementOrder.name = '结算单' + '-' + scope.settlementOrder.companyName +
            //     '(' + utilService.parseTimeByLong(scope.settlementOrder.createTime, 'yyyyMMddhhmmss') + ')';
            // scope.orderTitle = scope.settlementOrder.name;
            // scope.setHolidayOrder = data;

            break;
          case ORDER_TYPE.ISSUEDYNAMIC:
            /*console.log(data);
            scope.issueOrder = data;*/
            scope.issueDetail = data;
            scope.issueDetail.name = '期号' + '-' + scope.issueDetail.companyName +
              '-' + scope.issueDetail.id +
              '(' + utilService.parseTimeByLong(scope.issueDetail.issueStartTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.issueDetail.name;
            break;
          case ORDER_TYPE.SUITEDYNAMIC:
            /*console.log(data);
            scope.suiteOrder = data;
            break;*/

            scope.sOrder = suiteService.parseSuiteData(data);

            scope.sOrder.name = '套餐' + '-' + scope.sOrder.companyName +
              '-' + scope.sOrder.suiteId +
              '(' + utilService.parseTimeByLong(scope.sOrder.createTime,
                'yyyyMMddhhmmss') + ')';
            scope.orderTitle = scope.sOrder.name;
            break;
        }
        return scope;
      };
      /*营销订单印模板环境数据
       *
       */
      this.promotionOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.PROMOTION_ORDER_STATUS = CONSTANTS.PROMOTION_ORDER_STATUS;
        scope.promotionDetail = data;
        scope.promotionDetail.order.deliveryTime = scope.promotionDetail
          .order.deliveryTime ?
          new Date(parseInt(scope.promotionDetail.order.deliveryTime)) :
          scope.promotionDetail
          .order.deliveryTime = scope.promotionDetail.order.deliveryTime;

        if (scope.promotionDetail.order.actualPrice) {
          scope.promotionDetail.order.actualPrice = parseFloat(scope.promotionDetail
            .order.actualPrice / 100, 2);
        }
        scope.promotionDetail.name = '营销订单详情' + '-' +
          '(' + utilService.parseTimeByLong(scope.promotionDetail.order
            .createTime,
            'yyyyMMddhhmm') + ')';
        scope.orderTitle = scope.promotionDetail.name;
        return scope;
      };
      /*获取单据详情
       *
       */
      this.queryOrderDetail = function(orderType, orderId, scope) {
        var me = this;
        var promise;
        switch (orderType) {
          case ORDER_TYPE.DELIVERY:
            promise = me.queryDeliveryDetail({
              orderId: orderId
            }).then(function(res) {
              scope = me.parsePrintOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.REFUND:
            promise = me.queryRefundDetail({
              orderId: orderId
            }).then(function(res) {
              scope = me.parsePrintOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.INVENTORY:
            promise = me.queryInventoryDetail({
              orderId: orderId
            }).then(function(res) {
              scope = me.parsePrintOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.SETTLEMENT:
            promise = me.querySettlementDetail({
              orderId: orderId
            }).then(function(res) {
              scope = me.parsePrintOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.TEAORDER:
            promise = me.teaOrderDetail({
              orderId: orderId
            }).then(function(res) {
              scope = me.teaOrderScope(orderType, res, scope);
            });
          case ORDER_TYPE.PROMOTION:
            promise = me.queryPromotionList({
              ids: orderId
            }).then(function(res) {
              res = res.content[0];
              scope = me.promotionOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.ISSUEDYNAMIC:
            promise = me.queryPromotionList({
              ids: orderId
            }).then(function(res) {
              res = res.content[0];
              scope = me.promotionOrderScope(orderType, res, scope);
            });
            break;
          case ORDER_TYPE.SUITEDYNAMIC:
            promise = me.queryPromotionList({
              ids: orderId
            }).then(function(res) {
              res = res.content[0];
              scope = me.promotionOrderScope(orderType, res, scope);
            });
            break;
        }
        return promise;
      };
      /*查看单据详情
       *PS:调用改方法必须保证root中有order样式
       */
      this.checkOrderDetail = function(orderType, orderId, scope,
        isUpdate,
        companyName) { //TYPE=5 为下午茶订单
        var me = this;
        var templateUrl = me.getTemplatePath(orderType);
        var vari = '';
        switch (orderType) {
          case ORDER_TYPE.DELIVERY: //送货
            vari = 'deliveryOrderModal';
            break;
          case ORDER_TYPE.REFUND: //退货
            vari = 'refundOrderModal';
            break;
          case ORDER_TYPE.INVENTORY: //盘点
            vari = 'inventoryOrderModal';
            break;
          case ORDER_TYPE.SETTLEMENT: //结算
            vari = 'settlementOrderModal';
            break;
          case ORDER_TYPE.TEAORDER: //下午茶
            vari = 'teaOrderModal';
            break;
          case ORDER_TYPE.HOLIDAY: //节假日
            vari = 'holidayModal';
            break;
          case ORDER_TYPE.PROMOTION: //营销账单
            vari = 'promotion';
            break;
          case ORDER_TYPE.ISSUEDYNAMIC: //期号
            vari = 'issueModal';
            break;
          case ORDER_TYPE.SUITEDYNAMIC: //套餐
            vari = 'suiteModal';
            break;
        }
        return me.queryOrderDetail(orderType, orderId, scope).then(
          function() {
            scope.exportExcelOnDetail = me.exportExcelOnDetail;
            if (companyName) {
              scope.teaDetail.order.companyName = companyName;
              scope.addTeaType(scope.teaDetail.order)
            }
            if (!isUpdate) {
              scope[vari] = modalService.initModal({
                appendTo: angular.element(document.getElementsByClassName(
                  'order-center')),
                scope: scope,
                templateUrl: templateUrl
              });
            }
          });
      };

      /*获取模板地址
       *
       */
      // this.keyremark=function(e,remark,id){
      //    var promise;
      //    me=this;
      //     if (e.keyCode == 13) { //回车键
      //          me.modifyRemark({
      //                orderId: id,
      //                remark:remark
      //            }).then(function(res) {

      //            });    
      //            }

      /*下午茶打印模板环境数据
       *
       */
      this.teaOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.teaDetail = data;
        scope.teaDetail.name = '下午茶订单详情' + '-' +
          '(' + utilService.parseTimeByLong(scope.teaDetail.order.createTime,
            'yyyyMMddhhmm') + ')';
        scope.orderTitle = scope.teaDetail.name;
        return scope;
      };
      /*
       * 节假日打印模板环境数据
       */
      this.holidayOrderScope = function(orderType, data, scope) {
        scope.utilService = utilService;
        scope.CONSTANTS = CONSTANTS;
        scope.ORDER_TYPE = CONSTANTS.ORDER_TYPE;
        scope.DELIVERY_URGENCY = CONSTANTS.DELIVERY_URGENCY;
        scope.COMPANY_TYPE = CONSTANTS.COMPANY_TYPE;
        scope.SETTLEMENT_STATE = CONSTANTS.SETTLEMENT_STATE;
        scope.holidayDetail = data;
        scope.holidayDetail.name = '节假日订单详情' + '-' +
          '(' + utilService.parseTimeByLong(scope.holidayDetail.order.createTime,
            'yyyyMMddhhmm') + ')';
        scope.orderTitle = scope.holidayDetail.name;
        return scope;
      };

      this.modifyRemark = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'tea/order/remark',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      // 取消下午茶
      this.cancelTea = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'tea/order/cancel',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      // 确认接收下午茶
      this.acceptTea = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'tea/order/accept',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      this.getTemplatePath = function(orderType) {
        console.log(orderType)
        switch (orderType) {
          case ORDER_TYPE.DELIVERY:
            var templateUrl = 'order/deliveryOrderTemplate.html';
            break;
          case ORDER_TYPE.REFUND:
            var templateUrl = 'order/refundOrderTemplate.html';
            break;
          case ORDER_TYPE.INVENTORY:
            var templateUrl = 'order/inventoryOrderTemplate.html';
            break;
          case ORDER_TYPE.SETTLEMENT:
            var templateUrl = 'order/settlementOrderTemplate.html';
            break;

          case ORDER_TYPE.HOLIDAY:
            // alert("aaa")
            var templateUrl =
              'order/holidayWelfareParticularsTemplate.html';
            break;
          case ORDER_TYPE.TEAORDER:
            var templateUrl = 'order/teaOrderTemplate.html';
            break;
          case ORDER_TYPE.PROMOTION:
            var templateUrl = 'order/promotionOrderTemplate.html';
            break;

          case ORDER_TYPE.ISSUEDYNAMIC:
            var templateUrl = 'suite/issueDynamicTemplate.html';
            break;
          case ORDER_TYPE.SUITEDYNAMIC:
            var templateUrl =
              'suite/suiteDistributionDynamicTemplate.html';
            break;
        }
        return templateUrl;
      };
      /*获取模板节点
       *
       */
      this.getTemplateDomByType = function(orderType, scope) {
        var me = this;
        console.log(scope);
        return $compile($templateCache.get(me.getTemplatePath(orderType)))
          (scope);
      };
      /*
       * */
      this.printOrderDoms = function(orderDetails, orderType, scope) {
        var me = this;
        var doms = [];
        angular.forEach(orderDetails, function(detail) {
          var newscope = me.parsePrintOrderScope(orderType, detail,
            scope.$new(true));
          newscope.isPrint = true;
          console.log(newscope);
          doms.push(angular.element('<div></div>').append(me.getTemplateDomByType(
            orderType, newscope)));
        });
        return doms;
      };

      /*获取单据详情module的ID
       */
      this.getContainterId = function(orderType) {
        var containerId = '';
        switch (orderType) {
          case ORDER_TYPE.DELIVERY:
            containerId = 'delivery-order-table';
            break;
          case ORDER_TYPE.REFUND:
            containerId = 'refund-order-table';
            break;
          case ORDER_TYPE.INVENTORY:
            containerId = 'inventory-order-table';
            break;
          case ORDER_TYPE.SETTLEMENT:
            containerId = 'settlement-order-table';
            break;
          case ORDER_TYPE.HOLIDAY:
            containerId = 'holiday-welfare-order-detail-table';
            break;
          case ORDER_TYPE.TEAORDER:
            containerId = 'tea-order-table';
            break;
          case ORDER_TYPE.PROMOTION:
            containerId = 'promotion-order-table';
            break;
          case ORDER_TYPE.ISSUEDYNAMIC:
            containerId = 'issue-dynamic-template';
            break;
          case ORDER_TYPE.SUITEDYNAMIC:
            containerId = 'suite-dynamic-table';
            break;
        }
        return containerId;
      };
      this.formExcel = function(containerId, title) {
        var dom = angular.element('<a></a>');
        dom[0].href = $('#' + containerId).excelexportjs({
          containerid: containerId,
          datatype: 'table',
          returnUri: 'true'
        });
        dom[0].download = title + '.xls';
        dom[0].click();
      };
      /*从表格导出excel
       * PS:调用改方法必须保证有模板中有<div id="exportExcelWrap" class="hidden"></div>元素
       */
      this.exportExcel = function(orderType, orderId, scope) {
        var me = this;
        var containerId = me.getContainterId(orderType);
        if (orderId) {
          var excelTemplate = me.getTemplateDomByType(orderType, scope);
          angular.element(document.getElementById('exportExcelWrap')).append(
            excelTemplate);
          me.queryOrderDetail(orderType, orderId, scope).then(function() {
            scope.$applyAsync(function() {
              var dom = angular.element('<a></a>');
              dom[0].href = $('#' + containerId).excelexportjs({
                containerid: containerId,
                datatype: 'table',
                returnUri: 'true'
              });
              dom[0].download = scope.orderTitle + '.xls';
              dom[0].click();
            });
          });
        } else {
          scope.uri = $("#" + containerId).excelexportjs({
            containerid: containerId,
            datatype: 'table',
            returnUri: 'true'
          });
        }
      };
      /*从model中导出excel
       *
       */
      this.exportExcelOnDetail = function(orderType, scope) {
        me.exportExcel(orderType, '', scope);
      };
      /*从model中打印
       *
       */
      this.getPrintHtmlInOrderModule = function(orderType, scope) {
        var containerId = this.getContainterId(orderType);
        return $("#" + containerId).html();
      };
    }
  ]);
}
},{}],100:[function(require,module,exports){
module.exports = function(app) {
    app.service('positionService', ['xhrService', '$q', function(xhrService, $q) {
        /*新增仓位
        @Params
        row
        layer
        location
        */
        this.createPosition = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Post({
                path: 'product/position',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*修改仓位
        @Params
        id
        row
        layer
        location
        */
        this.modifyPosition = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'product/position',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*分页获取仓位
        @Params
        name
        sortType
        offset
        limit
        */
        this.queryPositionsByPage = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'product/position/_query',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*非分页获取仓位
        @Params
        name
         */
        this.queryAllPositions = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'product/position/_queryAll',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
    }]);
};
},{}],101:[function(require,module,exports){
/**
 * Created by lijinlong
 */
module.exports = function(app) {
    app.service('printService', function($mdDialog) {
        var LODOP;
        this.addHtml = function(html) {
            LODOP = window.getLodop();
            LODOP.SET_PRINT_MODE("POS_BASEON_PAPER", true);
            LODOP.SET_PRINT_COPIES(1);
            LODOP.SET_PRINT_STYLEA(0, "Horient", 0);
            LODOP.PRINT_INIT("");
            LODOP.ADD_PRINT_HTM(0, 0, "100%", "BottomMargin:10px", html);
        };
        this.preview = function(html) {
            this.addHtml(html)
            LODOP.PREVIEW();
        };
        this.selectAsDefaultPrinter = function() {
            LODOP = window.getLodop();
            LODOP.SELECT_PRINTER();
        };
        this.print = function(html) {
            this.addHtml(html);
            LODOP.PRINT();
        };
        this.printHtmls = function(htmls) {
            var me = this;
            if (_.isArray(htmls)) {
                angular.forEach(htmls, function(item) {
                    me.print(item);
                });
            } else {
                me.print(htmls);
            }
        };
        this.printByDefaultPrinter = function(htmls, needConfirm) {
            needConfirm = typeof needConfirm == 'undefined' ? true : needConfirm;
            var me = this;
            if (needConfirm) {
                $mdDialog.show($mdDialog.confirm({
                    title: '提示',
                    textContent: '请点击确认按钮打印！',
                    ok: '确认',
                    cancel: '取消'
                })).then(function() {
                    me.printHtmls(htmls);
                });
            } else {
                me.printHtmls(htmls);
            }

        };
    });
};

},{}],102:[function(require,module,exports){
//productService
module.exports = function(app) {
  app.service('productService', ['xhrService', '$q', '$filter', 'CONSTANTS',
    function(
      xhrService, $q, $filter, CONSTANTS) {
      this.indexData = function(data, offset) {
        angular.forEach(data, function(item, index) {
          item.index = index + offset;
        });
        return data;
      };
      /*
      转换商品列表
      */
      this._parseProductListData = function(data, labelList) {
        var temp = [];
        angular.forEach(data, function(d, i, a) {
          var obj = d.header;
          obj.category = d.category;
          obj.positions = d.positions;
          var labelNames = [];
          _.each(labelList, function(item) {
            var t = _.find(d.labelDtos, function(label) {
              return label.typeId == item.id;
            });
            if (typeof t != 'undefined') {
              labelNames.push(t.name);
            } else {
              labelNames.push('');
            }
          });
          obj.labelNames = labelNames;
          var t = '';
          _.each(obj.productTags, function(tagId, index) {
            if (index != 0) {
              t += ',';
            }
            t += CONSTANTS.PRODUCT_TAG.DESC[tagId];
            return t;
          });
          obj.productTagsPrefix = t;
          temp.push(obj);
        });
        return temp;
      };
      /*
      转换商品详情
      */
      this._parseProductData = function(res, labelList) {
        var temp = res.header;
        temp.categoryName = res.category.categoryName;
        temp.originPrice = temp.originPrice / 100.0;
        temp.price = temp.price / 100.0;
        temp.positionIds = res.positions;
        temp.labelDtos = [];
        temp.showLabelIdList = [];
        _.each(labelList, function(item) {
          var t = _.find(res.labelDtos, function(label) {
            return label.typeId == item.id;
          });
          if (typeof t != 'undefined') {
            temp.labelDtos.push(t);
            temp.showLabelIdList.push(t.id);
          } else {
            temp.showLabelIdList.push('');
          }
        });
        temp.labelIdList = _.pluck(temp.labelDtos, 'id');
        temp.categoryId = res.category.id;
        return temp;
      };
      /*按类型获取商品数据字典
      @Params 
      type
      */
      this.queryProductDictionary = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'product/dict/listByType',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //接口
      this.queryProductByKey = function(params) {
        // debugger
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'product/_query',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*获取品类列表
      @Params
      categoryId
      */
      this.queryProductCategoryList = function(params) {
        params = typeof params != 'undefined' ? params : { parentCategoryId: 0 };
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'product/category/show_list/' + params.parentCategoryId,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*创建品类
      @Params
      id
      categoryName
      categoryLevel
      */
      this.createProductCategory = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'product/category',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*删除品类
      @Params
      categoryId
       */
      this.deleteProductCategory = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Delete({
          path: 'product/category/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*修改品类
      @Params
      id
      categoryName
      categoryLevel
      */
      this.modifyProductCategory = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'product/category/modify',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //查看商品详情
      this.getProductById = function(params) {
        // debugger
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'product/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve($filter('int')(res, ['header.stock']));
          }
        });
        return promise;
      };
      //修改商品
      this.editProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'product/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //将商品放入指定品类
      this.addProductToCategory = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'product/category/' + params.id,
          // path: 'company/shelf_product/createCategory',
          params: params.productIds,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //保存新建商品
      this.saveNewProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'product',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //保存已有商品
      this.saveOldProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: 'product/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //删除商品
      this.deleteProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Delete({
          path: 'product/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //获取仓位列表
      this.getPositionList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'product/position',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      //商品库存修改记录
      this.getProductStockChangeLog = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: 'product/' + params.id + '/stockchanges',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      //增加单品推荐期间展示次数
      this.incrProductRecommend = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: 'product/recommend/incrView',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
    }
  ]);
};
},{}],103:[function(require,module,exports){
 var basePath = 'company/promotion/';
 module.exports = function(app) {
  app.service('promotionService', ['xhrService', 'utilService', '$q',
    function(xhrService, utilService,
      $q) {
      /*创建营销商品
       */
      this.createPromotionProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: basePath + 'product',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*修改营销商品
       */
      this.modifyPromotionProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'product/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*
      查询营销商品列表
       */
      this.queryPromotionProductList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'product/page',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*
      查询营销商品详情
       */
      this.queryPromotionProductDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'product/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*
      上架营销商品
       */
      this.onlinePromotionProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'product/online/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*
      下架营销商品
       */
      this.offlinePromotionProduct = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'product/offline/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /*
      获取营销商品HTML链接
       */
      this.getPromotionProductLink = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'product/link/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 创建营销套餐
       */
      this.createPromotionSuite = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Post({
          path: basePath + 'suite',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 修改营销商品套餐
       */
      this.modifyPromotionSuite = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'suite/' + params.id,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 删除营销商品套餐
       */
      this.deletePromotionSuite = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Delete({
          path: basePath + 'suite/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 查询营销商品套餐列表
       */
      this.queryPromotionSuiteList = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'suite/page',
          params: params,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 查询营销商品套餐详细
       */
      this.queryPromotionSuiteDetail = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'suite/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 获取营销商品HTML链接
       */
      this.getPromotionSuiteLink = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Get({
          path: basePath + 'suite/link/' + params.id,
          success: function(res) {
            deferred.resolve(res);
          }
        });
        return promise;
      };
      /**
       * 转换营销商品详细
       */
      this._parsePromotionProductDetail = function(data) {
        var temp = angular.copy(data);
        temp.price = temp.price / 100;
        temp.originalPrice = temp.originalPrice / 100;
        temp.active = parseInt(temp.active);
        temp.imgDetails = _.map(data.images, function(item, i) {
          var t = item.match(/_\d+_/)[0];
          var size = t.substr(1, t.length - 2);
          var wh = item.match(/\d+X\d+/)[0].split('X');
          return {
            index: i + 1,
            path: item,
            image_width: wh[0],
            image_height: wh[1],
            file_size: size
          };
        });
        temp.desImgDetails = _.map(data.desImages, function(item, i) {
          var t = item.match(/_\d+_/)[0];
          var size = t.substr(1, t.length - 2);
          var wh = item.match(/\d+X\d+/)[0].split('X');
          return {
            index: i + 1,
            path: item,
            image_width: wh[0],
            image_height: wh[1],
            file_size: size
          };
        });
        return temp;
      };
      /**
       * 转换营销商品列表数据
       */
      this._parsePromotionProductList = function(data) {
        var temp = [];
        _.each(data, function(item) {
          item.active = parseInt(item.active);
          temp.push(item);
        });
        return temp;
      };
      /**
       * 转换营销套餐详细
       */
      this._parsePromotionSuiteDetail = function(data) {

      };
      /**
       * 转换营销套餐列表数据
       */
      this._parsePromotionSuiteList = function(data) {
        var temp = [];
        _.each(data, function(item) {
          var productNamesStr = '';
          _.each(item.productNames, function(name, i) {
            productNamesStr += name;
            if (i < item.productNames.length - 1) {
              productNamesStr += ',';
            }
          });
          item.productNamesStr = productNamesStr;
          temp.push(item);
        });
        return temp;
      };
      /*退货
       *
       * orderId
       */
      this.refundPromotionOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/refund/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*收货
       *
       * orderId
       */
      this.receivePromotionOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/receive/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*支付全额
       *orderId
       */
      this.payFullPromotionOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/pay/full/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*确认支付定金
       *orderId
       */
      this.confirmDeposit = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/deposit/confirm/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*订单发货
       *orderId
       * 
       */
      this.deliveryPromotionOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/deliver/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*确认订单
       *orderId
       */
      this.confirmOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        var orderObj = {};
        angular.forEach(params.order, function(v, key) {
          if (v !== null) {
            orderObj[key] = v;
          }
        });
        angular.forEach(params.orderItems,function(item){
          item.productId=item.id;
          item.productSubtitle=item.subtitle;
          item.productTitle=item.title;
          item.productCover=item.cover;
          item.productSku=item.sku;

        });
        params.order = orderObj;
        xhrService.Put({
          path: basePath + 'order/confirm/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*取消未支付订单
       *orderId
       */
      this.cancelNoPaymentOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/cancel/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };
      /*取消订单
       *orderId
       */
      this.cancelPaymentOrder = function(params) {
        var deferred = $q.defer();
        var promise = deferred.promise;
        xhrService.Put({
          path: basePath + 'order/cancel/payment/' + params.orderId,
          params: params,
          success: function(res) {
            deferred.resolve(res);
          },
          error: function(res) {
            deferred.reject(res);
          }
        });
        return promise;
      };

    }
  ]);
 }

},{}],104:[function(require,module,exports){
module.exports = function(app) {
  app.service('roleService', function($q, xhrService) {
    /**
     * 获取所有角色
     */
    this.getRoles = function() {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'role',
          success: function(res) {
            resolve(res);
          }
        });
      });
    };
    /**
     * 添加角色
     */
    this.addRole = function(params) {
      return $q(function(resolve) {
        xhrService.Post({
          path: 'role',
          params: {
            parentId: params.parentId,
            name: params.name,
            permissions: params.permissionIds
          },
          success: function() {
            resolve();
          }
        });
      });
    };
    /**
     * 编辑角色
     */
    this.editRole = function(roleId, params) {
      return $q(function(resolve) {
        xhrService.Put({
          path: 'role/' + roleId,
          params: {
            name: params.name,
            permissions: params.permissionIds
          },
          success: function() {
            resolve();
          }
        });
      });
    };
    /**
     * 删除角色
     */
    this.removeRole = function(roleId) {
      return $q(function(resolve) {
        xhrService.Delete({
          path: 'role/' + roleId,
          success: function() {
            resolve();
          }
        });
      });
    };
    /**
     * 获取所有普通权限
     */
    this.getNormalPermissions = function() {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'permission/2',
          success: function(res) {
            resolve(res);
          }
        });
      });
    };
    /**
     * 获取所有特殊权限
     */
    this.getCriticalPermissions = function() {
      return $q(function(resolve) {
        xhrService.Get({
          path: 'permission/3',
          success: function(res) {
            resolve(res);
          }
        });
      });
    };
  });
};

},{}],105:[function(require,module,exports){
/**
 * Created by zhouwan on 2017/1/13.
 */
module.exports = function (app) {
  app.service("salesService", ['xhrService', '$q', function (xhrService, $q) {
    this.getQuerySalesList = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: "product/statistics/_query",
        params: params,
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    this.getStartTime = function () {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'product/statistics/startTime',
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    //滞销库
    this.addUnsalable = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: "product/unsalable/add",
        params: params,
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    //新品推荐库
    this.addCommend = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: "product/recommend/add",
        params: params,
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    //删除新品推荐
    this.delRecommend = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'product/recommend/del/' + params.id,
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    //删除滞销商品
    this.delUnsalable = function (params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'product/unsalable/del/' + params.id,
        success: function (res) {
          deferred.resolve(res);
        }
      });
      return promise;
    }

  }]);

}
},{}],106:[function(require,module,exports){
/*
 *shelfService
 */
module.exports = function(app) {
  app.service('shelfService', ['xhrService', 'CONSTANTS', '$q', function(
    xhrService, CONSTANTS, $q) {
    var shelves = [];
    //单利数据存储
    this.getShelves = function() {
      return shelves;
    };
    //服务
    /*货架数据转换
     *
     */
    this._parseShelfData = function(data) {
      //拷贝一份，保持数据源不变
      var temp = [];
      angular.forEach(data, function(item, index) {
        var t = angular.copy(item);
        t.index = index;
        t.company_type = CONSTANTS.COMPANY_TYPE.DESC[t.company_type];
        t.all_product_per = t.all_product_per && t.all_product_per
          .split(',').join(' | ');
        t.last_update_interval = t.last_update_interval && t.last_update_interval
          .split(',').join(' | ');
        t.valid_sheld_countVSshelf_count = t.valid_sheld_count +
          '/' + t.shelf_count;
        temp.push(t);
      });
      return temp;
    };
    /*
     *除当前货架上的其他商品
     */
    this._parseOtherShelfProducts = function(data, selectedIdList) {
      var me = this;
      var temp = [];
      angular.forEach(data, function(item, i) {
        var t = angular.copy(item.header);
        t.positions = item.positions;
        t.productId = item.header.id;
        if (_.contains(selectedIdList, t.productId)) {
          t.select = true;
        }
        t.categoryName = item.category.categoryName;
        t.category = item.category;
        temp.push(t);
      });
      return temp;
    };
    /**
     * 转换拣货单中的货架商品数据
     */
    this._parseShelfProductsInDeliveryEdit = function(data) {
      var temp = [];
      _.each(data, function(item) {
        var shelfProduct = item.productHeader || {};
        shelfProduct.shelfProductHeader = item.header;
        shelfProduct.category = item.productCategory;
        shelfProduct.positions = item.positionDtoList;
        shelfProduct.shelfStock = item.header.stock;
        shelfProduct.shelfProductId = item.header.id;
        shelfProduct.productId = item.productHeader.id;
        temp.push(shelfProduct);
      });
      return temp;
    };
    /*货架详细数据转换
     *
     */
    this._parseShelfDetailData = function(tables) {
      var t = [];
      angular.forEach(tables, function(table) {
        var temp = [];
        angular.forEach(table.productDetails, function(item) {
          var header = item.header;
          var row = parseInt(header.row);
          var col = parseInt(header.col);
          var rownum = row - 1;
          var colnum = col - 1;
          var unit = temp[rownum];
          if (!row && !col) {
            temp[4] = [];
            temp[4][0] = item;
          } else {
            if (unit && unit.length) {
              temp[rownum][colnum] = item;
            } else {
              temp[rownum] = [];
              temp[rownum][colnum] = item;
            }
          }
        });
        table.parsedProducts = temp;
        t.push(table);
      });
      return t;
    };
    /*货架商品数据转换
     */
    this._parseShelfProductsData = function(data) {
      var t1 = [];
      t1 = _.filter(data, function(item) {
        return item.header.row != 0;
      });
      var t2 = [];
      t2 = _.filter(data, function(item) {
        return item.header.row == 0;
      });
      t2 = _.map(t2, function(item) {
        item.header.row = 5;
        return item;
      });
      var t = t1.concat(t2);
      return t;
    };

    //接口

    /*获取公司列表
    *@Params
    * shelf_stock_percent
      shelf_warn_count
      company_name
      shelf_type
      last_update_interval
    */
    this.queryShelfList = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      var params_str = $.param(params);
      params && (params.urlWithParam = 'api/task/shelf_monitor' + (
        params_str ? '?' + params_str : ''));
      xhrService.Post({
        path: 'data/remote',
        params: params,
        success: function(res) {
          shelves = res;
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*根据公司获取货架列表
     *@Params
     *companyId
     */
    this.queryShelfListByCompanyId = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/shelf',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*根据货架获取货架下的商品列表
     *@Params
     *shelfId
     */
    this.queryShelfProducstsByShelfId = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/shelf/product/select_by_shelf_id',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*分页查询除当前货架上的其他商品
    *@Params
    shelfId
    productName
    categoryId
    profitLevel
    pageNo
    pageSize
    */
    this.queryOtherShelfProducts = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/shelf/product/other_shelf_products',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*货架商品销量曲线图
    *@Params
    shelfProductId
    days
     */
    this.queryShelfProductTrend = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'data/remote',
        params: {
          'urlWithParam': 'api/task/shelf_sale_trend?shelfProductId=' +
            params.shelfProductId + '&days=' + params.days
        },
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    /*获取货架上的商品过去一周的日均销售量
    *@Params
    shelfId
    */
    this.queryShelfAvgSale = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/shelf/product/shelfSaleAverage',
        params: { 'shelfId': params.shelfId },
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /*创建货架
     *@Params
     companyId 
     shelfName
     */
    this.createShelf = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'company/shelf',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    /*更新货架名称
    *@Params
    shelfId
    shelfName
    */
    this.modifyShelf = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'company/shelf',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
    /*根据公司ID获取货架详情
     *@Params
     *companyId
     */
    this.queryShelfDetailByCompanyId = function(params) {
      var me = this;
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/survey/query_all',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /*货架商品详细信息查询
    *@Params
    shelfProductId
    */
    this.queryShelfProductDetail = function(params) {
      var me = this;
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'company/shelf/product',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };
  }]);
};
},{}],107:[function(require,module,exports){
module.exports = function(app) {
    app.service('staffService', function($q, xhrService) {
        /*列表对象查询
         *queryParam
         *companyId
         *offset
         *limit
         */
        this.queryStaffList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/staff/find_list',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }

            });
            return promise;
        };
        /*零花钱对象详情查看
         *staffId
         */
        this.queryStaffDetail = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'company/staff/' + params.staffId,
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }

            });
            return promise;
        };
        /*零花钱对象添加
         *mobile
         *alias
         *remark
         */
        this.addStaff = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Post({
                path: 'company/staff',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };

        /*零花钱对象修改
         *id
         *mobile
         *alias
         *remark
         *avatar  
         */
        this.editStaff = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'company/staff',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*零花钱对象删除
         *staffId
         */
        this.deleteStaff = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Delete({
                path: 'company/staff/' + params.staffId,
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*零花钱对象 - excel校验
         *
         */
        this.examinExcel = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            var formData = new FormData();
            formData.append('file', params.file);
            formData.append('companyId', params.companyId);
            xhrService.Upload({
                path: 'company/staff/excel_check',
                params: formData,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*零花钱对象导入
         *filePath
         */
        this.importStaffExcel = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            var formData = new FormData();
            formData.append('file', params.file);
            formData.append('companyId', params.companyId);

            xhrService.Upload({
                path: 'company/staff/excel_import',
                params: formData,
                success: function(res) {
                    deferred.resolve(res);
                },
                error: function(res) {
                    deferred.reject(res);
                }
            });
            return promise;
        };

    });
};

},{}],108:[function(require,module,exports){
module.exports = function(app) {
  app.service('suiteService', ['xhrService', '$q', 'CONSTANTS', function(
    xhrService, $q, CONSTANTS) {
    var PRODUCT_FROM_TYPE = CONSTANTS.PICK_PRODUCT_FROM_TYPE;
    var PICK_PRODUCT_REASON = CONSTANTS.PICK_PRODUCT_REASON;
    //转换创建套餐 --> 上传图片 images
    this._getImageDetails = function(data) {
      var temp = angular.copy(data);
      console.log(temp);
      var imageDetails = _.map(temp, function(item, i) {
        var t = item.match(/_\d+_/)[0];
        var size = t.substr(1, t.length - 2);
        var wh = item.match(/\d+X\d+/)[0].split('X');
        return {
          index: i + 1,
          path: item,
          image_width: wh[0],
          image_height: wh[1],
          file_size: size
        };
      });
      return imageDetails;
    };
    /*
     查询本期套餐
     */
    this.queryOnlineSuites = function() {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'issue/online',
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /**
     * 套餐配送动态 --> 明细（套餐SKU数量、商品名称、商品数量）数据转换
     */
    this.parseSuiteData = function(res) {
      var items = _.filter(res.items, function(_items) {
        return _items.itemNum != "-1";
      });
      console.log(items);
      // var items = res.items;
      var suiteNamesArray = [];
      var obj = {};
      // 遍历items  分组
      _.each(items, function(item) {
        item.suiteName = item.suiteName != null ? item.suiteName :
          '好品推荐';
        if (obj[item.suiteName]) {
          obj[item.suiteName].products.push(item);
          obj[item.suiteName].itemNum += parseInt(item.itemNum);
          obj[item.suiteName].suiteName = item.suiteName;
        } else {
          obj[item.suiteName] = {
            suiteName: item.suiteName,
            products: [item],
            itemNum: parseInt(
              item.itemNum)
          };
        }
      });
      angular.forEach(obj, function(value, key) {
        suiteNamesArray.push(value);
      });
      res.suiteNamesArray = suiteNamesArray;
      res.suite = obj;
      return res;
    };
    /**
     * 转换本期套餐数据(拣货单编辑)
     */
    this._parseOnlineSuitesInDeliveryEdit = function(data,
      productIdsInShelf) {
      var temp = angular.copy(data);
      var suites = _.map(temp.suites, function(item) {
        var suiteProducts = _.map(item.products, function(product) {
          var suiteProduct = product.header || {};
          suiteProduct.positions = product.positions;
          suiteProduct.productId = product.header.id;
          suiteProduct.suiteId = item.suite.id;
          suiteProduct.issueId = temp.issue.id;
          suiteProduct.from = [PRODUCT_FROM_TYPE.FROM_SUITE];
          suiteProduct.reasons = [PICK_PRODUCT_REASON.WISHLIST];
          suiteProduct.category = product.category;
          if (_.contains(productIdsInShelf, suiteProduct.productId)) {
            suiteProduct.from = _.union(suiteProduct.from, [
              PRODUCT_FROM_TYPE.FROM_SHELF
            ]);
          } else {
            suiteProduct.from = _.union(suiteProduct.from, [
              PRODUCT_FROM_TYPE.FROM_NEW
            ]);
          }
          return suiteProduct;
        });
        var obj = {
          suiteTitle: item.suite.title,
          suite: item.suite,
          products: suiteProducts
        };
        return obj;
      });
      temp.suites = suites;
      return temp;

    };

    /**
     * 获取配送单列表接口：
     * logistics/order/delivery/findList
     */
    this.getSuiteDistributionDynamicList = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      /*if(params.type){//获取默认
       params.endTime =  $filter('date')(params.endTime, 'yyyy-MM-dd HH:mm:ss');
       params.startTime = $filter('date')(params.startTime, 'yyyy-MM-dd HH:mm:ss');
       delete params.type;
       } else{
       }*/
      xhrService.Get({
        // path: 'logistics/order/delivery/findList',
        path: 'logistics/order/delivery/findSuiteList',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        }
      });
      return promise;
    };

    /**
     * 期号
     * IssueSuite:
     *  suiteId
     *  active: boolean

     * Issue:
     *  id
     *  startTime
     *  endTime
     *  status: 0:待上线；1:已上线，2:已下线
     *  suites: IssueSuite[]

     * CreateOrUpdateIssueRequest:
     *  startTime
     *  endTime
     *  suites: IssueSuite[]
     */

    /**
     * 创建期号
     * POST
     * /backend/issue?publishImmediately=false
     * startTime
     *endTime
     *suites: IssueSuite[]
     */
    this.createIssue = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      params.isDeleted = 0;
      var path = 'issue'
      xhrService.Post({
        path: 'issue?publishImmediately=' + params.publishImmediately ||
          false,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 更新期号
     * PUT
     *  /backend/issue/{id}
     */
    this.updateIssue = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'issue/' + params.id,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /**
     * 获取期号
     * GET
     * /backend/issue/{id}
     */
    this.getIssue = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'issue/' + params.id,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     *获取期号列表
     * GET
     * backend/issue?offset=0&limit=20&status=0&from=1480521600000&to=1481328000000
     */
    this.getAllIssueList = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'issue',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 套餐
     * Suite:
     *  id: String
     *  type: int - 特色0；标准1；
     *  status:int - 未发布0；已发布1；
     *  banner: String
     *  title: String
     *  des: String
     *  productIds: String[]

     * SuiteWithProducts:
     *  suite
     *  products

     * SuiteWithStatistics:
     *  suite
     */

    /**
     * 创建套餐
     * POST
     * /backend/suite
     */
    this.createSuite = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      params.isDeleted = 0;
      xhrService.Post({
        path: 'suite',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 编辑套餐
     * PUT
     * /backend/suite/{id}
     */
    this.editorSuite = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'suite/' + params.id,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 删除套餐
     * DELETE
     * /backend/suite/{id}
     */
    this.deleteSuite = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'suite/' + params.id,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 发布套餐
     * PUT
     * /backend/suite/{id}/publish
     */
    this.publishSuite = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Put({
        path: 'suite/' + params.id + '/publish',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 根据id获取套餐(SuiteWithProducts)
     * GET
     * /backend/suite/{id}
     */
    this.getSuite = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'suite/' + params.id,
        // params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 获取套餐列表(SuiteWithStatistics[])
     * GET
     * /backend/suite?offset=0&limit=20&type=0&status=0&id={id}
     * [Filter Params: type(NONE,0,1), status(NONE,0,1), id(NONE,{id})]
     */
    this.getAllSuiteList = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: 'suite',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 期号实时动态
     * 分页查询期号实时动态数据
     * 接口名 /shelf/suite/statistical/pageable
     * 请求方法 POST
     * 请求参数: issueId, companyName, issueStartTime, issueEndTime
     */
    this.queryIssueDynamic = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'shelf/suite/statistical/pageable',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
    /**
     * 查询期号变动明细
     * 接口名 /shelf/suite/statistical/期id/企业id
     * 请求方法 GET
     * 请求参数: issueId, companyId
     */
    this.queryIssueChanges = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: '/shelf/suite/statistical/' + params.issueId + '/' +
          params.companyId,
        // params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 创建评论或回复
     * 接口名 crm/suite/comment
     * 请求方法 POST
     * 请求参数 suiteId, companyId, content, parentId
     */
    this._createComment = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'crm/suite/comment',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 分页查询评论
     * 接口名 crm/suite/comment/pageable
     * 请求方法 POST
     * 请求参数 suiteId, customerName, content, createTimeStart, createTimeEnd
     */
    this.queryComment = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'crm/suite/comment/pageable',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     * 删除评论
     * 接口名 crm/suite/comment/这里直接传suiteCommentId
     * 请求方法 DELETE
     * 请求参数 suiteCommentId
     */
    this._deleteComment = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Delete({
        path: 'crm/suite/comment/' + params.suiteCommentId,
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };

    /**
     *  查询消息中心列表
     *  接口名 /notification/center
     *  请求方法 GET
     *  请求参数 无
     */
    this.getMessageCenter = function() {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Get({
        path: '/notification/cente',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };


    /**
     * 期号实时动态 批量打印
     * shelf/suite/statistical/print
     * post
     */
    this.issueDynamicPrint = function(params) {
      var deferred = $q.defer();
      var promise = deferred.promise;
      xhrService.Post({
        path: 'shelf/suite/statistical/print',
        params: params,
        success: function(res) {
          deferred.resolve(res);
        },
        error: function(res) {
          deferred.reject(res);
        }
      });
      return promise;
    };
  }]);
};
},{}],109:[function(require,module,exports){
module.exports = function(app) {
    app.service('templateService', ['xhrService', '$q', 'cacheService', function(
        xhrService, $q, cacheService) {
        var me = this;
        this.query = function(path, type, params, needAll) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            var params = params || {};
            xhrService[type].call(this, {
                path: path,
                params: params,
                success: function(res, data) {
                    deferred.resolve(res);
                },
                error: function(res, data) {
                    deferred.reject(res);
                }
            });
            return promise;
        };
        /*获取模版列表
         *dest_id
         */
        this.queryTemplateList = function(params) {
            return me.query('template/helper/pageable', 'Post', params);
        };
        /*添加模板
         *name
         *version
         *dest_id
         */
        this.addTemplate = function(params) {
            return me.query('template/add', 'Post', params);
        };
        /*创建模板
        
         */
        this.createTemplate = function(params) {
            return me.query('template/helper', 'Post', params);
        };
        /*修改模板
         *id
         *type
         *name
         *status   
         *module
         */
        this.editTemplate = function(params) {
            // params.module = JSON.stringify(params.module);
            return me.query('template/helper', 'Put', params);
        };

        /*删除模板
         *id
         */
        this.deleteTemplate = function(params) {
            return me.query('template/helper/1/'+params.id, 'Delete', params);
        };
        /*获取模板详情
         */
        this.queryTemplateDetail = function(params) {
            return me.query('template/helper/' + params.id, 'Get', params);
        };
        /*模板发布
        type
        id
        status
         */
        this.publishTemplate=function(params){
            return me.query('template/helper/modify_status', 'Put', params);
        }


    }]);
};

},{}],110:[function(require,module,exports){
module.exports = function(app) {
  app.service('uploadService', ['xhrService', 'utilService', '$q', function(
    xhrService, utilService, $q) {
    var picFormApiSecret = window.cfg.picSecret;
    //建立一個可存取到該file的url
    this.getObjectURL = function(file) {
      var url = null;
      if (window.createObjectURL != undefined) { // basic
        url = window.createObjectURL(file);
      } else if (window.URL != undefined) { // mozilla(firefox)
        url = window.URL.createObjectURL(file);
      } else if (window.webkitURL != undefined) { // webkit or chrome
        url = window.webkitURL.createObjectURL(file);
      }
      return url;
    };
    this.getGuid = function() {
      var guid = "";
      for (var i = 1; i <= 32; i++) {
        var n = Math.floor(Math.random() * 16.0).toString(16);
        guid += n;
        if ((i == 8) || (i == 12) || (i == 16) || (i == 20))
          guid += "";
      }
      return guid;
    };
    this.upload = function(opts) {
      var file_dom = opts.file_dom,
        folder = opts.folder,
        str_dom = opts.str_dom,
        size_limit = opts.size_limit || {},
        is_upload_upyun = typeof opts.is_upload_upyun != 'undefined' ?
        opts.is_upload_upyun : true;
      var deferred = $q.defer();
      var promise = deferred.promise;
      var me = this;
      var file = file_dom.files[0];

      var myDate = new Date();
      var img = new Image();
      img.src = me.getObjectURL(file);
      img.onload = function() {
        if (file.size > size_limit.size && size_limit.size) {
          utilService.alertError('该图片已超过' + utilService.parseKByBytes(
              size_limit.size) +
            'k的限制');
          return;
        }
        if (img.width > size_limit.width && size_limit.width) {
          utilService.alertError('该图片宽已超过' + size_limit.width +
            '的限制');
          return;
        }
        if (img.height > size_limit.height && size_limit.height) {
          utilService.alertError('该图片高已超过' + size_limit.height +
            '的限制');
          return;
        }
        if (is_upload_upyun == 'true') { //需要上传又拍云
          var ext = '.' + file.name.split('.').pop();
          var config = {
            bucket: window.cfg.picBucket,
            expiration: parseInt((new Date().getTime() + 3600000) /
              1000),
            // 尽量不要使用直接传表单 API 的方式，以防泄露造成安全隐患
            form_api_secret: picFormApiSecret
          };
          var instance = new Sand(config);
          var path = '/' + folder + '/' + myDate.getFullYear() +
            '/' +
            myDate.getMonth() + '/' + me.getGuid() + '_' + file.size +
            '_' + img.width +
            'X' + img.height + ext;
          instance.upload(path, file_dom, function(res) {
            if (!str_dom) {
              deferred.resolve(res);
            } else {
              angular.element(str_dom).val(res.path);
            }
          });
        } else { //不需上传又拍云
          var res = {
            file_size: file.size,
            image_width: img.width,
            image_height: img.height,
            path: img.src
          }
          deferred.resolve(res);
        }

      };
      return promise;
    };
    this.uploadFile = function() {
      var deferred = $q.defer();
      var promise = deferred.promise;
      var input = angular.element('<input type="file"/>');
      input.bind('change', function(e) {
        var file = e.currentTarget.files[0];
        deferred.resolve(file);
      });
      input[0].click();
      return promise;
    };
  }]);
};
},{}],111:[function(require,module,exports){
/*
 *shelfService
 */
module.exports = function(app) {

  app.service('utilService', function($sce, CONSTANTS, $mdDialog, $filter) {
    /*
     *格式化表格头
     */
    this.transformHead = function(heads, config) {
      var temp = [];
      angular.forEach(heads, function(item) {
        if (!item.getValue) {
          item.getValue = function(value, record, index, scope) {
            var v = '<span>' + record[item.field] + '</span>';
            if (!(config && config.needCompile)) { //不需要编译
              v = $sce.trustAsHtml(v);
            }
            return v;
          };
        }
        temp.push(item);
      });
      return temp;
    };
    this.parseDateByTimeStamp = function(t, pattern) {
      return $filter('date')(t, 'yyyy-MM-dd HH:mm:ss');
    };
    /*
    *格式化时间
    d:date类型
    fmt
    */
    this.parseTimeByDate = function(d, fmt) {
      var f = fmt || 'yyyy-MM-dd hh:mm:ss',
        o = {
          "M+": d.getMonth() + 1, //月份
          "d+": d.getDate(), //日
          "h+": d.getHours(), //小时
          "m+": d.getMinutes(), //分
          "s+": d.getSeconds(), //秒
          "q+": Math.floor((d.getMonth() + 3) / 3), //季度
          "S": d.getMilliseconds() //毫秒
        };
      if (/(y+)/.test(f)) {
        f = f.replace(RegExp.$1, (d.getFullYear() + "").substr(4 -
          RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(f)) {
          f = f.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (
            ("00" + o[k]).substr(("" + o[k]).length)));
        }
      }
      return f;
    };
    /*
    *格式化时间
    *l:long类型
    fmt
    */
    this.parseTimeByLong = function(l, fmt) {
      var d = new Date(parseInt(l));
      return this.parseTimeByDate(d, fmt);
    };
    this.parseTimeByDateDis = function(d, dis, fmt) {
      var f = fmt || 'yyyy-MM-dd hh:mm:ss';
      var beginTime = d.getTime();
      var endTime = d.getTime() + dis * 24 * 60 * 60 * 1000;
      d.setTime(endTime);
      return this.parseTimeByDate(new Date(d), fmt);
    };
    this.parseLongTimeByDateDis = function(d, dis) {
      var beginTime = d.getTime();
      var endTime = d.getTime() + dis * 24 * 60 * 60 * 1000;
      return endTime;
    };
    this.getConstantJsonValue = function(key) {
      var values = CONSTANTS.SHELF_STATE.DESC;
      var result = [];
      angular.forEach(values, function(v, k) {
        result.push({
          value: k,
          desc: v
        });
      });
      console.log(result);
      return result;
    };
    this.indexArray = function(data, offset, keyname) {
      if (!keyname) {
        keyname = 'index';
      }
      angular.forEach(data, function(item, index) {
        item[keyname] = index + offset;
      });
      return data;
    };
    //获取查询请求的参数
    this.getSearchParams = function(params, value, key) {
      if (value) {
        params[key] = value;
      }
      return params;
    };
    //重置分页参数
    this.resetPagination = function(scope, offset, limit) {
      scope.offset = offset;
      scope.limit = limit;
      return {
        offset: scope.offset,
        limit: scope.limit
      };
    };
    //弹出错误警告
    this.alertError = function(errorMessage) {
      $mdDialog.show($mdDialog.alert({
        title: '失败',
        textContent: errorMessage,
        ok: '关闭',
        zIndex: 99999999999999
      }).clickOutsideToClose(true));
    };
    //弹出成功提示
    this.alertSuccess = function(msg) {
      $mdDialog.show($mdDialog.alert({
        title: '成功',
        textContent: msg,
        ok: '关闭',
        zIndex: 99999999999999
      }).clickOutsideToClose(true));
    };
    //将字节转换为K
    this.parseKByBytes = function(bytes) {
      return Math.round((bytes /
        1024 * 100) / 100);
    };
    //获取人民币
    this.getRMBStr = function(amt) {

      return amt ? (parseInt(amt / 100) + '.' + parseInt((amt / 10) %
        10) + parseInt(amt % 10)) : '0';
    };
    //获取分
    this.getPointInt = function(value) {
      return parseInt((value * 100).toFixed(0));
    };
    this.getPointDouble = function(value) {
      return (value * 100).toFixed(2);
    };
  });
};
},{}],112:[function(require,module,exports){
/**
 * Created by taoxiaofeng on 16/6/27.
 */
module.exports = function(app) {
    app.service('welfareService', ['xhrService', '$q', function(xhrService, $q) {
        /*零花钱工单列表分页查询
         *companyId
         *offset
         *limit
         */
        this.queryWelfareList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'welfare/pocketmoney/pageable',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*查询零钱发放列表
         *orderId
         *offset
         *limit
         */
        this.queryWelfareObjectList = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'welfare/pocketmoney/order/' + params.orderId + '/items',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*零钱审核
         *orderId
         *orderState
         *optRecord
         */
        this.auditWelfare = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Put({
                path: 'welfare/pocketmoney/order/state',
                params: params,
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
        /*发放零钱
        *
        */
    }]);
};

},{}],113:[function(require,module,exports){
module.exports = function(app) {
    app.service('wishlistService', ['xhrService', '$q', function(xhrService, $q) {
        this._parseWishlist = function(data) {
            var temp = [];
            var shelfCount = data.shelfCount;
            angular.forEach(data.items, function(item, i) {
                var t = angular.copy(item);
                t.excess = i + 1 > 20 * shelfCount;//大于20*货架数斜体显示
                temp.push(t);
            });
            return temp;
        };
        /*查询企业心愿商品列表
         *companyId
         */
        this.queryWishlist = function(params) {
            var deferred = $q.defer();
            var promise = deferred.promise;
            xhrService.Get({
                path: 'wishlist/company/' + params.companyId + '/reached',
                success: function(res) {
                    deferred.resolve(res);
                }
            });
            return promise;
        };
    }]);
}

},{}],114:[function(require,module,exports){
module.exports = function(app) {
  app.service('xhrService', ['$http', 'cacheService', '$mdDialog', '$mdToast',
    'loaddingService',
    function($http, cacheService, $mdDialog, $mdToast, loaddingService) {
      var _request = function(path, type, opts) {
        var config = { responseType: opts.responseType };
        config.url = (path ? window.cfg[path] : window.cfg.biz) + opts.path;
        config.method = type;
        config.data = {};
        config.timeout = 30000;
        config.headers = angular.extend(config.headers || {}, opts.headers);
        var pageConfig = {};
        if (type !== 'GET' && opts.params && opts.params.offset !==
          undefined && opts.params.limit !== undefined) {
          pageConfig.offset = opts.params.offset;
          pageConfig.limit = opts.params.limit;
          opts.params = _.omit(opts.params, 'offset');
          opts.params = _.omit(opts.params, 'limit');

          if (config.url.indexOf('?') == -1) {
            config.url = config.url + '?';
          } else {
            config.url = config.url + '&';
          }
          config.url = config.url + 'offset=' + pageConfig.offset +
            '&limit=' + pageConfig.limit;
        }
        type == 'GET' ? config.params = opts.params : config.data =
          opts.params;
        var dataType = opts.dataType ? opts.dataType : 'text';
        var authorization = cacheService.getSession();
        config.transformResponse = function(res) {
          if (dataType == 'text' && res) {
            res = res.replace(/\":(\d{16,})/g, "\":\"$1\""); //long型转string
            try {
              res = JSON.parse(res);
            } catch (e) {
              res = res;
            }

          }
          return res;
        };
        config.headers = angular.extend(config.headers || {}, {
          'Authorization': authorization,
          'X-Request-With': null
        });
        if (authorization) {
          config.headers = angular.extend(config.headers || {}, {
            'Authorization': authorization
          });
        }
        //loadding start
        loaddingService.show();

        $http(config).success(function(res, status, headers, config) {
          //loadding end
          loaddingService.hide();
          opts.success.call(this, res.data || res, status, headers,
            config);

        }).error(function(res, status, headers, config) {
          //loadding end
          loaddingService.hide();
          var error = opts.error;
          if (status == 403) {
            cacheService.setSession('');
            window.location.hash = '#/home';
            window.location.reload();
            return;
          }
          var errorMessage = res && (res.message || res.msg || res.error);
          if (opts.toastError) {
            $mdToast.show($mdToast.simple()
              .textContent("失败: " + errorMessage)
              .position('bottom right')
              .hideDelay(3000));
          } else {
            $mdDialog.show($mdDialog.alert({
              title: '失败',
              textContent: errorMessage,
              ok: '关闭',
              zIndex: 99999999999999
            }).clickOutsideToClose(true));
          }
          //res && window.alert(res.message);
          error && error.call(this, res);

        });
      };
      this.Get = function(opts) {
        _request(opts.host || 'biz', 'GET', opts);
      };
      this.Post = function(opts) {
        _request(opts.host || 'biz', 'POST', opts);
      };
      this.Put = function(opts) {
        _request(opts.host || 'biz', 'PUT', opts);
      };
      this.Delete = function(opts) {
        _request(opts.host || 'biz', 'DELETE', opts);
      };
      this.Upload = function(opts) {
        opts.headers = angular.extend({
          'Content-Type': undefined
        }, opts.headers || {});
        opts.transformRequest = angular.identity;
        _request(opts.host || 'biz', 'POST', opts);
      };
    }
  ]);
};
},{}],115:[function(require,module,exports){
module.exports=[require("./service/accountService.js"),require("./service/authService.js"),require("./service/cacheService.js"),require("./service/companyService.js"),require("./service/configurationInformationService.js"),require("./service/deadStockService.js"),require("./service/dialogService.js"),require("./service/financeService.js"),require("./service/goodsChooseService.js"),require("./service/holidayWelfareService.js"),require("./service/inStorageService.js"),require("./service/labelsManagementsService.js"),require("./service/loaddingService.js"),require("./service/modalService.js"),require("./service/newProductService.js"),require("./service/orderService.js"),require("./service/positionService.js"),require("./service/printService.js"),require("./service/productService.js"),require("./service/promotionService.js"),require("./service/roleService.js"),require("./service/salesService.js"),require("./service/shelfService.js"),require("./service/staffService.js"),require("./service/suiteService.js"),require("./service/templateService.js"),require("./service/uploadService.js"),require("./service/utilService.js"),require("./service/welfareService.js"),require("./service/wishlistService.js"),require("./service/xhrService.js")]
},{"./service/accountService.js":84,"./service/authService.js":85,"./service/cacheService.js":86,"./service/companyService.js":87,"./service/configurationInformationService.js":88,"./service/deadStockService.js":89,"./service/dialogService.js":90,"./service/financeService.js":91,"./service/goodsChooseService.js":92,"./service/holidayWelfareService.js":93,"./service/inStorageService.js":94,"./service/labelsManagementsService.js":95,"./service/loaddingService.js":96,"./service/modalService.js":97,"./service/newProductService.js":98,"./service/orderService.js":99,"./service/positionService.js":100,"./service/printService.js":101,"./service/productService.js":102,"./service/promotionService.js":103,"./service/roleService.js":104,"./service/salesService.js":105,"./service/shelfService.js":106,"./service/staffService.js":107,"./service/suiteService.js":108,"./service/templateService.js":109,"./service/uploadService.js":110,"./service/utilService.js":111,"./service/welfareService.js":112,"./service/wishlistService.js":113,"./service/xhrService.js":114}]},{},[82])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvanMvY29uc3RhbnRzLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvYWNjb3VudC5qcyIsImFwcC9qcy9jb250cm9sbGVyL2FwcC5qcyIsImFwcC9qcy9jb250cm9sbGVyL2NvbW1lbnRzTWFuYWdlLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvY29tcGFueS5qcyIsImFwcC9qcy9jb250cm9sbGVyL2NvbmZpZ3VyYXRpb25JbmZvcm1hdGlvbi5qcyIsImFwcC9qcy9jb250cm9sbGVyL2RlYWRTdG9jay5qcyIsImFwcC9qcy9jb250cm9sbGVyL2RlbGl2ZXJ5RWRpdC5qcyIsImFwcC9qcy9jb250cm9sbGVyL2ZpbmFuY2UuanMiLCJhcHAvanMvY29udHJvbGxlci9nb29kc0Nob29zZUhpc3RvcnkuanMiLCJhcHAvanMvY29udHJvbGxlci9nb29kc0Nob29zZU9yZGVyLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvaG9saWRheVdlbGZhcmUuanMiLCJhcHAvanMvY29udHJvbGxlci9ob21lLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvaW5TdG9yYWdlLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvaW5mb3JtYXRpb24uanMiLCJhcHAvanMvY29udHJvbGxlci9pc3N1ZUR5bmFtaWMuanMiLCJhcHAvanMvY29udHJvbGxlci9sYWJlbHNNYW5hZ2VtZW50LmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvbmV3UHJvZHVjdFJlY29tbWVuZC5qcyIsImFwcC9qcy9jb250cm9sbGVyL29yZGVyLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvcGlja09yZGVyLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvcG9zaXRpb25NYW5hZ2UuanMiLCJhcHAvanMvY29udHJvbGxlci9wcm9kdWN0LmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvcHJvbW90aW9uT3JkZXIuanMiLCJhcHAvanMvY29udHJvbGxlci9wcm9tb3Rpb25Qcm9kdWN0LmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvcHJvbW90aW9uU3VpdGUuanMiLCJhcHAvanMvY29udHJvbGxlci9yb2xlLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvc2FsZXNTdGF0aXN0aWNzLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvc2hlbGYuanMiLCJhcHAvanMvY29udHJvbGxlci9zaGVsZkRldGFpbC5qcyIsImFwcC9qcy9jb250cm9sbGVyL3NoZWxmTWFuYWdlLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvc3VpdGVDZmdNYW5hZ2UuanMiLCJhcHAvanMvY29udHJvbGxlci9zdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWMuanMiLCJhcHAvanMvY29udHJvbGxlci90ZWFJbmZvcm1hdGlvbi5qcyIsImFwcC9qcy9jb250cm9sbGVyL3RlbXBsYXRlLmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvdGVtcGxhdGVFZGl0LmpzIiwiYXBwL2pzL2NvbnRyb2xsZXIvd2VsZmFyZS5qcyIsImFwcC9qcy9jb250cm9sbGVycy5qcyIsImFwcC9qcy9kaXJlY3RpdmUvYmxvY2tBZGQuanMiLCJhcHAvanMvZGlyZWN0aXZlL2NvbXBhbnlTZWFyY2hlci5qcyIsImFwcC9qcy9kaXJlY3RpdmUvY29tcGlsZUh0bWwuanMiLCJhcHAvanMvZGlyZWN0aXZlL2NvdW50LmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9kYXRlRm9ybWF0ZS5qcyIsImFwcC9qcy9kaXJlY3RpdmUvZGF0ZVBpY2tlci5qcyIsImFwcC9qcy9kaXJlY3RpdmUvZGlhbG9nLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9kcm9wRG93bi5qcyIsImFwcC9qcy9kaXJlY3RpdmUvZWNoYXJ0c0xpbmUuanMiLCJhcHAvanMvZGlyZWN0aXZlL2ZpeGVkVGFibGVIZWFkZXJzLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9mb3JtUmVxdWlyZWQuanMiLCJhcHAvanMvZGlyZWN0aXZlL2xhYmVsc01hbmFnZW1lbnRzLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9sb2dpbi5qcyIsImFwcC9qcy9kaXJlY3RpdmUvbWRJbWcuanMiLCJhcHAvanMvZGlyZWN0aXZlL21kVXBsb2FkZXIuanMiLCJhcHAvanMvZGlyZWN0aXZlL21vZHVsZS5qcyIsImFwcC9qcy9kaXJlY3RpdmUvbXNTdGVwcGVyLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9tc1N0ZXBwZXJTdGVwLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9uYXZpZ2F0b3IuanMiLCJhcHAvanMvZGlyZWN0aXZlL25ld1VzZXJzLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9vbkZpbmlzaFJlbmRlckZpbHRlcnMuanMiLCJhcHAvanMvZGlyZWN0aXZlL3BhbmVsLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9wZXJtaXNzaW9ucy5qcyIsImFwcC9qcy9kaXJlY3RpdmUvcHJvZHVjdFNlYXJjaGVyLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9wcm9tb3Rpb24uanMiLCJhcHAvanMvZGlyZWN0aXZlL3JlcXVpcmVkSW5wdXQuanMiLCJhcHAvanMvZGlyZWN0aXZlL3NlYXJjaEdyb3VwLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9zaWRlYmFyLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS9zb3J0QnV0dG9uLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS90ZWFTZWFyY2hlci5qcyIsImFwcC9qcy9kaXJlY3RpdmUvdG9wU2VhcmNoZXIuanMiLCJhcHAvanMvZGlyZWN0aXZlL3VwbG9hZGVyLmpzIiwiYXBwL2pzL2RpcmVjdGl2ZS92YWxpZEZpbGVJbnB1dC5qcyIsImFwcC9qcy9kaXJlY3RpdmVzLmpzIiwiYXBwL2pzL2ZpbHRlci9kZXNjLmpzIiwiYXBwL2pzL2ZpbHRlci9pbWcuanMiLCJhcHAvanMvZmlsdGVyL2ludC5qcyIsImFwcC9qcy9maWx0ZXIvcG9pbnRzLmpzIiwiYXBwL2pzL2ZpbHRlci9ybWIuanMiLCJhcHAvanMvZmlsdGVyL3NlbGVjdGlvbi5qcyIsImFwcC9qcy9maWx0ZXIvc3R5bGUuanMiLCJhcHAvanMvZmlsdGVyL3ZhbHVlLmpzIiwiYXBwL2pzL2ZpbHRlci93ZWVrLmpzIiwiYXBwL2pzL2ZpbHRlcnMuanMiLCJhcHAvanMvaW5kZXguanMiLCJhcHAvanMvcm91dGVycy5qcyIsImFwcC9qcy9zZXJ2aWNlL2FjY291bnRTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvYXV0aFNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9jYWNoZVNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9jb21wYW55U2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL2NvbmZpZ3VyYXRpb25JbmZvcm1hdGlvblNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9kZWFkU3RvY2tTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvZGlhbG9nU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL2ZpbmFuY2VTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvZ29vZHNDaG9vc2VTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvaG9saWRheVdlbGZhcmVTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvaW5TdG9yYWdlU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL2xhYmVsc01hbmFnZW1lbnRzU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL2xvYWRkaW5nU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL21vZGFsU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL25ld1Byb2R1Y3RTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2Uvb3JkZXJTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvcG9zaXRpb25TZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvcHJpbnRTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvcHJvZHVjdFNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9wcm9tb3Rpb25TZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2Uvcm9sZVNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9zYWxlc1NlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9zaGVsZlNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9zdGFmZlNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS9zdWl0ZVNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS90ZW1wbGF0ZVNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS91cGxvYWRTZXJ2aWNlLmpzIiwiYXBwL2pzL3NlcnZpY2UvdXRpbFNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZS93ZWxmYXJlU2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL3dpc2hsaXN0U2VydmljZS5qcyIsImFwcC9qcy9zZXJ2aWNlL3hoclNlcnZpY2UuanMiLCJhcHAvanMvc2VydmljZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcnhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2w4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3prQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3R3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDemtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdlhBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5aUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0VEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0dBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAnQ09OU1RBTlRTJzoge1xuICAgIC8v5YWs5Y+457G75Z6LXG4gICAgJ0NPTVBBTllfVFlQRSc6IHtcbiAgICAgIENPTVBBTllfUEFZX01PREU6ICcxJyxcbiAgICAgIEVNUF9QQVlfTU9ERTogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfkvIHkuJrmgLvljIUnLFxuICAgICAgICAnMic6ICflkZjlt6Xoh6rotLknXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+WuouaIt+exu+WIq1xuICAgICdDVVNUT01FUl9UWVBFJzoge1xuICAgICAgQ09NUEFOWTogJzEnLFxuICAgICAgSE9URUw6ICcyJyxcbiAgICAgIElOVEVSTkVUX0JBUjogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfkvIHkuJonLFxuICAgICAgICAnMic6ICfphZLlupcnLFxuICAgICAgICAnMyc6ICfnvZHlkKcnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+WuouaIt+eKtuaAgVxuICAgICdDVVNUT01FUl9TVEFUVVMnOiB7XG4gICAgICBCRUlOR19DT09QRVJBVEU6ICcwJyxcbiAgICAgIFBBVVNFX0NPT1BFUkFURTogJzEnLFxuICAgICAgU1RPUF9DT09QRVJBVEU6ICcyJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5ZCI5L2c5LitJyxcbiAgICAgICAgJzEnOiAn5pqC5YGc5ZCI5L2cJyxcbiAgICAgICAgJzInOiAn5YGc5q2i5ZCI5L2cJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy/mi6PotKfnsbvlnotcbiAgICAnUElDS0lOR19UWVBFJzoge1xuICAgICAgUkFORE9NOiAnMicsXG4gICAgICBTRUxGOiAnMScsXG4gICAgICBPVEhFUjogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMic6ICflsI/kuozlj6/pmo/mnLrphY0nLFxuICAgICAgICAnMSc6ICflrozlhajoh6rpgIknLFxuICAgICAgICAnMyc6ICflhbbku5YnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+Wdj+i0puaKteaJo+exu+Wei1xuICAgICdDT01QQU5ZX0RFRFVDVElPTl9UWVBFJzoge1xuICAgICAgSU5fVFJBREVfUEFJRDogJzEnLCAvL+a6ouS7t+aUr+S7mOaUtuWFpVxuICAgICAgSU5fUExBVDogJzMnLCAvL+W5s+WPsOWPkeaUvuaUtuWFpVxuICAgICAgT1VUX1NFVFRMRU1FTlRfUEFZOiAnMicsIC8v57uT566X5oq15omj5pSv5Ye6XG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+a6ouS7t+aUr+S7mOaUtuWFpScsXG4gICAgICAgICcyJzogJ+e7k+eul+aKteaJo+aUr+WHuicsXG4gICAgICAgICczJzogJ+W5s+WPsOWPkeaUvuaUtuWFpSdcbiAgICAgIH1cbiAgICB9LFxuICAgIC8v6LSn5p6257G75Z6LXG4gICAgJ1NIRUxGX1RZUEUnOiB7XG4gICAgICBTTkFDS1M6ICcwJyxcbiAgICAgIEZSSURHRTogJzEnLFxuICAgICAgRlJFRVpFUjogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfpm7bpo58nLFxuICAgICAgICAnMSc6ICflhrDnrrEnLFxuICAgICAgICAnMic6ICflhrDmn5wnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+WNleaNruexu+Wei1xuICAgICdPUkRFUl9UWVBFJzoge1xuICAgICAgREVMSVZFUlk6ICcxJyxcbiAgICAgIFJFRlVORDogJzInLFxuICAgICAgSU5WRU5UT1JZOiAnMycsXG4gICAgICBTRVRUTEVNRU5UOiAnNCcsXG4gICAgICBIT0xJREFZOiAnMTAwJyxcbiAgICAgIFRFQU9SREVSOiAnOTknLFxuICAgICAgUFJPTU9USU9OOiAnOTgnLFxuICAgICAgU1VJVEVEWU5BTUlDOiAnOTcnLFxuICAgICAgSVNTVUVEWU5BTUlDOiAnOTYnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfpgIHotKfljZUnLFxuICAgICAgICAnMic6ICfpgIDotKfljZUnLFxuICAgICAgICAnMyc6ICfnm5jngrnljZUnLFxuICAgICAgICAnNCc6ICfnu5PnrpfljZUnLFxuICAgICAgICAnMTAwJzogJ+iKguWBh+aXpeemj+WIqeWNlScsXG4gICAgICAgICc5OSc6ICfkuIvljYjojLYnLFxuICAgICAgICAnOTgnOiAn6JCl6ZSA5Y2VJyxcbiAgICAgICAgJzk3JzogJ+Wll+mkkOWKqOaAgScsXG4gICAgICAgICc5Nic6ICfmnJ/lj7fliqjmgIEnXG4gICAgICB9XG4gICAgfSxcbiAgICAnSU5fU1RPUkFHRV9PUkRFUl9UWVBFJzoge1xuICAgICAgREVMSVZFUllfTU9ESUZZX0NPTkZJUk06ICcxJyxcbiAgICAgIFJFRlVORF9DT05GSVJNOiAnMicsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+mAgei0p+S/ruaUueehruiupOWNlScsXG4gICAgICAgICcyJzogJ+mAgOi0p+WFpeW6k+ehruiupOWNlScsXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+i0p+aetueKtuaAgVxuICAgICdTSEVMRl9TVEFURSc6IHtcbiAgICAgIFdBSVRfU0VORDogJzAnLFxuICAgICAgV0FJVF9DT01GSVJNOiAnMScsXG4gICAgICBXQUlUX09OTElORTogJzInLFxuICAgICAgVU5PUkRFUjogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICflt7LkuIvljZXlvoXlj5HpgIEnLFxuICAgICAgICAnMSc6ICflt7LkuIvljZXlvoXnoa7orqQnLFxuICAgICAgICAnMic6ICflt7Lnoa7orqTlvoXkuIrmnrYnLFxuICAgICAgICAnMyc6ICfmnKrkuIvljZUnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+WFpeW6k+S/ruaUueehruiupOWNleeKtuaAgVxuICAgIC8vICdJTl9TVE9SQUdFX1NUQVRFJzoge1xuICAgIC8vICAgICBJTl9TVE9SQUdFX05POiAxLFxuICAgIC8vICAgICBJTl9TVE9SQUdFX1lFUzogMixcbiAgICAvLyAgICAgREVTQzoge1xuICAgIC8vICAgICAgICAgMTogJ+acquWFpeW6kycsXG4gICAgLy8gICAgICAgICAyOiAn5bey5YWl5bqTJ1xuICAgIC8vICAgICB9XG4gICAgLy8gfSxcbiAgICAnSU5fU1RPUkFHRV9TVEFURSc6IHtcbiAgICAgIElOX1NUT1JBR0VfTk86ICcwJyxcbiAgICAgIElOX1NUT1JBR0VfWUVTOiAnMScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+acquWFpeW6kycsXG4gICAgICAgICcxJzogJ+W3suWFpeW6kydcbiAgICAgIH1cbiAgICB9LFxuICAgIC8v5YWl5bqT5L+u5pS556Gu6K6k5Y2V5piv5ZCm5L+u5pS5XG4gICAgJ0lOX1NUT1JBR0VfTU9ESUZZU1RBVEUnOiB7XG4gICAgICBJTl9TVE9SQUdFX01PRElGWVNUQVRFX05POiAnMCcsXG4gICAgICBJTl9TVE9SQUdFX01PRElGWVNUQVRFX1lFUzogJzEnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICflkKYnLFxuICAgICAgICAnMSc6ICfmmK8nXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+mAgei0p+WNleeKtuaAgVxuICAgICdERUxJVkVSWV9TVEFURSc6IHtcbiAgICAgIElOSVQ6ICcwJyxcbiAgICAgIFdBSVRfUElDSzogJzQnLFxuICAgICAgUElDS0lORzogJzUnLFxuICAgICAgUkVUVVJOX0lOSVQ6ICc2JyxcbiAgICAgIFdBSVRfQ09NRklSTTogJzEnLFxuICAgICAgV0FJVF9TSEVMVkU6ICcyJyxcbiAgICAgIENPTVBMRVRFRDogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfku4Xkv53lrZgnLFxuICAgICAgICAnNCc6ICflvoXmi6PotKcnLFxuICAgICAgICAnNSc6ICfmraPlnKjmi6PotKcnLFxuICAgICAgICAnNic6ICfku5PlupPov5Tlm54nLFxuICAgICAgICAnNyc6ICflrqLmiLfpgIDljZUnLFxuICAgICAgICAnMSc6ICfnrYnlvoXnoa7orqQnLFxuICAgICAgICAnMic6ICfnrYnlvoXkuIrmnrYnLFxuICAgICAgICAnMyc6ICfkuIrmnrblrozmiJAnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+mAgOi0p+WNleeKtuaAgVxuICAgICdSRUZVTkRfU1RBVEUnOiB7XG4gICAgICBJTklUOiAnMCcsXG4gICAgICBXQUlUX0NPTUZJUk06ICcxJyxcbiAgICAgIENPTVBMRVRFRDogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfkv53lrZjmnKrlj5HpgIEnLFxuICAgICAgICAnMSc6ICfnrYnlvoXnoa7orqQnLFxuICAgICAgICAnMic6ICflt7Lnoa7orqQnXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+ebmOeCueWNleeKtuaAgVxuICAgICdJTlZFTlRPUllfU1RBVEUnOiB7XG4gICAgICBJTklUOiAnMCcsXG4gICAgICBXQUlUX0NPTUZJUk06ICcxJyxcbiAgICAgIFdBSVRfU0VUVExFTUVOVDogJzInLFxuICAgICAgQ09NUExFVEVEOiAnMycsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+W+hee7k+eulycsXG4gICAgICAgICcxJzogJ+W+hee7k+eulycsXG4gICAgICAgICcyJzogJ+W+hee7k+eulycsXG4gICAgICAgICczJzogJ+W3sue7k+eulydcbiAgICAgIH1cbiAgICB9LFxuICAgIC8v57uT566X5Y2V54q25oCBXG4gICAgJ1NFVFRMRU1FTlRfU1RBVEUnOiB7XG4gICAgICBJTl9JTlZFTlRPUlk6ICcwJyxcbiAgICAgIFdBSVRfU0VORDogJzEnLFxuICAgICAgV0FJVF9DT01GSVJNOiAnMicsXG4gICAgICBXQUlUX1NFVFRMRU1FTlQ6ICczJyxcbiAgICAgIENPTVBMRVRFRDogJzQnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfnm5jngrnkuK0nLFxuICAgICAgICAnMSc6ICfmnKrlj5HpgIEnLFxuICAgICAgICAnMic6ICflj5HpgIHlvoXnoa7orqQnLFxuICAgICAgICAnMyc6ICflvoXku5jmrL4nLFxuICAgICAgICAnNCc6ICflt7Lku5jmrL4nXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+mAieWTgeWNleeKtuaAgVxuICAgICdHT09EU0NIT09TRV9PUkRFUl9TVEFURSc6IHtcbiAgICAgIFdBSVRfVkVSSUZZOiAnMScsXG4gICAgICBWRVJJRklFRDogJzUnLFxuICAgICAgRklOSVNIOiAnNicsXG4gICAgICBDT01QQU5ZX0NBTkNMRUQ6ICc4JyxcbiAgICAgIFNZU19DQU5DTEVEOiAnOScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+W+heaOpeaUticsXG4gICAgICAgICc1JzogJ+W3suaOpeaUticsXG4gICAgICAgICc2JzogJ+W3suWujOaIkCcsXG4gICAgICAgICc4JzogJ+W3suWIoOmZpCcsIC8v5LyB5Lia5Y+W5raIXG4gICAgICAgICc5JzogJ+W3suWPlua2iCcgLy/lpb3lk4Hlj5bmtohcbiAgICAgIH1cbiAgICB9LFxuICAgIC8v5ZWG5ZOB6aG16Z2i5qih5byPXG4gICAgJ1BST0RVQ1RfUEFHRV9NT0RFJzoge1xuICAgICAgTUFOQUdFOiAwLFxuICAgICAgU0VMRUNUOiAxLFxuICAgICAgREVTQzoge1xuICAgICAgICAwOiAn566h55CGJyxcbiAgICAgICAgMTogJ+mAieaLqSdcbiAgICAgIH1cbiAgICB9LFxuICAgIC8v6YCB6LSn5Y2V57Sn5oCl5bqmXG4gICAgJ0RFTElWRVJZX1VSR0VOQ1knOiB7XG4gICAgICBDT01NT046ICcwJyxcbiAgICAgIFVSR0VOQ1k6ICcxJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5q2j5bi4JyxcbiAgICAgICAgJzEnOiAn57Sn5oClJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy/mlbDlrZflop7lh4/moIflv5dcbiAgICAnTlVNX01PRElGWV9NT0RFJzoge1xuICAgICAgQUREOiAnMCcsXG4gICAgICBSRURVQ0U6ICcxJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5aKeJyxcbiAgICAgICAgJzEnOiAn5YePJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy/liKnmtqbnrYnnuqdcbiAgICAnUFJPRklUX0xFVkVMJzoge1xuICAgICAgVU5LTk9XTjogJzAnLFxuICAgICAgTE9XX1BST0ZJVDogJzEnLFxuICAgICAgTUVESVVNX1BST0ZJVDogJzUnLFxuICAgICAgSElHSF9QUk9GSVQ6ICc5JyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5pyq55+lJyxcbiAgICAgICAgJzEnOiAn5L2O5Yip5ramJyxcbiAgICAgICAgJzUnOiAn5Lit562J5Yip5ramJyxcbiAgICAgICAgJzknOiAn6auY5Yip5ramJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy/llYblk4HnibnmrormoIfor4ZcbiAgICAnUFJPRFVDVF9UQUcnOiB7XG4gICAgICBORVc6ICcxJyxcbiAgICAgIElOQUNUSVZFOiAnMicsXG4gICAgICBTSElFTEQ6ICczJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzEnOiAn5paw5ZOBJyxcbiAgICAgICAgJzInOiAn5rue6ZSAJyxcbiAgICAgICAgJzMnOiAn5bGP6JS9J1xuICAgICAgfVxuICAgIH0sXG4gICAgJ1NUT0NLX01PRElGWV9UWVBFJzoge1xuICAgICAgSU1QT1JUOiAnMScsXG4gICAgICBFWFBJUkU6ICc0JyxcbiAgICAgIFdBU1RFOiAnNicsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+i/m+i0pycsXG4gICAgICAgICc0JzogJ+i/h+acnycsXG4gICAgICAgICc2JzogJ+aNn+iAlydcbiAgICAgIH1cbiAgICB9LFxuICAgICdXRUxGQVJFX1NUQVRFJzoge1xuICAgICAgV0FJVF9BVURJVDogJzAnLFxuICAgICAgUEFTU0VEOiAnMScsXG4gICAgICBSRUZVU0VEOiAnMicsXG4gICAgICBXQUlUX1NFVFRMRTogJzMnLFxuICAgICAgUEFJRUQ6ICc0JyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5b6F5a6h5qC4JyxcbiAgICAgICAgJzEnOiAn5b6F57uT566XJyxcbiAgICAgICAgJzInOiAn5a6h5qC45pyq6YCa6L+HJyxcbiAgICAgICAgJzMnOiAn5b6F57uT566XJyxcbiAgICAgICAgJzQnOiAn5bey57uT566XJ1xuICAgICAgfSxcbiAgICAgIFNUWUxFOiB7XG4gICAgICAgICcwJzogJ3ByaW1hcnknLFxuICAgICAgICAnMSc6ICdzdWNjZXNzJyxcbiAgICAgICAgJzInOiAnZGFuZ2VyJyxcbiAgICAgICAgJzQnOiAnd2FybmluZydcbiAgICAgIH1cbiAgICB9LFxuICAgICdXRUVLX1RZUEUnOiB7XG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+WRqOS4gCcsXG4gICAgICAgICcyJzogJ+WRqOS6jCcsXG4gICAgICAgICczJzogJ+WRqOS4iScsXG4gICAgICAgICc0JzogJ+WRqOWbmycsXG4gICAgICAgICc1JzogJ+WRqOS6lCcsXG4gICAgICAgICc2JzogJ+WRqOWFrScsXG4gICAgICAgICc3JzogJ+WRqOaXpScsXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+i0ouWKoeezu+e7n+eKtuaAgVxuICAgICdJTlZPSUNFX05FRURfU1RBVEUnOiB7XG4gICAgICBOT05FRUQ6ICcwJyxcbiAgICAgIE5FRUQ6ICcxJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn5LiN6ZyA6KaBJyxcbiAgICAgICAgJzEnOiAn6ZyA6KaBJ1xuICAgICAgfVxuICAgIH0sXG4gICAgJ0lOVk9JQ0VfU1RBVEUnOiB7XG4gICAgICBVTklOVk9JQ0VEOiAnMCcsXG4gICAgICBJTlZPSUNFRDogJzEnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfmnKrlvIDnpagnLFxuICAgICAgICAnMSc6ICflt7LlvIDnpagnXG4gICAgICB9XG4gICAgfSxcbiAgICAnSU5WT0lDRV9USU1FX1RZUEUnOiB7XG4gICAgICBDUkVBVEVUSU1FOiAnMCcsXG4gICAgICBVUERBVEVUSU1FOiAnMScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+eUn+aIkOaXtumXtCcsXG4gICAgICAgICcxJzogJ+abtOaWsOaXtumXtCdcbiAgICAgIH1cbiAgICB9LFxuICAgICdFWFBSRVNTX0NPTVBBTllfVFlQRSc6IHtcbiAgICAgIFlVTkRBOiAnMCcsXG4gICAgICBTSFVORkVORzogJzEnLFxuICAgICAgWElFREFJOiAnMicsXG4gICAgICBZT1VaSEVORzogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfpn7Xovr7lv6vpgJInLFxuICAgICAgICAnMSc6ICfpobrkuLDlv6vpgJInLFxuICAgICAgICAnMic6ICfphY3pgIHmkLrluKYnLFxuICAgICAgICAnMyc6ICfpgq7mlL8nXG4gICAgICB9XG4gICAgfSxcbiAgICAnQ0FURUdPUllfTEVWRUwnOiB7XG4gICAgICBPTkU6ICcxJyxcbiAgICAgIFRXTzogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfkuIDnuqflk4HnsbsnLFxuICAgICAgICAnMic6ICfkuoznuqflk4HnsbsnXG4gICAgICB9XG4gICAgfSxcbiAgICAnUFJPRFVDVF9ESUNfVFlQRSc6IHtcbiAgICAgIE9SSUdJTl9QTEFDRTogJzEnLFxuICAgICAgQlJBTkRfQVdBUkVORVNTOiAnMicsXG4gICAgICBCUkFORF9HUkFERTogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfljp/kuqflnLAnLFxuICAgICAgICAnMic6ICflk4HniYzorqTnn6XluqYnLFxuICAgICAgICAnMyc6ICflk4HniYzmoaPmrKEnXG4gICAgICB9XG4gICAgfSxcbiAgICAnUFJPRFVDVF9TVE9DS19DSEFOR0VfVFlQRSc6IHtcbiAgICAgIFBVUkNIQVNFOiAnMScsXG4gICAgICBERUxJVkVSWTogJzInLFxuICAgICAgUkVUVVJOOiAnMycsXG4gICAgICBFWFBJUkU6ICc0JyxcbiAgICAgIERFTElWRVJZX1JFVFVSTjogJzUnLFxuICAgICAgT1RIRVJfTE9TUzogJzYnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfov5votKcnLFxuICAgICAgICAnMic6ICflh7rotKcnLFxuICAgICAgICAnMyc6ICfpgIDotKcnLFxuICAgICAgICAnNCc6ICfov4fmnJ8nLFxuICAgICAgICAnNSc6ICflh7rotKfpgIDlm54nLFxuICAgICAgICAnNic6ICflhbbku5bmjZ/ogJcnXG4gICAgICB9XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiAg5YWo6YOo57uT566XXG4gICAgICogIOW+ruS/oeaUr+S7mFxuICAgICAqICDlr7nlhazotKblj7fmlK/ku5hcbiAgICAgKi9cbiAgICAnUEFZTUVOVF9TVEFUVVMnOiB7XG4gICAgICBXRUNIQVRfUEFZOiAnMScsXG4gICAgICBBTElQQVlfQVBQOiAnMicsXG4gICAgICBCQUxBTkNFOiAnNScsXG4gICAgICBXRUNIQVRfQVBQOiAnNycsXG4gICAgICBCQU5LX0NBUkQ6ICc4JyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzEnOiAn5b6u5L+h5YWs5LyX5Y+3JyxcbiAgICAgICAgJzInOiAn5pSv5LuY5a6dJyxcbiAgICAgICAgJzUnOiAn5L2Z6aKd5pSv5LuYJyxcbiAgICAgICAgJzcnOiAn5b6u5L+hQVBQ5pSv5LuYJyxcbiAgICAgICAgJzgnOiAn5a+55YWs6LSm5Y+35pSv5LuYJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLyoqXG4gICAgICog5YWo6YOo6K6i5Y2VXG4gICAgICog5b6F5LuY5qy+XG4gICAgICog5b6F6YWN6YCBXG4gICAgICog5bey5a6M5oiQXG4gICAgICovXG4gICAgJ09SREVSX1NUQVRVUyc6IHtcbiAgICAgIFdBSVRJTkdfUEFZTUVOVDogJzEnLFxuICAgICAgV0FJVElOR19ESVNUUklCVVRJT046ICcyJyxcbiAgICAgIENPTVBMRVRFOiAnMycsXG4gICAgICBDQU5DRUw6ICc0JyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzEnOiAn5b6F5LuY5qy+JyxcbiAgICAgICAgJzInOiAn5b6F6YWN6YCBJyxcbiAgICAgICAgJzMnOiAn5bey5a6M5oiQJyxcbiAgICAgICAgJzQnOiAn5bey5Y+W5raIJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLyoqXG4gICAgICog6LSt5Lmw57G75Z6LXG4gICAgICog6aKE5a6aXG4gICAgICovXG4gICAgJ0JVWV9UWVBFJzoge1xuICAgICAgUkVTRVJWQVRJT046ICcwJyxcbiAgICAgIFNFTExJTkc6ICcxJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzAnOiAn6aKE5a6aJyxcbiAgICAgICAgJzEnOiAn54Ot5Y2WJ1xuICAgICAgfVxuICAgIH0sXG4gICAgJ1BBWV9UWVBFJzoge1xuICAgICAgVU5LTk9XOiAnMCcsXG4gICAgICBXWF9QQVk6ICcxJyxcbiAgICAgIEFMSV9QQVk6ICcyJyxcbiAgICAgIENBU0g6ICczJyxcbiAgICAgIEJBTktfQ0FSRDogJzQnLFxuICAgICAgUE9DS0VUX01PTkVZOiAnNScsXG4gICAgICBXWF9NSUNST1BBWTogJzYnLFxuICAgICAgV1hfQVBQUEFZOiAnNycsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+acquefpScsXG4gICAgICAgICcxJzogJ+W+ruS/oeWFrOS8l+WPtycsXG4gICAgICAgICcyJzogJ+aUr+S7mOWunScsXG4gICAgICAgICczJzogJ+eOsOmHkScsXG4gICAgICAgICc0JzogJ+mTtuihjOWNoScsXG4gICAgICAgICc1JzogJ+S9memineaUr+S7mCcsXG4gICAgICAgICc2JzogJ+W+ruS/oeWIt+WNoScsXG4gICAgICAgICc3JzogJ+W+ruS/oUFQUCdcbiAgICAgIH1cbiAgICB9LFxuICAgICdUZWFfT1JERVJfVFlQRSc6IHtcbiAgICAgIEZJTklPUkRFUjogJzAnLFxuICAgICAgTkVYVE9SREVSOiAnMScsXG4gICAgICBDQU5DRUxPUkRFUjogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfmnKrnn6UnLFxuICAgICAgICAnMSc6ICdkYWlqaWVzb25nJyxcbiAgICAgICAgJzInOiAn5bey5Y+W5raIJyxcbiAgICAgIH1cbiAgICB9LFxuICAgICdUaW1lX1BlcmlvZCc6IHtcbiAgICAgIE1PUk5JTkc6ICcxJyxcbiAgICAgIEFGVEVSTk9PTjogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfkuIrljYgnLFxuICAgICAgICAnMic6ICfkuIvljYgnXG4gICAgICB9XG4gICAgfSxcbiAgICAnVGVhX1BlcmlvZF9UeXBlJzoge1xuICAgICAgQUNDRVBUOiAnMScsXG4gICAgICBXQUlUOiAnMicsXG4gICAgICBDQU5DRUw6ICczJyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgJzEnOiAn5bey5o6l5Y2VJyxcbiAgICAgICAgJzInOiAn5b6F5o6l5Y2VJyxcbiAgICAgICAgJzMnOiAn5bey5Y+W5raIJ1xuICAgICAgfVxuICAgIH0sXG4gICAgJ1Byb21vdGlvbl9TZWFyY2hfVHlwZSc6IHtcbiAgICAgIFRFTDogJzEnLFxuICAgICAgQ09NUEFOWTogJzInLFxuICAgICAgTmFtZTogJzMnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICfmjInmiYvmnLrlj7fmkJzntKInLFxuICAgICAgICAnMic6ICfmjInkvIHkuJrlkI3np7DmkJzntKInLFxuICAgICAgICAnMyc6ICfmjInogZTns7vkurrmkJzntKInXG5cbiAgICAgIH1cbiAgICB9LFxuICAgICdQUk9NT1RJT05fT1JERVJfU1RBVFVTJzoge1xuICAgICAgV0FJVF9QQVlfREVQT1NJVDogJzEnLFxuICAgICAgV0FJVF9DT01GSVJNOiAnMicsXG4gICAgICBXQUlUX1BBWV9GVUxMOiAnMycsXG4gICAgICBXQUlUX1NFTkQ6ICc0JyxcbiAgICAgIFNFTkQ6ICc1JyxcbiAgICAgIFJFQ0VJVkVEOiAnNicsXG4gICAgICBDQU5DRUw6ICc3JyxcbiAgICAgIENBTkNFTF84OiAnOCcsXG4gICAgICBDQU5DRUxfOTogJzknLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMSc6ICflvoXku5jlrprph5EnLFxuICAgICAgICAnMic6ICflvoXnoa7orqQnLFxuICAgICAgICAnMyc6ICflvoXku5jlsL7mrL4nLFxuICAgICAgICAnNCc6ICflvoXlj5HotKcnLFxuICAgICAgICBcIjVcIjogXCLlt7Llj5HotKdcIixcbiAgICAgICAgJzYnOiAn5bey5pS26LSnJyxcbiAgICAgICAgXCI3XCI6IFwi5bey5Y+W5raIXCIsXG4gICAgICAgICc4JzogJ+W3suWPlua2iCcsIC8vKOetieW+hemAgOasvilcbiAgICAgICAgJzknOiBcIuW3suWPlua2iFwiIC8vKOW3sumAgOasvilcbiAgICAgIH1cbiAgICB9LFxuICAgICdQUk1PVElPTl9QUk9EVUNUX0FDVElWRSc6IHtcbiAgICAgIEFDVElWRTogJzEnLFxuICAgICAgTk9UQUNUSVZFOiAnMCcsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcxJzogJ+aetuS4iuWVhuWTgScsXG4gICAgICAgICcwJzogJ+W3suS4i+aetuWVhuWTgSdcblxuICAgICAgfVxuICAgIH0sXG4gICAgJ0lTU1VFX1NUQVRVUyc6IHtcbiAgICAgIFdBSVRJTkdfT05MSU5FOiAnMCcsXG4gICAgICBBTFJFQURZX09OTElORTogJzEnLFxuICAgICAgQUxSRUFEWV9PRkZMSU5FOiAnMicsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+W+heS4iue6vycsXG4gICAgICAgICcxJzogJ+W3suS4iue6vycsXG4gICAgICAgICcyJzogJ+W3suS4i+e6vydcbiAgICAgIH1cbiAgICB9LFxuICAgICdJU1NVRV9BQ1RJVkUnOiB7XG4gICAgICBDTE9TRTogJzAnLFxuICAgICAgT1BFTjogJzEnLFxuICAgICAgREVTQzoge1xuICAgICAgICBmYWxzZTogJ+WFs+mXrScsXG4gICAgICAgIHRydWU6ICflvIDlkK8nXG4gICAgICB9XG4gICAgfSxcblxuICAgICdTVUlURV9UWVBFJzoge1xuICAgICAgRkVBVFVSRVM6ICcwJyxcbiAgICAgIFNUQU5EQVJEOiAnMScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+eJueiJsicsXG4gICAgICAgICcxJzogJ+agh+WHhidcbiAgICAgIH1cbiAgICB9LFxuICAgICdTVUlURV9TVEFUVVMnOiB7XG4gICAgICBOT1RfUkVMRUFTRTogJzAnLFxuICAgICAgQUxSRUFEWV9SRUxFQVNFOiAnMScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+acquWPkeW4gycsXG4gICAgICAgICcxJzogJ+W3suWPkeW4gydcbiAgICAgIH1cbiAgICB9LFxuICAgICdQUk9NT1RJT05fUEFZX1RZUEUnOiB7XG4gICAgICBQQVlfREVQT1NJVDogJzEnLFxuICAgICAgUEFZX0FMTDogJzInLFxuICAgICAgREVTQzoge1xuICAgICAgICAxOiAn5a6a6YeR5pSv5LuYJyxcbiAgICAgICAgMjogJ+WFqOmineaUr+S7mCdcbiAgICAgIH1cbiAgICB9LFxuICAgICdURU1QTEFURV9UWVBFJzoge1xuICAgICAgRU5URVJQUklTRTogJzEnLFxuICAgICAgSE9URUw6ICcyJyxcbiAgICAgIElOVEVSTkVUX0JBUjogJzMnLFxuICAgICAgR1VFU1Q6ICc0JyxcbiAgICAgIERFU0M6IHtcbiAgICAgICAgMTogJ+S8geS4micsXG4gICAgICAgIDI6ICfphZLlupcnLFxuICAgICAgICAzOiAn572R5ZCnJyxcbiAgICAgICAgNDogJ+iHqueUseS6uidcbiAgICAgIH1cbiAgICB9LFxuICAgICdURU1QTEFURV9TVEFUVVMnOiB7XG4gICAgICBVTlBVQkxJQzogJzAnLFxuICAgICAgUFVCTElDOiAnMScsXG4gICAgICBERVNDOiB7XG4gICAgICAgICcwJzogJ+acquWPkeW4gycsXG4gICAgICAgICcxJzogJ+WPkeW4gydcbiAgICAgIH1cbiAgICB9LFxuICAgICdDT05URU5UX1RZUEUnOiB7XG4gICAgICBCQU5ORVI6ICcwJyxcbiAgICAgIENPTU1PTjogJzEnLFxuICAgICAgREVTQzoge1xuICAgICAgICAnMCc6ICfova7mkq3lm74nLFxuICAgICAgICAnMSc6ICfmma7pgJonXG4gICAgICB9XG4gICAgfSxcbiAgICAvL+aLo+i0p+WNleWVhuWTgSDkuIrmnrbljp/lm6BcbiAgICAnUElDS19QUk9EVUNUX1JFQVNPTic6IHtcbiAgICAgIENIT1NFTjogJzAnLCAvL+mAiei0reWNlVxuICAgICAgV0lTSExJU1Q6ICcxJywgLy/lv4PmhL/ljZVcbiAgICAgIFJFUExBQ0VNRU5UX0FEVklDRTogJzInLCAvL+S4i+aetuWVhuWTgeWQjOexu+abv+aNouaOqOiNkFxuICAgICAgU0hFTEZfQkVTVF9TQUxFUzogJzMnLCAvL+i0p+aetuacgOi/kTYw5pel5Ye66LSn546HVE9QMybplIDllK7pop1UT1AyXG4gICAgICBHTE9CQUxfQkVTVF9TQUxFUzogJzQnLCAvL+WFqOW6k+acgOi/kTYw5pel5Ye66LSn546HVE9QMybplIDllK7pop1UT1AyXG4gICAgICBSRUNPTU1FTkRFRDogJzUnLCAvL+WNleWTgeaOqOiNkFxuICAgICAgU1VQUExFTUVOVF9BRFZJQ0U6ICc2JywgLy/ooaXotKflu7rorq5cbiAgICAgIElDT046IHtcbiAgICAgICAgJzAnOiAnLi9pbWcvaWNvbi1nb29kc2Nob29zZS1yZWQucG5nJyxcbiAgICAgICAgJzEnOiAnLi9pbWcvaWNvbi1saWtlLnBuZycsXG4gICAgICAgICcyJzogJy4vaW1nL2ljb24tcmVwbGFjZW1lbnQtYWR2aWNlLnBuZycsXG4gICAgICAgICczJzogJy4vaW1nL2ljb24tc2hlbGYtYmVzdC1zYWxlcy5wbmcnLFxuICAgICAgICAnNCc6ICcuL2ltZy9pY29uLWdsb2JhbC1iZXN0LXNhbGVzLnBuZycsXG4gICAgICAgICc1JzogJy4vaW1nL2ljb24tcmVjb21tZW5kLnBuZycsXG4gICAgICAgICc2JzogJy4vaW1nL2ljb24tc3VwcGxlbWVudC1hZHZpY2UucG5nJ1xuICAgICAgfSxcbiAgICAgIEtFWV9XT1JEOiB7XG4gICAgICAgICcwJzogJ+mAiScsXG4gICAgICAgICcxJzogJ+aEvycsXG4gICAgICAgICcyJzogJ+abvycsXG4gICAgICAgICczJzogJ+aeticsXG4gICAgICAgICc0JzogJ+WFqCcsXG4gICAgICAgICc1JzogJ+WNlScsXG4gICAgICAgICc2JzogJ+ihpSdcbiAgICAgIH0sXG4gICAgICBLRVk6IHtcbiAgICAgICAgJ3dpc2hsaXN0JzogJzEnLFxuICAgICAgICAncmVwbGFjZW1lbnRzJzogJzInLFxuICAgICAgICAnc2hlbGZTYWxlc0NoYXJ0JzogJzMnLFxuICAgICAgICAnZ2xvYmFsU2FsZXNDaGFydCc6ICc0JyxcbiAgICAgICAgJ3JlY29tbWVuZGVkJzogJzUnLFxuICAgICAgICAncmVwbGVuaXNobWVudCc6ICc2J1xuICAgICAgfVxuICAgIH0sXG4gICAgLy/mi6PotKfljZXllYblk4Eg5p2l5rqQXG4gICAgJ1BJQ0tfUFJPRFVDVF9GUk9NX1RZUEUnOiB7XG4gICAgICBGUk9NX1NVSVRFOiAxLFxuICAgICAgRlJPTV9ORVc6IDIsXG4gICAgICBGUk9NX1NIRUxGOiAzLFxuICAgICAgRlJPTV9SRUZFUjogNCxcbiAgICAgIEZST01fQ0hPT1NFOiA1LFxuICAgICAgRlJPTV9FRElUOiA2XG4gICAgfSxcbiAgICAvKkBQYXJhbXNcbiAgICBvcHRpb25zKOW/heWhq++8jOiLpeS4uuWvueixoeWImeaJgOacieWPguaVsOmDveWcqOivpeWAvOiuvue9rizkuIDml6bku6Xlr7nosaHlvaLlvI/orr7nva7or6XlgLzvvIzlkI7pnaLlj4LmlbDlpLHmlYjjgILoi6XkuLrlrZfnrKbkuLLvvIzliJnooajnpLrlj5blk6rkuKplbnVtLOWmgiDigJhQUk9GSVRfTEVWRUzigJkpXG4gICAg5pSv5oyB5Lul5LiL6K6+572u6aG5XG4gICAgY2xzT3JOYW1lKOW/heWhqyzooajnpLrlj5blk6rkuKplbnVtLOWmgiDigJhQUk9GSVRfTEVWRUzigJkpXG4gICAgaGFzRGVmYXVsdCjpnZ7lv4XloavvvIzkuI3loavlsIbmnInpu5jorqTlgLzvvIzor6Xpu5jorqTlgLznibnmjIcg5omA5pyJ57G75Z6LIOaIliDkuI3loasg562JKVxuICAgIGNvZGVLZXko6Z2e5b+F5aGrKVxuICAgIHZhbHVlS2V5KOmdnuW/heWhqylcbiAgICBkZWZhdWx0T2JqKOmdnuW/heWhqyDloavlhpnmoLzlvI/kuLp7Jy0xJzon5omA5pyJ57G75Z6LJ30pXG4gICAgKi9cbiAgICBnZXRMaXN0OiBmdW5jdGlvbihvcHRpb25zLCBoYXNEZWZhdWx0LCBjb2RlS2V5LCB2YWx1ZUtleSwgZGVmYXVsdE9iaixcbiAgICAgIGlzQ29kZU51bSkge1xuICAgICAgdmFyIGNsc09yTmFtZTtcbiAgICAgIGlmIChvcHRpb25zLmNsc09yTmFtZSkgeyAvL+iLpW9wdGlvbnPkuLrlr7nosaEs5ZCO6Z2i5Y+C5pWw5bCG5LuOb3B0aW9uc+S4reWPluWAvFxuICAgICAgICBjbHNPck5hbWUgPSBvcHRpb25zLmNsc09yTmFtZTtcbiAgICAgICAgaGFzRGVmYXVsdCA9IG9wdGlvbnMuaGFzRGVmYXVsdDtcbiAgICAgICAgY29kZUtleSA9IG9wdGlvbnMuY29kZUtleTtcbiAgICAgICAgdmFsdWVLZXkgPSBvcHRpb25zLnZhbHVlS2V5O1xuICAgICAgICBkZWZhdWx0T2JqID0gb3B0aW9ucy5kZWZhdWx0T2JqO1xuICAgICAgICBpc0NvZGVOdW0gPSBvcHRpb25zLmlzQ29kZU51bTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNsc09yTmFtZSA9IG9wdGlvbnM7XG4gICAgICB9XG4gICAgICBpZiAoIWNsc09yTmFtZSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICB2YXIgY2sgPSBjb2RlS2V5IHx8ICdjb2RlJztcbiAgICAgIHZhciB2ayA9IHZhbHVlS2V5IHx8ICdkZXNjJztcblxuICAgICAgdmFyIGwgPSBfLm1hcCh0aGlzW2Nsc09yTmFtZV0uREVTQywgZnVuY3Rpb24odmFsLCBjb2RlKSB7XG4gICAgICAgIC8vIHJldHVybiB7IGNvZGU6IGtleSwgZGVzYzogdmFsIH07XG4gICAgICAgIHZhciBvID0ge307XG4gICAgICAgIG9bY2tdID0gaXNDb2RlTnVtID8gcGFyc2VJbnQoY29kZSkgOiBjb2RlO1xuICAgICAgICBvW3ZrXSA9IHZhbDtcbiAgICAgICAgcmV0dXJuIG87XG4gICAgICB9KTtcbiAgICAgIGhhc0RlZmF1bHQgPSB0eXBlb2YoaGFzRGVmYXVsdCkgIT0gJ3VuZGVmaW5lZCcgPyBoYXNEZWZhdWx0IDogdHJ1ZTtcbiAgICAgIGlmIChoYXNEZWZhdWx0KSB7XG4gICAgICAgIHZhciBkT2piID0ge307XG4gICAgICAgIGRPamJbY2tdID0gaXNDb2RlTnVtID8gLTEgOiAnLTEnO1xuICAgICAgICBkT2piW3ZrXSA9ICflhajpg6gnO1xuICAgICAgICBpZiAoZGVmYXVsdE9iaikge1xuICAgICAgICAgIGlmIChfLnBhaXJzKGRlZmF1bHRPYmopLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGRPamJbY2tdID0gXy5wYWlycyhkZWZhdWx0T2JqKVswXVswXTtcbiAgICAgICAgICAgIGRPamJbdmtdID0gXy5wYWlycyhkZWZhdWx0T2JqKVswXVsxXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbC5zcGxpY2UoMCwgMCwgZE9qYik7XG4gICAgICB9XG4gICAgICByZXR1cm4gbDtcbiAgICB9XG4gIH1cbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ2FjY291bnQnLCBmdW5jdGlvbigkc2NvcGUsICRtZERpYWxvZywgbW9kYWxTZXJ2aWNlLFxuICAgIHV0aWxTZXJ2aWNlLCBhY2NvdW50U2VydmljZSwgTmdUYWJsZVBhcmFtcywgcm9sZVNlcnZpY2UpIHtcbiAgICAkc2NvcGUuc2VhcmNoTmFtZSA9IFwiXCI7XG4gICAgJHNjb3BlLmhlYWRzID0gW3tcbiAgICAgIHRpdGxlOiAn5bqP5Y+3JyxcbiAgICAgIHdpZHRoOiAnNiUnLFxuICAgICAgZmllbGQ6ICdpbmRleCcsXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfnlKjmiLflkI0nLFxuICAgICAgd2lkdGg6ICcxNiUnLFxuICAgICAgZmllbGQ6ICduYW1lJyxcbiAgICB9LCB7XG4gICAgICB0aXRsZTogJ+aJi+acuuWPtycsXG4gICAgICB3aWR0aDogJzI0JScsXG4gICAgICBmaWVsZDogJ21vYmlsZScsXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfliJvlu7rogIUnLFxuICAgICAgd2lkdGg6ICcxNiUnLFxuICAgICAgZmllbGQ6ICdjcmVhdG9yJyxcbiAgICAgIGdldFZhbHVlOiBmdW5jdGlvbihjcmVhdG9yKSB7XG4gICAgICAgIHJldHVybiBjcmVhdG9yLm5hbWU7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfliJvlu7rml7bpl7QnLFxuICAgICAgd2lkdGg6ICcxNiUnLFxuICAgICAgZmllbGQ6ICdjcmVhdGVUaW1lJyxcbiAgICAgIGdldFZhbHVlOiBmdW5jdGlvbihjcmVhdGVUaW1lKSB7XG4gICAgICAgIHJldHVybiB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoY3JlYXRlVGltZSxcbiAgICAgICAgICAneXl5eS1NTS1kZCBoaDptbScpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn566h55CG6ICFJyxcbiAgICAgIHdpZHRoOiAnMTYlJyxcbiAgICAgIGZpZWxkOiAnc3VwZXJ2aXNvcicsXG4gICAgICBnZXRWYWx1ZTogZnVuY3Rpb24oc3VwZXJ2aXNvcikge1xuICAgICAgICByZXR1cm4gc3VwZXJ2aXNvci5uYW1lO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn5pON5L2cJyxcbiAgICAgIHdpZHRoOiAnNiUnLFxuICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIgbmctY2xpY2s9XCJlZGl0QWNjb3VudChyb3cpXCIgPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1wZW5jaWxcIj48L3NwYW4+PC9idXR0b24+JyArXG4gICAgICAgICAgJyZuYnNwJm5ic3AmbmJzcCcgK1xuICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kYW5nZXIgYnRuLXNtXCIgbmctY2xpY2s9XCJkZWxldGVDbGljayhyb3cpXCI+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRyYXNoXCI+PC9zcGFuPjwvYnV0dG9uPic7XG4gICAgICB9LFxuICAgIH1dO1xuICAgICRzY29wZS5jcmVhdGVBY2NvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAkbWREaWFsb2cuc2hvdyhhZGRPckVkaXRBY2NvdW50TW9kYWxPcHRpb25zKCRzY29wZSkpLnRoZW4odXBkYXRlKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLm1hbmFnZVJvbGVzID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IFwiIy9yb2xlXCJcbiAgICB9O1xuXG4gICAgLyog57yW6L6RKi9cbiAgICAkc2NvcGUuZWRpdEFjY291bnQgPSBmdW5jdGlvbihhY2NvdW50KSB7XG4gICAgICAkbWREaWFsb2cuc2hvdyhhZGRPckVkaXRBY2NvdW50TW9kYWxPcHRpb25zKCRzY29wZSwgYWNjb3VudCkpLnRoZW4oXG4gICAgICAgIHVwZGF0ZSk7XG4gICAgfTtcblxuICAgIC8q5Yig6ZmkKi9cbiAgICAkc2NvcGUuZGVsZXRlQ2xpY2sgPSBmdW5jdGlvbihhY2NvdW50KSB7XG4gICAgICAkc2NvcGUuYWNjb3VudCA9IGFuZ3VsYXIuY29weShhY2NvdW50KTtcbiAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgJ2FjY291bnQnKSksXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnZGVsZXRlVXNlck1vZGVsJ1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8q5Yig6Zmk55So5oi356Gu6K6kKi9cbiAgICAkc2NvcGUuZGVsZXRlVXNlciA9IGZ1bmN0aW9uKGFjY291bnQpIHtcbiAgICAgIGFjY291bnRTZXJ2aWNlLmRlbGV0ZU1hbmFnZXIoe1xuICAgICAgICBpZDogJHNjb3BlLmFjY291bnQubWFuYWdlcklkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICB1cGRhdGUoKTtcbiAgICAgICAgJHNjb3BlLm1vZGFsLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyrnu5l0YWJsZei1i+WAvCovXG4gICAgdmFyIGZpbmRBbGwgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICgkc2NvcGUuc2VhcmNoTmFtZSkge1xuICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7fSwge1xuICAgICAgICAgIGNvdW50czogW10sXG4gICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjb3VudFNlcnZpY2Uuc2VhcmNoTmFtZSgkc2NvcGUuc2VhcmNoTmFtZSkudGhlbihcbiAgICAgICAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy5sZW5naHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2NvdW50U2VydmljZS5pbmRleEFjY291bnQocmVzLCAxKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLm9mZnNldCA9IDA7IC8vIOmHjee9rlxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCEkc2NvcGUub2Zmc2V0KSB7XG4gICAgICAgICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmxpbWl0ID0gMTU7XG4gICAgICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgIH0sIHtcbiAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDI1LFxuICAgICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICAkc2NvcGUub2Zmc2V0ID0gJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKTtcbiAgICAgICAgICAgIHJldHVybiBhY2NvdW50U2VydmljZS5maW5kQWxsTWFuYWdlcih7fSwgJHNjb3BlLm9mZnNldCxcbiAgICAgICAgICAgICAgJHNjb3BlLmxpbWl0KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgICAgICByZXR1cm4gYWNjb3VudFNlcnZpY2UuaW5kZXhBY2NvdW50KHJlcy5jb250ZW50LFxuICAgICAgICAgICAgICAgICRzY29wZS5vZmZzZXQgKyAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvLyDlvZPliY3nmbvpmYbotKbmiLdcbiAgICAkc2NvcGUuY3VycmVudEFjY291bnQgPSB7fTtcbiAgICAvLyDnibnmrormnYPpmZBcbiAgICAkc2NvcGUuY3JpdGlhbFBlcm1pc3Npb25zID0gW107XG4gICAgLy8g5omA5pyJ566h55CG6ICFXG4gICAgJHNjb3BlLnN1cGVydmlzb3JzID0gW107XG4gICAgLy8g5omA5pyJ6KeS6ImyXG4gICAgJHNjb3BlLnJvbGUgPSB7fTtcblxuICAgIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgIGZpbmRBbGwoKTtcbiAgICAgIGFjY291bnRTZXJ2aWNlLmxvYWRTdXBlcnZpc29ycygpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5zdXBlcnZpc29ycyA9IHJlcztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIChmdW5jdGlvbigpIHtcbiAgICAgIGFjY291bnRTZXJ2aWNlLmxvYWRTZWxmKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgYW5ndWxhci5leHRlbmQoJHNjb3BlLmN1cnJlbnRBY2NvdW50LCByZXMpO1xuICAgICAgfSk7XG4gICAgICByb2xlU2VydmljZS5nZXRDcml0aWNhbFBlcm1pc3Npb25zKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgYW5ndWxhci5leHRlbmQoJHNjb3BlLmNyaXRpYWxQZXJtaXNzaW9ucywgcmVzKTtcbiAgICAgIH0pO1xuICAgICAgcm9sZVNlcnZpY2UuZ2V0Um9sZXMoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBhbmd1bGFyLmV4dGVuZCgkc2NvcGUucm9sZSwgcmVzKTtcbiAgICAgIH0pO1xuICAgICAgdXBkYXRlKCk7XG4gICAgfSkoKTtcblxuICAgICRzY29wZS5zZWFyY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zZWFyY2hOYW1lID0gJHNjb3BlLnNlYXJjaE5hbWUudHJpbSgpO1xuICAgICAgaWYgKCRzY29wZS5zZWFyY2hOYW1lKSB7XG4gICAgICAgIGZpbmRBbGwoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLnNlYXJjaE5hbWUgPSBcIlwiO1xuICAgICAgZmluZEFsbCgpO1xuICAgIH07XG4gICAgJHNjb3BlLmRvd25sb2FkRXhjZWwgPSBmdW5jdGlvbigpIHtcbiAgICAgIGFjY291bnRTZXJ2aWNlLmRvd25sb2FkRXhjZWwoKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgYS5zdHlsZSA9IFwiZGlzcGxheTogbm9uZVwiO1xuICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwge1xuICAgICAgICAgICAgdHlwZTogXCJvY3RldC9zdHJlYW1cIlxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICAgICAgICBhLmhyZWYgPSB1cmw7XG4gICAgICAgIGEuZG93bmxvYWQgPSBcInBlcm1pc3Npb25zLnhsc1wiO1xuICAgICAgICBhLmNsaWNrKCk7XG4gICAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS51cGxvYWRQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdXBsb2FkRXhjZWwoYWNjb3VudFNlcnZpY2UudXBsb2FkUGVybWlzc2lvbnMpO1xuICAgIH07XG4gICAgJHNjb3BlLnVwbG9hZFBlcm1pc3Npb25Hcm91cHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHVwbG9hZEV4Y2VsKGFjY291bnRTZXJ2aWNlLnVwbG9hZFBlcm1pc3Npb25Hcm91cHMpO1xuICAgIH07XG4gICAgdmFyIHVwbG9hZEV4Y2VsID0gZnVuY3Rpb24odXBsb2FkZXIpIHtcbiAgICAgICRtZERpYWxvZy5zaG93KHVwbG9hZEV4Y2VsTW9kYWxPcHRpb25zKHVwbG9hZGVyKSkudGhlbihmdW5jdGlvbihcbiAgICAgICAgZGF0YSkge1xuICAgICAgICAkbWREaWFsb2cuc2hvdyhcbiAgICAgICAgICAkbWREaWFsb2cuYWxlcnQoKVxuICAgICAgICAgIC5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpXG4gICAgICAgICAgLnRpdGxlKCfkuIrkvKDmiJDlip8nKVxuICAgICAgICAgIC50ZXh0Q29udGVudChkYXRhLnJ1bk1zZylcbiAgICAgICAgICAub2soJ+ehruWumicpXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIGFkZE9yRWRpdEFjY291bnRNb2RhbE9wdGlvbnMoc2NvcGUsIGFjY291bnQpIHtcbiAgcmV0dXJuIHtcbiAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2FjY291bnQvYWRkT3JFZGl0QWNjb3VudE1vZGFsLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6IEFkZE9yRWRpdEFjY291bnRDdHJsLFxuICAgIGxvY2Fsczoge1xuICAgICAgYWNjb3VudDogYWNjb3VudCxcbiAgICAgIGNvbnRleHQ6IHNjb3BlXG4gICAgfVxuICB9O1xufTtcblxuZnVuY3Rpb24gQWRkT3JFZGl0QWNjb3VudEN0cmwoJHNjb3BlLCAkbWREaWFsb2csICRtZFBhbmVsLCBhY2NvdW50U2VydmljZSxcbiAgY29udGV4dCwgYWNjb3VudCkge1xuICB2YXIgY3VycmVudEFjY291bnQgPSBjb250ZXh0LmN1cnJlbnRBY2NvdW50O1xuICB2YXIgZWRpdE1vZGUgPSB0eXBlb2YoYWNjb3VudCkgIT0gJ3VuZGVmaW5lZCc7XG4gICRzY29wZS5lZGl0TW9kZSA9IGVkaXRNb2RlO1xuICAkc2NvcGUuYWxsUGVybWlzc2lvbnMgPSBbe1xuICAgIGlkOiBcIuiHquWumuS5iVwiLFxuICAgIG5hbWU6IFwi54m55q6K5p2D6ZmQXCIsXG4gICAgcGVybWlzc2lvbnM6IGNvbnRleHQuY3JpdGlhbFBlcm1pc3Npb25zXG4gIH1dO1xuICAkc2NvcGUuYWNjb3VudCA9IGFjY291bnQgPyBhbmd1bGFyLmNvcHkoYWNjb3VudCkgOiB7XG4gICAgY3JlYXRvcjogY3VycmVudEFjY291bnQsXG4gICAgc3VwZXJ2aXNvcjogY3VycmVudEFjY291bnQsXG4gIH07XG4gIGlmICghJHNjb3BlLmFjY291bnQucGVybWlzc2lvbklkcykgJHNjb3BlLmFjY291bnQucGVybWlzc2lvbklkcyA9IFtdO1xuICAkc2NvcGUucGljVXJsID0gd2luZG93LmNmZy5waWNVcmw7XG4gICRzY29wZS5jcmVhdG9yTmFtZSA9ICRzY29wZS5hY2NvdW50LmNyZWF0b3IubmFtZTtcbiAgJHNjb3BlLnBpY2tlZFN1cGVydmlzb3IgPSAkc2NvcGUuYWNjb3VudC5zdXBlcnZpc29yO1xuICAkc2NvcGUuc3VwZXJ2aXNvcnMgPSBbJHNjb3BlLnBpY2tlZFN1cGVydmlzb3JdLmNvbmNhdChjb250ZXh0LnN1cGVydmlzb3JzLmZpbHRlcihcbiAgICBmdW5jdGlvbihzdXBlcnZpc29yKSB7XG4gICAgICAvLyDku47nrqHnkIbogIXliJfooajkuK3ov4fmu6TmjonlvZPliY3nvJbovpHnmoTnlKjmiLfvvIjlpoLmnpzmnInnmoTor53vvInlkowgcGlja2VkU3VwZXJ2aXNvcu+8iOW3suaUvuWcqOesrOS4gOS9je+8iVxuICAgICAgdmFyIGlkID0gc3VwZXJ2aXNvci5tYW5hZ2VySWQ7XG4gICAgICByZXR1cm4gaWQgIT09ICRzY29wZS5hY2NvdW50Lm1hbmFnZXJJZCAmJiBpZCAhPT0gJHNjb3BlLnBpY2tlZFN1cGVydmlzb3JcbiAgICAgICAgLm1hbmFnZXJJZDtcbiAgICB9KSk7XG4gICRzY29wZS5vayA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXN1bHQgPSAkc2NvcGUuYWNjb3VudDtcbiAgICB2YXIgY2hlY2tSb2xlSWRzID0gJHNjb3BlLmNoZWNrZWRSb2xlcy5tYXAoZnVuY3Rpb24ocm9sZSkge1xuICAgICAgcmV0dXJuIHJvbGUuaWQ7XG4gICAgfSk7XG4gICAgaWYgKGVkaXRNb2RlKSB7XG4gICAgICBhY2NvdW50U2VydmljZS5tb2RpZnlNYW5hZ2VyKHtcbiAgICAgICAgICBpZDogcmVzdWx0Lm1hbmFnZXJJZCxcbiAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgICBwc3c6IHJlc3VsdC5wYXNzd29yZCA/ICQuaGV4X21kNShyZXN1bHQucGFzc3dvcmQpIDogbnVsbCxcbiAgICAgICAgICBzdXBlcnZpc29ySWQ6ICRzY29wZS5waWNrZWRTdXBlcnZpc29yLm1hbmFnZXJJZCxcbiAgICAgICAgICBwZXJtaXNzaW9uSWRzOiByZXN1bHQucGVybWlzc2lvbklkcyxcbiAgICAgICAgICByb2xlSWRzOiBjaGVja1JvbGVJZHMsXG4gICAgICAgICAgYXZhdGFyOiByZXN1bHQuYXZhdGFyXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBhY2NvdW50U2VydmljZS5jcmVhdGVNYW5hZ2VyKHtcbiAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgICBtb2JpbGU6IHJlc3VsdC5tb2JpbGUsXG4gICAgICAgICAgcHN3OiAkLmhleF9tZDUocmVzdWx0LnBhc3N3b3JkKSxcbiAgICAgICAgICBzdXBlcnZpc29ySWQ6ICRzY29wZS5waWNrZWRTdXBlcnZpc29yLm1hbmFnZXJJZCxcbiAgICAgICAgICBwZXJtaXNzaW9uSWRzOiByZXN1bHQucGVybWlzc2lvbklkcyxcbiAgICAgICAgICByb2xlSWRzOiBjaGVja1JvbGVJZHMsXG4gICAgICAgICAgYXZhdGFyOiByZXN1bHQuYXZhdGFyXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgfTtcbiAgJHNjb3BlLnBpY2tSb2xlID0gZnVuY3Rpb24oKSB7XG4gICAgJG1kUGFuZWwub3BlbihwaWNrUm9sZU9wdGlvbnMoJG1kUGFuZWwsIGNvbnRleHQucm9sZSwgJHNjb3BlLmNoZWNrZWRSb2xlcyxcbiAgICAgIGN1cnJlbnRBY2NvdW50KSk7XG4gIH07XG4gICRzY29wZS5jaGVja2VkUm9sZXMgPSBbXTtcbiAgdmFyIGNoZWNrZWRSb2xlSWRzID0gJHNjb3BlLmFjY291bnQucm9sZUlkcztcbiAgaWYgKGNoZWNrZWRSb2xlSWRzKSB7XG4gICAgZmluZENoZWNrZWRSb2xlcyhjb250ZXh0LnJvbGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gZmluZENoZWNrZWRSb2xlcyhyb2xlKSB7XG4gICAgaWYgKGNoZWNrZWRSb2xlSWRzLmluZGV4T2Yocm9sZS5pZCkgPiAtMSkge1xuICAgICAgJHNjb3BlLmNoZWNrZWRSb2xlcy5wdXNoKHJvbGUpO1xuICAgIH1cbiAgICBhbmd1bGFyLmZvckVhY2gocm9sZS5jaGlsZHJlbiwgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgIGZpbmRDaGVja2VkUm9sZXMoY2hpbGQpO1xuICAgIH0pO1xuICB9O1xufTtcblxuZnVuY3Rpb24gcGlja1JvbGVPcHRpb25zKCRtZFBhbmVsLCByb2xlLCBjaGVja2VkUm9sZXMsIGN1cnJlbnRBY2NvdW50KSB7XG4gIHJldHVybiB7XG4gICAgYXR0YWNoVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICBjb250cm9sbGVyOiBQYW5lbERpYWxvZ0N0cmwsXG4gICAgY29udHJvbGxlckFzOiAnY3RybCcsXG4gICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L3BpY2tSb2xlUGFuZWwuaHRtbCcsXG4gICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgcGFuZWxDbGFzczogJ3BpY2stcm9sZS1wYW5lbCcsXG4gICAgcG9zaXRpb246ICRtZFBhbmVsLm5ld1BhbmVsUG9zaXRpb24oKS5hYnNvbHV0ZSgpLmNlbnRlcigpLFxuICAgIHRyYXBGb2N1czogdHJ1ZSxcbiAgICB6SW5kZXg6IDEwMDAyLFxuICAgIGVzY2FwZVRvQ2xvc2U6IHRydWUsXG4gICAgZm9jdXNPbk9wZW46IHRydWUsXG4gICAgbG9jYWxzOiB7XG4gICAgICByb2xlOiByb2xlLFxuICAgICAgY2hlY2tlZFJvbGVzOiBjaGVja2VkUm9sZXMsXG4gICAgICBjdXJyZW50QWNjb3VudDogY3VycmVudEFjY291bnRcbiAgICB9XG4gIH07XG59O1xuXG5mdW5jdGlvbiBQYW5lbERpYWxvZ0N0cmwoJHNjb3BlLCBtZFBhbmVsUmVmLCByb2xlLCBjaGVja2VkUm9sZXMsIGN1cnJlbnRBY2NvdW50KSB7XG4gIHZhciBjaGVja2VkSW5mb3MgPSBbXTtcbiAgdmFyIGN1cnJlbnRSb2xlSW5mb3MgPSBbXTtcbiAgKGZ1bmN0aW9uKCkge1xuICAgIHZhciBpZHMgPSBjaGVja2VkUm9sZXMubWFwKGZ1bmN0aW9uKHJvbGUpIHtcbiAgICAgIHJldHVybiByb2xlLmlkXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiB3cmFwKHJvbGUsIHBhcmVudEluZm8pIHtcbiAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICBfZW5hYmxlZDogMCxcbiAgICAgICAgcm9sZTogcm9sZSxcbiAgICAgICAgcGFyZW50OiBwYXJlbnRJbmZvLFxuICAgICAgfVxuICAgICAgaW5mby5jaGlsZHJlbiA9ICFyb2xlLmNoaWxkcmVuID8gW10gOiByb2xlLmNoaWxkcmVuLm1hcChmdW5jdGlvbihjaGlsZCkge1xuICAgICAgICByZXR1cm4gd3JhcChjaGlsZCwgaW5mbyk7XG4gICAgICB9KVxuICAgICAgaWYgKGlkcy5pbmRleE9mKHJvbGUuaWQpID4gLTEpIGNoZWNrZWRJbmZvcy5wdXNoKGluZm8pO1xuICAgICAgaWYgKGN1cnJlbnRBY2NvdW50LnJvbGVJZHMuaW5kZXhPZihyb2xlLmlkKSA+IC0xKSBjdXJyZW50Um9sZUluZm9zLnB1c2goXG4gICAgICAgIGluZm8pO1xuICAgICAgcmV0dXJuIGluZm87XG4gICAgfVxuICAgICRzY29wZS5yb2xlSW5mbyA9IHdyYXAocm9sZSwgbnVsbCk7XG4gIH0oKSk7XG4gIHZhciByb290ID0gcm9sZTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgY2hlY2tlZFJvbGVJZHMgPSBbXTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBzZWxmLm9rID0gZnVuY3Rpb24oKSB7XG4gICAgY2hlY2tlZFJvbGVzLnNwbGljZSgwLCBjaGVja2VkUm9sZXMubGVuZ3RoKTtcbiAgICBhbmd1bGFyLmZvckVhY2gocmVzdWx0LCBmdW5jdGlvbihyb2xlKSB7XG4gICAgICBjaGVja2VkUm9sZXMucHVzaChyb2xlKTtcbiAgICB9KTtcbiAgICBzZWxmLmNsb3NlUGFuZWwoKTtcbiAgfTtcbiAgc2VsZi5jbG9zZVBhbmVsID0gZnVuY3Rpb24oKSB7XG4gICAgbWRQYW5lbFJlZi5jbG9zZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICBtZFBhbmVsUmVmLmRlc3Ryb3koKTtcbiAgICB9KTtcbiAgfTtcbiAgc2VsZi5waWNrYWJsZSA9IGZ1bmN0aW9uKGluZm8pIHtcbiAgICB2YXIgcm9sZSA9IGluZm8ucm9sZTtcbiAgICByZXR1cm4gcm9sZSAhPT0gcm9vdCAmJiBpbmZvLl9lbmFibGVkID09IDA7XG4gIH07XG4gIHNlbGYuaXNDaGVja2VkID0gZnVuY3Rpb24oaW5mbykge1xuICAgIHJldHVybiBjaGVja2VkUm9sZUlkcy5pbmRleE9mKGluZm8ucm9sZS5pZCkgPiAtMTtcbiAgfTtcbiAgc2VsZi50b2dnbGUgPSBmdW5jdGlvbihpbmZvKSB7XG4gICAgdmFyIHJvbGUgPSBpbmZvLnJvbGU7XG4gICAgdmFyIGluZGV4ID0gY2hlY2tlZFJvbGVJZHMuaW5kZXhPZihyb2xlLmlkKTtcbiAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICBjaGVja2VkUm9sZUlkcy5wdXNoKHJvbGUuaWQpO1xuICAgICAgcmVzdWx0LnB1c2gocm9sZSk7XG4gICAgICBzZXRQYXJlbnRFbmFibGUoaW5mbywgZmFsc2UpO1xuICAgICAgc2V0Q2hpbGRyZW5FbmFibGUoaW5mbywgZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjaGVja2VkUm9sZUlkcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgcmVzdWx0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICBzZXRQYXJlbnRFbmFibGUoaW5mbywgdHJ1ZSk7XG4gICAgICBzZXRDaGlsZHJlbkVuYWJsZShpbmZvLCB0cnVlKTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gc2V0UGFyZW50RW5hYmxlKGluZm8sIGRpc2FibGUpIHtcbiAgICBpZiAoaW5mby5wYXJlbnQpIHtcbiAgICAgIHZhciBwYXJlbnQgPSBpbmZvLnBhcmVudDtcbiAgICAgIHZhciBkZWx0YSA9IGRpc2FibGUgPyAtMSA6IDE7XG4gICAgICBwYXJlbnQuX2VuYWJsZWQgPSBwYXJlbnQuX2VuYWJsZWQgKyBkZWx0YTtcbiAgICAgIHNldFBhcmVudEVuYWJsZShwYXJlbnQsIGRpc2FibGUpO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBzZXRDaGlsZHJlbkVuYWJsZShpbmZvLCBkaXNhYmxlKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gaW5mby5jaGlsZHJlbjtcbiAgICBpZiAoY2hpbGRyZW4pIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChjaGlsZHJlbiwgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgdmFyIGRlbHRhID0gZGlzYWJsZSA/IC0xIDogMTtcbiAgICAgICAgY2hpbGQuX2VuYWJsZWQgPSBjaGlsZC5fZW5hYmxlZCArIGRlbHRhO1xuICAgICAgICBzZXRDaGlsZHJlbkVuYWJsZShjaGlsZCwgZGlzYWJsZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIC8vIDEuIOWFiOWwhuaJgOacieiKgueCueemgeatolxuICBzZXRDaGlsZHJlbkVuYWJsZSgkc2NvcGUucm9sZUluZm8sIGZhbHNlKTtcbiAgLy8gMi4g5YaN5byA5pS+5b2T5YmN6LSm5oi35omA5oul5pyJ6KeS6Imy55qE5a2Q6KeS6ImyXG4gIGFuZ3VsYXIuZm9yRWFjaChjdXJyZW50Um9sZUluZm9zLCBmdW5jdGlvbihjdXJyZW50Um9sZUluZm8pIHtcbiAgICBzZXRDaGlsZHJlbkVuYWJsZShjdXJyZW50Um9sZUluZm8sIHRydWUpO1xuICB9KTtcbiAgYW5ndWxhci5mb3JFYWNoKGNoZWNrZWRJbmZvcywgZnVuY3Rpb24oY2hlY2tlZEluZm8pIHtcbiAgICBzZWxmLnRvZ2dsZShjaGVja2VkSW5mbyk7IC8vIOmAieS4reW3sumAieinkuiJslxuICB9KTtcbn1cblxuZnVuY3Rpb24gdXBsb2FkRXhjZWxNb2RhbE9wdGlvbnModXBsb2FkZXIpIHtcbiAgcmV0dXJuIHtcbiAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2FjY291bnQvdXBsb2FkRXhjZWxNb2RhbC5odG1sJyxcbiAgICBjb250cm9sbGVyOiBVcGxvYWRFeGNlbEN0cmwsXG4gICAgbG9jYWxzOiB7XG4gICAgICB1cGxvYWRlcjogdXBsb2FkZXJcbiAgICB9XG4gIH07XG59O1xuXG5mdW5jdGlvbiBVcGxvYWRFeGNlbEN0cmwoJHNjb3BlLCAkbWREaWFsb2csICR0aW1lb3V0LCBhY2NvdW50U2VydmljZSwgdXBsb2FkZXIpIHtcbiAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgfTtcbiAgJHNjb3BlLm9rID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbW1lbnQgPSAkc2NvcGUuY29tbWVudDtcbiAgICB2YXIgZmlsZSA9ICQoXCIjZmlsZV9pbnB1dFwiKVswXS5maWxlc1swXTtcbiAgICB1cGxvYWRlcihjb21tZW50LCBmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICRtZERpYWxvZy5oaWRlKGRhdGEpO1xuICAgIH0pO1xuICB9O1xufTsiLCIvKlxuICrmgLvmjqdcbiAqYXBwQ29udHJsbGVyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoJ2FwcCcsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAvL+W8gOWni+i3r+eUseWbnuiwg1xuICAgICAgICAvL+aIkOWKn+i3r+eUseWbnuiwg1xuICAgICAgICAkc2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oZSxyKSB7XG4gICAgICAgICAgICB2YXIgcm91dGU9ci4kJHJvdXRlO1xuICAgICAgICAgICAgdmFyIHBhdGg9cm91dGUubmFtZTtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgnc2lkZWJhci5hY3RpdmUnLHBhdGgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUudGFicyA9IFt7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdEeW5hbWljIFRpdGxlIDEnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyB0aXRsZTogJ0R5bmFtaWMgVGl0bGUgMicsIGNvbnRlbnQ6ICdEeW5hbWljIGNvbnRlbnQgMicgfVxuICAgICAgICBdO1xuICAgICAgICAkc2NvcGUuc2VsZWN0RXZlbnQgPSBmdW5jdGlvbihpdGVtKSB7XG5cbiAgICAgICAgfTtcbiAgICAgICAgLy/mt7vliqB0YWIgXG4gICAgICAgICRzY29wZS4kb24oJ0FkZFRhYicsIGZ1bmN0aW9uKGUsIG9iaikge1xuICAgICAgICAgICAgdmFyIGlkID0gb2JqLmlkO1xuICAgICAgICAgICAgaWYgKCFfLmZpbmRXaGVyZShpZCwgeyBpZDogaWQgfSkpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGFicy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG9iai5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICc8ZGl2IHVpLXZpZXc9XCInICsgaWQgKyAnXCI+PC9kaXY+J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH0pO1xufTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzExLzI1LlxuICovXG4vKipcbiAqIOWVhuWTgeagh+etvueuoeeQhlxuICogbGFiZWxzTWFuYWdlbWVudFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcignY29tbWVudHNNYW5hZ2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRjb21waWxlLCBtb2RhbFNlcnZpY2UsIG9yZGVyU2VydmljZSwgTmdUYWJsZVBhcmFtcywgc3VpdGVTZXJ2aWNlLCBDT05TVEFOVFMsIHV0aWxTZXJ2aWNlKSB7XG5cbiAgICAgICAgJHNjb3BlLk9SREVSX1NUQVRVUyA9IENPTlNUQU5UUy5PUkRFUl9TVEFUVVM7Ly/orqLljZXnirbmgIFcbiAgICAgICAgJHNjb3BlLk9SREVSX1RZUEUgPSBDT05TVEFOVFMuT1JERVJfVFlQRTsgLy/orqLljZXnsbvlnotcbiAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge1xuICAgICAgICAgICAgc3VpdGVOYW1lOiAnJywvL+Wll+mkkOWQjeensFxuICAgICAgICAgICAgc3VpdGVJZDogJycsLy/lpZfppJBJRFxuICAgICAgICAgICAgY29tcGFueU5hbWU6ICcnLCAvL+WFrOWPuOWQjeensFxuICAgICAgICAgICAgY29tcGFueUlkOiAnJywgLy/lhazlj7hJRFxuICAgICAgICAgICAgY3VzdG9tZXJOYW1lOiAnJywgLy/nlKjmiLflkI3np7BcbiAgICAgICAgICAgIGNvbnRlbnQ6ICcnLCAvL+ivhOiuuuWGheWuuVxuICAgICAgICAgICAgY3JlYXRlVGltZVN0YXJ0OiAnJywvL+ivhOiuuuWIm+W7uuaXtumXtFxuICAgICAgICAgICAgY3JlYXRlVGltZUVuZDogJycvL+ivhOiuuuWIm+W7uuaXtumXtFxuICAgICAgICB9O1xuXG4gICAgICAgIC8v5qC55o2u5LyB5Lia5pCc57SiXG4gICAgICAgICRzY29wZS5zZWFyY2hCeUNvbXBhbnkgPSBmdW5jdGlvbiAoY29tcGFueSkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lID0gY29tcGFueS5jb21wYW55TmFtZTtcbiAgICAgICAgICAgICRzY29wZS5jb21tZW50c0xpc3QoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL+a4heepuuS8geS4muaQnOe0olxuICAgICAgICAkc2NvcGUuZW1wdHlDb21wYW55U2VhcmNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDor4TorrrliJfooahcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5jb21tZW50c0xpc3QgPSBmdW5jdGlvbiAocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDIwLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgc2VhcmNoID0gZ2V0UGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgICAgIC8qdmFyIHAgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJOYW1lOiAkc2NvcGUuY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogJHNjb3BlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIH07Ki9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5UGFyYW0gPSBhbmd1bGFyLmV4dGVuZCggZ2V0UGFyYW1zKCkse1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1aXRlU2VydmljZS5xdWVyeUNvbW1lbnQocXVlcnlQYXJhbSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0luZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNvbW1lbnRzTGlzdCgpO1xuICAgICAgICB2YXIgZ2V0UGFyYW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gJHNjb3BlLnF1ZXJ5UGFyYW1zO1xuICAgICAgICAgICAgdGVtcFt0ZW1wLm1hcmtJZF0gPSB0ZW1wLmZ1enp5O1xuICAgICAgICAgICAgcmV0dXJuIF8ub21pdCh0ZW1wLCAnbWFya0lkJywgJ2Z1enp5Jyk7XG4gICAgICAgIH07XG5cblxuICAgICAgICAvKuaJk+WNsCovXG4gICAgICAgIC8v5omT5Y2w5Y2V5o2u5YiX6KGoXG4gICAgICAgIHZhciBwcmludE9yZGVyQXJyYXkgPSBbXTtcbiAgICAgICAgdmFyIGNoZWNrSW5mbyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBfLmZpbmRXaGVyZShwcmludE9yZGVyQXJyYXksIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJJZDogaXRlbS5vcmRlcklkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2hlY2tBbGxDZmcgPSB7XG4gICAgICAgICAgICBmbGFnOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5Yu+6YCJXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24gKGUsIG9yZGVyKSB7XG4gICAgICAgICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNDaGVja2VkID0gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9yZGVyLmNoZWNrZWQgPSBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgcHJpbnRPcmRlckFycmF5LnB1c2gob3JkZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hlY2tBbGxDZmcuZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHByaW50T3JkZXJBcnJheSA9IF8ud2l0aG91dChwcmludE9yZGVyQXJyYXksIG9yZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEFsbE9yZGVyID0gZnVuY3Rpb24gKGUsIGRhdGEsIGNoZWNrYWxsKSB7XG4gICAgICAgICAgICB2YXIgc3QgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQgIT09IHN0KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24oZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8v6YCJ5oupXG4gICAgICAgICRzY29wZS5xdWVyeUNob29zZSA9IHtcbiAgICAgICAgICAgIG5hbWVUeXBlRGF0YTogW3tcbiAgICAgICAgICAgICAgICBtYXJrSWQ6ICcnLFxuICAgICAgICAgICAgICAgIGRlc2M6ICfml6AnXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbWFya0lkOiAnY3VzdG9tZXJOYW1lJyxcbiAgICAgICAgICAgICAgICBkZXNjOiAn55So5oi35ZCNJ1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG1hcmtJZDogJ2NvbnRlbnQnLFxuICAgICAgICAgICAgICAgIGRlc2M6ICflhoXlrrknXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zW1wibWFya0lkXCJdID0gaXRlbS5tYXJrSWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWbnuWkjeivhOiuulxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnJlcGx5Q29tbWVudCA9IGZ1bmN0aW9uIChjbSkge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnRzTWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9yZXBseUNvbW1lbnRzVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmNvbW1lbnRzID0gY207XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOehruWumuWbnuWkjVxuICAgICAgICAgKmRldGVybWluZVJlcGx5KClcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5kZXRlcm1pbmVSZXBseSA9IGZ1bmN0aW9uIChjb21tZW50cykge1xuICAgICAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb21tZW50cy5jb250ZW50KTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc3VpdGVJZDogY29tbWVudHMuc3VpdGVJZCxcbiAgICAgICAgICAgICAgICBjb21wYW55SWQ6IGNvbW1lbnRzLmNvbXBhbnlJZCxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBjb21tZW50cy5yZXBseSxcbiAgICAgICAgICAgICAgICBwYXJlbnRJZDogY29tbWVudHMuaWQsXG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzdWl0ZVNlcnZpY2UuX2NyZWF0ZUNvbW1lbnQocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tbWVudHNMaXN0KCk7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+WbnuWkjeaIkOWKn++8gScpO1xuICAgICAgICAgICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWPlua2iOWbnuWkjVxuICAgICAgICAgKiBjYW5jZWxSZXBseSgpXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUuY2FuY2VsUmVwbHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgdGhpcy4kY2xvc2UoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5Yig6Zmk6K+E6K66XG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUuZGVsZXRlQ29tbWVudCA9IGZ1bmN0aW9uIChjbSkge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc3VpdGVDb21tZW50SWQ6IGNtLmlkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3VpdGVTZXJ2aWNlLl9kZWxldGVDb21tZW50KHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+ivhOiuuuWIoOmZpOaIkOWKn+OAgicpO1xuICAgICAgICAgICAgICAgICRzY29wZS5jb21tZW50c0xpc3QoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cblxuIiwiLypcbiAq5LyB5Lia5bqT5o6n5Yi25ZmoXG4gKmNvbXBhbnlDb250cm9sbGVyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdjb21wYW55JywgZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2LCAkbWREaWFsb2csICRzY2UsXG4gICAgJGVsZW1lbnQsICRjb21waWxlLCAkdGVtcGxhdGVDYWNoZSwgJGZpbHRlciwgTmdUYWJsZVBhcmFtcyxcbiAgICBwcmludFNlcnZpY2UsIHV0aWxTZXJ2aWNlLFxuICAgIG1vZGFsU2VydmljZSwgY29tcGFueVNlcnZpY2UsIENPTlNUQU5UUykge1xuICAgICRzY29wZS5DT05TVEFOVFMgPSBDT05TVEFOVFM7XG4gICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge307IC8v5LyB5Lia5p+l6K+i5Y+C5pWwXG4gICAgJHNjb3BlLnNlbGVjdGVkQ29tcGFueUxpc3QgPSBbXTsgLy/pgInkuK3nmoTkvIHkuJrliJfooahcblxuICAgIC8vIOS4i+mdouS7o+eggeS4uuWvvOWHukV4Y2Vs5YGa5YeG5aSHXG4gICAgdmFyIGV4Y2VsVGVtcGxhdGUgPSAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQoXG4gICAgICAnY29tcGFueS9jb21wYW55VGFibGVUZW1wbGF0ZS5odG1sJykpKCRzY29wZSk7XG4gICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgJ2V4cG9ydEV4Y2VsV3JhcCcpKS5hcHBlbmQoZXhjZWxUZW1wbGF0ZSk7XG5cbiAgICAvKuWumuS5iSovXG4gICAgJHNjb3BlLmNvbXBhbnlDcmVhdGVNb2RhbDtcbiAgICB2YXIgZ2V0UmVjb3JkQnlJZCA9IGZ1bmN0aW9uKHJlY29yZCkge1xuICAgICAgdmFyIHZhbHVlO1xuICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5jb21wYW55LmNvbnRhY3RzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmIChyZWNvcmQuaWQgPT0gaXRlbS5pZCkge1xuICAgICAgICAgIHZhbHVlID0gaXRlbTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICB2YXIgZGVmYXVsdENvbmNhdCA9IHtcbiAgICAgIG1vYmlsZTogJycsXG4gICAgICB0ZWw6ICcnLFxuICAgICAgcXE6ICcnLFxuICAgICAgd2VjaGF0OiAnJyxcbiAgICAgIGNvbW1hbmQ6ICcnLFxuICAgICAgY29udGFjdE5hbWU6ICcnLFxuICAgICAgaXNFZGl0aW5nOiB0cnVlXG4gICAgfTtcbiAgICAkc2NvcGUuY29tcGFueXMgPSBbXTtcbiAgICAkc2NvcGUuY29udGFjdFRhYmxlRGF0YSA9IFtdO1xuICAgICRzY29wZS5jb21wYW55ID0ge1xuICAgICAgY29tcGFueUlkOiAnJyxcbiAgICAgIGNvbXBhbnlNYW5hZ2VySWQ6ICcnLFxuICAgICAgc3RhZmZOdW06ICcnLFxuICAgICAgY29tcGFueU5hbWU6ICcnLFxuICAgICAgc2hlbGZUeXBlOiAnJyxcbiAgICAgIHBpY2tpbmdUeXBlOiBDT05TVEFOVFMuUElDS0lOR19UWVBFLlJBTkRPTSxcbiAgICAgIHBpY2tpbmdSZW1hcms6ICcnLFxuICAgICAgZGVzOiAnJyxcbiAgICAgIGFkZHJlc3M6ICcnLFxuICAgICAgbGltaXRGZWU6ICcnLFxuICAgICAgbG5nOiAnJyxcbiAgICAgIGxhdDogJycsXG4gICAgICBjaGFuZ2U6ICcnLFxuICAgICAgZm9sbG93UGVvcGxlOiAnJyxcbiAgICAgIHN0YXR1czogJycsXG4gICAgICBpc1ByZW1pdW06IGZhbHNlLFxuICAgICAgY29udGFjdHM6IFtdLFxuICAgICAgc2VuZFdlZWs6IFtdLFxuICAgICAgYmFsYW5jZTogMCxcbiAgICAgIHN1cGVyQWRtaW46ICcnLFxuICAgICAgY3VzdG9tZXJUeXBlOiAnJyxcbiAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jb21wYW55SWQgPSAnJztcbiAgICAgICAgdGhpcy5jb21wYW55TWFuYWdlcklkID0gJyc7XG4gICAgICAgIHRoaXMuc3RhZmZOdW0gPSAnJztcbiAgICAgICAgdGhpcy5jb21wYW55TmFtZSA9ICcnO1xuICAgICAgICB0aGlzLnNoZWxmVHlwZSA9ICcnO1xuICAgICAgICB0aGlzLnBpY2tpbmdUeXBlID0gQ09OU1RBTlRTLlBJQ0tJTkdfVFlQRS5SQU5ET007XG4gICAgICAgIHRoaXMucGlja2luZ1JlbWFyayA9ICcnO1xuICAgICAgICB0aGlzLmRlcyA9ICcnO1xuICAgICAgICB0aGlzLmFkZHJlc3MgPSAnJztcbiAgICAgICAgdGhpcy5saW1pdEZlZSA9ICcnO1xuICAgICAgICB0aGlzLmNvbnRhY3RzID0gW107XG4gICAgICAgIHRoaXMuc2VuZFdlZWsgPSBbXTtcbiAgICAgICAgdGhpcy5sbmcgPSAnJztcbiAgICAgICAgdGhpcy5sYXQgPSAnJztcbiAgICAgICAgdGhpcy5pc1ByZW1pdW0gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mb2xsb3dQZW9wbGUgPSAnJztcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAnJztcbiAgICAgICAgdGhpcy5jaGFuZ2UgPSAnJztcbiAgICAgICAgdGhpcy5iYWxhbmNlID0gMDtcbiAgICAgICAgdGhpcy5zdXBlckFkbWluID0gJyc7XG4gICAgICAgIHRoaXMuY3VzdG9tZXJUeXBlID0gJyc7XG4gICAgICB9LCAvL0NvbXBhbnlDb250YWN0SW5mb1tdICDkvIHkuJrogZTns7vkurrliJfooahcbiAgICAgIHZpZXdGb3JtYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5saW1pdEZlZSA9IHRoaXMubGltaXRGZWUgPj0gMCA/IHBhcnNlSW50KHRoaXMubGltaXRGZWUgL1xuICAgICAgICAgIDEwMCkgOiAnJztcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5a6i5oi36LSn5p6257G75Z6LIOiuvue9rlxuICAgICRzY29wZS5mb3JtQ29uZmlnID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnQ09NUEFOWV9UWVBFJyxcbiAgICAgICAgICBoYXNEZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgICBjb2RlS2V5OiAndmFsdWUnLFxuICAgICAgICAgIHZhbHVlS2V5OiAnZGVzYydcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5nZXRMaXN0KCk7XG4gICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7XG4gICAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICAgIH0pIHx8IG9wdGlvbnNbMV07XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgIHRoaXMuZGVmYXVsdEl0ZW0gPSByZWNvcmQ7XG4gICAgICAgICRzY29wZS5jb21wYW55LnNoZWxmVHlwZSA9IHJlY29yZC52YWx1ZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5a6i5oi357G75YirKOWmguS8geS4mu+8jOe9keWQp+etiSlcbiAgICAkc2NvcGUuY3VzdG9tZXJUeXBlID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24obW9kZSkge1xuICAgICAgICB2YXIgbGlzdE9wdHMgPSB7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnQ1VTVE9NRVJfVFlQRScsXG4gICAgICAgICAgY29kZUtleTogJ2N1c3RvbWVyVHlwZScsXG4gICAgICAgICAgdmFsdWVLZXk6ICduYW1lJ1xuICAgICAgICB9O1xuICAgICAgICBpZiAobW9kZSA9PSAxKSB7IC8v562b6YCJ5qih5byPXG4gICAgICAgICAgbGlzdE9wdHMuZGVmYXVsdE9iaiA9IHtcbiAgICAgICAgICAgICctMSc6ICfmiYDmnInlrqLmiLfnsbvliKsnXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsaXN0T3B0cy5oYXNEZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIENPTlNUQU5UUy5nZXRMaXN0KGxpc3RPcHRzKTtcbiAgICAgIH0sXG4gICAgICBnZXREZWZhdWx0SXRlbTogZnVuY3Rpb24obW9kZSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmdldExpc3QobW9kZSk7XG4gICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7XG4gICAgICAgICAgY3VzdG9tZXJUeXBlOiB2YWx1ZVxuICAgICAgICB9KSB8fCBvcHRpb25zWzBdO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uKG1vZGUsIHJlY29yZCkge1xuICAgICAgICBpZiAobW9kZSA9PSAxKSB7IC8v562b6YCJ5qih5byPXG4gICAgICAgICAgaWYgKHJlY29yZC5jdXN0b21lclR5cGUgIT0gLTEpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jdXN0b21lclR5cGUgPSByZWNvcmQuY3VzdG9tZXJUeXBlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLnF1ZXJ5UGFyYW1zLmN1c3RvbWVyVHlwZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgJHNjb3BlLnNlYXJjaENvbXBhbnkoKTtcbiAgICAgICAgfSBlbHNlIHsgLy/orr7nva7mqKHlvI9cbiAgICAgICAgICB0aGlzLmRlZmF1bHRJdGVtID0gcmVjb3JkO1xuICAgICAgICAgICRzY29wZS5jb21wYW55LmN1c3RvbWVyVHlwZSA9IHJlY29yZC5jdXN0b21lclR5cGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5a6i5oi354q25oCBXG4gICAgJHNjb3BlLmN1c3RvbWVyU3RhdHVzID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24obW9kZSkge1xuICAgICAgICB2YXIgbGlzdE9wdHMgPSB7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnQ1VTVE9NRVJfU1RBVFVTJyxcbiAgICAgICAgICBjb2RlS2V5OiAnY3VzdG9tZXJTdGF0dXMnLFxuICAgICAgICAgIHZhbHVlS2V5OiAnbmFtZSdcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG1vZGUgPT0gMSkgeyAvL+etm+mAieaooeW8j1xuICAgICAgICAgIGxpc3RPcHRzLmRlZmF1bHRPYmogPSB7XG4gICAgICAgICAgICAnLTEnOiAn5omA5pyJ5LyB5Lia54q25oCBJ1xuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGlzdE9wdHMuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDT05TVEFOVFMuZ2V0TGlzdChsaXN0T3B0cyk7XG4gICAgICB9LFxuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKG1vZGUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5nZXRMaXN0KG1vZGUpO1xuICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgIGN1c3RvbWVyU3RhdHVzOiB2YWx1ZVxuICAgICAgICB9KSB8fCBvcHRpb25zWzBdO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uKG1vZGUsIHJlY29yZCkge1xuICAgICAgICBpZiAobW9kZSA9PSAxKSB7IC8v562b6YCJ5qih5byPXG4gICAgICAgICAgaWYgKHJlY29yZC5jdXN0b21lclN0YXR1cyAhPSAtMSkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXR1cyA9IHJlY29yZC5jdXN0b21lclN0YXR1cztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5xdWVyeVBhcmFtcy5zdGF0dXM7XG4gICAgICAgICAgfVxuICAgICAgICAgICRzY29wZS5zZWFyY2hDb21wYW55KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5kZWZhdWx0SXRlbSA9IHJlY29yZDtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueS5zdGF0dXMgPSByZWNvcmQuY3VzdG9tZXJTdGF0dXM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5a6i5oi35p+l6K+i57G75YirIOiuvue9rlxuICAgICRzY29wZS5xdWVyeUNvbXBhbnlUeXBlQ29uZmlnID0ge1xuICAgICAgbmFtZVR5cGVEYXRhOiBbe1xuICAgICAgICBtYXJrSWQ6ICdjb21wYW55TmFtZScsXG4gICAgICAgIGRlc2M6ICflkI3np7AnXG4gICAgICB9LCB7XG4gICAgICAgIG1hcmtJZDogJ2FkZHJlc3MnLFxuICAgICAgICBkZXNjOiAn5Zyw5Z2AJ1xuICAgICAgfV0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtc1tcIm1hcmtJZFwiXSA9IGl0ZW0ubWFya0lkO1xuICAgICAgICAkc2NvcGUucXVlcnlUeXBlTmFtZSA9IGl0ZW0uZGVzYztcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5Zue6L2m6ZSu5p+l6K+iIFxuICAgICRzY29wZS5jb21wYW55S2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICBpZiAoa2V5Y29kZSA9PSAxMykge1xuICAgICAgICAkc2NvcGUuc2VhcmNoQ29tcGFueSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/ooajmoLzorr7nva5cbiAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAkc2NvcGUubGltaXQgPSAyMDtcbiAgICAkc2NvcGUuY29tcGFueVRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgY291bnQ6ICRzY29wZS5saW1pdFxuICAgIH0sIHtcbiAgICAgIGNvdW50czogW10sXG4gICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAyMCxcbiAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICBnZXREYXRhOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgJHNjb3BlLm9mZnNldCA9ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSk7XG4gICAgICAgIHZhciBwID0gZ2V0UGFyYW1zKCk7XG4gICAgICAgIHAub2Zmc2V0ID0gJHNjb3BlLm9mZnNldDtcbiAgICAgICAgcC5saW1pdCA9ICRzY29wZS5saW1pdDtcbiAgICAgICAgcmV0dXJuIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueUxpc3QocCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgIHJldHVybiBjb21wYW55U2VydmljZS5wYXJzZUNvbXBhbnlMaXN0KHJlcy5jb250ZW50LFxuICAgICAgICAgICAgJHNjb3BlLm9mZnNldCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHZhciBnZXRQYXJhbXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB0ZW1wID0gJHNjb3BlLnF1ZXJ5UGFyYW1zO1xuICAgICAgXy5lYWNoKCRzY29wZS5xdWVyeUNvbXBhbnlUeXBlQ29uZmlnLm5hbWVUeXBlRGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBkZWxldGUgdGVtcFtpdGVtLm1hcmtJZF07XG4gICAgICB9KTtcbiAgICAgIHRlbXBbdGVtcC5tYXJrSWRdID0gdGVtcC5xdWVyeU5hbWU7XG4gICAgICByZXR1cm4gXy5vbWl0KHRlbXAsICdtYXJrSWQnLCAncXVlcnlOYW1lJyk7XG4gICAgfTtcbiAgICAvL+WLvumAiVxuICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbihlLCBjb21wYW55KSB7XG4gICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgaXNDaGVja2VkID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgfVxuICAgICAgY29tcGFueS5jaGVja2VkID0gaXNDaGVja2VkO1xuICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRDb21wYW55TGlzdC5wdXNoKGNvbXBhbnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkQ29tcGFueUxpc3QgPSBfLndpdGhvdXQoJHNjb3BlLnNlbGVjdGVkQ29tcGFueUxpc3QsXG4gICAgICAgICAgY29tcGFueSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIOmAieaLqeaYn+acn1xuICAgIHZhciB3ZWVrQ2hvaWNzID0gJGZpbHRlcignc2VsZWN0aW9uJykoJ1dFRUtfVFlQRScsIG51bGwsICd2YWx1ZScsXG4gICAgICAnZGVzYycsICcnLCB0cnVlKTtcbiAgICAkc2NvcGUud2Vla0NvbmZpZyA9IHtcbiAgICAgIGNob2ljZXM6IHdlZWtDaG9pY3MsXG4gICAgICBkZWZhdWx0SXRlbToge1xuICAgICAgICB2YWx1ZTogJy0xJyxcbiAgICAgICAgZGVzYzogJ+mAieaLqeaYn+acnydcbiAgICAgIH0sXG4gICAgICBnZXRPcHRpb25CeVZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuY2hvaWNlcztcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKG9wdGlvbnMsIHtcbiAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgIGlmIChyZWNvcmQudmFsdWUgPT0gdGhpcy5kZWZhdWx0SXRlbS52YWx1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueS5zZW5kV2VlayA9IF8uc29ydEJ5KF8udW5pb24oJHNjb3BlLmNvbXBhbnkuc2VuZFdlZWssIFtcbiAgICAgICAgICAgIHJlY29yZC52YWx1ZVxuICAgICAgICAgIF0pKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlbFdlZWs6IGZ1bmN0aW9uKGNoaXApIHtcbiAgICAgICAgdmFyIHZhbHVlID0gJGZpbHRlcigndmFsdWUnKShjaGlwLCAnV0VFS19UWVBFJywgdHJ1ZSk7XG4gICAgICAgICRzY29wZS5jb21wYW55LnNlbmRXZWVrID0gXy53aXRob3V0KCRzY29wZS5jb21wYW55LnNlbmRXZWVrLFxuICAgICAgICAgIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5p+l6K+i5LyB5Lia5YiX6KGoXG4gICAgJHNjb3BlLnNlYXJjaENvbXBhbnkgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5jb21wYW55VGFibGUuc2V0dGluZ3Moe1xuICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WvvOWHuuS8geS4muWIl+ihqFxuICAgICRzY29wZS5leHBvcnRDb21wYW55VGFibGVFeGNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCEkc2NvcGUuc2VsZWN0ZWRDb21wYW55TGlzdC5sZW5ndGgpIHtcbiAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcign6K+35YWI6YCJ5oup6ZyA5a+85Ye655qE5LyB5LiaJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBkb20gPSBhbmd1bGFyLmVsZW1lbnQoJzxhPjwvYT4nKTtcbiAgICAgIGRvbVswXS5ocmVmID0gJCgnI2V4cG9ydC1jb21wYW55LXRhYmxlJykuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgIGNvbnRhaW5lcmlkOiAnZXhwb3J0LWNvbXBhbnktdGFibGUnLFxuICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgIH0pO1xuICAgICAgZG9tWzBdLmRvd25sb2FkID0gJ+S8geS4muWIl+ihqC54bHMnO1xuICAgICAgZG9tWzBdLmNsaWNrKCk7XG4gICAgfTtcbiAgICAvL+aJk+W8gOS8geS4miDmlrDlop4g57yW6L6RXG4gICAgJHNjb3BlLm9wZW5DcmVhdGVFZGl0Q29tcGFueVdpbiA9IGZ1bmN0aW9uKGNvbXBhbnlJZCkge1xuICAgICAgJHNjb3BlLmNvbXBhbnkucmVzZXQoKTtcbiAgICAgIGlmICghY29tcGFueUlkKSB7IC8v5paw5aKe5qih5byPXG4gICAgICAgICRzY29wZS5jb250YWN0VGFibGUuc2V0dGluZ3Moe1xuICAgICAgICAgIGRhdGFzZXQ6IFtdXG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUuY29tcGFueUNyZWF0ZU1vZGFsID0gaW5pdE1vZGFsKCdtb2RlbGNvbnRlbnQnLCAnbWlkZGxlJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb21wYW55U2VydmljZS5xdWVyeUNvbXBhbnlQcmVtaXVtU3RhdGUoe1xuICAgICAgICAgIGNvbXBhbnlJZDogY29tcGFueUlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLmNvbXBhbnkuaXNQcmVtaXVtID0gISFwYXJzZUludChyZXMuZW5hYmxlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueURlZHVjdGlvbih7XG4gICAgICAgICAgY29tcGFueUlkOiBjb21wYW55SWRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueS5iYWxhbmNlID0gcmVzLmJhbGFuY2U7XG4gICAgICAgIH0pO1xuICAgICAgICBjb21wYW55U2VydmljZS5xdWVyeUNvbXBhbnkoe1xuICAgICAgICAgIGNvbXBhbnlJZDogY29tcGFueUlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLmNvbXBhbnkgPSBhbmd1bGFyLmV4dGVuZCgkc2NvcGUuY29tcGFueSwgcmVzKTtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueS52aWV3Rm9ybWF0ZSgpO1xuICAgICAgICAgICRzY29wZS5jb250YWN0VGFibGVEYXRhID0gYW5ndWxhci5jb3B5KHJlcy5jb250YWN0cyk7XG4gICAgICAgICAgJHNjb3BlLmNvbnRhY3RUYWJsZS5zZXR0aW5ncyh7XG4gICAgICAgICAgICBkYXRhc2V0OiAkc2NvcGUuY29udGFjdFRhYmxlRGF0YVxuICAgICAgICAgIH0pO1xuICAgICAgICAgICRzY29wZS5jb21wYW55Q3JlYXRlTW9kYWwgPSBpbml0TW9kYWwoJ21vZGVsY29udGVudCcsXG4gICAgICAgICAgICAnbWlkZGxlJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgfTtcbiAgICAvL01vZGFsXG4gICAgdmFyIGluaXRNb2RhbCA9IGZ1bmN0aW9uKHRlbXBsYXRlVXJsLCBzaXplLCBhcHBlbmRUb0VsZW1lbnQpIHtcbiAgICAgIHJldHVybiBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFwcGVuZFRvRWxlbWVudCB8fCAkZWxlbWVudCxcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlVXJsLFxuICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICBzaXplOiBzaXplXG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v56Gu5a6a5o+Q5Lqk5LyB5Lia5L+h5oGvXG4gICAgJHNjb3BlLnN1Ym1pdENvbXBhbnlDb25maXJtID0gZnVuY3Rpb24oY29tcGFueSkge1xuICAgICAgdmFyIGVycm9yTXNnID0gJyc7XG4gICAgICBpZiAoIWNvbXBhbnkuY29udGFjdHMubGVuZ3RoKSB7XG4gICAgICAgIGVycm9yTXNnID0gJ+ivt+a3u+WKoOiBlOezu+aWueW8jyc7XG4gICAgICB9IGVsc2UgaWYgKGNvbXBhbnkucGlja2luZ1R5cGUgPT0gQ09OU1RBTlRTLlBJQ0tJTkdfVFlQRS5PVEhFUikge1xuICAgICAgICBpZiAoIWNvbXBhbnkucGlja2luZ1JlbWFyaykge1xuICAgICAgICAgIGVycm9yTXNnID0gJ+ivt+Whq+WGmeWFtuS7luaLo+i0p+exu+Weiyc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChlcnJvck1zZy5sZW5ndGgpIHtcbiAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcihlcnJvck1zZyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBjb21wYW55UGFyYW1zID0gYW5ndWxhci5jb3B5KGNvbXBhbnkpO1xuICAgICAgaWYgKGNvbXBhbnlQYXJhbXMucGlja2luZ1R5cGUgIT0gQ09OU1RBTlRTLlBJQ0tJTkdfVFlQRS5PVEhFUikge1xuICAgICAgICBjb21wYW55UGFyYW1zLnBpY2tpbmdSZW1hcmsgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmIChjb21wYW55UGFyYW1zLmxpbWl0RmVlID09ICcnKSB7XG4gICAgICAgIGNvbXBhbnlQYXJhbXMubGltaXRGZWUgPSAtMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbXBhbnlQYXJhbXMubGltaXRGZWUgPSB1dGlsU2VydmljZS5nZXRQb2ludEludChcbiAgICAgICAgICBjb21wYW55UGFyYW1zLmxpbWl0RmVlIHx8IDApO1xuICAgICAgfVxuICAgICAgaWYgKCFjb21wYW55LmNvbXBhbnlJZCkgeyAvL+aWsOWinuaooeW8j1xuICAgICAgICAkc2NvcGUuY3JlYXRlQ29tcGFueUNvbmZpcm0oY29tcGFueVBhcmFtcyk7XG4gICAgICB9IGVsc2UgeyAvL+S/ruaUueaooeW8j1xuICAgICAgICAkc2NvcGUuZWRpdENvbXBhbnlDb25maXJtKGNvbXBhbnlQYXJhbXMpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/noa7orqTliJvlu7rkvIHkuJpcbiAgICAkc2NvcGUuY3JlYXRlQ29tcGFueUNvbmZpcm0gPSBmdW5jdGlvbihjb21wYW55UGFyYW1zKSB7XG4gICAgICByZXR1cm4gY29tcGFueVNlcnZpY2UuY3JlYXRlQ29tcGFueShjb21wYW55UGFyYW1zKS50aGVuKGZ1bmN0aW9uKFxuICAgICAgICByZXMpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KCRzY29wZS5jb21wYW55LmNoYW5nZSkpIHtcbiAgICAgICAgICBjb21wYW55U2VydmljZS5zZXRDb21wYW55RGVkdWN0aW9uKHtcbiAgICAgICAgICAgIGNvbXBhbnlJZDogcmVzLmNvbXBhbnlJZCxcbiAgICAgICAgICAgIGNoYW5nZTogJGZpbHRlcigncG9pbnRzJykoJHNjb3BlLmNvbXBhbnkuY2hhbmdlKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5jb21wYW55Q3JlYXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgJHNjb3BlLmNvbXBhbnlUYWJsZS5yZWxvYWQoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/noa7orqTnvJbovpHkvIHkuJpcbiAgICAkc2NvcGUuZWRpdENvbXBhbnlDb25maXJtID0gZnVuY3Rpb24oY29tcGFueVBhcmFtcykge1xuICAgICAgdmFyIHByb21pc2UgPSBjb21wYW55U2VydmljZS5lZGl0Q29tcGFueShjb21wYW55UGFyYW1zKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAocGFyc2VJbnQoJHNjb3BlLmNvbXBhbnkuY2hhbmdlKSkge1xuICAgICAgICAgICAgY29tcGFueVNlcnZpY2Uuc2V0Q29tcGFueURlZHVjdGlvbih7XG4gICAgICAgICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLmNvbXBhbnkuY29tcGFueUlkLFxuICAgICAgICAgICAgICBjaGFuZ2U6ICRmaWx0ZXIoJ3BvaW50cycpKCRzY29wZS5jb21wYW55LmNoYW5nZSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuY29tcGFueUNyZWF0ZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgJHNjb3BlLmNvbXBhbnlUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7fSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8v5re75Yqg6IGU57O75Lq6XG4gICAgJHNjb3BlLmNvbmZpcm1BZGQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5jb250YWN0VGFibGUuc2V0dGluZ3MoKS5kYXRhc2V0LnB1c2goYW5ndWxhci5jb3B5KFxuICAgICAgICBkZWZhdWx0Q29uY2F0KSk7XG4gICAgICAkc2NvcGUuY29udGFjdFRhYmxlLnJlbG9hZCgpO1xuICAgIH07XG5cbiAgICAvL+S/ruaUueiBlOezu+S6ulxuICAgICRzY29wZS5jb25maXJtRWRpdCA9IGZ1bmN0aW9uKHJvdywgcm93Rm9ybSwgc2NvcGUpIHtcbiAgICAgIHJvdy5pc0VkaXRpbmcgPSBmYWxzZTtcbiAgICAgIHJvd0Zvcm0uJHNldFByaXN0aW5lKCk7XG5cbiAgICAgIGlmIChyb3cuaWQpIHsgLy/kv67mlLnogZTns7vkurpcbiAgICAgICAgY29tcGFueVNlcnZpY2UuZWRpdENvbXBhbnlDb250YWN0KHJvdykudGhlbihmdW5jdGlvbihyZXMpIHsgLy/miJDlip9cbiAgICAgICAgICAkc2NvcGUuY29tcGFueVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHsgLy/lpLHotKVcbiAgICAgICAgICByb3cgPSBhbmd1bGFyLmV4dGVuZChyb3csIGdldFJlY29yZEJ5SWQocm93KSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHsgLy/mt7vliqDogZTns7vkurpcbiAgICAgICAgaWYgKHNjb3BlLmNvbXBhbnkuY29tcGFueUlkKSB7IC8v5L+u5pS55LyB5Lia5pe25re75Yqg6IGU57O75Lq6XG4gICAgICAgICAgcm93LmNvbXBhbnlJZCA9IHNjb3BlLmNvbXBhbnkuY29tcGFueUlkO1xuICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLmFkZENvbXBhbnlDb250YWN0KHJvdykudGhlbihmdW5jdGlvbihyZXMpIHsgLy/miJDlip9cbiAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueSh7XG4gICAgICAgICAgICAgIGNvbXBhbnlJZDogc2NvcGUuY29tcGFueS5jb21wYW55SWRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICRzY29wZS5jb21wYW55ID0gYW5ndWxhci5leHRlbmQoJHNjb3BlLmNvbXBhbnksXG4gICAgICAgICAgICAgICAgcmVzKTtcbiAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnkuZm9ybWF0ZSgpO1xuICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdFRhYmxlRGF0YSA9IGFuZ3VsYXIuY29weShyZXMuY29udGFjdHMpO1xuICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdFRhYmxlLnNldHRpbmdzKHtcbiAgICAgICAgICAgICAgICBkYXRhc2V0OiAkc2NvcGUuY29udGFjdFRhYmxlRGF0YVxuICAgICAgICAgICAgICB9KTsgLyokc2NvcGUuY29tcGFueVRhYmxlLnJlbG9hZCgpOyovXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikgeyAvL+Wksei0pVxuICAgICAgICAgICAgJHNjb3BlLmNvbnRhY3RUYWJsZURhdGEgPSBfLndpdGhvdXQoJHNjb3BlLmNvbnRhY3RUYWJsZURhdGEsXG4gICAgICAgICAgICAgIHJvdyk7XG4gICAgICAgICAgICAkc2NvcGUuY29udGFjdFRhYmxlLnNldHRpbmdzKHtcbiAgICAgICAgICAgICAgZGF0YXNldDogJHNjb3BlLmNvbnRhY3RUYWJsZURhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmNvbnRhY3RUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHsgLy/liJvlu7rkvIHkuJrml7bmt7vliqDogZTns7vkurpcbiAgICAgICAgICAkc2NvcGUuY29tcGFueS5jb250YWN0cy5wdXNoKHJvdyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZS5zdGFydEVkaXQgPSBmdW5jdGlvbihyb3csIHJvd0Zvcm0pIHtcbiAgICAgIHJvdy5pc0VkaXRpbmcgPSB0cnVlO1xuICAgICAgLy9yb3dGb3JtLm9yaWdpblJvdyA9IGFuZ3VsYXIuY29weShyb3cpO1xuICAgIH07XG4gICAgLy/lj5bmtojkv67mlLnogZTns7vkurpcbiAgICAkc2NvcGUuY2FuY2VsRWRpdCA9IGZ1bmN0aW9uKHJvdywgcm93Rm9ybSkge1xuICAgICAgcm93LmlzRWRpdGluZyA9IGZhbHNlO1xuICAgICAgcm93Rm9ybS4kc2V0UHJpc3RpbmUoKTtcbiAgICAgIGlmIChyb3cuaWQpIHsgLy/kv67mlLlcbiAgICAgICAgcm93ID0gYW5ndWxhci5leHRlbmQocm93LCBnZXRSZWNvcmRCeUlkKHJvdykpO1xuICAgICAgfSBlbHNlIHsgLy/liKDpmaRcbiAgICAgICAgJHNjb3BlLmNvbnRhY3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQgPSBfLndpdGhvdXQoJHNjb3BlLmNvbnRhY3RUYWJsZVxuICAgICAgICAgIC5zZXR0aW5ncygpLmRhdGFzZXQsIHJvdyk7XG4gICAgICAgICRzY29wZS5jb250YWN0VGFibGUucmVsb2FkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+WIoOmZpOiBlOezu+S6ulxuICAgICRzY29wZS5jb25maXJtRGVsZXRlID0gZnVuY3Rpb24ocm93KSB7XG4gICAgICBpZiAoJHNjb3BlLmNvbnRhY3RUYWJsZS5kYXRhLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgdGl0bGU6ICflpLHotKUnLFxuICAgICAgICAgIHRleHRDb250ZW50OiAn5peg5rOV5Yig6ZmkLOW/hemhu+aciTHkvY3ogZTns7vkurohJyxcbiAgICAgICAgICBvazogJ+WFs+mXrSdcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb21wYW55U2VydmljZS5kZWxldGVDb21wYW55Q29udGFjdCh7XG4gICAgICAgIGNvbnRhY3RJZDogcm93LmlkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUuY29udGFjdFRhYmxlLnNldHRpbmdzKCkuZGF0YXNldCA9IF8ud2l0aG91dCgkc2NvcGUuY29udGFjdFRhYmxlXG4gICAgICAgICAgLnNldHRpbmdzKCkuZGF0YXNldCwgcm93KTtcbiAgICAgICAgJHNjb3BlLmNvbnRhY3RUYWJsZS5yZWxvYWQoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/ph43nva7lr4bnoIFcbiAgICAkc2NvcGUucmVzZXRQV0QgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLnJlc2V0Q29tcGFueVBhc3N3b3JkKHtcbiAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY29tcGFueS5jb21wYW55SWRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgdGl0bGU6ICfmiJDlip8nLFxuICAgICAgICAgIHRleHRDb250ZW50OiAn6YeN572u5a+G56CB5oiQ5YqfJyxcbiAgICAgICAgICBvazogJ+WFs+mXrSdcbiAgICAgICAgfSkpO1xuICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgdGl0bGU6ICfor7fmsYLlpLHotKUnLFxuICAgICAgICAgIHRleHRDb250ZW50OiAn6YeN572u5a+G56CB5aSx6LSlJyxcbiAgICAgICAgICBvazogJ+WFs+mXrSdcbiAgICAgICAgfSkpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8v54q25oCB5pu05pS55pel5b+XXG4gICAgJHNjb3BlLmNvbXBhbnlDaGFuZ2VMb2dDcmw7XG4gICAgJHNjb3BlLmNvbXBhbnlDaGFuZ2VMb2dUYWJsZUhlYWRzID0gW3tcbiAgICAgIHRpdGxlOiAn5bqP5Y+3JyxcbiAgICAgIGZpZWxkOiAnaW5kZXgnXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfmk43kvZzml7bpl7QnLFxuICAgICAgZmllbGQ6ICdvcHRUaW1lJyxcbiAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gJzxzcGFuPicgKyAkZmlsdGVyKCdkYXRlJykodmFsdWUsICd5eXl5Lk1NLmRkJykgK1xuICAgICAgICAgICc8L3NwYW4+JztcbiAgICAgIH0sXG4gICAgICBzaG93OiB0cnVlXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICflp5PlkI0nLFxuICAgICAgZmllbGQ6ICdvcHROYW1lJyxcbiAgICAgIHNob3c6IHRydWUsXG4gICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odikge1xuICAgICAgICByZXR1cm4gJzxzcGFuICBzdHlsZT1cIndpZHRoOjE4MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO1wiPicgK1xuICAgICAgICAgIHYgKyAnPC9zcGFuPic7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfmk43kvZzliY3nirbmgIEnLFxuICAgICAgZmllbGQ6ICdwcmVTdGF0dXNBbGlhcycsXG4gICAgICBzaG93OiB0cnVlXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfmk43kvZzlkI7nirbmgIEnLFxuICAgICAgZmllbGQ6ICdzdWZTdGF0dXNBbGlhcycsXG4gICAgICBzaG93OiB0cnVlXG4gICAgfV07XG4gICAgJHNjb3BlLmNvbXBhbnlDaGFuZ2VMb2dUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgIGNvdW50czogMTBcbiAgICB9LCB7XG4gICAgICBjb3VudHM6IFtdLFxuICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMTMsXG4gICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgZGF0YXNldDogW11cbiAgICB9KTtcbiAgICAkc2NvcGUuZ2V0Q29tcGFueVN0YXRlQ2hhbmdlTG9nID0gZnVuY3Rpb24oY29tcGFueUlkKSB7XG4gICAgICBjb21wYW55U2VydmljZS5xdWVyeUNvbXBhbnlTdGF0ZUNoYW5nZUxvZyh7XG4gICAgICAgIGNvbXBhbnlJZDogY29tcGFueUlkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuY29tcGFueUNoYW5nZUxvZ1RhYmxlLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiB1dGlsU2VydmljZS5pbmRleEFycmF5KHJlcywgMSlcbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueUNoYW5nZUxvZ0N0cmwuc2hvd0RpYWxvZygkc2NvcGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLmNoYW5nZUNvbXBhbnlQcmVtaXVtU3RhdGUgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IGNvbXBhbnkuaXNQcmVtaXVtO1xuICAgICAgICB2YXIgY29tcGFueUlkID0gY29tcGFueS5jb21wYW55SWQ7XG4gICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgn5o+Q56S6JylcbiAgICAgICAgICAgIC50ZXh0Q29udGVudCgn5LyB5Lia5rqi5Lu35Yqf6IO95byA5ZCv5ZCO5peg5rOV5YWz6Zet77yM56Gu5a6a6KaB5byA5ZCv77yfJylcbiAgICAgICAgICAgIC5vaygn56Gu5a6aJylcbiAgICAgICAgICAgIC5jYW5jZWwoJ+WPlua2iCcpXG4gICAgICAgICAgKS50aGVuKGZ1bmN0aW9uKGYpIHtcbiAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLnNldENvbXBhbnlQcmVtaXVtKHtcbiAgICAgICAgICAgICAgY29tcGFueUlkOiBjb21wYW55SWRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7fSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbXBhbnkuaXNQcmVtaXVtID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbXBhbnkuaXNQcmVtaXVtID0gZmFsc2U7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmFsZXJ0KClcbiAgICAgICAgICAgIC5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpXG4gICAgICAgICAgICAudGl0bGUoJ+aPkOekuicpXG4gICAgICAgICAgICAudGV4dENvbnRlbnQoJ+S8geS4mua6ouS7t+S4jeaUr+aMgeWFs+mXreWKn+iDve+8gScpXG4gICAgICAgICAgICAub2soJ+ehruWumicpKTtcbiAgICAgICAgICBjb21wYW55LmlzUHJlbWl1bSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8v5Z2P6LSm5oq15omjXG4gICAgJHNjb3BlLmNvbXBhbnlEZWR1Y3Rpb25DdHJsO1xuICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uRmxvdyA9IFtdO1xuICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uVGFibGVIZWFkcyA9IFt7XG4gICAgICB0aXRsZTogJ+Wdj+i0puaKteaJo+S9meminScsXG4gICAgICBmaWVsZDogJ2JhbGFuY2UnLFxuICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gJzxzcGFuPicgKyAkZmlsdGVyKCdybWInKSh2YWx1ZSkgKyAnPC9zcGFuPic7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgdGl0bGU6ICflj5jljJbph5Hpop0nLFxuICAgICAgZmllbGQ6ICdjaGFuZ2UnLFxuICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gJzxzcGFuPicgKyAkZmlsdGVyKCdybWInKSh2YWx1ZSkgKyAnPC9zcGFuPic7XG4gICAgICB9LFxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn57G75Z6LJyxcbiAgICAgIGZpZWxkOiAnb3B0VHlwZScsXG4gICAgICBzaG93OiB0cnVlLFxuICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAnPHNwYW4+JyArICRmaWx0ZXIoJ2Rlc2MnKSh2YWx1ZSxcbiAgICAgICAgICAnQ09NUEFOWV9ERURVQ1RJT05fVFlQRScpICsgJzwvc3Bhbj4nO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn5pON5L2c5Lq6JyxcbiAgICAgIGZpZWxkOiAnbWFuYWdlck5hbWUnLFxuICAgICAgc2hvdzogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn5pON5L2c5pe26Ze0JyxcbiAgICAgIGZpZWxkOiAnY3JlYXRlVGltZScsXG4gICAgICBzaG93OiB0cnVlLFxuICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAnPHNwYW4+JyArICRmaWx0ZXIoJ2RhdGUnKSh2YWx1ZSxcbiAgICAgICAgICAneXl5eS5NTS5kZCBISDptbTpzcycpICsgJzwvc3Bhbj4nO1xuICAgICAgfSxcbiAgICB9XTtcbiAgICAkc2NvcGUuY29tcGFueURlZHVjdGlvbk9mZnNldCA9ICRzY29wZS5vZmZzZXQ7XG4gICAgJHNjb3BlLmNvbXBhbnlEZWR1Y3Rpb25UYWJsZTtcbiAgICAkc2NvcGUuZ2V0Q29tcGFueURlZHVjdGlvbkxpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uVGFibGUgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgIH0sIHtcbiAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgdmFyIHAgPSB7fTtcbiAgICAgICAgICAkc2NvcGUuY29tcGFueURlZHVjdGlvbk9mZnNldCA9ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC1cbiAgICAgICAgICAgIDEpO1xuICAgICAgICAgIHAgPSB7XG4gICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5jb21wYW55RGVkdWN0aW9uT2Zmc2V0LFxuICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLmNvbXBhbnkuY29tcGFueUlkXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gY29tcGFueVNlcnZpY2UucXVlcnlDb21wYW55RGVkdWN0aW9uRmxvdyhwKS50aGVuKFxuICAgICAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uRmxvdyA9IHJlcy5jb250ZW50O1xuICAgICAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgICAgICByZXR1cm4gY29tcGFueVNlcnZpY2UuaW5kZXhDb21wYW55KHJlcy5jb250ZW50LFxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uT2Zmc2V0ICsgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5jb21wYW55RGVkdWN0aW9uQ3RybC5zaG93RGlhbG9nKCRzY29wZSk7XG4gICAgICB9KTtcbiAgICAgIC8qICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnlEZWR1Y3Rpb25UYWJsZS5yZWxvYWQoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnlEZWR1Y3Rpb25DdHJsLnNob3dEaWFsb2coJHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pOyovXG4gICAgfTtcbiAgICAvL+iBlOezu+aWueW8j+ebuOWFs1xuICAgICRzY29wZS5jb250YWN0SGVhZHMgPSBbe1xuICAgICAgdGl0bGU6ICfogZTns7vkuronLFxuICAgICAgZmllbGQ6ICdjb250YWN0TmFtZScsXG4gICAgICBkYXRhVHlwZTogJ3RleHQnLFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9LCB7XG4gICAgICB0aXRsZTogJ+aJi+acuicsXG4gICAgICBmaWVsZDogJ21vYmlsZScsXG4gICAgICBkYXRhVHlwZTogJ3RleHQnLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICByZWxhdGVkRmllbGQ6ICd0ZWwnXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICfluqfmnLonLFxuICAgICAgZmllbGQ6ICd0ZWwnLFxuICAgICAgZGF0YVR5cGU6ICd0ZXh0JyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgcmVsYXRlZEZpZWxkOiAnbW9iaWxlJ1xuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAnUVEnLFxuICAgICAgZmllbGQ6ICdxcScsXG4gICAgICBkYXRhVHlwZTogJ3RleHQnXG4gICAgfSwge1xuICAgICAgdGl0bGU6ICflvq7kv6Hlj7cnLFxuICAgICAgZmllbGQ6ICd3ZWNoYXQnLFxuICAgICAgZGF0YVR5cGU6ICd0ZXh0J1xuICAgIH0sIHtcbiAgICAgIHRpdGxlOiAn5pON5L2cJyxcbiAgICAgIGZpZWxkOiAnY29tbWFuZCcsXG4gICAgICBkYXRhVHlwZTogJ2NvbW1hbmQnXG4gICAgfV07XG4gICAgJHNjb3BlLmJsb2NrID0ge1xuICAgICAgY29tcGFueUlkOiBcIlwiLFxuICAgICAgcHJvZHVjdElkOiBcIlwiLFxuICAgICAgcmVhc29uOiBcIlwiLFxuICAgICAgbW9kaWZ5UmVhc29uOiBcIlwiLFxuICAgICAgcHJvZHVjdE5hbWU6IFwiXCIsXG4gICAgICBtb2RpZnlJZDogXCJcIixcbiAgICAgIGFkZEJveDogXCJcIlxuICAgIH07XG4gICAgJHNjb3BlLmdldEJsb2NrTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNvbXBhbnlTZXJ2aWNlLmdldEJsb2NrQ29tcGFueSh7XG4gICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLmJsb2NrLmNvbXBhbnlJZFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmJsb2NrQ29ucGFueUxpc3QgPSByZXM7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5zZWVCbG9jayA9IGZ1bmN0aW9uKGNvbXBhbnlJZCkge1xuICAgICAgJHNjb3BlLmJsb2NrLmFkZEJveCA9IGZhbHNlO1xuICAgICAgJHNjb3BlLmJsb2NrLmNvbXBhbnlJZCA9IGNvbXBhbnlJZDtcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLmdldFplcm9Qcm9kdWN0KHtcbiAgICAgICAgY29tcGFueUlkOiAnNzE0OTg3MjQyNjY1Mjc5NDg4J1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmJsb2NrWmVyb1Byb2R1Y3QgPSByZXM7XG4gICAgICB9KTtcbiAgICAgICRzY29wZS5nZXRCbG9ja0xpc3QoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUuY29tcGFueUJsb2NrTW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICBhcHBlbmRUbzogJGVsZW1lbnQsXG4gICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogXCJibG9ja01hbmFnZVwiLFxuICAgICAgICAgIGJhY2tkcm9wOiAnc3RhdGljJyxcbiAgICAgICAgICBzaXplOiAnbGcnXG4gICAgICAgIH0pO1xuICAgICAgfSlcblxuICAgIH07XG4gICAgJHNjb3BlLnNob3dBZGRCb3ggPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5ibG9jay5hZGRCb3ggPSB0cnVlO1xuICAgIH1cbiAgICAkc2NvcGUuYWRkQmxvY2sgPSBmdW5jdGlvbihwcm9kdWN0SWQsIHJlYXNvbiwgY2FsbGJhY2spIHtcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLmFkZEJsb2NrQ29tcGFueSh7XG4gICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLmJsb2NrLmNvbXBhbnlJZCxcbiAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsXG4gICAgICAgIHJlYXNvbjogcmVhc29uXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuZ2V0QmxvY2tMaXN0KCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KVxuICAgICAgfSk7XG5cbiAgICB9O1xuICAgICRzY29wZS5tb2RpZnlCbG9jayA9IGZ1bmN0aW9uKGlkLCBuYW1lLCByZWFzb24pIHtcbiAgICAgICRzY29wZS5ibG9jay5tb2RpZnlJZCA9IGlkO1xuICAgICAgJHNjb3BlLmJsb2NrLm5hbWUgPSBuYW1lO1xuICAgICAgJHNjb3BlLmJsb2NrLm1vZGlmeVJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICRzY29wZS5kZWxldGVCbG9ja01vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgIGFwcGVuZFRvOiAkZWxlbWVudCxcbiAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwibW9kaWZ5RGlhbG9nXCIsXG4gICAgICAgIGJhY2tkcm9wOiAnc3RhdGljJyxcbiAgICAgICAgc2l6ZTogJ3NtJ1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUubW9kaWZ5QmxvY2tTdXJlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgY29tcGFueVNlcnZpY2UubW9kaWZ5QmxvY2tDb21wYW55KHtcbiAgICAgICAgaWQ6ICRzY29wZS5ibG9jay5tb2RpZnlJZCxcbiAgICAgICAgcmVhc29uOiAkc2NvcGUuYmxvY2subW9kaWZ5UmVhc29uXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuZ2V0QmxvY2tMaXN0KCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBtZS4kY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLmRlbGV0ZUNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLmRlbGV0ZUJsb2NrQ29tcGFueSh7XG4gICAgICAgIGlkOiAkc2NvcGUuYmxvY2tEZWxldGVJZCxcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cbiAgICAgICAgJHNjb3BlLmdldEJsb2NrTGlzdCgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbWUuJGNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZGVsZXRlQmxvY2sgPSBmdW5jdGlvbihpZCkge1xuICAgICAgJHNjb3BlLmJsb2NrRGVsZXRlSWQgPSBpZDtcbiAgICAgICRzY29wZS5kZWxldGVCbG9ja01vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgIGFwcGVuZFRvOiAkZWxlbWVudCxcbiAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiYmxvY2tEZWxldGVcIixcbiAgICAgICAgYmFja2Ryb3A6ICdzdGF0aWMnLFxuICAgICAgICBzaXplOiAnc20nXG4gICAgICB9KTtcblxuXG4gICAgfTtcbiAgICAkc2NvcGUuY29udGFjdFRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgY291bnQ6IDVcbiAgICB9LCB7XG4gICAgICBjb3VudHM6IFtdLFxuICAgICAgZGF0YXNldDogJHNjb3BlLmNvbnRhY3RUYWJsZURhdGFcbiAgICB9KTtcbiAgfSk7XG59OyIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzEwLzE4LlxuICog5L+h5oGv6YWN572uXG4gKiBjb25maWd1cmF0aW9uSW5mb3JtYXRpb25cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ2NvbmZpZ3VyYXRpb25JbmZvcm1hdGlvbicsIGZ1bmN0aW9uKCRzY29wZSxcbiAgICBjb25maWd1cmF0aW9uSW5mb3JtYXRpb25TZXJ2aWNlLCAkZmlsdGVyLCBob2xpZGF5V2VsZmFyZVNlcnZpY2UsXG4gICAgdXRpbFNlcnZpY2UpIHtcblxuXG4gICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge307XG4gICAgJHNjb3BlLnRvdGFsRmVlID0gW107XG4gICAgJHNjb3BlLnNob3dUaW1lO1xuICAgICRzY29wZS5kZXBvc2l0QW1vdW50ID0gW107XG4gICAgJHNjb3BlLndlbGZhcmVUaW1lID0ge307XG5cblxuICAgIC8qKlxuICAgICAqIOiOt+WPlumbtuiKsemSseWuoeaguOWfuuaVsOm7mOiupOWAvFxuICAgICAqL1xuICAgICRzY29wZS5nZXRQb2NrZXRNb25leUF1ZGl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBjb25maWd1cmF0aW9uSW5mb3JtYXRpb25TZXJ2aWNlLmdldFBvY2tldE1vbmV5QXVkaXQoKS50aGVuKFxuICAgICAgICBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUudG90YWxGZWUgPSAkZmlsdGVyKCdybWInKShyZXMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5nZXRQb2NrZXRNb25leUF1ZGl0KCk7XG5cblxuICAgIC8qKlxuICAgICAqIOmbtuiKsemSseWuoeaguOWfuuaVsFxuICAgICAqL1xuICAgICRzY29wZS5wb2NrZXRNb25leUF1ZGl0ID0gZnVuY3Rpb24odG90YWxGZWUpIHtcbiAgICAgIGNvbmZpZ3VyYXRpb25JbmZvcm1hdGlvblNlcnZpY2UucG9ja2V0TW9uZXlBdWRpdCgkZmlsdGVyKCdwb2ludHMnKVxuICAgICAgICAodG90YWxGZWUpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBhbGVydChcIuaBreWWnOS9oCzorr7nva7miJDlip8hISFcIik7XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiDojrflj5blv4PmhL/ljZXllYbmo4DmoIfor4bmmL7npLrml7bmlYjphY3nva5cbiAgICAgKi9cbiAgICAkc2NvcGUuZ2V0QWdpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNvbmZpZ3VyYXRpb25JbmZvcm1hdGlvblNlcnZpY2UuZ2V0V2lzaExpc3RDb25maWd1cmF0aW9uKCkudGhlbihcbiAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLnNob3dUaW1lID0gcmVzO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5nZXRBZ2luZygpO1xuXG4gICAgLyoqXG4gICAgICog5b+D5oS/5Y2V5LiK5p625qCH6K+G5pi+56S65pe25pWI6YWN572uXG4gICAgICovXG4gICAgJHNjb3BlLnNob3dUaW1lTGlzdCA9IHtcbiAgICAgIHNob3dUaW1lQXJyOiBbe1xuICAgICAgICBzaG93VGltZTogMCxcbiAgICAgICAgbmFtZTogJzEw5aSpJ1xuICAgICAgfSwge1xuICAgICAgICBzaG93VGltZTogMSxcbiAgICAgICAgbmFtZTogJzXliIbpkp8nXG4gICAgICB9LCB7XG4gICAgICAgIHNob3dUaW1lOiAyLFxuICAgICAgICBuYW1lOiAnMTXliIbpkp8nXG4gICAgICB9LCB7XG4gICAgICAgIHNob3dUaW1lOiAzLFxuICAgICAgICBuYW1lOiAnMeWkqSdcbiAgICAgIH0sIHtcbiAgICAgICAgc2hvd1RpbWU6IDQsXG4gICAgICAgIG5hbWU6ICcz5aSpJ1xuICAgICAgfSwge1xuICAgICAgICBzaG93VGltZTogNSxcbiAgICAgICAgbmFtZTogJzXlpKknXG4gICAgICB9XSxcbiAgICAgIGdldERlZmF1bHRJdGVtOiBmdW5jdGlvbihzaG93VGltZSkge1xuICAgICAgICB2YXIgcyA9IHBhcnNlSW50KHNob3dUaW1lKTtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLnNob3dUaW1lQXJyO1xuICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgIHNob3dUaW1lOiBzXG4gICAgICAgIH0pIHx8IG9wdGlvbnNbMF07XG4gICAgICB9LFxuICAgICAgd2lzaExpc3RMaW1pdGF0aW9uOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSBpdGVtLnNob3dUaW1lO1xuICAgICAgICBjb25maWd1cmF0aW9uSW5mb3JtYXRpb25TZXJ2aWNlLndpc2hMaXN0Q29uZmlndXJhdGlvbihwYXJhbXMpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKipcbiAgICAgKiDojrflj5bpu5jorqTnmoQo6aKE5a6a5pe26Ze044CB54Ot5Y2W5pe26Ze044CB57uT5p2f5pe26Ze0KVxuICAgICAqL1xuICAgICRzY29wZS5fZ2V0SG9saWRheURlZmF1bHRUaW1lID0gZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgIGhvbGlkYXlXZWxmYXJlU2VydmljZS5nZXRIb2xpZGF5RGVmYXVsdFRpbWUoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUud2VsZmFyZVRpbWUuc2NoZWR1bGVkVGltZURhdGUgPSByZXMucHJlU2FsZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS53ZWxmYXJlVGltZS5zY2hlZHVsZWRUaW1lID0gdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKFxuICAgICAgICAgIHJlcy5wcmVTYWxlKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS53ZWxmYXJlVGltZS5zZWxsaW5nVGltZURhdGUgPSByZXMuaG90U2FsZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS53ZWxmYXJlVGltZS5zZWxsaW5nVGltZSA9IHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhcbiAgICAgICAgICByZXMuaG90U2FsZSkpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUud2VsZmFyZVRpbWUub3ZlclRpbWVEYXRlID0gcmVzLmVuZFNhbGUpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUud2VsZmFyZVRpbWUub3ZlclRpbWUgPSB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoXG4gICAgICAgICAgcmVzLmVuZFNhbGUpKTtcbiAgICAgIH0pXG4gICAgfTtcbiAgICAkc2NvcGUuX2dldEhvbGlkYXlEZWZhdWx0VGltZSgkc2NvcGUpO1xuXG5cbiAgICAvKioqXG4gICAgICog6K6+572uICDmm7TmlrDoioLlgYfml6Xnpo/liKkg5rS75Yqo5pe26Ze0XG4gICAgICog5oiq5q2i5pe26Ze05Yiw5bCP5pe2XG4gICAgICovXG5cbiAgICAvL+aXtumXtOaIs+i9rOaNouaIkOWFq+S9jeaXpeacnyDkvovlpoI6MjAxNC01LTVcbiAgICBmdW5jdGlvbiBjb252ZXJ0RGF0ZShjRGF0YSkge1xuICAgICAgdmFyIG15RGF0ZSA9IG5ldyBEYXRlKGNEYXRhKTtcbiAgICAgIHZhciB5ZWFyID0gbXlEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICB2YXIgbW9udGggPSBteURhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgICB2YXIgZGF5ID0gbXlEYXRlLmdldERhdGUoKTtcbiAgICAgIHJldHVybiB5ZWFyICsgJy0nICsgbW9udGggKyAnLScgKyBkYXk7XG4gICAgfVxuXG4gICAgLy/ml7bpl7TmiLPovazmjaLmiJDlm5vkvY3ml7bpl7Qg5L6L5aaCOiAxMDoxMDowMFxuICAgIGZ1bmN0aW9uIGNvbnZlcnRUaW1lKGNUaW1lKSB7XG4gICAgICB2YXIgbXlEYXRlID0gbmV3IERhdGUoY1RpbWUpO1xuICAgICAgdmFyIGhvdXJzID0gbXlEYXRlLmdldEhvdXJzKCk7XG4gICAgICB2YXIgbWludXRlcyA9IG15RGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICB2YXIgc2Vjb25kID0gbXlEYXRlLmdldFNlY29uZHMoKTtcbiAgICAgIHJldHVybiBob3VycyArICc6JyArIG1pbnV0ZXMgKyAnOicgKyBzZWNvbmQ7XG4gICAgfVxuXG4gICAgJHNjb3BlLnNldFdlbGZhcmVUaW1lID0gZnVuY3Rpb24od2VsZmFyZVRpbWUpIHtcbiAgICAgIC8vIHZhciBzY2hlZHVsZWRDb252ZXJzaW9uID0gbmV3IERhdGUoKTtcbiAgICAgIHZhciBzY2hlZHVsZWRUaW1lRGF0ZSA9IGNvbnZlcnREYXRlKHdlbGZhcmVUaW1lLnNjaGVkdWxlZFRpbWVEYXRlKTtcbiAgICAgIHZhciBzZWxsaW5nVGltZURhdGUgPSBjb252ZXJ0RGF0ZSh3ZWxmYXJlVGltZS5zZWxsaW5nVGltZURhdGUpO1xuICAgICAgdmFyIG92ZXJUaW1lRGF0ZSA9IGNvbnZlcnREYXRlKHdlbGZhcmVUaW1lLm92ZXJUaW1lRGF0ZSk7XG4gICAgICB2YXIgc2NoZWR1bGVkVGltZSA9IGNvbnZlcnRUaW1lKERhdGUucGFyc2UoKHdlbGZhcmVUaW1lLnNjaGVkdWxlZFRpbWUpKSk7XG4gICAgICB2YXIgc2VsbGluZ1RpbWUgPSBjb252ZXJ0VGltZShEYXRlLnBhcnNlKCh3ZWxmYXJlVGltZS5zZWxsaW5nVGltZSkpKTtcbiAgICAgIHZhciBvdmVyVGltZSA9IGNvbnZlcnRUaW1lKERhdGUucGFyc2UoKHdlbGZhcmVUaW1lLm92ZXJUaW1lKSkpO1xuICAgICAgdmFyIHByZVNhbGUgPSBEYXRlLnBhcnNlKHNjaGVkdWxlZFRpbWVEYXRlICsgJyAnICsgc2NoZWR1bGVkVGltZSk7XG4gICAgICB2YXIgaG90U2FsZSA9IERhdGUucGFyc2Uoc2VsbGluZ1RpbWVEYXRlICsgJyAnICsgc2VsbGluZ1RpbWUpO1xuICAgICAgdmFyIGVuZFNhbGUgPSBEYXRlLnBhcnNlKG92ZXJUaW1lRGF0ZSArICcgJyArIG92ZXJUaW1lKTtcbiAgICAgIGNvbnNvbGUubG9nKHByZVNhbGUpO1xuICAgICAgaWYgKHdlbGZhcmVUaW1lLnNjaGVkdWxlZFRpbWUgPT0gXCJcIiB8fCB3ZWxmYXJlVGltZS5zZWxsaW5nVGltZSA9PVxuICAgICAgICBcIlwiIHx8IHdlbGZhcmVUaW1lLm92ZXJUaW1lID09IFwiXCIpIHtcbiAgICAgICAgYWxlcnQoXCLml7bpl7TmoLzlvI/mnInor68s6K+36K6+572u5YeG56Gu5pe26Ze0ISEhXCIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcGFyYW1zID0geyBwcmVTYWxlOiBwcmVTYWxlLCBob3RTYWxlOiBob3RTYWxlLCBlbmRTYWxlOiBlbmRTYWxlIH07XG4gICAgICAgIGhvbGlkYXlXZWxmYXJlU2VydmljZS51cGRhdGVIb2xpZGF5VGltZShwYXJhbXMpLnRoZW4oZnVuY3Rpb24oXG4gICAgICAgICAgcmVzKSB7XG4gICAgICAgICAgYWxlcnQoXCLorr7nva7miJDlip/jgIJcIik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKuiQpemUgOWVhuWTgS/nu4TlkIjlrprph5Hpop3luqZcbiAgICAgKi9cbiAgICAvL+iOt+WPlum7mOiupOeahOiQpemUgOWVhuWTgS/nu4TlkIjlrprph5Hpop3luqZcbiAgICAkc2NvcGUuX2dldE1hcmtldGluZ0FjdGl2aXRpZXNEZXBvc2l0SW5mbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gZGVidWdnZXJcbiAgICAgIGNvbmZpZ3VyYXRpb25JbmZvcm1hdGlvblNlcnZpY2UuZ2V0TWFya2V0aW5nQWN0aXZpdGllc0RlcG9zaXRJbmZvKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLmRlcG9zaXRBbW91bnQgPSAkZmlsdGVyKCdybWInKShyZXMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5fZ2V0TWFya2V0aW5nQWN0aXZpdGllc0RlcG9zaXRJbmZvKCk7XG5cbiAgICAkc2NvcGUubWFya2V0aW5nQWN0aXZpdGllc0RlcG9zaXQgPSBmdW5jdGlvbihkZXBvc2l0QW1vdW50KSB7XG4gICAgICAvLyBkZWJ1Z2dlclxuICAgICAgY29uZmlndXJhdGlvbkluZm9ybWF0aW9uU2VydmljZS5tYXJrZXRpbmdBY3Rpdml0aWVzRGVwb3NpdEluZm8oXG4gICAgICAgICRmaWx0ZXIoJ3BvaW50cycpKGRlcG9zaXRBbW91bnQpKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBhbGVydCgn6K6+572u5oiQ5Yqf77yB77yB77yBJyk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOiOt+WPlumAiei0reWNlemAiei0reS4iumZkOmFjee9ruiuvue9rlxuICAgICAqL1xuICAgIHZhciBsaW1pdE51bUNvbnN0YW50ID0ge1xuICAgICAgb25lU2hlbGY6ICcxJyxcbiAgICAgIHR3b1NoZWxmOiAnMicsXG4gICAgICB0aHJlZVNoZWxmOiAnMycsXG4gICAgICBmb3VyU2hlbGY6ICc0JyxcbiAgICAgIGFsbFNoZWxmOiAnNSdcbiAgICB9O1xuICAgICRzY29wZS5fZ2V0Q2hvb3NlT3JkZXJJbmZvQ2VpbGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgY29uZmlndXJhdGlvbkluZm9ybWF0aW9uU2VydmljZS5nZXRDaG9vc2VPcmRlckluZm9DZWlsaW5nKCkudGhlbihcbiAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLmxpbWl0TnVtQ29uZmlnID0ge307XG4gICAgICAgICAgdmFyIGxpbWl0TnVtQ29uc3RhdEludmVydCA9IF8uaW52ZXJ0KGxpbWl0TnVtQ29uc3RhbnQpO1xuICAgICAgICAgIF8uZWFjaChyZXMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciB0ZW1wID0ge1xuICAgICAgICAgICAgICBpZDogaXRlbS5pZCxcbiAgICAgICAgICAgICAgbGltaXROdW06IGl0ZW0ubGltaXROdW1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkc2NvcGUubGltaXROdW1Db25maWdbbGltaXROdW1Db25zdGF0SW52ZXJ0W2l0ZW0uc2hlbGZOdW1UeXBlXV0gPVxuICAgICAgICAgICAgICB0ZW1wO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pXG4gICAgfTtcbiAgICAkc2NvcGUuX2dldENob29zZU9yZGVySW5mb0NlaWxpbmcoKTtcbiAgICAvKipcbiAgICAgKiDpgInotK3ljZXpgInotK3kuIrpmZDphY3nva7orr7nva5cbiAgICAgKi9cbiAgICAkc2NvcGUuY2hvb3NlT3JkZXJJbmZvID0gZnVuY3Rpb24obGltaXROdW1Db25maWcpIHtcbiAgICAgIHZhciBwYXJhbXMgPSBfLm1hcChfLnBhaXJzKGxpbWl0TnVtQ29uZmlnKSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBpdGVtWzFdLmlkIHx8IG51bGwsXG4gICAgICAgICAgc2hlbGZOdW1UeXBlOiBsaW1pdE51bUNvbnN0YW50W2l0ZW1bMF1dLFxuICAgICAgICAgIGxpbWl0TnVtOiBpdGVtWzFdLmxpbWl0TnVtXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25maWd1cmF0aW9uSW5mb3JtYXRpb25TZXJ2aWNlLmNyZWF0ZUNob29zZU9yZGVySW5mbyhwYXJhbXMpLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0U3VjY2Vzcygn6YWN572u5oiQ5YqfIScpO1xuICAgICAgICB9KVxuICAgIH1cbiAgfSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdkZWFkU3RvY2snLCBmdW5jdGlvbigkc2NvcGUsICRtZFBhbmVsLCBwcm9kdWN0U2VydmljZSxcbiAgICB1dGlsU2VydmljZSwgTmdUYWJsZVBhcmFtcywgbW9kYWxTZXJ2aWNlLCBDT05TVEFOVFMsIHBvc2l0aW9uU2VydmljZSxcbiAgICBkZWFkU3RvY2tTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLkNPTlNUQU5UUyA9IENPTlNUQU5UUztcbiAgICB2YXIgQ0FURUdPUllfTEVWRUwgPSBDT05TVEFOVFMuQ0FURUdPUllfTEVWRUw7XG4gICAgdmFyIFBST0RVQ1RfRElDX1RZUEUgPSBDT05TVEFOVFMuUFJPRFVDVF9ESUNfVFlQRTtcbiAgICAvL+ihqOagvOiuvue9rlxuICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHtcbiAgICAgIHByb2R1Y3ROYW1lOiAnJ1xuICAgIH07XG4gICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgJHNjb3BlLmRlYWRTdG9ja1Byb2R1Y3RMaXN0ID0gW107XG4gICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgY291bnQ6ICRzY29wZS5saW1pdFxuICAgIH0sIHtcbiAgICAgIGNvdW50czogW11cbiAgICB9KTtcbiAgICAkc2NvcGUuZ2V0RGVhZFN0b2NrUHJvZHVjdExpc3QgPSBmdW5jdGlvbihzb3J0VHlwZSkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgcHJvZHVjdE5hbWU6ICRzY29wZS5xdWVyeVBhcmFtcy5wcm9kdWN0TmFtZVxuICAgICAgfTtcbiAgICAgIGlmIChzb3J0VHlwZSkge1xuICAgICAgICBwYXJhbXMuc29ydFR5cGUgPSBzb3J0VHlwZTtcbiAgICAgIH1cbiAgICAgIGRlYWRTdG9ja1NlcnZpY2UuZ2V0RGVhZFN0b2NrUHJvZHVjdExpc3QocGFyYW1zKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuZGVhZFN0b2NrUHJvZHVjdExpc3QgPSByZXMubGlzdDtcbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKCkuZGF0YXNldCA9ICRzY29wZS5kZWFkU3RvY2tQcm9kdWN0TGlzdDtcbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuZGVsRGVhZFN0b2NrUHJvZHVjdCA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgIGRlYWRTdG9ja1NlcnZpY2UucmVtb3ZlRGVhZFN0b2NrUHJvZHVjdCh7XG4gICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdC5pZFxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmdldERlYWRTdG9ja1Byb2R1Y3RMaXN0KCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5zb3J0ID0gZnVuY3Rpb24oc29ydE9iaiwgc29ydFR5cGUpIHtcbiAgICAgIHZhciBzb3J0Q29kZSA9IHNvcnRPYmouc29ydENvZGU7XG4gICAgICB2YXIgcjtcbiAgICAgIHN3aXRjaCAoc29ydFR5cGUpIHtcbiAgICAgICAgY2FzZSAncHJpY2UnOlxuICAgICAgICAgIHIgPSBzb3J0Q29kZSAqIDE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ292ZXJTdG9ja1JhdGUnOlxuICAgICAgICAgIHIgPSBzb3J0Q29kZSAqIDU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2Rpc3RyaWJTaGVsZkNvdW50JzpcbiAgICAgICAgICByID0gc29ydENvZGUgKiA2O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZUJ1eVJhdGVEZXZpYXRlJzpcbiAgICAgICAgICByID0gc29ydENvZGUgKiA4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzaGlwbWVudFJhdGVEZXZpYXRlJzpcbiAgICAgICAgICByID0gc29ydENvZGUgKiAxMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2FsZXNDb3VudEF2Zyc6XG4gICAgICAgICAgciA9IHNvcnRDb2RlICogMTE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3NhbGVzRmVlQXZnJzpcbiAgICAgICAgICByID0gc29ydENvZGUgKiAxMjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc3RvY2snOlxuICAgICAgICAgIHIgPSBzb3J0Q29kZSAqIDEzO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgJHNjb3BlLmdldERlYWRTdG9ja1Byb2R1Y3RMaXN0KHIpO1xuICAgIH07XG4gICAgJHNjb3BlLmdldERlYWRTdG9ja1Byb2R1Y3RMaXN0KCk7XG4gIH0pO1xufTtcbiIsIi8q5ouj6LSn5Y2V57yW6L6RKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdkZWxpdmVyeUVkaXRDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkY29tcGlsZSxcbiAgICAkdGVtcGxhdGVDYWNoZSwgJHJvdXRlUGFyYW1zLCBzaGVsZlNlcnZpY2UsIGNvbXBhbnlTZXJ2aWNlLFxuICAgIHByb2R1Y3RTZXJ2aWNlLCBvcmRlclNlcnZpY2UsIGdvb2RzQ2hvb3NlU2VydmljZSwgc3VpdGVTZXJ2aWNlLFxuICAgIG1vZGFsU2VydmljZSwgTmdUYWJsZVBhcmFtcywgQ09OU1RBTlRTLCB1dGlsU2VydmljZSkge1xuICAgICRzY29wZS5DT05TVEFOVFMgPSBDT05TVEFOVFM7XG4gICAgJHNjb3BlLlBJQ0tfUFJPRFVDVF9SRUFTT04gPSBDT05TVEFOVFMuUElDS19QUk9EVUNUX1JFQVNPTjtcbiAgICB2YXIgQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAkc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAkc2NvcGUucGljVXJsID0gd2luZG93LmNmZy5waWNVcmw7XG4gICAgJHNjb3BlLnBpY2tPcmRlciA9IHt9O1xuICAgICRzY29wZS5vcmRlcklkID0gJHJvdXRlUGFyYW1zLm9yZGVySWQ7XG4gICAgJHNjb3BlLmdvb2RzQ2hvb3NlT3JkZXJJZCA9ICRyb3V0ZVBhcmFtcy5nb29kc0Nob29zZU9yZGVySWQgfHwgMDtcbiAgICAkc2NvcGUuY29tcGFueSA9IHt9O1xuICAgICRzY29wZS5jYXRlb3R5TGlzdCA9IFtdO1xuICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcgPSB7fTtcbiAgICAkc2NvcGUuc2hlbGZQcm9kdWN0TGlzdCA9IFtdO1xuICAgIHZhciB0bXBOZXdQcm9kdWN0TGlzdCA9IFtdO1xuICAgIHZhciBtYXhQcm9kdWN0c0NvdW50ID0gNTA7IC8v5ZGY5bel6Ieq6LS55LyB5LiaLOWVhuWTgeaVsOmHj+aegemZkOWAvFxuICAgIHZhciBnb29kc0Nob29zZVByb2R1Y3RMaXN0ID0gW107XG4gICAgdmFyIGJsYWNrTGlzdCA9IFtdO1xuICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IHRydWU7XG4gICAgJHNjb3BlLnBpY2tSZWZlckJ0bkRpc2FibGUgPSB0cnVlO1xuICAgIC8v5Y+C6ICD6aG15omT5byA5pa55byPXG4gICAgJHNjb3BlLlJFRkVSX09QRU5fTU9ERSA9IHtcbiAgICAgIGF1dG86IDEsIC8v6Ieq5YqoXG4gICAgICBtYW51YWw6IDIgLy/miYvliqhcbiAgICB9O1xuICAgICRzY29wZS5sb2NhbExhbmcgPSB7XG4gICAgICBzZWxlY3RBbGw6IFwi5YWo6YCJXCIsXG4gICAgICBzZWxlY3ROb25lOiBcIuWFqOS4jemAiVwiLFxuICAgICAgcmVzZXQ6IFwi6YeN572uXCIsXG4gICAgICBzZWFyY2g6IFwi6L6T5YWl5YWz6ZSu5a2X5pCc57SiXCIsXG4gICAgICBub3RoaW5nU2VsZWN0ZWQ6IFwi6K+36YCJ5oup6ZyA5YWz6IGU55qE5pys5pyf5aWX6aSQXCJcbiAgICB9O1xuICAgIHZhciBQUk9EVUNUX0ZST01fVFlQRSA9IENPTlNUQU5UUy5QSUNLX1BST0RVQ1RfRlJPTV9UWVBFO1xuICAgICRzY29wZS5QUk9EVUNUX0ZST01fVFlQRSA9IFBST0RVQ1RfRlJPTV9UWVBFO1xuICAgIHZhciBpbml0VmlldyA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCRzY29wZS5vcmRlcklkID4gMCkgeyAvL+S/ruaUueaooeW8j1xuICAgICAgICBpbml0RWRpdFZpZXcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5vcGVuUGlja1JlZmVyKCRzY29wZS5SRUZFUl9PUEVOX01PREUuYXV0byk7XG4gICAgICAgIGlmICgkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkID4gMCkgeyAvL+mAiei0reWNlei9rOWMlui/h+adpVxuICAgICAgICAgIGluaXRHb29kc0Nob29zZVZpZXcoKTtcbiAgICAgICAgfSBlbHNlIHsgLy/mlrDlop7mqKHlvI9cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGluaXRFZGl0VmlldyA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy/kuIvpnaLku6PnoIHkuLrlr7zlh7pFeGNlbOWBmuWHhuWkh1xuICAgICAgdmFyIGV4Y2VsVGVtcGxhdGUgPSAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQoXG4gICAgICAgICdwaWNrT3JkZXIvcGlja09yZGVyVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgICAnZXhwb3J0RGVsaXZlcnlFeGNlbFdyYXAnKSkuYXBwZW5kKGV4Y2VsVGVtcGxhdGUpO1xuICAgICAgdmFyIHF1ZXJ5UGFyYW1zID0geyBvcmRlcklkOiAkc2NvcGUub3JkZXJJZCB9O1xuICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5RGVsaXZlcnlEZXRhaWwocXVlcnlQYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5waWNrT3JkZXIgPSBhbmd1bGFyLmNvcHkocmVzKTtcbiAgICAgICAgJHNjb3BlLm9yZGVyID0gYW5ndWxhci5jb3B5KHJlcyk7IC8vZXhjZWzkuK3nmoRvcmRlcijnlLHkuo7kuI7pgIHotKfljZXlhbHnlKjlkIzkuIDkuKpleGNlbClcbiAgICAgICAgXy5lYWNoKHJlcy5pdGVtcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgIGl0ZW0uaXRlbU51bSA9IHBhcnNlSW50KGl0ZW0uaXRlbU51bSk7XG4gICAgICAgICAgaWYgKGl0ZW0uc3VpdGVJZCAmJiBpdGVtLnN1aXRlSWQgIT0gMCkge1xuICAgICAgICAgICAgaXRlbS5pc3N1ZUlkID0gcmVzLmlzc3VlSWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW0uZnJvbSA9IFtQUk9EVUNUX0ZST01fVFlQRS5GUk9NX0VESVRdO1xuICAgICAgICAgIGlmIChpdGVtLml0ZW1UeXBlID09IDEpIHtcbiAgICAgICAgICAgIGl0ZW0uZnJvbSA9IF8udW5pb24oaXRlbS5mcm9tLCBbUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9ORVddKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaXRlbVR5cGUgPT0gMikge1xuICAgICAgICAgICAgaXRlbS5mcm9tID0gXy51bmlvbihpdGVtLmZyb20sIFtQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1NIRUxGXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpdGVtLml0ZW1UeXBlICE9IDMpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucHVzaEl0ZW0oaXRlbSxcbiAgICAgICAgICAgICAgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9FRElUKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBsb2FkU2hlbGZQcm9kdWN0cyhyZXMuc2hlbGZJZCk7XG4gICAgICAgIGxvYWRDb21wYW55RGV0YWlsKHJlcy5jb21wYW55SWQpO1xuICAgICAgICBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRJZExpc3QoKSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5Yqg6L296LSn5p625ZWG5ZOBXG4gICAgdmFyIGxvYWRTaGVsZlByb2R1Y3RzID0gZnVuY3Rpb24oc2hlbGZJZCkge1xuICAgICAgdmFyIHF1ZXJ5UGFyYW1zID0geyBzaGVsZklkOiBzaGVsZklkIH07XG4gICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZlByb2R1Y3N0c0J5U2hlbGZJZChxdWVyeVBhcmFtcykudGhlbihcbiAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLnNoZWxmUHJvZHVjdExpc3QgPSBzaGVsZlNlcnZpY2UuX3BhcnNlU2hlbGZQcm9kdWN0c0luRGVsaXZlcnlFZGl0KFxuICAgICAgICAgICAgcmVzKTtcbiAgICAgICAgICBsb2FkU2hlbGZBdmdTYWxlKHNoZWxmSWQpO1xuICAgICAgICAgIGxvYWREZWxpdmVyeVJlY29tbSgkc2NvcGUuY29tcGFueS5jb21wYW55SWQsIHNoZWxmSWQpO1xuICAgICAgICAgIGxvYWRPbmxpbmVTdWl0ZXMoKTtcbiAgICAgICAgICBpZiAoJHNjb3BlLmdvb2RzQ2hvb3NlT3JkZXJJZCkgeyAvL+iLpeaYr+mAiei0reWNlei9rOaNoui/h+adpVxuICAgICAgICAgICAganVkZ2VHb29kc0Nob29zZUxpc3RGcm9tKCk7XG4gICAgICAgICAgICBqdWRnZVNlbGVjdE9uT3BlblJlZmVyKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8v6K+75Y+W5pel5Z2H6ZSA6YeP5pWw5o2uXG4gICAgdmFyIGxvYWRTaGVsZkF2Z1NhbGUgPSBmdW5jdGlvbihzaGVsZklkKSB7XG4gICAgICB2YXIgcXVlcnlQYXJhbXMgPSB7IHNoZWxmSWQ6IHNoZWxmSWQgfTtcbiAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmQXZnU2FsZShxdWVyeVBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgXy5lYWNoKHJlcy5jb250ZW50LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgXy5lYWNoKCRzY29wZS5zaGVsZlByb2R1Y3RMaXN0LCBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICAgICAgICBpZiAocHJvZHVjdC5zaGVsZlByb2R1Y3RJZCA9PSBpdGVtLnNoZWxmX3Byb2R1Y3RfaWQpIHtcbiAgICAgICAgICAgICAgcHJvZHVjdC5zaGVsZkF2Z1NhbGUgPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liqDovb3mnKzmnJ/lpZfppJBcbiAgICB2YXIgbG9hZE9ubGluZVN1aXRlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgc3VpdGVTZXJ2aWNlLnF1ZXJ5T25saW5lU3VpdGVzKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgdmFyIHByb2R1Y3RJZHNJblNoZWxmID0gXy5wbHVjaygkc2NvcGUuc2hlbGZQcm9kdWN0TGlzdCxcbiAgICAgICAgICAncHJvZHVjdElkJyk7XG4gICAgICAgIG9ubGluZUlzc3VlID0gc3VpdGVTZXJ2aWNlLl9wYXJzZU9ubGluZVN1aXRlc0luRGVsaXZlcnlFZGl0KFxuICAgICAgICAgIHJlcywgcHJvZHVjdElkc0luU2hlbGYpO1xuICAgICAgICAkc2NvcGUuc3VpdGVMaXN0ID0gb25saW5lSXNzdWUuc3VpdGVzO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WKoOi9veaLo+i0p+WPguiAg1xuICAgIHZhciBsb2FkRGVsaXZlcnlSZWNvbW0gPSBmdW5jdGlvbihjb21wYW55SWQsIHNoZWxmSWQpIHtcbiAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5UmVjb21tKHtcbiAgICAgICAgY29tcGFueUlkOiBjb21wYW55SWQsXG4gICAgICAgIHNoZWxmSWQ6IHNoZWxmSWRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIHZhciBwcm9kdWN0SWRzSW5TaGVsZiA9IF8ucGx1Y2soJHNjb3BlLnNoZWxmUHJvZHVjdExpc3QsXG4gICAgICAgICAgJ3Byb2R1Y3RJZCcpO1xuICAgICAgICAkc2NvcGUucmVmZXJEYXRhID0gb3JkZXJTZXJ2aWNlLl9wYXJzZURlbGl2ZXJ5UmVjb21tKHJlcyxcbiAgICAgICAgICBwcm9kdWN0SWRzSW5TaGVsZik7XG4gICAgICAgICRzY29wZS5waWNrUmVmZXJCdG5EaXNhYmxlID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IGZhbHNlO1xuICAgICAgICBpbmNyUHJvZHVjdFJlY29tbWVuZCgpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WinuWKoOWNleWTgeaOqOiNkOacn+mXtOWxleekuuasoeaVsFxuICAgIHZhciBpbmNyUHJvZHVjdFJlY29tbWVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHByb2R1Y3RJZHMgPSBfLnBsdWNrKCRzY29wZS5yZWZlckRhdGEucmVjb21tZW5kZWQsXG4gICAgICAgICdwcm9kdWN0SWQnKTtcbiAgICAgIGlmIChwcm9kdWN0SWRzLmxlbmd0aCkge1xuICAgICAgICBwcm9kdWN0U2VydmljZS5pbmNyUHJvZHVjdFJlY29tbWVuZCh7XG4gICAgICAgICAgcHJvZHVjdElkczogcHJvZHVjdElkc1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge30pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/moLnmja7llYblk4FpZHPojrflj5bllYblk4HmnIDov5ExMOasoeaLo+i0p+Wdh+WAvFxuICAgIHZhciBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MgPSBmdW5jdGlvbihwcm9kdWN0SWRzKSB7XG4gICAgICBvcmRlclNlcnZpY2UucXVlcnlMYXRlc3REZWxpdmVyeUNvdW50QXZncyh7XG4gICAgICAgIHByb2R1Y3RJZHM6IHByb2R1Y3RJZHNcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcuc2V0TGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MocmVzKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liqDovb3pu5HlkI3ljZXllYblk4FcbiAgICB2YXIgbG9hZEJsYWNrbGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgY29tcGFueVNlcnZpY2UuZ2V0QmxvY2tDb21wYW55KHtcbiAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY29tcGFueS5jb21wYW55SWRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIGJsYWNrTGlzdCA9IHJlcztcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liqDovb3kvIHkuJror6bmg4VcbiAgICB2YXIgbG9hZENvbXBhbnlEZXRhaWwgPSBmdW5jdGlvbihjb21wYW55SWQpIHtcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueSh7XG4gICAgICAgIGNvbXBhbnlJZDogY29tcGFueUlkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuc2VsZWN0Q29tcGFueUNhbGxiYWNrKHJlcyk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5Yid5aeL5YyWIOmAiei0reWNlei9rOaNoui/h+adpeeahOeVjOmdolxuICAgIHZhciBpbml0R29vZHNDaG9vc2VWaWV3ID0gZnVuY3Rpb24oKSB7XG4gICAgICBnb29kc0Nob29zZVNlcnZpY2UucXVlcnlNYW5hZ2VyT3JkZXJEZXRhaWwoe1xuICAgICAgICBvcmRlcklkOiAkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICByZXMubWFuYWdlck9yZGVySWQgPSByZXMub3JkZXJJZDtcbiAgICAgICAgZGVsZXRlIHJlcy5vcmRlcklkO1xuICAgICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnlJZCh7XG4gICAgICAgICAgY29tcGFueUlkOiByZXMuY29tcGFueUlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oc2hlbGZSZXMpIHtcbiAgICAgICAgICBpZiAoIXNoZWxmUmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygtMSk7XG4gICAgICAgICAgICB1dGlsU2VydmljZS5hbGVydEVycm9yKCfor6XkvIHkuJrmmoLml6DotKfmnrbvvIzml6Dms5XliJvlu7rmi6PotKfljZUhJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF8uZWFjaChyZXMuaXRlbXMsIGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgICAgICAgIHByb2R1Y3QucmVhc29ucyA9IFtDT05TVEFOVFMuUElDS19QUk9EVUNUX1JFQVNPTlxuICAgICAgICAgICAgICAuQ0hPU0VOXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgcHJvZHVjdC5mcm9tID0gW0NPTlNUQU5UUy5QSUNLX1BST0RVQ1RfRlJPTV9UWVBFXG4gICAgICAgICAgICAgIC5GUk9NX0NIT09TRVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHByb2R1Y3QuaXRlbU51bSA9IHByb2R1Y3QuaXRlbU51bSA+IDAgPyBwcm9kdWN0XG4gICAgICAgICAgICAgIC5pdGVtTnVtIDogJyc7XG4gICAgICAgICAgICBnb29kc0Nob29zZVByb2R1Y3RMaXN0LnB1c2gocHJvZHVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJHNjb3BlLnBpY2tPcmRlciA9IGFuZ3VsYXIuY29weShyZXMpO1xuICAgICAgICAgIGxvYWRDb21wYW55RGV0YWlsKHJlcy5jb21wYW55SWQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liKTmlq3pgInotK3ljZXllYblk4HmmK/mlrDlk4HkuIrmnrbov5jmmK/ooaXotKdcbiAgICB2YXIganVkZ2VHb29kc0Nob29zZUxpc3RGcm9tID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2hlbGZQcm9kdWN0SWRzID0gXy5wbHVjaygkc2NvcGUuc2hlbGZQcm9kdWN0TGlzdCxcbiAgICAgICAgJ3Byb2R1Y3RJZCcpO1xuICAgICAgXy5lYWNoKGdvb2RzQ2hvb3NlUHJvZHVjdExpc3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKF8uY29udGFpbnMoc2hlbGZQcm9kdWN0SWRzLCBpdGVtLnByb2R1Y3RJZCkpIHtcbiAgICAgICAgICBpdGVtLmZyb20gPSBfLnVuaW9uKGl0ZW0uZnJvbSwgW0NPTlNUQU5UUy5QSUNLX1BST0RVQ1RfRlJPTV9UWVBFXG4gICAgICAgICAgICAuRlJPTV9TSEVMRlxuICAgICAgICAgIF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGl0ZW0uZnJvbSA9IF8udW5pb24oaXRlbS5mcm9tLCBbQ09OU1RBTlRTLlBJQ0tfUFJPRFVDVF9GUk9NX1RZUEVcbiAgICAgICAgICAgIC5GUk9NX05FV1xuICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucHVzaEl0ZW0oaXRlbSwgQ09OU1RBTlRTLlBJQ0tfUFJPRFVDVF9GUk9NX1RZUEVcbiAgICAgICAgICAuRlJPTV9DSE9PU0UpO1xuICAgICAgfSk7XG4gICAgICBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRJZExpc3QoKSk7XG4gICAgfTtcbiAgICAvKuS4u+mdouadvyovXG4gICAgLy/pgInmi6nlhazlj7hcbiAgICAkc2NvcGUuc2VsZWN0Q29tcGFueUNhbGxiYWNrID0gZnVuY3Rpb24oY29tcGFueSkge1xuICAgICAgdmFyIEdPT0RTQ0hPT1NFX09SREVSX1NUQVRFID0gQ09OU1RBTlRTLkdPT0RTQ0hPT1NFX09SREVSX1NUQVRFO1xuICAgICAgJHNjb3BlLmNvbXBhbnkgPSBjb21wYW55O1xuICAgICAgbG9hZEJsYWNrbGlzdCgpO1xuICAgICAgaWYgKCRzY29wZS5vcmRlcklkID4gMCB8fCAkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkID4gMCkge1xuICAgICAgICAkc2NvcGUuc2hlbGZTZWxlY3REaXNhYmxlID0gJHNjb3BlLm9yZGVySWQgPiAwO1xuICAgICAgICBsb2FkU2hlbGZMaXN0KGNvbXBhbnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ29vZHNDaG9vc2VTZXJ2aWNlLnF1ZXJ5TWFuYWdlck9yZGVyTGlzdCh7XG4gICAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICAgIGxpbWl0OiAxLFxuICAgICAgICAgIGNvbXBhbnlJZDogY29tcGFueS5jb21wYW55SWQsXG4gICAgICAgICAgb3JkZXJTdGF0ZXM6IFtHT09EU0NIT09TRV9PUkRFUl9TVEFURS5XQUlUX1ZFUklGWSxcbiAgICAgICAgICAgIEdPT0RTQ0hPT1NFX09SREVSX1NUQVRFLlZFUklGSUVEXG4gICAgICAgICAgXVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGlmIChyZXMuY29udGVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+ivpeS8geS4muWtmOWcqOacquWujOaIkOmAiei0reWNle+8jOivt+S7jumAiei0reWNleaooeWdl+i/m+ihjOWIm+W7uuaLo+i0p+WNlSEnKTtcbiAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuc2hlbGZTZWxlY3REaXNhYmxlID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLnNoZWxmU2VsZWN0RGlzYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgbG9hZFNoZWxmTGlzdChjb21wYW55KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/lhbPogZTlpZfppJBcbiAgICAkc2NvcGUucmVsYXRlU3VpdGVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUuc2VsZWN0ZWRMaXN0Q29uZmlnLnJlbW92ZVN1aXRlSXRlbXMoKTtcbiAgICAgIF8uZWFjaCgkc2NvcGUuc2VsZWN0ZWRTdWl0ZUxpc3QsIGZ1bmN0aW9uKHN1aXRlKSB7XG4gICAgICAgIF8uZWFjaChzdWl0ZS5wcm9kdWN0cywgZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucHVzaEl0ZW0ocHJvZHVjdCxcbiAgICAgICAgICAgIFBST0RVQ1RfRlJPTV9UWVBFLkZST01fU1VJVEUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgbG9hZExhdGVzdERlbGl2ZXJ5Q291bnRBdmdzKCRzY29wZS5zZWxlY3RlZExpc3RDb25maWcuZ2V0SWRMaXN0KCkpO1xuICAgIH07XG4gICAgLy/liKTmlq3mmK/lkKbmmL7npLog5paw5ZOB5LiK5p62L+ihpei0py/kuIvmnrZcbiAgICAkc2NvcGUuaXNTaG93V3JhcCA9IGZ1bmN0aW9uKGZyb21UeXBlKSB7XG4gICAgICByZXR1cm4gJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRMaXN0KGZyb21UeXBlKS5sZW5ndGg7XG4gICAgfTtcbiAgICAvLyDmuIXnqbrmlbDmja5cbiAgICAkc2NvcGUuY2xlYXJkYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUuY2F0ZW90eUxpc3QgPSBbXTtcbiAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcuY2xlYXJMaXN0KCk7XG4gICAgfTtcbiAgICAvL+WvvOWHukV4Y2VsXG4gICAgJHNjb3BlLmV4cG9ydEV4Y2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICBkb21bMF0uaHJlZiA9ICQoJyNwaWNrLW9yZGVyLXRhYmxlJykuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgIGNvbnRhaW5lcmlkOiAncGljay1vcmRlci10YWJsZScsXG4gICAgICAgIGRhdGF0eXBlOiAndGFibGUnLFxuICAgICAgICByZXR1cm5Vcmk6ICd0cnVlJ1xuICAgICAgfSk7XG4gICAgICBkb21bMF0uZG93bmxvYWQgPSAn5ouj6LSn5Y2VJyArICctJyArICRzY29wZS5vcmRlci5jb21wYW55TmFtZSArICctJyArXG4gICAgICAgICRzY29wZS5vcmRlci5zaGVsZk5hbWUgKyAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoXG4gICAgICAgICAgJHNjb3BlLm9yZGVyLnVwZGF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJykueGxzJztcbiAgICAgIGRvbVswXS5jbGljaygpO1xuICAgIH07XG4gICAgJHNjb3BlLmZpbHRlckl0ZW1zID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uaXRlbVR5cGUgIT0gMztcbiAgICB9O1xuICAgIC8v5L+d5a2Y6YCB6LSn5Y2VXG4gICAgJHNjb3BlLnNhdmVEZWxpdmVyeSA9IGZ1bmN0aW9uKHNlbmRXYXJlaG91c2UpIHtcbiAgICAgIHZhciBzZWxlY3RlZE5ld1Byb2R1Y3RzID0gJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRMaXN0KFxuICAgICAgICBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX05FVyk7XG4gICAgICB2YXIgc2VsZWN0ZWRTdXBwbGVtZW50UHJvZHVjdHMgPSAkc2NvcGUuc2VsZWN0ZWRMaXN0Q29uZmlnLmdldExpc3QoXG4gICAgICAgIFBST0RVQ1RfRlJPTV9UWVBFLkZST01fU0hFTEYpO1xuICAgICAgdmFyIHNlbGVjdGVkUHJvZHVjdHMgPSBfLnVuaW9uKHNlbGVjdGVkTmV3UHJvZHVjdHMsXG4gICAgICAgIHNlbGVjdGVkU3VwcGxlbWVudFByb2R1Y3RzKTtcbiAgICAgIGlmICghc2VsZWN0ZWRQcm9kdWN0cy5sZW5ndGgpIHtcbiAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcign6K+36YCJ5oup5LiK5p625oiW6KGl6LSn5ZWG5ZOBIScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgaXRlbU51bUZsYWcgPSB0cnVlOyAvL2l0ZW1OdW3mnKrloavlhpnmoIfor4ZcbiAgICAgIHZhciBibGFja0ZsYWcgPSBmYWxzZTsgLy/pu5HlkI3ljZXmoIfor4ZcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuICAgICAgdmFyIGJsYWNrSWRzID0gXy5wbHVjayhibGFja0xpc3QsICdwcm9kdWN0SWQnKTtcbiAgICAgIF8uZWFjaChzZWxlY3RlZFByb2R1Y3RzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmICghaXRlbS5pdGVtTnVtKSB7XG4gICAgICAgICAgaXRlbU51bUZsYWcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtLmJsYWNrID0gXy5jb250YWlucyhibGFja0lkcywgaXRlbS5wcm9kdWN0SWQpO1xuICAgICAgICBibGFja0ZsYWcgPSBpdGVtLmJsYWNrO1xuICAgICAgICB2YXIgaXRlbVR5cGU7XG4gICAgICAgIGlmIChfLmNvbnRhaW5zKGl0ZW0uZnJvbSwgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9ORVcpKSB7XG4gICAgICAgICAgaXRlbVR5cGUgPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKF8uY29udGFpbnMoaXRlbS5mcm9tLCBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1NIRUxGKSkge1xuICAgICAgICAgIGl0ZW1UeXBlID0gMjtcbiAgICAgICAgfVxuICAgICAgICBpdGVtcy5wdXNoKHtcbiAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLFxuICAgICAgICAgIGl0ZW1OdW06IGl0ZW0uaXRlbU51bSxcbiAgICAgICAgICBpdGVtVHlwZTogaXRlbVR5cGUsXG4gICAgICAgICAgc2hlbGZQcm9kdWN0SWQ6IGl0ZW0uc2hlbGZQcm9kdWN0SWQgfHwgMCxcbiAgICAgICAgICBzdWl0ZUlkOiBpdGVtLnN1aXRlSWQsXG4gICAgICAgICAgaXNzdWVJZDogaXRlbS5pc3N1ZUlkLFxuICAgICAgICAgIHJlYXNvbnM6IGl0ZW0ucmVhc29uc1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFkdmljZU91dExpc3QgPSAkc2NvcGUuc2VsZWN0ZWRMaXN0Q29uZmlnLmdldEFkdmljZU91dExpc3QoKTtcbiAgICAgIF8uZWFjaChhZHZpY2VPdXRMaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGl0ZW1zLnB1c2goe1xuICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsXG4gICAgICAgICAgaXRlbVR5cGU6IDMsXG4gICAgICAgICAgc2hlbGZQcm9kdWN0SWQ6IGl0ZW0uc2hlbGZQcm9kdWN0SWQgfHwgMFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgaWYgKCFpdGVtTnVtRmxhZykge1xuICAgICAgICB1dGlsU2VydmljZS5hbGVydEVycm9yKCfor7flrozlloTotKflk4HmlbDph48hJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBzaGVsZlR5cGUgPSAkc2NvcGUuY29tcGFueS5zaGVsZlR5cGU7XG4gICAgICBpZiAoc2hlbGZUeXBlID09IENPTVBBTllfVFlQRS5FTVBfUEFZX01PREUgJiYgc2VsZWN0ZWRQcm9kdWN0cy5sZW5ndGggPlxuICAgICAgICBtYXhQcm9kdWN0c0NvdW50KSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+WRmOW3peiHqui0ueS8geS4mu+8jOWVhuWTgeS4jeW+l+i2hei/hycgKyBtYXhQcm9kdWN0c0NvdW50ICtcbiAgICAgICAgICAn5qC3IScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRDYXRlZ29yaWVOYW1lcygpLmxlbmd0aCA8PSAyKSB7XG4gICAgICAgIGlmICghY29uZmlybSgn5omA5raJ5Y+K5ZOB57G74omkMizmmK/lkKbnu6fnu60/JykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChibGFja0ZsYWcpIHtcbiAgICAgICAgaWYgKCFjb25maXJtKCflrZjlnKjpu5HlkI3ljZXllYblk4Es5piv5ZCm57un57utPycpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvL+aVtOWQiOaPkOWPlnN1aXRlSWRzIGlzc3VlSWRcbiAgICAgIHZhciBzdWl0ZUlkcyA9IF8udW5pb24oXy53aXRob3V0KF8ucGx1Y2soaXRlbXMsICdzdWl0ZUlkJyksXG4gICAgICAgIG51bGwsXG4gICAgICAgIHVuZGVmaW5lZCwgJzAnKSk7XG4gICAgICB2YXIgaXNzdWVJZHMgPSBfLnVuaW9uKF8ud2l0aG91dChfLnBsdWNrKGl0ZW1zLCAnaXNzdWVJZCcpLFxuICAgICAgICBudWxsLFxuICAgICAgICB1bmRlZmluZWQsICcwJykpO1xuICAgICAgdmFyIGlzc3VlSWQgPSAtMTtcbiAgICAgIGlmIChpc3N1ZUlkcy5sZW5ndGgpIHtcbiAgICAgICAgaXNzdWVJZCA9IGlzc3VlSWRzLmxlbmd0aCA+IDEgPyBvbmxpbmVJc3N1ZS5pc3N1ZS5pZCA6XG4gICAgICAgICAgaXNzdWVJZHNbMF07IC8v6Iul5pyJ5YWz6IGU5pys5pyf5aWX6aSQ5YiZaXNzdWVJZOiuvuS4uuacrOacn++8jOWQpuWImeWni+e7iOWPluWVhuWTgeS4iuWFs+iBlOeahGlzc3VlSWRcbiAgICAgIH1cbiAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IHRydWU7XG4gICAgICBpZiAoJHNjb3BlLm9yZGVySWQgPiAwKSB7IC8v57yW6L6R5qih5byPXG4gICAgICAgIGVkaXREZWxpdmVyeUZvclNlcnZlcihpdGVtcywgaXNzdWVJZCwgc3VpdGVJZHMsIHNlbmRXYXJlaG91c2UpO1xuICAgICAgfSBlbHNlIHsgLy/mlrDlop7mqKHlvI9cbiAgICAgICAgY3JlYXRlRGVsaXZlcnlGb3JTZXJ2ZXIoaXRlbXMsIGlzc3VlSWQsIHN1aXRlSWRzLCBzZW5kV2FyZWhvdXNlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5Y+R6YCB5Yiw5LuT5bqTXG4gICAgJHNjb3BlLnNlbmRXYXJlaG91c2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zYXZlRGVsaXZlcnkodHJ1ZSk7XG4gICAgfTtcbiAgICAvL+aWsOW7uihzZXJ2ZXLkuqTkupIpXG4gICAgdmFyIGNyZWF0ZURlbGl2ZXJ5Rm9yU2VydmVyID0gZnVuY3Rpb24oaXRlbXMsIGlzc3VlSWQsIHN1aXRlSWRzLFxuICAgICAgc2VuZFdhcmVob3VzZSkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgc2hlbGZJZDogJHNjb3BlLnBpY2tPcmRlci5zaGVsZklkLFxuICAgICAgICB1cmdlbnQ6ICRzY29wZS5waWNrT3JkZXIudXJnZW50LFxuICAgICAgICBpdGVtczogaXRlbXMsXG4gICAgICAgIGlzc3VlSWQ6IGlzc3VlSWQsXG4gICAgICAgIHN1aXRlSWRzOiBzdWl0ZUlkc1xuICAgICAgfTtcbiAgICAgIG9yZGVyU2VydmljZS5jcmVhdGVEZWxpdmVyeU9yZGVyKHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmRpc2FibGVFZGl0ID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5vcmRlcklkID0gcmVzLm9yZGVySWQ7XG4gICAgICAgIGlmIChzZW5kV2FyZWhvdXNlKSB7IC8v5Y+R6YCB57uZ5LuT5bqTXG4gICAgICAgICAgc2VuZFdhcmVob3VzZUZvclNlcnZlcigpO1xuICAgICAgICB9IGVsc2UgeyAvL+S7heS/neWtmFxuICAgICAgICAgIGlmICgkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkID4gMCkge1xuICAgICAgICAgICAgc2V0R29vZHNDaG9vc2VPcmRlckZpbmlzaCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhbGVydCgn5L+d5a2Y5oiQ5YqfIScpO1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygtMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmRpc2FibGVFZGl0ID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v57yW6L6RKHNlcnZlcuS6pOS6kilcbiAgICB2YXIgZWRpdERlbGl2ZXJ5Rm9yU2VydmVyID0gZnVuY3Rpb24oaXRlbXMsIGlzc3VlSWQsIHN1aXRlSWRzLFxuICAgICAgc2VuZFdhcmVob3VzZSkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgb3JkZXJJZDogJHNjb3BlLnBpY2tPcmRlci5vcmRlcklkLFxuICAgICAgICBvcmRlclN0YXRlOiAkc2NvcGUucGlja09yZGVyLm9yZGVyU3RhdGUsXG4gICAgICAgIHVyZ2VudDogJHNjb3BlLnBpY2tPcmRlci51cmdlbnQsXG4gICAgICAgIGl0ZW1zOiBpdGVtcyxcbiAgICAgICAgaXNzdWVJZDogaXNzdWVJZCxcbiAgICAgICAgc3VpdGVJZHM6IHN1aXRlSWRzXG4gICAgICB9O1xuICAgICAgb3JkZXJTZXJ2aWNlLm1vZGlmeURlbGl2ZXJ5T3JkZXIocGFyYW1zKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBpZiAoc2VuZFdhcmVob3VzZSkgeyAvL+WPkemAgee7meS7k+W6k1xuICAgICAgICAgIHNlbmRXYXJlaG91c2VGb3JTZXJ2ZXIoKTtcbiAgICAgICAgfSBlbHNlIHsgLy/ku4Xkv53lrZhcbiAgICAgICAgICB1dGlsU2VydmljZS5hbGVydFN1Y2Nlc3MoJ+S/neWtmOaIkOWKnyEnKTtcbiAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKC0xKTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WPkemAgeWIsOS7k+W6kyhzZXJ2ZXLkuqTkupIpXG4gICAgdmFyIHNlbmRXYXJlaG91c2VGb3JTZXJ2ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZW5kV2FyZWhvdXNlUGFyYW1zID0ge1xuICAgICAgICBvcmRlcklkOiAkc2NvcGUub3JkZXJJZCxcbiAgICAgICAgb3JkZXJTdGF0ZTogQ09OU1RBTlRTLkRFTElWRVJZX1NUQVRFLldBSVRfUElDS1xuICAgICAgfTtcbiAgICAgIG9yZGVyU2VydmljZS5tb2RpZnlEZWxpdmVyeVN0YXRlKHNlbmRXYXJlaG91c2VQYXJhbXMpLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGlmICgkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkID4gMCkge1xuICAgICAgICAgICAgc2V0R29vZHNDaG9vc2VPcmRlckZpbmlzaCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1dGlsU2VydmljZS5hbGVydFN1Y2Nlc3MoJ+WPkemAgeaIkOWKnyEnKTtcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soLTEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+iuvue9rumAiei0reWNleS4uuW3suWujOaIkCBcbiAgICB2YXIgc2V0R29vZHNDaG9vc2VPcmRlckZpbmlzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgZ29vZHNDaG9vc2VTZXJ2aWNlLm1vZGlmeU9yZGVyU3RhdGUoe1xuICAgICAgICBvcmRlcklkOiAkc2NvcGUuZ29vZHNDaG9vc2VPcmRlcklkLFxuICAgICAgICBvcmRlclN0YXRlOiBDT05TVEFOVFMuR09PRFNDSE9PU0VfT1JERVJfU1RBVEUuRklOSVNIXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICB1dGlsU2VydmljZS5hbGVydFN1Y2Nlc3MoJ+S/neWtmOaIkOWKnyEnKTtcbiAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygtMSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8q5paw5ZOB5LiK5p62Ki9cbiAgICB2YXIgc2V0TmV3UHJvZHVjdHNUYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgICAkc2NvcGUubGltaXQgPSAxMDtcbiAgICAgICRzY29wZS5uZXdQcm9kY3V0c1RhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICB9LCB7XG4gICAgICAgIGNvdW50czogW10sXG4gICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDEzLFxuICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICByZXR1cm4gc2hlbGZTZXJ2aWNlLnF1ZXJ5T3RoZXJTaGVsZlByb2R1Y3RzKHtcbiAgICAgICAgICAgIG9mZnNldDogJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSxcbiAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICBzaGVsZklkOiAkc2NvcGUucGlja09yZGVyLnNoZWxmSWQsXG4gICAgICAgICAgICBwcm9kdWN0TmFtZTogJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMucHJvZHVjdE5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeUlkOiAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcy5jYXRlZ29yeUlkLFxuICAgICAgICAgICAgcHJvZml0TGV2ZWw6ICRzY29wZS5uZXdQcm9kdWN0c1F1ZXJ5UGFyYW1zLnByb2ZpdExldmVsLFxuICAgICAgICAgICAgaXNEZWxldGVkOiAwXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gc2hlbGZTZXJ2aWNlLl9wYXJzZU90aGVyU2hlbGZQcm9kdWN0cyhyZXMuY29udGVudCxcbiAgICAgICAgICAgICAgXy5wbHVjayh0bXBOZXdQcm9kdWN0TGlzdCwgJ3Byb2R1Y3RJZCcpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+afpeivouWVhuWTgeexu+WIq+WIl+ihqFxuICAgIHZhciBxdWVyeVByb2R1Y3RDYXRlZ29yeUxpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgIHByb2R1Y3RTZXJ2aWNlLnF1ZXJ5UHJvZHVjdENhdGVnb3J5TGlzdCgpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5jYXRlb3R5TGlzdCA9IFt7XG4gICAgICAgICAgY29kZTogJy0xJyxcbiAgICAgICAgICBkZXNjOiBcIuWFqOmDqOWTgeexu1wiXG4gICAgICAgIH1dO1xuICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzLCBmdW5jdGlvbihjYXRlZ29yeSwgaW5kZXgpIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IHsgJ2NvZGUnOiBjYXRlZ29yeS5pZCwgJ2Rlc2MnOiBjYXRlZ29yeS5jYXRlZ29yeU5hbWUgfTtcbiAgICAgICAgICAkc2NvcGUuY2F0ZW90eUxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5wcm9maXRMaXN0ID0gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgY2xzT3JOYW1lOiAnUFJPRklUX0xFVkVMJyxcbiAgICAgIGRlZmF1bHRPYmo6IHsgJy0xJzogJ+WFqOmDqOWIqea2puetiee6pycgfVxuICAgIH0pO1xuICAgIC8v5omT5byAIOaWsOWTgeS4iuaetlxuICAgICRzY29wZS5wdXRTYWxlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbmV3UHJvZHVjdExpc3QgPSAkc2NvcGUuc2VsZWN0ZWRMaXN0Q29uZmlnLmdldExpc3QoXG4gICAgICAgIFBST0RVQ1RfRlJPTV9UWVBFLkZST01fTkVXKTtcbiAgICAgIHRtcE5ld1Byb2R1Y3RMaXN0ID0gYW5ndWxhci5jb3B5KG5ld1Byb2R1Y3RMaXN0KTtcbiAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgJ2RlbGl2ZXJ5LWVkaXQnKSksXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWxQcm9kdWN0TGlzdCcsXG4gICAgICAgIHNpemU6ICdsZydcbiAgICAgIH0pO1xuICAgICAgJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgIHNldE5ld1Byb2R1Y3RzVGFibGUoKTtcbiAgICAgIHF1ZXJ5UHJvZHVjdENhdGVnb3J5TGlzdCgpO1xuICAgIH07XG4gICAgLy/lk4HnsbvpgInmi6lcbiAgICAkc2NvcGUuc2VsZWN0Q2F0ZWdvcnlDYWxsYmFjayA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNvZGUpIHtcbiAgICAgICAgaXRlbS5jb2RlICE9PSAnLTEnID8gJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMuY2F0ZWdvcnlJZCA9XG4gICAgICAgICAgaXRlbS5jb2RlIDogJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMuY2F0ZWdvcnlJZCA9XG4gICAgICAgICAgdW5kZWZpbmVkO1xuICAgICAgICBzZXROZXdQcm9kdWN0c1RhYmxlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+WIqea2puetiee6p+mAieaLqVxuICAgICRzY29wZS5zZWxlY3RQcm9maXRDYWxsYmFjayA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNvZGUpIHtcbiAgICAgICAgaXRlbS5jb2RlICE9PSAnLTEnID8gJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMucHJvZml0TGV2ZWwgPVxuICAgICAgICAgIGl0ZW0uY29kZSA6ICRzY29wZS5uZXdQcm9kdWN0c1F1ZXJ5UGFyYW1zLnByb2ZpdExldmVsID1cbiAgICAgICAgICB1bmRlZmluZWQ7XG4gICAgICAgIHNldE5ld1Byb2R1Y3RzVGFibGUoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5pCc57Si5ZWG5ZOBXG4gICAgJHNjb3BlLnNlYXJjaFByb2R1Y3QgPSBmdW5jdGlvbihxdWVyeVBhcmFtcykge1xuICAgICAgJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMucHJvZHVjdE5hbWUgPSBxdWVyeVBhcmFtcy5wcm9kdWN0TmFtZTtcbiAgICAgIHNldE5ld1Byb2R1Y3RzVGFibGUoKTtcbiAgICB9O1xuICAgICRzY29wZS5rZXlQcmVzc1NlYXJjaFByb2R1Y3QgPSBmdW5jdGlvbihlLCBxdWVyeVBhcmFtcykge1xuICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykgeyAvL+Wbnui9pumUrlxuICAgICAgICAkc2NvcGUuc2VhcmNoUHJvZHVjdChxdWVyeVBhcmFtcyk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+WVhuWTgemAieaLqVxuICAgICRzY29wZS5jaGtib3hDaGFuZ2UgPSBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICBpZiAocHJvZHVjdC5zZWxlY3QpIHtcbiAgICAgICAgcHJvZHVjdC5wcm9kdWN0SWQgPSBwcm9kdWN0LmlkO1xuICAgICAgICB0bXBOZXdQcm9kdWN0TGlzdC5wdXNoKHByb2R1Y3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG1wTmV3UHJvZHVjdExpc3QgPSBfLnJlamVjdCh0bXBOZXdQcm9kdWN0TGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHJldHVybiBpdGVtLnByb2R1Y3RJZCA9PSBwcm9kdWN0LnByb2R1Y3RJZDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+aWsOWTgeS4iuaetiDnoa7orqRcbiAgICAkc2NvcGUuY29uZmlybVB1dFNhbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucmVtb3ZlTmV3SXRlbXNXaXRob3V0SWRzKF8ucGx1Y2soXG4gICAgICAgIHRtcE5ld1Byb2R1Y3RMaXN0LCAncHJvZHVjdElkJykpO1xuICAgICAgXy5lYWNoKHRtcE5ld1Byb2R1Y3RMaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucHVzaEl0ZW0oaXRlbSwgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9ORVcpO1xuICAgICAgfSk7XG4gICAgICBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRJZExpc3QoKSk7XG4gICAgICAkc2NvcGUubW9kYWwuY2xvc2UoKTtcbiAgICB9O1xuICAgIC8v5paw5ZOB5LiK5p62IOWIoOmZpFxuICAgICRzY29wZS5yZW1vdmVQdXRTYWxlUHJvZHVjdCA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucmVtb3ZlSXRlbUJ5UHJvZHVjdElkKHByb2R1Y3QucHJvZHVjdElkKTtcbiAgICB9O1xuICAgIC8q6KGl6LSnKi9cbiAgICAvL+aJk+W8gCDooaXotKdcbiAgICAkc2NvcGUuc3VwcGxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAganVkZ2VTZWxlY3RPbk9wZW5TdXBwbGVtZW50KCk7XG4gICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICdkZWxpdmVyeS1lZGl0JykpLFxuICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZGFsU2hlbGZQcm9kdWN0TGlzdEZvclN1cHBsZW1lbnQnLFxuICAgICAgICBzaXplOiAnbGcnXG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5omT5byAIOihpei0p+aXtiDliKTmlq3mmK/lkKbpgInkuK1cbiAgICB2YXIganVkZ2VTZWxlY3RPbk9wZW5TdXBwbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICBfLmVhY2goJHNjb3BlLnNoZWxmUHJvZHVjdExpc3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkUHJvZHVjdCA9ICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcuZ2V0QnlQcm9kdWN0SWQoXG4gICAgICAgICAgaXRlbS5wcm9kdWN0SWQpO1xuICAgICAgICBpdGVtLnRtcFNlbGVjdCA9IHR5cGVvZiBzZWxlY3RlZFByb2R1Y3QgIT0gJ3VuZGVmaW5lZCc7XG4gICAgICAgIGl0ZW0uaXRlbU51bSA9IGl0ZW0udG1wU2VsZWN0ID8gc2VsZWN0ZWRQcm9kdWN0Lml0ZW1OdW0gOlxuICAgICAgICAgICcnO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuc2VsZWN0T25DaGNrYm94ID0gZnVuY3Rpb24oc2hlbGZQcm9kdWN0KSB7XG4gICAgICBpZiAoIXNoZWxmUHJvZHVjdC50bXBTZWxlY3QpIHtcbiAgICAgICAgYWRkUmVtb3ZlUHJvZHVjdE9uU3VwcGxlbWVudChzaGVsZlByb2R1Y3QsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkZFJlbW92ZVByb2R1Y3RPblN1cHBsZW1lbnQoc2hlbGZQcm9kdWN0LCB0cnVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v6YCJ5Lit6KGl6LSnKOWhq+WGmeaVsOWtl+aXtilcbiAgICAkc2NvcGUuc2VsZWN0T25JbnB1dE51bSA9IGZ1bmN0aW9uKHNoZWxmUHJvZHVjdCkge1xuICAgICAgaWYgKCFzaGVsZlByb2R1Y3QuaXRlbU51bSkge1xuICAgICAgICBhZGRSZW1vdmVQcm9kdWN0T25TdXBwbGVtZW50KHNoZWxmUHJvZHVjdCwgZmFsc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkUmVtb3ZlUHJvZHVjdE9uU3VwcGxlbWVudChzaGVsZlByb2R1Y3QsIHRydWUpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/ooaXotKfkuK0g6YCJ5LitL+enu+mZpFxuICAgIHZhciBhZGRSZW1vdmVQcm9kdWN0T25TdXBwbGVtZW50ID0gZnVuY3Rpb24oaXRlbSwgc2VsZWN0KSB7XG4gICAgICBfLmVhY2goJHNjb3BlLnNoZWxmUHJvZHVjdExpc3QsIGZ1bmN0aW9uKHApIHtcbiAgICAgICAgaWYgKHAucHJvZHVjdElkID09IGl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgcC50bXBTZWxlY3QgPSBzZWxlY3Q7XG4gICAgICAgICAgcC5pdGVtTnVtID0gaXRlbS5pdGVtTnVtO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v6KGl6LSnIOehruiupFxuICAgICRzY29wZS5zdXBwbGVtZW50Q29uZmlybSA9IGZ1bmN0aW9uKCkge1xuICAgICAgXy5lYWNoKCRzY29wZS5zaGVsZlByb2R1Y3RMaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLnRtcFNlbGVjdCkge1xuICAgICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucHVzaEl0ZW0oaXRlbSxcbiAgICAgICAgICAgIFBST0RVQ1RfRlJPTV9UWVBFLkZST01fU0hFTEYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucmVtb3ZlSXRlbUJ5UHJvZHVjdElkKGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRJZExpc3QoKSk7XG4gICAgICAkc2NvcGUubW9kYWwuY2xvc2UoKTtcbiAgICB9O1xuICAgIC8v6KGl6LSnIOWIoOmZpFxuICAgICRzY29wZS5yZW1vdmVTdXBwbGVtZW50UHJvZHVjdCA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcucmVtb3ZlSXRlbUJ5UHJvZHVjdElkKHByb2R1Y3QucHJvZHVjdElkKTtcbiAgICB9O1xuICAgIC8q5ouj6LSn5L+h5oGv5Y+C6ICD6aG16Z2i55u45YWzKi9cbiAgICAvL+aJk+W8gOaLo+i0p+aVsOaNruWPguiAg+mhtVxuICAgICRzY29wZS5vcGVuUGlja1JlZmVyID0gZnVuY3Rpb24obW9kZSkge1xuICAgICAgJHNjb3BlLnJlZmVyT3Blbk1vZGUgPSBtb2RlO1xuICAgICAganVkZ2VTZWxlY3RPbk9wZW5SZWZlcigpO1xuICAgICAgJHNjb3BlLm1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAnZGVsaXZlcnktZWRpdCcpKSxcbiAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwaWNrT3JkZXIvcGlja1JlZmVyVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgIHNpemU6ICd4eGxnJ1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+aJk+W8gCDmi6PotKfmlbDmja7lj4LogIPpobUg5Yik5pat5piv5ZCm6YCJ5LitXG4gICAgdmFyIGp1ZGdlU2VsZWN0T25PcGVuUmVmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIF8uZWFjaChfLmtleXMoJHNjb3BlLnJlZmVyRGF0YSksIGZ1bmN0aW9uKGtleSwgaSkge1xuICAgICAgICBfLmVhY2goJHNjb3BlLnJlZmVyRGF0YVtrZXldLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgdmFyIHNlbGVjdGVkUHJvZHVjdCA9ICRzY29wZS5zZWxlY3RlZExpc3RDb25maWcuZ2V0QnlQcm9kdWN0SWQoXG4gICAgICAgICAgICBpdGVtLnByb2R1Y3RJZCk7XG4gICAgICAgICAgaXRlbS50bXBTZWxlY3QgPSB0eXBlb2Ygc2VsZWN0ZWRQcm9kdWN0ICE9XG4gICAgICAgICAgICAndW5kZWZpbmVkJztcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5L+d55WZ5bCP5pWwXG4gICAgJHNjb3BlLnJlc2VydmVOdW0gPSBmdW5jdGlvbihudW0sIHBvaW50TnVtKSB7XG4gICAgICBwb2ludE51bSA9IHBvaW50TnVtIHx8IDI7XG4gICAgICByZXR1cm4gcGFyc2VGbG9hdChudW0pLnRvRml4ZWQocG9pbnROdW0pO1xuICAgIH07XG4gICAgLy/ov5Tlm55cbiAgICAkc2NvcGUuZ29CYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XG4gICAgfTtcbiAgICAvL+WwhuWll+mkkCDliqDlhaUg5ouj6LSn5Y2VXG4gICAgJHNjb3BlLmFkZFN1aXRlVG9QaWNrT3JkZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIF8uZWFjaCgkc2NvcGUucmVmZXJEYXRhLndpc2hsaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5hZGRUb1BpY2tPcmRlcihpdGVtKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liqDlhaUg5ouj6LSn5Y2VXG4gICAgJHNjb3BlLmFkZFRvUGlja09yZGVyID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgYWRkUmVtb3ZlUHJvSW5SZWZlcihpdGVtLCB0cnVlKTtcbiAgICB9O1xuICAgIC8v56e76ZmkIOaLo+i0p+WNlVxuICAgICRzY29wZS5yZW1vdmVGcm9tUGlja09yZGVyID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgYWRkUmVtb3ZlUHJvSW5SZWZlcihpdGVtLCBmYWxzZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiDllYblk4HliqDlhaXmiJbnp7vpmaQg5Y+C6ICD6aG16Z2iXG4gICAgICogaXRlbSAgIOWVhuWTgVxuICAgICAqIHNlbGVjdCB0cnVlKOWKoOWFpSksZmFsc2Uo56e76ZmkKVxuICAgICAqL1xuICAgIHZhciBhZGRSZW1vdmVQcm9JblJlZmVyID0gZnVuY3Rpb24oaXRlbSwgc2VsZWN0KSB7XG4gICAgICBfLmVhY2goXy5rZXlzKCRzY29wZS5yZWZlckRhdGEpLCBmdW5jdGlvbihrZXksIGkpIHtcbiAgICAgICAgXy5lYWNoKCRzY29wZS5yZWZlckRhdGFba2V5XSwgZnVuY3Rpb24ocCkge1xuICAgICAgICAgIGlmIChwLnByb2R1Y3RJZCA9PSBpdGVtLnByb2R1Y3RJZCkge1xuICAgICAgICAgICAgcC50bXBTZWxlY3QgPSBzZWxlY3Q7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/kv67mlLnkvIHkuJrlpIfms6hcbiAgICAkc2NvcGUubW9kaWZ5Q29tcGFueURlcyA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcbiAgICAgIGNvbXBhbnlTZXJ2aWNlLmVkaXRDb21wYW55KGNvbXBhbnkpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0U3VjY2Vzcygn5L+u5pS55oiQ5YqfIScpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WujOaIkFxuICAgICRzY29wZS5maW5pc2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIF8uZWFjaChfLmtleXMoJHNjb3BlLnJlZmVyRGF0YSksIGZ1bmN0aW9uKGtleSwgaSkge1xuICAgICAgICBpZiAoa2V5ID09ICd6ZXJvU2hpcG1lbnRSYXRlJyB8fCBrZXkgPT0gJ2xvd1NoaXBtZW50UmF0ZScpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXy5lYWNoKCRzY29wZS5yZWZlckRhdGFba2V5XSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIGlmIChpdGVtLnRtcFNlbGVjdCkge1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5wdXNoSXRlbShpdGVtLFxuICAgICAgICAgICAgICBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1JFRkVSKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5yZW1vdmVJdGVtQnlQcm9kdWN0SWQoXG4gICAgICAgICAgICAgIGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBsb2FkTGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MoJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5nZXRJZExpc3QoKSk7XG4gICAgICAkc2NvcGUubW9kYWwuY2xvc2UoKTtcbiAgICB9O1xuICAgIC8v6Ieq5Yqo5re75YqgXG4gICAgJHNjb3BlLmF1dG9BZGQgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAvL+W/g+aEv+WNleWVhuWTge+8mjXkuKrlhajpgIlcbiAgICAgIF8uZWFjaCgkc2NvcGUucmVmZXJEYXRhLndpc2hsaXN0LCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCA1KSB7XG4gICAgICAgICAgJHNjb3BlLmFkZFRvUGlja09yZGVyKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIC8v5LiL5p625ZCM57G75pu/5o2i77yaNeS4qu+8iOavj+S4quWTgeexu+WHuui0p+eOh1RPUDEm6ZSA5ZSu6aKdVE9QMemaj+acuumAieaLqe+8iVxuICAgICAgXy5lYWNoKCRzY29wZS5yZWZlckRhdGEucmVwbGFjZW1lbnRzLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpZiAoIWluZGV4ICUgMikge1xuICAgICAgICAgICRzY29wZS5hZGRUb1BpY2tPcmRlcihpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvL+i0p+aetlRPUDU6NeS4quWFqOmAiVxuICAgICAgXy5lYWNoKCRzY29wZS5yZWZlckRhdGEuc2hlbGZTYWxlc0NoYXJ0LCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAkc2NvcGUuYWRkVG9QaWNrT3JkZXIoaXRlbSk7XG4gICAgICB9KTtcbiAgICAgIC8v5YWo5bGAVE9QNTo15Liq5YWo6YCJXG4gICAgICBfLmVhY2goJHNjb3BlLnJlZmVyRGF0YS5nbG9iYWxTYWxlc0NoYXJ0LCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAkc2NvcGUuYWRkVG9QaWNrT3JkZXIoaXRlbSk7XG4gICAgICB9KTtcbiAgICAgIC8v5Y2V5ZOB5o6o6I2Q77ya5YWo6YCJ77yIM3415Liq77yJXG4gICAgICBfLmVhY2goJHNjb3BlLnJlZmVyRGF0YS5yZWNvbW1lbmRlZCwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgJHNjb3BlLmFkZFRvUGlja09yZGVyKGl0ZW0pO1xuICAgICAgfSk7XG4gICAgICAvL+W7uuiuruihpei0p++8mjXkuKrlhajpgIlcbiAgICAgIF8uZWFjaCgkc2NvcGUucmVmZXJEYXRhLnJlcGxlbmlzaG1lbnQsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgICRzY29wZS5hZGRUb1BpY2tPcmRlcihpdGVtKTtcbiAgICAgIH0pO1xuICAgICAgJHNjb3BlLmZpbmlzaCgpO1xuICAgIH07XG4gICAgLy/otKfmnrbpgInmi6lcbiAgICAkc2NvcGUuc2hlbGZDb25maWcgPSB7XG4gICAgICBsaXN0OiBbXSxcbiAgICAgIHNldExpc3Q6IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gYW5ndWxhci5jb3B5KGxpc3QpO1xuICAgICAgfSxcbiAgICAgIGdldERlZmF1bHRJdGVtOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMubGlzdDtcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKG9wdGlvbnMsIHtcbiAgICAgICAgICBpZDogdmFsdWVcbiAgICAgICAgfSkgfHwgb3B0aW9uc1swXTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihyZWNvcmQpIHtcbiAgICAgICAgJHNjb3BlLnBpY2tPcmRlci5zaGVsZklkID0gcmVjb3JkLmlkO1xuICAgICAgfSxcbiAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gW107XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+e0p+aApeW6plxuICAgICRzY29wZS51cmdlbmN5Q29uZmlnID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnREVMSVZFUllfVVJHRU5DWScsXG4gICAgICAgICAgaGFzRGVmYXVsdDogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5nZXRMaXN0KCk7XG4gICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7XG4gICAgICAgICAgY29kZTogdmFsdWVcbiAgICAgICAgfSkgfHwgb3B0aW9uc1swXTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihyZWNvcmQpIHtcbiAgICAgICAgJHNjb3BlLnBpY2tPcmRlci51cmdlbnQgPSByZWNvcmQuY29kZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5Yqg6L296LSn5p625YiX6KGoXG4gICAgdmFyIGxvYWRTaGVsZkxpc3QgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICB2YXIgcXVlcnlQYXJhbXMgPSB7IGNvbXBhbnlJZDogY29tcGFueS5jb21wYW55SWQgfTtcbiAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmTGlzdEJ5Q29tcGFueUlkKHF1ZXJ5UGFyYW1zKS50aGVuKGZ1bmN0aW9uKFxuICAgICAgICByZXMpIHtcbiAgICAgICAgJHNjb3BlLnNoZWxmQ29uZmlnLnNldExpc3QocmVzKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/pgInkuK3llYblk4FsaXN0XG4gICAgJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZyA9IHtcbiAgICAgIGxpc3Q6IFtdLFxuICAgICAgcHVzaEl0ZW06IGZ1bmN0aW9uKGl0ZW0sIGZyb21UeXBlKSB7XG4gICAgICAgIHZhciB0ZW1wID0gYW5ndWxhci5jb3B5KGl0ZW0pO1xuICAgICAgICB2YXIgdCA9IF8uZmluZCh0aGlzLmxpc3QsIGZ1bmN0aW9uKHApIHtcbiAgICAgICAgICByZXR1cm4gcC5wcm9kdWN0SWQgPT0gdGVtcC5wcm9kdWN0SWQ7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodCkge1xuICAgICAgICAgIHZhciBmcm9tID0gXy51bmlvbih0ZW1wLmZyb20sIHQuZnJvbSk7XG4gICAgICAgICAgdmFyIHJlYXNvbnMgPSBfLnVuaW9uKHRlbXAucmVhc29ucywgdC5yZWFzb25zKTtcbiAgICAgICAgICBfLmV4dGVuZCh0LCB0ZW1wKTtcbiAgICAgICAgICB0LmZyb20gPSBmcm9tO1xuICAgICAgICAgIHQucmVhc29ucyA9IHJlYXNvbnM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdCA9IHRlbXA7XG4gICAgICAgICAgdC5mcm9tID0gXy51bmlvbih0ZW1wLmZyb20gfHwgW10sIFtmcm9tVHlwZV0pO1xuICAgICAgICAgIHRoaXMubGlzdC5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVtb3ZlU3VpdGVJdGVtczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBQSUNLX1BST0RVQ1RfUkVBU09OID0gQ09OU1RBTlRTLlBJQ0tfUFJPRFVDVF9SRUFTT047XG4gICAgICAgIHRoaXMubGlzdCA9IF8ucmVqZWN0KHRoaXMubGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHJldHVybiBfLmNvbnRhaW5zKGl0ZW0uZnJvbSwgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9TVUlURSkgJiZcbiAgICAgICAgICAgICFfLmNvbnRhaW5zKGl0ZW0uZnJvbSwgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9SRUZFUik7XG4gICAgICAgIH0pO1xuICAgICAgICBfLmVhY2godGhpcy5saXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgaWYgKF8uY29udGFpbnMoaXRlbS5yZWFzb25zLCBQSUNLX1BST0RVQ1RfUkVBU09OLldJU0hMSVNUKSAmJlxuICAgICAgICAgICAgIV8uY29udGFpbnMoaXRlbS5mcm9tLCBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1JFRkVSKSkge1xuICAgICAgICAgICAgaXRlbS5yZWFzb25zID0gXy53aXRob3V0KGl0ZW0ucmVhc29ucyxcbiAgICAgICAgICAgICAgUElDS19QUk9EVUNUX1JFQVNPTi5XSVNITElTVCk7XG4gICAgICAgICAgICBpdGVtLmZyb20gPSBfLndpdGhvdXQoaXRlbS5mcm9tLCBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1NVSVRFKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIHJlbW92ZUl0ZW1CeVByb2R1Y3RJZDogZnVuY3Rpb24ocHJvZHVjdElkKSB7XG4gICAgICAgIHRoaXMubGlzdCA9IF8ucmVqZWN0KHRoaXMubGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHJldHVybiBpdGVtLnByb2R1Y3RJZCA9PSBwcm9kdWN0SWQ7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIC8v5Yig6Zmk5LiN5Zyo5oyH5a6aSURz5Lit55qE5ZWG5ZOBXG4gICAgICByZW1vdmVOZXdJdGVtc1dpdGhvdXRJZHM6IGZ1bmN0aW9uKHByb2R1Y3RJZHMpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gXy5yZWplY3QodGhpcy5saXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuICFfLmNvbnRhaW5zKHByb2R1Y3RJZHMsIGl0ZW0ucHJvZHVjdElkKSAmJiBfLmNvbnRhaW5zKFxuICAgICAgICAgICAgaXRlbS5mcm9tLCBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX05FVyk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGdldEJ5UHJvZHVjdElkOiBmdW5jdGlvbihwcm9kdWN0SWQpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBfLmZpbmQodGhpcy5saXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0ucHJvZHVjdElkID09IHByb2R1Y3RJZDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9kdWN0O1xuICAgICAgfSxcbiAgICAgIGdldEJ5U2hlbGZQcm9kdWN0SWQ6IGZ1bmN0aW9uKHNoZWxmUHJvZHVjdElkKSB7XG4gICAgICAgIHZhciBwcm9kdWN0ID0gXy5maW5kKHRoaXMubGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIGlmIChfLmNvbnRhaW5zKGl0ZW0uZnJvbSwgUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9TSEVMRikpIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLnByb2R1Y3Quc2hlbGZQcm9kdWN0SGVhZGVyLmlkID09XG4gICAgICAgICAgICAgIHNoZWxmUHJvZHVjdElkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb2R1Y3Q7XG4gICAgICB9LFxuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24oZnJvbVR5cGUpIHtcbiAgICAgICAgaWYgKGZyb21UeXBlKSB7XG4gICAgICAgICAgcmV0dXJuIF8uZmlsdGVyKHRoaXMubGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIF8uY29udGFpbnMoaXRlbS5mcm9tLCBmcm9tVHlwZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubGlzdDtcbiAgICAgICAgfVxuXG4gICAgICB9LFxuICAgICAgZ2V0SWRMaXN0OiBmdW5jdGlvbihmcm9tVHlwZSkge1xuICAgICAgICB2YXIgc2VsZWN0ZWRMaXN0ID0gW107XG4gICAgICAgIGlmIChmcm9tVHlwZSkge1xuICAgICAgICAgIHNlbGVjdGVkTGlzdCA9IF8uZmlsdGVyKHRoaXMubGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIF8uY29udGFpbnMoaXRlbS5mcm9tLCBmcm9tVHlwZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VsZWN0ZWRMaXN0ID0gdGhpcy5saXN0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLnBsdWNrKHNlbGVjdGVkTGlzdCwgJ3Byb2R1Y3RJZCcpO1xuICAgICAgfSxcbiAgICAgIC8v6I635Y+W5bu66K6u5LiL5p625ZWG5ZOBXG4gICAgICBnZXRBZHZpY2VPdXRMaXN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgdmFyIGFkdmljZU91dFByb2R1Y3RJZHMgPSBbXTtcbiAgICAgICAgLy/lrp7ml7borqHnrpfpmaTljrvotKfmnrbllYblk4HvvIzlubbkuJTpgJrov4dwcm9kdWN0SWTljrvph41cbiAgICAgICAgdmFyIGFkdmljZU91dExpc3QgPSBfLnJlamVjdCgkc2NvcGUuc2hlbGZQcm9kdWN0TGlzdCxcbiAgICAgICAgICBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICB2YXIgdCA9IF8uZmluZChtZS5saXN0LCBmdW5jdGlvbihzZWxlY3RlZE9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRPYmoucHJvZHVjdElkID09IGl0ZW0ucHJvZHVjdElkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoXy5jb250YWlucyhhZHZpY2VPdXRQcm9kdWN0SWRzLCBpdGVtLnByb2R1Y3RJZCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhZHZpY2VPdXRQcm9kdWN0SWRzLnB1c2goaXRlbS5wcm9kdWN0SWQpO1xuICAgICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFkdmljZU91dExpc3Q7XG4gICAgICB9LFxuICAgICAgZ2V0Q2F0ZWdvcmllTmFtZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYSA9IF8udW5pcShfLnBsdWNrKF8ucGx1Y2sodGhpcy5saXN0LCAnY2F0ZWdvcnknKSxcbiAgICAgICAgICAnY2F0ZWdvcnlOYW1lJykpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICAgIH0sXG4gICAgICBjbGVhckxpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmxpc3QgPSBbXTtcbiAgICAgIH0sXG4gICAgICBjYWxjdWxhdGVUb3RhbEZlZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0b3RhbEZlZUludCA9IDA7XG4gICAgICAgIF8uZWFjaCgkc2NvcGUuc2VsZWN0ZWRMaXN0Q29uZmlnLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICB0b3RhbEZlZUludCArPSBwYXJzZUludChpdGVtLnByaWNlLCAxMCkgKiBpdGVtLml0ZW1OdW07XG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUucGlja09yZGVyLm9yZGVyRmVlID0gdG90YWxGZWVJbnQ7XG4gICAgICB9LFxuICAgICAgLy/orr7nva7mnIDov5ExMOaXpeaLo+i0p+Wdh+WAvFxuICAgICAgc2V0TGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3M6IGZ1bmN0aW9uKGF2Z0xpc3QpIHtcbiAgICAgICAgdmFyIGxpc3QgPSBhbmd1bGFyLmNvcHkodGhpcy5saXN0KTtcbiAgICAgICAgXy5lYWNoKGxpc3QsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgICAgaXRlbS5sYXRlc3REZWxpdmVyeUNvdW50QXZncyA9IGF2Z0xpc3RbaW5kZXhdO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saXN0ID0gbGlzdDtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v55uR5ZCsbGlzdOaUueWPmFxuICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkTGlzdENvbmZpZy5saXN0JywgZnVuY3Rpb24obmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICBpZiAobmV3VmFsdWUgPT0gb2xkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgJHNjb3BlLnNlbGVjdGVkTGlzdENvbmZpZy5jYWxjdWxhdGVUb3RhbEZlZSgpO1xuICAgIH0sIHRydWUpO1xuICAgIC8v55uR5ZCs6LSn5p626YCJ5oupXG4gICAgJHNjb3BlLiR3YXRjaCgncGlja09yZGVyLnNoZWxmSWQnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgIGlmIChuZXdWYWx1ZSA9PSBvbGRWYWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoJHNjb3BlLm9yZGVySWQgPiAwKSB7IC8v5L+u5pS55qih5byPXG4gICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHsgLy/mlrDlop7mqKHlvI9cbiAgICAgICAgLy/ov5jljp9cbiAgICAgICAgJHNjb3BlLmNsZWFyZGF0YSgpO1xuICAgICAgICAkc2NvcGUucGlja09yZGVyLnVyZ2VudCA9ICRzY29wZS51cmdlbmN5Q29uZmlnLmdldExpc3QoKVswXS5jb2RlO1xuICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlICE9ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAganVkZ2VVbmZpbmlzaGVkRGVsaXZlcnkobmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB0cnVlKTtcbiAgICAvL+afpeivouivpei0p+aetuaYr+WQpuacieacquWujOaIkOeahOmAgei0p+WNlVxuICAgIHZhciBqdWRnZVVuZmluaXNoZWREZWxpdmVyeSA9IGZ1bmN0aW9uKHNoZWxmSWQpIHtcbiAgICAgIHZhciBERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgbGltaXQ6IDEsXG4gICAgICAgIHNoZWxmSWQ6IHNoZWxmSWQsXG4gICAgICAgIG9yZGVyU3RhdGVzOiBbREVMSVZFUllfU1RBVEUuSU5JVCwgREVMSVZFUllfU1RBVEUuV0FJVF9QSUNLLFxuICAgICAgICAgIERFTElWRVJZX1NUQVRFLlBJQ0tJTkcsIERFTElWRVJZX1NUQVRFLlJFVFVSTl9JTklULFxuICAgICAgICAgIERFTElWRVJZX1NUQVRFLldBSVRfQ09NRklSTSwgREVMSVZFUllfU1RBVEUuV0FJVF9TSEVMVkVcbiAgICAgICAgXVxuICAgICAgfTtcbiAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5TGlzdChwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIGlmIChyZXMudG90YWxFbGVtZW50cyA+IDApIHtcbiAgICAgICAgICB1dGlsU2VydmljZS5hbGVydEVycm9yKCfor6XotKfmnrblrZjlnKjkuIDkuKrmnKrlrozmiJDnmoTpgIHotKfljZXvvIzlsIbml6Dms5XliJvlu7rpgIHotKfljZUhJyk7XG4gICAgICAgICAgJHNjb3BlLmRpc2FibGVFZGl0ID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2FkU2hlbGZQcm9kdWN0cyhzaGVsZklkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBpbml0VmlldygpO1xuICB9KTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXBwKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoJ2ZpbmFuY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbWRTaWRlbmF2LCAkbWREaWFsb2csICRzY2UsICRlbGVtZW50LCBDT05TVEFOVFMsICRjb21waWxlLCAkZmlsdGVyLCBOZ1RhYmxlUGFyYW1zLCBvcmRlclNlcnZpY2UsIHByaW50U2VydmljZSwgdXRpbFNlcnZpY2UsIG1vZGFsU2VydmljZSwgZmluYW5jZVNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLkNPTlNUQU5UUyA9IENPTlNUQU5UUztcbiAgICAgICAgJHNjb3BlLk9SREVSX1RZUEUgPSBDT05TVEFOVFMuT1JERVJfVFlQRTtcbiAgICAgICAgJHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgJHNjb3BlLkNPTVBBTllfVFlQRSA9IENPTlNUQU5UUy5DT01QQU5ZX1RZUEU7XG4gICAgICAgICRzY29wZS5TRVRUTEVNRU5UX1NUQVRFID0gQ09OU1RBTlRTLlNFVFRMRU1FTlRfU1RBVEU7XG4gICAgICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICAgICAkc2NvcGUuZmluYW5jZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3JkZXJzID0gW107XG4gICAgICAgICRzY29wZS5pc0ludm9pY2UgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuc2V0dGxlbWVudE9yZGVyID0ge307XG4gICAgICAgICRzY29wZS5vcmRlclN0YXRlTGlzdCA9IFt7XG4gICAgICAgICAgICBkZXNjOiAn5YWo6YOo5LuY5qy+54q25oCBJyxcbiAgICAgICAgICAgIGNvZGU6ICcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGRlc2M6ICflvoXku5jmrL4nLFxuICAgICAgICAgICAgY29kZTogQ09OU1RBTlRTLlNFVFRMRU1FTlRfU1RBVEUuV0FJVF9TRVRUTEVNRU5UXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGRlc2M6ICflt7Lku5jmrL4nLFxuICAgICAgICAgICAgY29kZTogQ09OU1RBTlRTLlNFVFRMRU1FTlRfU1RBVEUuQ09NUExFVEVEXG4gICAgICAgIH1dO1xuICAgICAgICAkc2NvcGUuaW52b2ljZU5lZWRTdGF0ZUxpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCgnSU5WT0lDRV9ORUVEX1NUQVRFJywgdHJ1ZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHsnJzogJ+WFqOmDqOW8gOelqOmcgOaxgid9KTtcbiAgICAgICAgJHNjb3BlLmludm9pY2VTdGF0ZUxpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCgnSU5WT0lDRV9TVEFURScsIHRydWUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB7Jyc6ICflhajpg6jnpajlj7cnfSk7XG4gICAgICAgICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcgPSB7XG4gICAgICAgICAgICBxdWVyeUZpbmFuY2VLZXk6ICcnLFxuICAgICAgICAgICAgY29tcGFueU5hbWU6ICcnLFxuICAgICAgICAgICAgZmluYW5jZVN0YXJ0VGltZTogJycsXG4gICAgICAgICAgICBmaW5hbmNlRW5kVGltZTogJycsXG4gICAgICAgICAgICBvcmRlclN0YXRlczogJycsXG4gICAgICAgICAgICBpc0ludm9pY2U6ICcnLFxuICAgICAgICAgICAgaXNVcGRhdGVUaW1lOiAwLFxuICAgICAgICAgICAgaXNJbnZvaWNlTnVtOiAnJyxcbiAgICAgICAgICAgIGNob2ljZXM6IENPTlNUQU5UUy5nZXRMaXN0KCdJTlZPSUNFX1RJTUVfVFlQRScsIGZhbHNlKSxcbiAgICAgICAgICAgIGNvbXBhbnlLZXl1cDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICAgICAgICAgICAgaWYgKGtleWNvZGUgPT0gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbmFuY2VUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbmFuY2VUYWJsZS5wYWdlKDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZWxlY3RJc1VwYWRhdGU6IGZ1bmN0aW9uICh0aW1lVHlwZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuaXNVcGRhdGVUaW1lID0gdGltZVR5cGUuY29kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZ2V0RmluYW5jZUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuZmluYW5jZVRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9mZnNldCA9ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIHAgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFueU5hbWU6ICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuY29tcGFueU5hbWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuZmluYW5jZVN0YXJ0VGltZSAhPT0gJycpIHsgLy/pnZ7nqbrlrZfnrKbkuLJcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuZmluYW5jZVN0YXJ0VGltZSA9ICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuZmluYW5jZVN0YXJ0VGltZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5RmluYW5jZUNvbmZpZy5maW5hbmNlRW5kVGltZSAhPT0gJycpIHsgLy/pnZ7nqbrlrZfnrKbkuLJcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuZmluYW5jZUVuZFRpbWUgPSBuZXcgRGF0ZSgkc2NvcGUucXVlcnlGaW5hbmNlQ29uZmlnLmZpbmFuY2VFbmRUaW1lLmdldFRpbWUoKSsyNCo2MCo2MCoxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5RmluYW5jZUNvbmZpZy5vcmRlclN0YXRlcyAhPSAnJykgeyAvLzMgNFxuICAgICAgICAgICAgICAgICAgICAgICAgcC5vcmRlclN0YXRlcyA9ICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcub3JkZXJTdGF0ZXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuaXNJbnZvaWNlICE9PSAnJykgeyAvLyAwICAxXG4gICAgICAgICAgICAgICAgICAgICAgICBwLmlzSW52b2ljZSA9ICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuaXNJbnZvaWNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucXVlcnlGaW5hbmNlQ29uZmlnLmlzVXBkYXRlVGltZSkgeyAvLzFcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuaXNVcGRhdGVUaW1lID0gJHNjb3BlLnF1ZXJ5RmluYW5jZUNvbmZpZy5pc1VwZGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuaXNJbnZvaWNlTnVtICE9PSAnJykgeyAvLzAgMVxuICAgICAgICAgICAgICAgICAgICAgICAgcC5pc0ludm9pY2VOdW0gPSAkc2NvcGUucXVlcnlGaW5hbmNlQ29uZmlnLmlzSW52b2ljZU51bTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmluYW5jZVNlcnZpY2UucXVlcnlGaW5hbmNlTGlzdChwKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5maW5hbmNlcyA9IHJlcy5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0luZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlLm9mZnNldCArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5nZXRGaW5hbmNlTGlzdCgpO1xuICAgICAgICAkc2NvcGUuY29uZmlybVBheW1lbnREaWFsb2c7XG4gICAgICAgICRzY29wZS5pbnZvaWNlRGlhbG9nO1xuICAgICAgICAkc2NvcGUuY29uZmlybVBheW1lbnRQYXJhbSA9IHtcbiAgICAgICAgICAgIHJlZklkOiAnJyxcbiAgICAgICAgICAgIGR1ZUZlZTogJycsIC8v5LyB5Lia5bqU5LuY5qy+XG4gICAgICAgICAgICBiYWREZWJ0RmVlOiAnJywgLy/lnY/otKbmirXmiaPpop1cbiAgICAgICAgICAgIHJlY2VpdmVGZWU6ICcnLCAvL+S8geS4muWIsOi0pumHkeminVxuICAgICAgICAgICAgcmVjZWl2ZUZlZVRpbWU6ICcnLCAvL+WIsOi0puaXtumXtFxuICAgICAgICAgICAgcmVjZWl2ZUZlZVRpbWVIb3VyOiAnJ1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuaW52b2ljZVBhcmFtID0ge1xuICAgICAgICAgICAgcmVmSWQ6ICcnLFxuICAgICAgICAgICAgaW52b2ljZUZlZTogMCxcbiAgICAgICAgICAgIGludm9pY2VOdW1iZXI6ICcnLFxuICAgICAgICAgICAgZXhwcmVzc051bWJlcjogJycsXG4gICAgICAgICAgICBleHByZXNzQ29tcGFueToge30sXG4gICAgICAgICAgICBuZWVkRXhwcmVzc051bWJlcjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZXhwcmVzc0NvbXBhbnlDaG9pY2UgPSBDT05TVEFOVFMuZ2V0TGlzdCgnRVhQUkVTU19DT01QQU5ZX1RZUEUnLCBmYWxzZSk7XG4gICAgICAgICRzY29wZS5jdXJyZW50T3JkZXIgPSB7fTtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5RmluYW5jZUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuZmluYW5jZVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5vcGVuRmluYW5jZURldGFpbCA9IGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRPcmRlciA9IG9yZGVyO1xuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLmNoZWNrT3JkZXJEZXRhaWwoQ09OU1RBTlRTLk9SREVSX1RZUEUuU0VUVExFTUVOVCwgb3JkZXIub3JkZXJJZCwgJHNjb3BlKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEZpbmFuY2VDb21wYW55ID0gZnVuY3Rpb24gKGNvbXBhbnkpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcuY29tcGFueSA9IGNvbXBhbnk7XG4gICAgICAgICAgICAkc2NvcGUuZmluYW5jZVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuICAgICAgICAvL+ihqOagvOS4reWvvOWHumV4Y2VsXG4gICAgICAgICRzY29wZS5leHBvcnRFeGNlbCA9IGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRPcmRlciA9IG9yZGVyO1xuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLmV4cG9ydEV4Y2VsKENPTlNUQU5UUy5PUkRFUl9UWVBFLlNFVFRMRU1FTlQsIG9yZGVyLm9yZGVySWQsICRzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zaG93SW5vdmljZUFuZFBheW1lbnRXaW4gPSBmdW5jdGlvbiAob3JkZXIsIHNjb3BlLCB0eXBlKSB7XG4gICAgICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLmNvbmZpcm1QYXltZW50UGFyYW0ucmVmSWQgPSBvcmRlci5vcmRlcklkO1xuICAgICAgICAgICAgICAgIHNjb3BlLmNvbmZpcm1QYXltZW50UGFyYW0uZHVlRmVlID0gJGZpbHRlcigncm1iJykoc2NvcGUuY3VycmVudE9yZGVyLm9yZGVyRmVlKTtcbiAgICAgICAgICAgICAgICBzY29wZS5jb25maXJtUGF5bWVudFBhcmFtLmJhZERlYnRGZWUgPSAkZmlsdGVyKCdybWInKShvcmRlci5vcmRlckRpc2NvdW50KTtcbiAgICAgICAgICAgICAgICBzY29wZS5jb25maXJtUGF5bWVudFBhcmFtLnJlY2VpdmVGZWUgPSAnJztcbiAgICAgICAgICAgICAgICBzY29wZS5jb25maXJtUGF5bWVudFBhcmFtLnJlY2VpdmVGZWVUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgc2NvcGUuY29uZmlybVBheW1lbnRQYXJhbS5yZWNlaXZlRmVlVGltZUhvdXIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICBzY29wZS5jb25maXJtUGF5bWVudERpYWxvZy5zaG93RGlhbG9nKCRzY29wZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNjb3BlLmludm9pY2VQYXJhbS5yZWZJZCA9IG9yZGVyLm9yZGVySWQ7XG4gICAgICAgICAgICAgICAgc2NvcGUuaW52b2ljZVBhcmFtLmludm9pY2VOdW1iZXIgPSAnJztcbiAgICAgICAgICAgICAgICBzY29wZS5pbnZvaWNlUGFyYW0uaW52b2ljZUZlZSA9ICcnO1xuICAgICAgICAgICAgICAgIHNjb3BlLmludm9pY2VQYXJhbS5leHByZXNzQ29tcGFueSA9ICRzY29wZS5leHByZXNzQ29tcGFueUNob2ljZVswXTtcbiAgICAgICAgICAgICAgICBzY29wZS5pbnZvaWNlUGFyYW0uZXhwcmVzc051bWJlciA9ICcnO1xuICAgICAgICAgICAgICAgIHNjb3BlLmludm9pY2VEaWFsb2cuc2hvd0RpYWxvZygkc2NvcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUucHJpbnRPcmRlciA9IGZ1bmN0aW9uIChvcmRlclR5cGUpIHtcbiAgICAgICAgICAgIHZhciBodG1sID0gb3JkZXJTZXJ2aWNlLmdldFByaW50SHRtbEluT3JkZXJNb2R1bGUob3JkZXJUeXBlKTtcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgICAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcihodG1sKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2xvc2VDb25maXJtUGF5bWVudFdpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5jb25maXJtUGF5bWVudERpYWxvZy5jbG9zZURpYWxvZygpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2xvc2VJbnZvaWNlV2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmludm9pY2VEaWFsb2cuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNvbmZpcm1QYXltZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZmluYW5jZVNlcnZpY2UuY29uZmlybVBheW1lbnQoYW5ndWxhci5jb3B5KCRzY29wZS5jb25maXJtUGF5bWVudFBhcmFtKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlQ29uZmlybVBheW1lbnRXaW4oKTtcbiAgICAgICAgICAgICAgICBvcmRlclNlcnZpY2UuY2hlY2tPcmRlckRldGFpbChDT05TVEFOVFMuT1JERVJfVFlQRS5TRVRUTEVNRU5ULCAkc2NvcGUuY3VycmVudE9yZGVyLm9yZGVySWQsICRzY29wZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNyZWF0ZUludm9pY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmaW5hbmNlU2VydmljZS5jcmVhdGVJbnZvaWNlKGFuZ3VsYXIuY29weSgkc2NvcGUuaW52b2ljZVBhcmFtKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlSW52b2ljZVdpbigpO1xuICAgICAgICAgICAgICAgIG9yZGVyU2VydmljZS5jaGVja09yZGVyRGV0YWlsKENPTlNUQU5UUy5PUkRFUl9UWVBFLlNFVFRMRU1FTlQsICRzY29wZS5jdXJyZW50T3JkZXIub3JkZXJJZCwgJHNjb3BlLCB0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0RXhwcmVzc0NvbXBhbnkgPSBmdW5jdGlvbiAoZXhwcmVzc0NvbXBhbnkpIHtcbiAgICAgICAgICAgICRzY29wZS5pbnZvaWNlUGFyYW0uZXhwcmVzc0NvbXBhbnkgPSBleHByZXNzQ29tcGFueTtcbiAgICAgICAgICAgIGlmIChleHByZXNzQ29tcGFueS5jb2RlID09IENPTlNUQU5UUy5FWFBSRVNTX0NPTVBBTllfVFlQRS5YSUVEQUkpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW52b2ljZVBhcmFtLm5lZWRFeHByZXNzTnVtYmVyID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnZvaWNlUGFyYW0ubmVlZEV4cHJlc3NOdW1iZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0T3JkZXJTdGF0ZSA9IGZ1bmN0aW9uIChjaG9pY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeUZpbmFuY2VDb25maWcub3JkZXJTdGF0ZXMgPSBjaG9pY2UuY29kZTtcbiAgICAgICAgICAgICRzY29wZS5maW5hbmNlVGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICAkc2NvcGUuZmluYW5jZVRhYmxlLnBhZ2UoMSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RJbnZvaWNlTmVlZFN0YXRlID0gZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5RmluYW5jZUNvbmZpZy5pc0ludm9pY2UgPSBjaG9pY2UuY29kZTtcbiAgICAgICAgICAgICRzY29wZS5maW5hbmNlVGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICAkc2NvcGUuZmluYW5jZVRhYmxlLnBhZ2UoMSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RJbnZvaWNlU3RhdGUgPSBmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlGaW5hbmNlQ29uZmlnLmlzSW52b2ljZU51bSA9IGNob2ljZS5jb2RlO1xuICAgICAgICAgICAgJHNjb3BlLmZpbmFuY2VUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICRzY29wZS5maW5hbmNlVGFibGUucGFnZSgxKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL+WvvOWHuuWNleaNruWIl+ihqFxuICAgICAgICB2YXIgY2hlY2tJbmZvID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciB0ID0gXy5maW5kV2hlcmUoJHNjb3BlLnNlbGVjdGVkT3JkZXJzICwge1xuICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBpdGVtLm9yZGVySWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jaGVja0FsbENmZyA9IHtcbiAgICAgICAgICAgIGZsYWc6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWLvumAiVxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbiA9IGZ1bmN0aW9uIChlLCBvcmRlcikge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoXy5pc09iamVjdChlKSkge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3JkZXIuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgICAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRPcmRlcnMucHVzaChvcmRlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3JkZXJzID0gXy53aXRob3V0KCRzY29wZS5zZWxlY3RlZE9yZGVycywgb3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0QWxsT3JkZXIgPSBmdW5jdGlvbiAoZSwgZGF0YSwgY2hlY2thbGwpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICB2YXIgc3QgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQgIT09IHN0KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24oZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5leHBvcnRPcmRlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLypzZWxlY3RlZE9yZGVycz1zZWxlY3RlZE9yZGVycy5jb25jYXQob3JkZXJzKTsqL1xuXG4gICAgICAgICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVySWQgPSAnZmluYW5jZS10YWJsZSc7XG4gICAgICAgICAgICB2YXIgbXlEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciBteXRpbWU9bXlEYXRlLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICBkb21bMF0uaHJlZiA9ICQoJyMnICsgY29udGFpbmVySWQpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcmlkOiBjb250YWluZXJJZCxcbiAgICAgICAgICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgICAgICAgICByZXR1cm5Vcmk6ICd0cnVlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkb21bMF0uZG93bmxvYWQgPSAn6LSi5Yqh566h55CGJyArICfvvIgnICsgbXl0aW1lICsgJ++8iScgKyAnLnhscyc7XG4gICAgICAgICAgICBkb21bMF0uY2xpY2soKTtcbiAgICAgICAgfTtcblxuICBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaJuemHj+WvvOWHumV4Y2VsXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUuYmF0Y2hFeHBvcnRFeGNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnNlbGVjdGVkT3JkZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5leHBvcnRPcmRlcigkc2NvcGUuc2VsZWN0ZWRPcmRlcnMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbGVydCgn6K+35YWI56Gu5a6a6ZyA6KaB5a+85Ye655qE5pWw5o2uISEhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmZpbHRlckl0ZW1zID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5jaGVja2VkID09IHRydWU7XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwiLyrpgInlk4HljZXljoblj7IqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ2dvb2RzQ2hvb3NlSGlzdG9yeUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRjb21waWxlLFxuICAgICR0ZW1wbGF0ZUNhY2hlLCBDT05TVEFOVFMsIG1vZGFsU2VydmljZSwgdXRpbFNlcnZpY2UsIE5nVGFibGVQYXJhbXMsXG4gICAgZ29vZHNDaG9vc2VTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLk9SREVSX1NUQVRFID0gQ09OU1RBTlRTLkdPT0RTQ0hPT1NFX09SREVSX1NUQVRFO1xuICAgICRzY29wZS5DT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgICRzY29wZS5vcmRlclN0YXRlcyA9IENPTlNUQU5UUy5nZXRMaXN0KCdHT09EU0NIT09TRV9PUkRFUl9TVEFURScpO1xuICAgICRzY29wZS5jdXJPcmRlclN0YXRlID0gJHNjb3BlLm9yZGVyU3RhdGVzWzBdO1xuXG4gICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge307XG4gICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgJHNjb3BlLmxpbWl0ID0gMTA7XG5cbiAgICAkc2NvcGUuc2V0T3JkZXJUYWJsZSA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0VGltZTtcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5lbmRUaW1lID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZFRpbWU7XG4gICAgICAkc2NvcGUub3JkZXJUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgY291bnQ6ICRzY29wZS5saW1pdFxuICAgICAgfSwge1xuICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAxMyxcbiAgICAgICAgcGFnaW5hdGlvbk1pbkJsb2NrczogMixcbiAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgcmV0dXJuIGdvb2RzQ2hvb3NlU2VydmljZS5xdWVyeU1hbmFnZXJPcmRlckxpc3Qoe1xuICAgICAgICAgICAgb2Zmc2V0OiAocGFyYW1zLnBhZ2UoKSAtIDEpICogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlJZCxcbiAgICAgICAgICAgIHN0YXJ0VGltZTogJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0VGltZSA/ICRzY29wZS5xdWVyeVBhcmFtc1xuICAgICAgICAgICAgICAuc3RhcnRUaW1lLmdldFRpbWUoKSA6IG51bGwsXG4gICAgICAgICAgICBlbmRUaW1lOiAkc2NvcGUucXVlcnlQYXJhbXMuZW5kVGltZSA/ICRzY29wZS5xdWVyeVBhcmFtc1xuICAgICAgICAgICAgICAuZW5kVGltZS5nZXRUaW1lKCkgOiBudWxsLFxuICAgICAgICAgICAgb3JkZXJTdGF0ZXM6IFskc2NvcGUuT1JERVJfU1RBVEUuRklOSVNILCAkc2NvcGUuT1JERVJfU1RBVEVcbiAgICAgICAgICAgICAgLlNZU19DQU5DTEVEXG4gICAgICAgICAgICBdXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgfTtcbiAgICAkc2NvcGUuc2V0T3JkZXJUYWJsZSgpO1xuXG4gICAgLy/moLnmja7kvIHkuJrmkJzntKJcbiAgICAkc2NvcGUuc2VhcmNoQnlDb21wYW55ID0gZnVuY3Rpb24oY29tcGFueSkge1xuICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlJZCA9IGNvbXBhbnkuY29tcGFueUlkO1xuICAgICAgJHNjb3BlLnNldE9yZGVyVGFibGUoKTtcbiAgICB9O1xuICAgIC8v5riF56m65LyB5Lia5pCc57SiXG4gICAgJHNjb3BlLmVtcHR5Q29tcGFueVNlYXJjaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgZGVsZXRlICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWQ7XG4gICAgfTtcbiAgICAvL+iOt+WPlumAiei0reWNleivpue7hlxuICAgIHZhciBnZXRPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIGdvb2RzQ2hvb3NlU2VydmljZS5xdWVyeU1hbmFnZXJPcmRlckRldGFpbCh7XG4gICAgICAgIG9yZGVySWQ6IG9wdHMub3JkZXJJZFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLm9yZGVyID0gcmVzO1xuICAgICAgICAkc2NvcGUub3JkZXIubmFtZSA9ICfpgInotK3ljZUnICsgJy0nICsgcmVzLmNvbXBhbnlOYW1lICsgJygnICtcbiAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcocmVzLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICBcInl5eXlNTWRkaGhtbXNzXCIpICsgJyknO1xuICAgICAgICBvcHRzLmRpZExvYWREYXRhKHJlcykgfHwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mn6XnnIvpgInotK3ljZXor6bnu4ZcbiAgICAkc2NvcGUuY2hlY2tPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICBnZXRPcmRlckRldGFpbCh7XG4gICAgICAgIG9yZGVySWQ6IG9yZGVyLm9yZGVySWQsXG4gICAgICAgIGRpZExvYWREYXRhOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUub3JkZXJNb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgICAnZ29vZHMtY2hvb3NlLWhpc3RvcnknKSksXG4gICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdnb29kc0Nob29zZU9yZGVyL2dvb2RzQ2hvb3NlT3JkZXJUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5omT5Y2wXG4gICAgJHNjb3BlLnByaW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIoJChcbiAgICAgICAgICAnI2dvb2RzLWNob29zZS1vcmRlci10YWJsZScpLnBhcmVudCgpLmh0bWwoKSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v6K+m5oOF6aG16Z2i5a+85Ye6RXhjZWxcbiAgICAkc2NvcGUuZXhwb3J0RXhjZWxPbkRldGFpbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLnVyaSA9ICQoXCIjZ29vZHMtY2hvb3NlLW9yZGVyLXRhYmxlXCIpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICBjb250YWluZXJpZDogJ2dvb2RzLWNob29zZS1vcmRlci10YWJsZScsXG4gICAgICAgIGRhdGF0eXBlOiAndGFibGUnLFxuICAgICAgICByZXR1cm5Vcmk6ICd0cnVlJ1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WcqOWIl+ihqOS4reWvvOWHukV4Y2VsXG4gICAgJHNjb3BlLmV4cG9ydEV4Y2VsT25MaXN0ID0gZnVuY3Rpb24ob3JkZXIpIHtcbiAgICAgIHZhciBleGNlbFRlbXBsYXRlID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KFxuICAgICAgICAnZ29vZHNDaG9vc2VPcmRlci9nb29kc0Nob29zZU9yZGVyVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRFeGNlbFdyYXAnKSkuYXBwZW5kKFxuICAgICAgICBleGNlbFRlbXBsYXRlKTtcblxuICAgICAgZ2V0T3JkZXJEZXRhaWwoe1xuICAgICAgICBvcmRlcklkOiBvcmRlci5vcmRlcklkLFxuICAgICAgICBkaWRMb2FkRGF0YTogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGRvbSA9IGFuZ3VsYXIuZWxlbWVudCgnPGE+PC9hPicpO1xuICAgICAgICAgICAgZG9tWzBdLmhyZWYgPSAkKCcjZ29vZHMtY2hvb3NlLW9yZGVyLXRhYmxlJykuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgICAgICAgIGNvbnRhaW5lcmlkOiBcImdvb2RzLWNob29zZS1vcmRlci10YWJsZVwiLFxuICAgICAgICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZG9tWzBdLmRvd25sb2FkID0gJHNjb3BlLm9yZGVyLm5hbWUgKyAnLnhscyc7XG4gICAgICAgICAgICBkb21bMF0uY2xpY2soKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG59IiwiLyrpgInlk4HljZUqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ2dvb2RzQ2hvb3NlT3JkZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRjb21waWxlLFxuICAgICR0ZW1wbGF0ZUNhY2hlLCBDT05TVEFOVFMsIG1vZGFsU2VydmljZSwgdXRpbFNlcnZpY2UsXG4gICAgZ29vZHNDaG9vc2VTZXJ2aWNlLCBOZ1RhYmxlUGFyYW1zLCBwcmludFNlcnZpY2UsIHNoZWxmU2VydmljZSkge1xuICAgICRzY29wZS5PUkRFUl9TVEFURSA9IENPTlNUQU5UUy5HT09EU0NIT09TRV9PUkRFUl9TVEFURTtcbiAgICB2YXIgT1JERVJfU1RBVEUgPSBDT05TVEFOVFMuR09PRFNDSE9PU0VfT1JERVJfU1RBVEU7XG4gICAgJHNjb3BlLkNPTVBBTllfVFlQRSA9IENPTlNUQU5UUy5DT01QQU5ZX1RZUEU7XG4gICAgJHNjb3BlLm9yZGVyU3RhdGVzID0gQ09OU1RBTlRTLmdldExpc3QoJ0dPT0RTQ0hPT1NFX09SREVSX1NUQVRFJyk7XG4gICAgJHNjb3BlLmN1ck9yZGVyU3RhdGUgPSAkc2NvcGUub3JkZXJTdGF0ZXNbMF07XG5cblxuICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHt9O1xuICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICRzY29wZS5saW1pdCA9IDEwMDAwO1xuXG4gICAgJHNjb3BlLnJlY29yZFBhcmFtcyA9IHt9O1xuXG4gICAgJHNjb3BlLnNldE9yZGVyVGFibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5vcmRlclRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICB9LCB7XG4gICAgICAgIGNvdW50czogW10sXG4gICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDEzLFxuICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICByZXR1cm4gZ29vZHNDaG9vc2VTZXJ2aWNlLnF1ZXJ5TWFuYWdlck9yZGVyTGlzdCh7XG4gICAgICAgICAgICBvZmZzZXQ6IChwYXJhbXMucGFnZSgpIC0gMSkgKiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkLFxuICAgICAgICAgICAgc3RhcnRUaW1lOiAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lID8gJHNjb3BlLnF1ZXJ5UGFyYW1zXG4gICAgICAgICAgICAgIC5zdGFydFRpbWUuZ2V0VGltZSgpIDogbnVsbCxcbiAgICAgICAgICAgIGVuZFRpbWU6ICRzY29wZS5xdWVyeVBhcmFtcy5lbmRUaW1lID8gJHNjb3BlLnF1ZXJ5UGFyYW1zXG4gICAgICAgICAgICAgIC5lbmRUaW1lLmdldFRpbWUoKSA6IG51bGwsXG4gICAgICAgICAgICBvcmRlclN0YXRlczogJHNjb3BlLmN1ck9yZGVyU3RhdGUuY29kZSAhPSAtMSA/IFtcbiAgICAgICAgICAgICAgJHNjb3BlLmN1ck9yZGVyU3RhdGUuY29kZVxuICAgICAgICAgICAgXSA6IFtPUkRFUl9TVEFURS5XQUlUX1ZFUklGWSwgT1JERVJfU1RBVEUuVkVSSUZJRURdXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgfTtcbiAgICAkc2NvcGUuc2V0T3JkZXJUYWJsZSgpO1xuICAgIC8v5qC55o2u5LyB5Lia5pCc57SiXG4gICAgJHNjb3BlLnNlYXJjaEJ5Q29tcGFueSA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWQgPSBjb21wYW55LmNvbXBhbnlJZDtcbiAgICAgICRzY29wZS5zZXRPcmRlclRhYmxlKCk7XG4gICAgfTtcbiAgICAvL+a4heepuuS8geS4muaQnOe0olxuICAgICRzY29wZS5lbXB0eUNvbXBhbnlTZWFyY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIGRlbGV0ZSAkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkO1xuICAgIH07XG4gICAgLy/liIfmjaLorqLljZXnirbmgIFcbiAgICAkc2NvcGUuc2VsZWN0T3JkZXJTdGF0ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICRzY29wZS5jdXJPcmRlclN0YXRlID0gaXRlbTtcbiAgICAgICRzY29wZS5zZXRPcmRlclRhYmxlKCk7XG4gICAgfTtcbiAgICAvL+iOt+WPlumAiei0reWNleivpue7hlxuICAgIHZhciBnZXRPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIGdvb2RzQ2hvb3NlU2VydmljZS5xdWVyeU1hbmFnZXJPcmRlckRldGFpbCh7XG4gICAgICAgIG9yZGVySWQ6IG9wdHMub3JkZXJJZFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLm9yZGVyID0gcmVzO1xuICAgICAgICAkc2NvcGUub3JkZXIubmFtZSA9ICfpgInotK3ljZUnICsgJy0nICsgcmVzLmNvbXBhbnlOYW1lICsgJygnICtcbiAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcocmVzLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICBcInl5eXlNTWRkaGhtbXNzXCIpICsgJyknO1xuICAgICAgICBvcHRzLmRpZExvYWREYXRhKHJlcykgfHwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mn6XnnIvpgInotK3ljZXmmI7nu4ZcbiAgICAkc2NvcGUuY2hlY2tPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICBnZXRPcmRlckRldGFpbCh7XG4gICAgICAgIG9yZGVySWQ6IG9yZGVyLm9yZGVySWQsXG4gICAgICAgIGRpZExvYWREYXRhOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUub3JkZXJNb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgICAnZ29vZHMtY2hvb3NlLW9yZGVyJykpLFxuICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZ29vZHNDaG9vc2VPcmRlci9nb29kc0Nob29zZU9yZGVyVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+ivpuaDhemhtemdouWvvOWHukV4Y2VsXG4gICAgJHNjb3BlLmV4cG9ydEV4Y2VsT25EZXRhaWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS51cmkgPSAkKFwiI2dvb2RzLWNob29zZS1vcmRlci10YWJsZVwiKS5leGNlbGV4cG9ydGpzKHtcbiAgICAgICAgY29udGFpbmVyaWQ6ICdnb29kcy1jaG9vc2Utb3JkZXItdGFibGUnLFxuICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/lnKjliJfooajkuK3lr7zlh7pFeGNlbFxuICAgICRzY29wZS5leHBvcnRFeGNlbE9uTGlzdCA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICB2YXIgZXhjZWxUZW1wbGF0ZSA9ICRjb21waWxlKCR0ZW1wbGF0ZUNhY2hlLmdldChcbiAgICAgICAgJ2dvb2RzQ2hvb3NlT3JkZXIvZ29vZHNDaG9vc2VPcmRlclRlbXBsYXRlLmh0bWwnKSkoJHNjb3BlKTtcbiAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0RXhjZWxXcmFwJykpLmFwcGVuZChcbiAgICAgICAgZXhjZWxUZW1wbGF0ZSk7XG5cbiAgICAgIGdldE9yZGVyRGV0YWlsKHtcbiAgICAgICAgb3JkZXJJZDogb3JkZXIub3JkZXJJZCxcbiAgICAgICAgZGlkTG9hZERhdGE6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkb20gPSBhbmd1bGFyLmVsZW1lbnQoJzxhPjwvYT4nKTtcbiAgICAgICAgICAgIGRvbVswXS5ocmVmID0gJCgnI2dvb2RzLWNob29zZS1vcmRlci10YWJsZScpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICAgICAgICBjb250YWluZXJpZDogXCJnb29kcy1jaG9vc2Utb3JkZXItdGFibGVcIixcbiAgICAgICAgICAgICAgZGF0YXR5cGU6ICd0YWJsZScsXG4gICAgICAgICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRvbVswXS5kb3dubG9hZCA9ICRzY29wZS5vcmRlci5uYW1lICsgJy54bHMnO1xuICAgICAgICAgICAgZG9tWzBdLmNsaWNrKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/miZPljbBcbiAgICAkc2NvcGUucHJpbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcigkKFxuICAgICAgICAgICcjZ29vZHMtY2hvb3NlLW9yZGVyLXRhYmxlJykucGFyZW50KCkuaHRtbCgpKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mibnph4/miZPljbBcbiAgICAkc2NvcGUuYmF0Y2hQcmludCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgfTtcbiAgICAvL+WPlua2iOatpOWNlVxuICAgICRzY29wZS5jYWNlbE9yZGVyID0gZnVuY3Rpb24ob3JkZXIpIHtcbiAgICAgIG9wZW5SZWNvcmRNb2RhbChvcmRlciwgQ09OU1RBTlRTLkdPT0RTQ0hPT1NFX09SREVSX1NUQVRFLlNZU19DQU5DTEVEKTtcbiAgICB9O1xuICAgIC8v5o6l5pS2XG4gICAgJHNjb3BlLnJlY2VpdmVPcmRlciA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICBvcGVuUmVjb3JkTW9kYWwob3JkZXIsIENPTlNUQU5UUy5HT09EU0NIT09TRV9PUkRFUl9TVEFURS5WRVJJRklFRCk7XG4gICAgfTtcbiAgICAvL+WIm+W7uumAiei0reWNlVxuICAgICRzY29wZS5jcmVhdGVQaWNrT3JkZXIgPSBmdW5jdGlvbihvcmRlcikge1xuXG4gICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnlJZCh7XG4gICAgICAgIGNvbXBhbnlJZDogb3JkZXIuY29tcGFueUlkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBpZiAocmVzLmxlbmd0aCkge1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyNkZWxpdmVyeUVkaXQvMC8nICsgb3JkZXIub3JkZXJJZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhbGVydCgn6K+l5LyB5Lia5pqC5peg6LSn5p6277yM5peg5rOV5Yib5bu65ouj6LSn5Y2VIScpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIH07XG4gICAgLy/miZPlvIDlrqLmu6HlpIfms6gg5aGr5YaZ5qGGXG4gICAgdmFyIG9wZW5SZWNvcmRNb2RhbCA9IGZ1bmN0aW9uKG9yZGVyLCByZWNvcmRUeXBlKSB7XG4gICAgICAkc2NvcGUucmVjb3JkUGFyYW1zLnR5cGUgPSByZWNvcmRUeXBlO1xuICAgICAgJHNjb3BlLnJlY29yZFBhcmFtcy5vcmRlcklkID0gb3JkZXIub3JkZXJJZDtcbiAgICAgICRzY29wZS5yZWNvcmRQYXJhbXMub3B0UmVjb3JkID0gJyc7XG4gICAgICAkc2NvcGUucmVjb3JkTW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICdnb29kcy1jaG9vc2Utb3JkZXInKSksXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWxSZWNvcmQnXG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5a6i5ruh5aSH5rOoIOehruWumlxuICAgICRzY29wZS5jb25maXJtUmVjb3JkID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICBnb29kc0Nob29zZVNlcnZpY2UubW9kaWZ5T3JkZXJTdGF0ZSh7XG4gICAgICAgIG9yZGVySWQ6IHBhcmFtcy5vcmRlcklkLFxuICAgICAgICBvcmRlclN0YXRlOiBwYXJhbXMudHlwZSxcbiAgICAgICAgb3B0UmVjb3JkOiBwYXJhbXMub3B0UmVjb3JkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUub3JkZXJNb2RhbC5jbG9zZSgpO1xuICAgICAgICAkc2NvcGUucmVjb3JkTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgJHNjb3BlLm9yZGVyVGFibGUucmVsb2FkKCk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuXG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFwcCkge1xuICAgIGFwcC5jb250cm9sbGVyKCdob2xpZGF5V2VsZmFyZScsIGZ1bmN0aW9uICgkc2NvcGUsIE5nVGFibGVQYXJhbXMsIGhvbGlkYXlXZWxmYXJlU2VydmljZSwgJHVpYk1vZGFsLCBtb2RhbFNlcnZpY2UsIHV0aWxTZXJ2aWNlLCBwcmludFNlcnZpY2UsIENPTlNUQU5UUywgJG1kRGlhbG9nLCBvcmRlclNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLmhvbGlkYXlXZWxmYXJlID0ge307XG4gICAgICAgICRzY29wZS53ZWxmYXJlVGltZSA9IHtcbiAgICAgICAgICAgIHNjaGVkdWxlZFRpbWU6ICcnLFxuICAgICAgICAgICAgc2NoZWR1bGVkVGltZURhdGU6ICcnLFxuICAgICAgICAgICAgc2VsbGluZ1RpbWU6ICcnLFxuICAgICAgICAgICAgc2VsbGluZ1RpbWVEYXRlOiAnJyxcbiAgICAgICAgICAgIG92ZXJUaW1lOiAnJyxcbiAgICAgICAgICAgIG92ZXJUaW1lRGF0ZTogJydcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm9yZGVyID0ge307XG4gICAgICAgICRzY29wZS5zZXR0bGVtZW50T3JkZXIgPSB7fTtcbiAgICAgICAgJHNjb3BlLlBBWU1FTlRfU1RBVFVTID0gQ09OU1RBTlRTLlBBWU1FTlRfU1RBVFVTOyAgIC8vIOaUr+S7mOeKtuaAgVxuICAgICAgICAkc2NvcGUuT1JERVJfU1RBVFVTID0gQ09OU1RBTlRTLk9SREVSX1NUQVRVUzsgICAvL+iuouWNleeKtuaAgVxuICAgICAgICAkc2NvcGUuQlVZX1RZUEUgPSBDT05TVEFOVFMuQlVZX1RZUEU7IC8v6LSt5Lmw57G75Z6LXG4gICAgICAgIHZhciBPUkRFUl9TVEFUVVMgPSAkc2NvcGUuT1JERVJfU1RBVFVTO1xuICAgICAgICAkc2NvcGUuT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFOyAvL+iuouWNleexu+Wei1xuICAgICAgICAkc2NvcGUucGF5bWVudDtcbiAgICAgICAgJHNjb3BlLnByaW1hcnlCdG5UZXh0cyA9IHtcbiAgICAgICAgICAgIDE6ICfmlLbliLDmrL7pobknLFxuICAgICAgICAgICAgMjogJ+WujOaIkOmFjemAgSdcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm9yZGVyU3RhdHVzID0ge307XG4gICAgICAgICRzY29wZS5zZXR0bGVtZW50V2F5ID0ge307XG4gICAgICAgICRzY29wZS5xdWVyeVdlbGZhcmVPcmRlclBhcmFtcyA9IHt9O1xuICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBwYXlDaGFubmVsczogJycsIC8vIOaUr+S7mOeKtuaAgVxuICAgICAgICAgICAgc3RhdHVzOiAnJywgLy8g6K6i5Y2V54q25oCBXG4gICAgICAgICAgICBzdGFydFRpbWU6ICcnLCAvL+W8gOWni+aXtumXtFxuICAgICAgICAgICAgZW5kVGltZTogJycsIC8v57uT5p2f5pe26Ze0XG4gICAgICAgICAgICBjb21wYW55SWRzOiAnJyAvL+WFrOWPuElEXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWFyY2hCeUNvbXBhbnkgPSBmdW5jdGlvbiAoY29tcGFueSkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlJZHMgPSBjb21wYW55LmNvbXBhbnlJZDtcbiAgICAgICAgICAgICRzY29wZS5nZXRIb2xpZGF5V2VsZmFyZUxpc3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/pgInmi6nmlK/ku5jnirbmgIFcbiAgICAgICAgJHNjb3BlLnNlbGVjdFBheW1lbnRTdGF0dXMgPSBmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMucGF5Q2hhbm5lbHMgPSBjaG9pY2UuY29kZTtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5wYWdlKDEpO1xuICAgICAgICB9O1xuICAgICAgICAvL+mAieiuouWNleeKtuaAgVxuICAgICAgICAkc2NvcGUuc2VsZXN0T3JkZXJTdGF0dXMgPSBmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhdHVzID0gY2hvaWNlLmNvZGU7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucGFnZSgxKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqKlxuICAgICAgICAgKiDojrflj5boioLlgYfml6Xnpo/liKnlhajpg6jorqLljZVcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5nZXRIb2xpZGF5V2VsZmFyZUxpc3QgPSBmdW5jdGlvbiAocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDIwLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICRzY29wZS5vcmRlclN0YXR1cy5jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5Q2hhbm5lbHM6ICRzY29wZS5zZXR0bGVtZW50V2F5LmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAxXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkcyAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuY29tcGFueUlkcyA9ICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWRzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBTZGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5xdWVyeVBhcmFtcy5zdGFydFRpbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBFZGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5xdWVyeVBhcmFtcy5lbmRUaW1lKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTigkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5zdGFydFRpbWUgPSBuZXcgRGF0ZShTZGF0ZS5nZXRGdWxsWWVhcigpLCBTZGF0ZS5nZXRNb250aCgpLCBTZGF0ZS5nZXREYXRlKCksIDAsIDAsIDApLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKCRzY29wZS5xdWVyeVBhcmFtcy5lbmRUaW1lKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwLmVuZFRpbWUgPSBuZXcgRGF0ZShFZGF0ZS5nZXRGdWxsWWVhcigpLCBFZGF0ZS5nZXRNb250aCgpLCBFZGF0ZS5nZXREYXRlKCksIDIzLCA1OSwgNTkpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaG9saWRheVdlbGZhcmVTZXJ2aWNlLmdldEFsbFdlbGZhcmVPcmRlcnMoYW5ndWxhci5jb3B5KHApKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGhvbGlkYXlXZWxmYXJlU2VydmljZS5wYXJzZURhdGEocmVzLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0luZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShhLCAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmdldEhvbGlkYXlXZWxmYXJlTGlzdCgpO1xuXG4gICAgICAgIC8q5omT5Y2wKi9cbiAgICAgICAgLy/miZPljbDljZXmja7liJfooahcbiAgICAgICAgdmFyIHByaW50T3JkZXJBcnJheSA9IFtdO1xuICAgICAgICB2YXIgY2hlY2tJbmZvID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKHByaW50T3JkZXJBcnJheSwge1xuICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBpdGVtLm9yZGVySWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jaGVja0FsbENmZyA9IHtcbiAgICAgICAgICAgIGZsYWc6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDli77pgIlcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbiAoZSwgb3JkZXIpIHtcbiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoXy5pc09iamVjdChlKSkge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3JkZXIuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgICAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBwcmludE9yZGVyQXJyYXkucHVzaChvcmRlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcHJpbnRPcmRlckFycmF5ID0gXy53aXRob3V0KHByaW50T3JkZXJBcnJheSwgb3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0QWxsT3JkZXIgPSBmdW5jdGlvbiAoZSwgZGF0YSwgY2hlY2thbGwpIHtcbiAgICAgICAgICAgIHZhciBzdCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCAhPT0gc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbihlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZCwgaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqKlxuICAgICAgICAgKiDmibnph4/miZPljbBcbiAgICAgICAgICovXG5cbiAgICAgICAgLy/miZPljbBcbiAgICAgICAgJHNjb3BlLnByaW50T3JkZXIgPSBmdW5jdGlvbiAob3JkZXJzKSB7XG4gICAgICAgICAgICB2YXIgdGVtcHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBhVGVtcHMgPSBbXTtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob3JkZXJzKSA9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICAgICAgYVRlbXBzID0gb3JkZXJzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhVGVtcHMgPSBbb3JkZXJzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhVGVtcHMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdGVtcHMucHVzaChpdGVtLmlkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaG9saWRheVdlbGZhcmVTZXJ2aWNlLmdldEFsbFdlbGZhcmVPcmRlcnMoe1xuICAgICAgICAgICAgICAgIC8vIGlkczpfLnBsdWNrKG9yZGVycywnaWQnKVxuICAgICAgICAgICAgICAgIGlkczogdGVtcHNcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIHZhciBob2xpZGF5T3JkZXJEZXRhaWxzID0gcmVzLmNvbnRlbnQgfHwgW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzUHJpbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRlbXBzID0gb3JkZXJTZXJ2aWNlLnByaW50T3JkZXJEb21zKGhvbGlkYXlPcmRlckRldGFpbHMsICRzY29wZS5PUkRFUl9UWVBFLkhPTElEQVksICRzY29wZSk7XG4gICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0ZW1wcyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRlbXBzKTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlbXBzLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW1bMF0uaW5uZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzLnB1c2goaXRlbVswXS5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcihodG1scyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGh0bWxzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuYmF0aE11bHRpUHJpbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAocHJpbnRPcmRlckFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wcmludE9yZGVyKHByaW50T3JkZXJBcnJheSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6JyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICfor7fpgInmi6npnIDopoHmiZPljbDnmoTnpajmja4nLFxuICAgICAgICAgICAgICAgICAgICBvazogJ+ehruiupCdcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8qKipcbiAgICAgICAgICog5piO57uGXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUub3JkZXJEZXRhaWwgPSBmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICAvKmlmIChvcmRlci5vcmRlci5zdGF0dXMgPT0gXCIyXCIpIHtcbiAgICAgICAgICAgICAkc2NvcGUucGF5bWVudCA9IHRydWU7XG4gICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob2xpZGF5V2VsZmFyZScpKSxcbiAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnb3JkZXIvaG9saWRheVdlbGZhcmVQYXJ0aWN1bGFyc1RlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlciA9IG9yZGVyO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyLm5hbWUgPSBvcmRlci5hZGRyZXNzLmNvbnRhY3ROYW1lICsgJy0nICsgb3JkZXIub3JkZXIuZXZlbnRUaXRsZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKioqXG4gICAgICAgICAqIOaYjue7hiAtLT4g5omT5Y2wXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUuaG9saWRheVdlbGZhcmVEZXRhaWxQcmludCA9IGZ1bmN0aW9uIChvcmRlclR5cGUpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICB2YXIgaHRtbCA9IG9yZGVyU2VydmljZS5nZXRQcmludEh0bWxJbk9yZGVyTW9kdWxlKG9yZGVyVHlwZSk7XG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGh0bWwpO1xuICAgICAgICAgICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIoaHRtbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIC8qKipcbiAgICAgICAgICog6IqC5YGH5pel6K6i6LSt5Y2V5piO57uG5a+85Ye6RXhjZWzooajmoLxcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5leHBvcnRFeGNlbE9uRGV0YWlsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnVyaSA9ICQoXCIjaG9saWRheS13ZWxmYXJlLW9yZGVyLWRldGFpbC10YWJsZVwiKS5leGNlbGV4cG9ydGpzKHtcbiAgICAgICAgICAgICAgICBjb250YWluZXJpZDogJ2hvbGlkYXktd2VsZmFyZS1vcmRlci1kZXRhaWwtdGFibGUnLFxuICAgICAgICAgICAgICAgIGRhdGF0eXBlOiAndGFibGUnLFxuICAgICAgICAgICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuICAgICAgICAvKioqXG4gICAgICAgICAqIOS/ruaUueiuouWNleeKtuaAgVxuICAgICAgICAgKi9cbiAgICAgICAgLy9cbiAgICAgICAgJHNjb3BlLm1vZGlmeU9yZGVyU3RhdHVzID0gZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge29yZGVySWQ6IG9yZGVyLm9yZGVyLmlkLCBub3RlczogJyd9O1xuICAgICAgICAgICAgc3dpdGNoIChvcmRlci5vcmRlci5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1NUQVRVUy5XQUlUSU5HX1BBWU1FTlQ6Ly/lvoXmlLbmrL5cbiAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVQYXltZW50KHBhcmFtcywgb3JkZXIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1NUQVRVUy5XQUlUSU5HX0RJU1RSSUJVVElPTjovL+W+hemFjemAgVxuICAgICAgICAgICAgICAgICAgICBfY29tcGxldGVEZWxpdmVyeShwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLyoqKlxuICAgICAgICAgKiDmlLbliLDmrL7poblcbiAgICAgICAgICovXG4gICAgICAgIHZhciBfcmVjZWl2ZVBheW1lbnQgPSBmdW5jdGlvbiAocGFyYW1zLCBvcmRlcikge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIGhvbGlkYXlXZWxmYXJlU2VydmljZS5yZWNlaXZlUGF5bWVudChwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIC8vIG9yZGVyLm9yZGVyLnBheUNoYW5uZWwgPSBDT05TVEFOVFMuUEFZTUVOVF9TVEFUVVMuQkFOS19DQVJEO1xuICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRIb2xpZGF5V2VsZmFyZUxpc3QoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDlrozmiJDphY3pgIFcbiAgICAgICAgICovXG4gICAgICAgIHZhciBfY29tcGxldGVEZWxpdmVyeSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIGhvbGlkYXlXZWxmYXJlU2VydmljZS5jb21wbGV0ZURlbGl2ZXJ5KHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEhvbGlkYXlXZWxmYXJlTGlzdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKipcbiAgICAgICAgICog5piO57uGIC0tPiDlj5bmtojmraTljZVcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5jYWNlbE9yZGVyID0gZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge29yZGVySWQ6IG9yZGVyLm9yZGVyLmlkLCBub3RlczogJyd9O1xuICAgICAgICAgICAgaG9saWRheVdlbGZhcmVTZXJ2aWNlLmNhbmNlbE9yZGVyKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEhvbGlkYXlXZWxmYXJlTGlzdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqKlxuICAgICAgICAgKiDlhajpg6jnu5PnrpfkuIvmi4nnrZvpgIlcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5zZXR0bGVtZW50U3RhdHVzTGlzdCA9IENPTlNUQU5UUy5nZXRMaXN0KHtcbiAgICAgICAgICAgIGNsc09yTmFtZTogJ1BBWU1FTlRfU1RBVFVTJyxcbiAgICAgICAgICAgIGRlZmF1bHRPYmo6IHtcbiAgICAgICAgICAgICAgICAnJzogJ+WFqOmDqOe7k+eulydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS5fc2V0dGxlbWVudFdheSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgJHNjb3BlLnNldHRsZW1lbnRXYXkgPSBpdGVtO1xuICAgICAgICAgICAgJHNjb3BlLmdldEhvbGlkYXlXZWxmYXJlTGlzdCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKipcbiAgICAgICAgICog5YWo6YOo6K6i5Y2V5LiL5ouJ562b6YCJXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUub3JkZXJTdGF0dXNMaXN0ID0gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgICAgICAgY2xzT3JOYW1lOiAnT1JERVJfU1RBVFVTJyxcbiAgICAgICAgICAgIGRlZmF1bHRPYmo6IHtcbiAgICAgICAgICAgICAgICAnJzogJ+WFqOmDqOiuouWNlSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS5fb3JkZXJTdGF0dXMgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyU3RhdHVzID0gaXRlbTtcbiAgICAgICAgICAgICRzY29wZS5nZXRIb2xpZGF5V2VsZmFyZUxpc3QoKTtcbiAgICAgICAgfTtcbiAgICB9KVxufTtcblxuIiwiLypcbiAq6aaW6aG1XG4gKmhvbWVDb250cm9sbGVyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFwcCkge1xuICBhcHAuY29udHJvbGxlcignaG9tZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAkc2NvcGUucG9ydHMgPSBbe1xuICAgICAgbmFtZTogJ+S/oeaBr+mFjee9ricsXG4gICAgICByb3V0ZTogJyNjb25maWd1cmF0aW9uSW5mb3JtYXRpb24nLFxuICAgICAgaW1nOiAnLi9pbWcvY29uZmlndXJhdGlvbkluZm9ybWF0aW9uLnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5LyB5Lia5bqTJyxcbiAgICAgIHJvdXRlOiAnI2NvbXBhbnknLFxuICAgICAgaW1nOiAnLi9pbWcvaWNvbi1jb21wYW55LnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5LyB5Lia6LSn5p62566h55CGJyxcbiAgICAgIHJvdXRlOiAnI3NoZWxmTWFuYWdlJyxcbiAgICAgIGltZzogJy4vaW1nL2ljb24tc2hlbGYucG5nJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICfmlrDlk4HmjqjojZAnLFxuICAgICAgcm91dGU6ICcjbmV3UHJvZHVjdFJlY29tbWVuZCcsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLXByb2R1Y3QucG5nJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICfllYblk4HnrqHnkIYnLFxuICAgICAgcm91dGU6ICcjcHJvZHVjdCcsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLXByb2R1Y3QucG5nJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICfllYblk4HmoIfnrb7nrqHnkIYnLFxuICAgICAgcm91dGU6ICcjbGFiZWxzTWFuYWdlbWVudCcsXG4gICAgICBpbWc6ICcuL2ltZy9sYWJlbHNNYW5hZ2VtZW50LnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5ZWG5ZOB5pWw5o2u57uf6K6hJyxcbiAgICAgIHJvdXRlOiAnI3NhbGVzU3RhdGlzdGljcycsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLW1hcmtldGluZy5wbmcnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ+S8geS4muiQpemUgOaVsOaNricsXG4gICAgICByb3V0ZTogJycsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLW1hcmtldGluZy5wbmcnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ+i0p+aetuW3oeafpScsXG4gICAgICByb3V0ZTogJyNzaGVsZicsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLWNoZWNrLnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5Y2V5o2u5Lit5b+DJyxcbiAgICAgIHJvdXRlOiAnJyxcbiAgICAgIGltZzogJy4vaW1nL2ljb24tdGlja2V0LnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn6LSm5Y+3566h55CGJyxcbiAgICAgIHJvdXRlOiAnI2FjY291bnQnLFxuICAgICAgaW1nOiAnLi9pbWcvaWNvbi1hY2NvdW50LnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5Zue5LuT5Y2VJyxcbiAgICAgIHJvdXRlOiAnI2luU3RvcmFnZScsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLWluLXN0b3JhZ2UucG5nJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICfkv6Hmga/mlLbpm4YnLFxuICAgICAgcm91dGU6ICcnLFxuICAgICAgaW1nOiAnLi9pbWcvaWNvbi1pbi1zdG9yYWdlLnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn6IqC5YGH5pel56aP5YipJyxcbiAgICAgIHJvdXRlOiAnI2hvbGlkYXlXZWxmYXJlJyxcbiAgICAgIGltZzogJy4vaW1nL2hvbGlkYXlXZWxmYXJlLnBuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5pyf5Y+35a6e5pe25Yqo5oCBJyxcbiAgICAgIHJvdXRlOiAnI2lzc3VlRHluYW1pYycsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLWlzc3VlRHluYW1pYy5wbmcnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ+Wll+mkkOmFjemAgeWKqOaAgScsXG4gICAgICByb3V0ZTogJyNzdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWMnLFxuICAgICAgaW1nOiAnLi9pbWcvaWNvbi1zdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWMucG5nJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICflpZfppJDphY3nva7nrqHnkIYnLFxuICAgICAgcm91dGU6ICcjc3VpdGVDZmdNYW5hZ2UnLFxuICAgICAgaW1nOiAnLi9pbWcvaWNvbi1zdWl0ZUNmZ01hbmFnZS5wbmcnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ+WQjue7reabtOWkmuWTpicsXG4gICAgICByb3V0ZTogJycsXG4gICAgICBpbWc6ICcuL2ltZy9pY29uLW1hcmtldGluZy5wbmcnXG4gICAgfV07XG4gIH0pO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuXHRhcHAuY29udHJvbGxlcignaW5TdG9yYWdlJywgZnVuY3Rpb24oJHNjb3BlLCAkY29tcGlsZSwgJHRlbXBsYXRlQ2FjaGUsIENPTlNUQU5UUywgbW9kYWxTZXJ2aWNlLCBOZ1RhYmxlUGFyYW1zLCBpblN0b3JhZ2VTZXJ2aWNlLCB1dGlsU2VydmljZSwgY29tcGFueVNlcnZpY2UsIHByb2R1Y3RTZXJ2aWNlLCBhY2NvdW50U2VydmljZSxvcmRlclNlcnZpY2UpIHtcblx0XHQkc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcblx0XHQkc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuXHRcdCRzY29wZS50aWNrZXRUeXBlID0gQ09OU1RBTlRTLklOX1NUT1JBR0VfT1JERVJfVFlQRTtcblx0XHQkc2NvcGUucHJvZml0TGV2ZWwgPSBDT05TVEFOVFMuUFJPRklUX0xFVkVMO1xuXHRcdCRzY29wZS5xdWVyeVBhcmFtcyA9IHt9O1xuXHRcdCRzY29wZS5vZmZzZXQgPSAwO1xuXHRcdCRzY29wZS5saW1pdCA9IDI1O1xuXHRcdCRzY29wZS5xdWVyeVBhcmFtcy5zdGFydFRpbWUgPSBuZXcgRGF0ZSh1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJykgKyAnIDAwOjAwOjAwJyk7XG5cdFx0JHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZFRpbWUgPSBuZXcgRGF0ZSh1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKSArIFwiIDIzOjU5OjU5XCIpO1xuXHRcdHZhciBpbml0VmlldyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGV4Y2VsVGVtcGxhdGUxID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KCdpblN0b3JhZ2UvZGVsaXZlcnlJblN0b3JhZ2VUZW1wbGF0ZS5odG1sJykpKCRzY29wZSk7XG5cdFx0XHRhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydEV4Y2VsV3JhcCcpKS5hcHBlbmQoZXhjZWxUZW1wbGF0ZTEpO1xuXHRcdFx0dmFyIGV4Y2VsVGVtcGxhdGUyID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KCdpblN0b3JhZ2UvcmVmdW5kSW5TdG9yYWdlVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuXHRcdFx0YW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRFeGNlbFdyYXAnKSkuYXBwZW5kKGV4Y2VsVGVtcGxhdGUyKTtcblx0XHR9O1xuXHRcdGluaXRWaWV3KCk7XG5cdFx0Ly/mn6Xor6Jcblx0XHQkc2NvcGUuc2VhcmNoSW5TdG9yYWdlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHR2YXIgc3RhcnRUaW1lID0gcGFyYW1zLnN0YXJ0VGltZS5nZXRUaW1lKCksXG5cdFx0XHRcdGVuZFRpbWUgPSBwYXJhbXMuZW5kVGltZS5nZXRUaW1lKCk7XG5cdFx0XHQvLyAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG5cdFx0XHQkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuXHRcdFx0XHRkYXRhc2V0OiBbXVxuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQkc2NvcGUuZ2V0UGFyYW1zID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcGFyYW1zID0ge1xuXHRcdFx0XHQvLyBwYWdlTm86ICRzY29wZS5wYWdlTm8sXG5cdFx0XHRcdG9mZnNldDogJHNjb3BlLm9mZnNldCxcblx0XHRcdFx0bGltaXQ6ICRzY29wZS5saW1pdCxcblx0XHRcdFx0c3RhcnRUaW1lOiAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lLmdldFRpbWUoKSxcblx0XHRcdFx0ZW5kVGltZTogJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZFRpbWUuZ2V0VGltZSgpLFxuXHRcdFx0XHRjb21wYW55TmFtZTogJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lLFxuXHRcdFx0XHRvcmRlclR5cGVzOiAkc2NvcGUucXVlcnlQYXJhbXMub3JkZXJUeXBlLFxuXHRcdFx0XHRjcmVhdG9ySWQ6ICRzY29wZS5xdWVyeVBhcmFtcy5jcmVhdG9ySWQsXG5cdFx0XHRcdG9yZGVyU3RhdGVzOiAkc2NvcGUucXVlcnlQYXJhbXMub3JkZXJTdGF0ZXMsXG5cdFx0XHRcdHVwZGF0ZVN0YXR1czogJHNjb3BlLnF1ZXJ5UGFyYW1zLnVwZGF0ZVN0YXR1cyxcblx0XHRcdFx0Y29tcGFueUlkOiAkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkLFxuXHRcdFx0XHRjb25maXJtSWQ6ICRzY29wZS5xdWVyeVBhcmFtcy5jb25maXJtSWQsXG5cdFx0XHRcdG1vZGlmaWVkOiAkc2NvcGUucXVlcnlQYXJhbXMubW9kaWZpZWRcblx0XHRcdH07XG5cblx0XHRcdGFuZ3VsYXIuZm9yRWFjaChwYXJhbXMsIGZ1bmN0aW9uKHYsIGspIHtcblx0XHRcdFx0aWYgKHYgPT0gJy0xJykge1xuXHRcdFx0XHRcdGRlbGV0ZSBwYXJhbXNba107XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKCFwYXJhbXMuY29tcGFueU5hbWUpIHtcblx0XHRcdFx0ZGVsZXRlIHBhcmFtc1snY29tcGFueUlkJ107XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcGFyYW1zO1xuXHRcdH07XG5cdFx0JHNjb3BlLnR5cGVIZWFkQ29uZmlncyA9IHtcblx0XHRcdC8v5LiN55+l6YGT5LuA5LmI5oSP5oCdXG5cdFx0XHRkZWJvdW5jZToge1xuXHRcdFx0XHQnZGVmYXVsdCc6IDUwMCxcblx0XHRcdFx0J2JsdXInOiAyNTBcblx0XHRcdH0sXG5cdFx0XHRnZXR0ZXJTZXR0ZXI6IHRydWVcblx0XHR9O1xuXHRcdC8v5pCc57Si5Yqg6L29XG5cdFx0JHNjb3BlLmdldFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHQkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkID0gJyc7XG5cdFx0XHRyZXR1cm4gY29tcGFueVNlcnZpY2UucXVlcnlDb21wYW55TGlzdCh7XG5cdFx0XHRcdHBhZ2VObzogMCxcblx0XHRcdFx0ZGVsU3RhdGU6IDAsXG5cdFx0XHRcdGNvbXBhbnlOYW1lOiB2YWx1ZVxuXHRcdFx0fSkudGhlbihmdW5jdGlvbihyZXMpIHtcblx0XHRcdFx0cmV0dXJuIHJlcy5jb250ZW50O1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvL+aQnOe0oumAieaLqVxuXHRcdCRzY29wZS5zZWxlY3RUeXBlSGVhZE9wdGlvbnMgPSBmdW5jdGlvbihpdGVtLCBtb2RlbCwgbGFiZWwsIGV2ZW50KSB7XG5cdFx0XHQkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueUlkID0gaXRlbS5jb21wYW55SWQ7XG5cdFx0XHQkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuXHRcdFx0XHRkYXRhc2V0OiBbXVxuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdCRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcblx0XHRcdGNvdW50OiAkc2NvcGUubGltaXRcblx0XHR9LCB7XG5cdFx0XHRjb3VudHM6IFtdLFxuXHRcdFx0cGFnaW5hdGlvbk1heEJsb2NrczogMjUsXG5cdFx0XHRwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuXHRcdFx0Z2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHRcdCRzY29wZS5vZmZzZXQgPSAocGFyYW1zLnBhZ2UoKSAtIDEpICogJHNjb3BlLmxpbWl0O1xuXHRcdFx0XHR2YXIgcGFyYW1zMSA9ICRzY29wZS5nZXRQYXJhbXMoKTtcblx0XHRcdFx0cmV0dXJuIGluU3RvcmFnZVNlcnZpY2UuZ2V0SW5TdG9yYWdlTGlzdChwYXJhbXMxKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRcdHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG5cdFx0XHRcdFx0JHNjb3BlLmluU3RvcmFnZURhdGEgPSByZXMuY29udGVudDtcblx0XHRcdFx0XHRyZXR1cm4gYWNjb3VudFNlcnZpY2UuaW5kZXhBY2NvdW50KCRzY29wZS5pblN0b3JhZ2VEYXRhLCAkc2NvcGUub2Zmc2V0ICsgMSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdC8v5Y2V5o2u57G75Z6LXG5cdFx0JHNjb3BlLnRpY2tldERhdGEgPSBbe1xuXHRcdFx0bWFya0lkOiAnLTEnLFxuXHRcdFx0bmFtZTogJ+WFqOmDqOWNleaNruexu+Weiydcblx0XHR9LCB7XG5cdFx0XHRtYXJrSWQ6ICcxJyxcblx0XHRcdG5hbWU6ICfpgIHotKfkv67mlLnnoa7orqTljZUnXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiAnMicsXG5cdFx0XHRuYW1lOiAn6YCA6LSn56Gu6K6k5Y2VJ1xuXHRcdH1dO1xuXHRcdCRzY29wZS5jdXJUaWNrZXREYXRhID0gJHNjb3BlLnRpY2tldERhdGFbMF07XG5cdFx0JHNjb3BlLmxvY2FsTGFuZyA9IHtcblx0XHRcdHNlbGVjdEFsbDogXCLlhajpgIlcIixcblx0XHRcdHNlbGVjdE5vbmU6IFwi5YWo5LiN6YCJXCIsXG5cdFx0XHRyZXNldDogXCLph43nva5cIixcblx0XHRcdHNlYXJjaDogXCLor7fovpPlhaXmkJzntKLlhoXlrrkuLi5cIixcblx0XHRcdG5vdGhpbmdTZWxlY3RlZDogXCIxMjMxMlwiXG5cdFx0fTtcblx0XHQkc2NvcGUub3JkZXJUeXBlU2VsZWN0ID0gZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0JHNjb3BlLm9mZnNldCA9IDA7XG5cdFx0XHQkc2NvcGUubGltaXQgPSAyNTtcblx0XHRcdCRzY29wZS5xdWVyeVBhcmFtcy5vcmRlclR5cGUgPSBkYXRhLm1hcmtJZDtcblx0XHRcdC8vICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcblx0XHRcdCRzY29wZS50YWJsZVBhcmFtcy5zZXR0aW5ncyh7XG5cdFx0XHRcdGRhdGFzZXQ6IFtdXG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0Ly/ljZXmja7mk43kvZzkurpcblx0XHQkc2NvcGUub3BlYXRlckRhdGEgPSBbe1xuXHRcdFx0bWFuYWdlcklkOiAnLTEnLFxuXHRcdFx0bmFtZTogJ+WFqOmDqOWNleaNruaTjeS9nOS6uidcblx0XHR9XTtcblx0XHQkc2NvcGUuY3VyT3BlYXRlckRhdGEgPSAkc2NvcGUub3BlYXRlckRhdGFbMF07XG5cdFx0JHNjb3BlLm9wZWF0ZXJEYXRhRnVuID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpblN0b3JhZ2VTZXJ2aWNlLmdldEFsbE1hbmFnZXIoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHQkc2NvcGUub3BlYXRlckRhdGEgPSBfLnVuaW9uKCRzY29wZS5vcGVhdGVyRGF0YSwgcmVzLmNvbnRlbnQpO1xuXHRcdFx0XHQkc2NvcGUuc3RvY2tNYW5hZ2VyRGF0YSA9IGFuZ3VsYXIuY29weSgkc2NvcGUub3BlYXRlckRhdGEpO1xuXHRcdFx0XHQkc2NvcGUuc3RvY2tNYW5hZ2VyRGF0YVswXS5uYW1lID0gJ+WFqOmDqOWFpeW6k+ehruiupOS6uic7XG5cdFx0XHR9KTtcblx0XHR9KCk7XG5cblx0XHQkc2NvcGUubWFuYWdlclNlbGVjdCA9IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdCRzY29wZS5xdWVyeVBhcmFtcy5jcmVhdG9ySWQgPSBkYXRhLm1hbmFnZXJJZDtcblx0XHRcdC8vICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcblx0XHRcdCRzY29wZS50YWJsZVBhcmFtcy5zZXR0aW5ncyh7XG5cdFx0XHRcdGRhdGFzZXQ6IFtdXG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdC8v54q25oCBXG5cdFx0JHNjb3BlLm9yZGVyU3RhdGVEYXRhID0gW3tcblx0XHRcdG1hcmtJZDogJy0xJyxcblx0XHRcdG5hbWU6ICflhajpg6jnirbmgIEnXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiAnMCcsXG5cdFx0XHRuYW1lOiAn5pyq5YWl5bqTJ1xuXHRcdH0sIHtcblx0XHRcdG1hcmtJZDogJzEnLFxuXHRcdFx0bmFtZTogJ+W3suWFpeW6kydcblx0XHR9XTtcblx0XHQkc2NvcGUuY3VyT3JkZXJTdGF0ZURhdGEgPSB7XG5cdFx0XHRtYXJrSWQ6ICctMScsXG5cdFx0XHRuYW1lOiAn5YWo6YOo54q25oCBJ1xuXHRcdH07XG5cdFx0JHNjb3BlLm9yZGVyU3RhdHVzU2VsZWN0ID0gZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0JHNjb3BlLnF1ZXJ5UGFyYW1zLm9yZGVyU3RhdGVzID0gZGF0YS5tYXJrSWQ7XG5cdFx0XHQvLyAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG5cdFx0XHQkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuXHRcdFx0XHRkYXRhc2V0OiBbXVxuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvL+WFpeW6k+ehruiupOS6ulxuXHRcdCRzY29wZS5zdG9ja01hbmFnZXJEYXRhID0gYW5ndWxhci5jb3B5KCRzY29wZS5vcGVhdGVyRGF0YSk7XG5cdFx0JHNjb3BlLnN0b2NrTWFuYWdlclNlbGVjdCA9IGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0JHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbmZpcm1JZCA9IGRhdGEubWFuYWdlcklkO1xuXHRcdFx0Ly8gJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuXHRcdFx0JHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcblx0XHRcdFx0ZGF0YXNldDogW11cblx0XHRcdH0pO1xuXHRcdH07XG5cdFx0JHNjb3BlLnN0b2NrTWFuYWdlckRhdGFbMF0ubmFtZSA9ICflhajpg6jlhaXlupPnoa7orqTkuronO1xuXHRcdCRzY29wZS5jdXJTdG9ja01hbmFnZXJEYXRhID0gJHNjb3BlLnN0b2NrTWFuYWdlckRhdGFbMF07XG5cdFx0Ly/mmK/lkKbkv67mlLlcblxuXHRcdCRzY29wZS5tb2RpZmllZERhdGEgPSBbe1xuXHRcdFx0bWFya0lkOiAnLTEnLFxuXHRcdFx0bmFtZTogJ+WFqOmDqOS/ruaUueeKtuaAgSdcblx0XHR9LCB7XG5cdFx0XHRtYXJrSWQ6ICcwJyxcblx0XHRcdG5hbWU6ICflkKYnXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiAnMScsXG5cdFx0XHRuYW1lOiAn5pivJ1xuXHRcdH1dO1xuXHRcdCRzY29wZS5jdXJNb2RpZmllZERhdGEgPSAkc2NvcGUubW9kaWZpZWREYXRhWzBdO1xuXHRcdCRzY29wZS5tb2RpZmllZFNlbGVjdCA9IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdCRzY29wZS5xdWVyeVBhcmFtcy5tb2RpZmllZCA9IGRhdGEubWFya0lkO1xuXHRcdFx0JHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcblx0XHRcdFx0ZGF0YXNldDogW11cblx0XHRcdH0pO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHTmn6XnnIvmmI7nu4Zcblx0XHQqL1xuXHRcdCRzY29wZS5zdG9ja09yZGVySW5mb0RhdGEgPSB7fTtcblx0XHQkc2NvcGUucHJvZHVjdEl0ZW1zID0gW107XG5cdFx0JHNjb3BlLnZpZXdEZXRhaWwgPSBmdW5jdGlvbihvYmopIHtcblx0XHRcdHZhciBvcmRlclR5cGUgPSBvYmoub3JkZXJUeXBlLFxuXHRcdFx0XHRvcmRlclN0YXRlID0gb2JqLm9yZGVyU3RhdGU7XG5cdFx0XHQkc2NvcGUuc2VsZWN0ZWRPYmogPSBbXTtcblx0XHRcdGluU3RvcmFnZVNlcnZpY2UuZ2V0SW5TdG9yYWdlRGV0YWlsKHtcblx0XHRcdFx0b3JkZXJJZDogb2JqLm9yZGVySWRcblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdCRzY29wZS5zdG9ja09yZGVySW5mb0RhdGEgPSByZXM7XG5cdFx0XHRcdCRzY29wZS5wcm9kdWN0SXRlbXMgPSBhbmd1bGFyLmNvcHkocmVzLml0ZW1zKTtcblx0XHRcdFx0Xy5lYWNoKCRzY29wZS5wcm9kdWN0SXRlbXMsIGZ1bmN0aW9uKHYsIGspIHtcblx0XHRcdFx0XHR2LnBvc2l0aW9uSXRlbSA9IHYucG9zaXRpb25zWzBdICYmIHYucG9zaXRpb25zWzBdLm5hbWU7XG5cdFx0XHRcdFx0aWYgKCRzY29wZS5zdG9ja09yZGVySW5mb0RhdGEub3JkZXJUeXBlID09IDEpIHtcblx0XHRcdFx0XHRcdHYub2xkQ29uZmlybU51bSA9IHBhcnNlSW50KHYucmVmSXRlbU51bSkgLSBwYXJzZUludCh2LnJlZkNvbmZpcm1OdW0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdCRzY29wZS5wcm9kdWN0SXRlbXMgPSBfLnNvcnRCeSgkc2NvcGUucHJvZHVjdEl0ZW1zLCAncG9zaXRpb25JdGVtJyk7XG5cblx0XHRcdFx0aWYgKG9yZGVyVHlwZSA9PSAyKSB7XG5cdFx0XHRcdFx0Ly/pgIDotKfnoa7orqTljZXor6bmg4VNb2RhbFxuXHRcdFx0XHRcdCRzY29wZS5pblN0b3JhZ2VJbml0TW9kYWwoJ21vZGFsLXJlZnVuZC1jb25maXJtLXRpY2tldCcpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG9yZGVyVHlwZSA9PSAxKSB7XG5cblx0XHRcdFx0XHQkc2NvcGUuaW5TdG9yYWdlSW5pdE1vZGFsKCdtb2RhbC1kZWxpdmVyeS1tb2RpZnktY29uZmlybS10aWNrZXQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQkc2NvcGUuZ2V0UG9zaXRpb25zID0gZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0dmFyIGFyciA9IFtdO1xuXHRcdFx0Xy5lYWNoKGRhdGEsIGZ1bmN0aW9uKHYsIGspIHtcblx0XHRcdFx0YXJyLnB1c2goXCInXCIrdi5uYW1lKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGFyci5qb2luKCc8YnIvPicpO1xuXHRcdH07XG5cblx0XHQkc2NvcGUuZXJyb3JUeXBlRGF0YSA9IFt7XG5cdFx0XHRtYXJrSWQ6ICdBJyxcblx0XHRcdG5hbWU6ICfljZXmja7lvZXplJknLFxuXHRcdFx0c2VsZWN0ZWQ6IGZhbHNlXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiAnQicsXG5cdFx0XHRuYW1lOiAn5LuT5bqT6ZSZ5Y+RJyxcblx0XHRcdHNlbGVjdGVkOiBmYWxzZVxuXHRcdH0sIHtcblx0XHRcdG1hcmtJZDogXCJDXCIsXG5cdFx0XHRuYW1lOiBcIuS7k+W6k+a8j+WPkVwiLFxuXHRcdFx0c2VsZWN0ZWQ6IGZhbHNlXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiBcIkRcIixcblx0XHRcdG5hbWU6IFwi5LuT5bqT5aSa5Y+RXCIsXG5cdFx0XHRzZWxlY3RlZDogZmFsc2Vcblx0XHR9LCB7XG5cdFx0XHRtYXJrSWQ6IFwiRVwiLFxuXHRcdFx0bmFtZTogXCLlrqLmiLfkuI3opoFcIixcblx0XHRcdHNlbGVjdGVkOiBmYWxzZVxuXHRcdH0sIHtcblx0XHRcdG1hcmtJZDogXCJGXCIsXG5cdFx0XHRuYW1lOiBcIuS6p+WTgeegtOaNn1wiLFxuXHRcdFx0c2VsZWN0ZWQ6IGZhbHNlXG5cdFx0fSwge1xuXHRcdFx0bWFya0lkOiBcIkdcIixcblx0XHRcdG5hbWU6IFwi5Lqn5ZOB5Li05pyfXCIsXG5cdFx0XHRzZWxlY3RlZDogZmFsc2Vcblx0XHR9LCB7XG5cdFx0XHRtYXJrSWQ6IFwiSFwiLFxuXHRcdFx0bmFtZTogXCLkuqflk4Hov4fmnJ9cIixcblx0XHRcdHNlbGVjdGVkOiBmYWxzZVxuXHRcdH0sIHtcblx0XHRcdG1hcmtJZDogXCJJXCIsXG5cdFx0XHRuYW1lOiBcIuWFtuWug1wiLFxuXHRcdFx0c2VsZWN0ZWQ6IGZhbHNlXG5cdFx0fV07XG5cdFx0Ly/miZPlvIDlupPlrZjkv67mlLnmoYZcblx0XHQkc2NvcGUuc3RvY2tRdWVyeVBhcmFtcyA9IHt9O1xuXHRcdCRzY29wZS5zdG9ja0RlbHRhV2luID0gZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdGlmICgkc2NvcGUuc3RvY2tPcmRlckluZm9EYXRhLm9yZGVyU3RhdGUgPT0gMCkge1xuXHRcdFx0XHQkc2NvcGUuZXJyb3JUeXBlU2VsZWN0TWFya0lkID0gJyc7XG5cdFx0XHRcdF8uZWFjaCgkc2NvcGUuZXJyb3JUeXBlRGF0YSwgZnVuY3Rpb24odiwgaywgb2JqKSB7XG5cdFx0XHRcdFx0di5zZWxlY3RlZCA9IGZhbHNlO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0JHNjb3BlLnN0b2NrUXVlcnlQYXJhbXMgPSB7XG5cdFx0XHRcdFx0bW9kZTogaXRlbS5jb25maXJtTnVtID49IDAgPyAnYWRkJyA6ICdtaW51cycsXG5cdFx0XHRcdFx0Y29uZmlybVJlY29yZDogaXRlbS5jb25maXJtUmVjb3JkXG5cdFx0XHRcdH07XG5cdFx0XHRcdCRzY29wZS5pblN0b3JhZ2VJbml0TW9kYWwoJ21vZGFsLW1vZGlmeXN0b2NrJywgJ3NtJywgJ3JvdycpO1xuXHRcdFx0XHQkc2NvcGUuc3RvY2tEZWx0YVdpbkl0ZW0gPSBpdGVtO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0JHNjb3BlLmxvY2FsTGFuZyA9IHtcblx0XHRcdHNlbGVjdEFsbDogXCLlhajpgIlcIixcblx0XHRcdHNlbGVjdE5vbmU6IFwi5YWo5LiN6YCJXCIsXG5cdFx0XHRyZXNldDogXCLph43nva5cIixcblx0XHRcdHNlYXJjaDogXCJUeXBlIGhlcmUgdG8gc2VhcmNoLi4uXCIsXG5cdFx0XHRub3RoaW5nU2VsZWN0ZWQ6IFwi5pegXCJcblx0XHR9O1xuXG5cdFx0JHNjb3BlLmVycm9yVHlwZVNlbGVjdE1hcmtJZCA9ICcnO1xuXHRcdCRzY29wZS5zdG9ja0RlbHRhV2luQ29uZmlybSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuXHRcdFx0aWYgKHBhcmFtcy50eXBlT3V0UHV0RGF0YS5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRhbGVydCgn6K+36YCJ5oup5Y6f5Zug77yBJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBpbmRleCA9IF8uZmluZEluZGV4KCRzY29wZS5wcm9kdWN0SXRlbXMsICRzY29wZS5zdG9ja0RlbHRhV2luSXRlbSk7XG5cdFx0XHQkc2NvcGUuc3RvY2tEZWx0YVdpbkl0ZW0uY29uZmlybVJlY29yZCA9IHBhcmFtcy5jb25maXJtUmVjb3JkO1xuXHRcdFx0JHNjb3BlLnN0b2NrRGVsdGFXaW5JdGVtLm9sZENvbmZpcm1OdW0gPSAkc2NvcGUuc3RvY2tEZWx0YVdpbkl0ZW0uY29uZmlybU51bTtcblx0XHRcdCRzY29wZS5zdG9ja0RlbHRhV2luSXRlbS5jb25maXJtTnVtID0gcGFyYW1zLm1vZGUgPT0gJ2FkZCcgPyBwYXJhbXMubnVtYmVyIDogJy0nICsgcGFyYW1zLm51bWJlcjtcblx0XHRcdHRoaXMuJGNsb3NlKCk7XG5cdFx0fTtcblx0XHQvL+mAieaLqemUmeivr+exu+Wei1xuXHRcdCRzY29wZS5lcnJvclR5cGVTZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHQkc2NvcGUuZXJyb3JUeXBlU2VsZWN0TWFya0lkID0gaXRlbS5tYXJrSWQ7XG5cdFx0XHRpZiAoaXRlbS5tYXJrSWQgPT0gJ0knKSB7XG5cdFx0XHRcdCRzY29wZS5zdG9ja1F1ZXJ5UGFyYW1zLmNvbmZpcm1SZWNvcmQgPSAnJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCRzY29wZS5zdG9ja1F1ZXJ5UGFyYW1zLmNvbmZpcm1SZWNvcmQgPSBpdGVtLm5hbWU7XG5cdFx0XHR9XG5cblx0XHR9O1xuXHRcdCRzY29wZS5pblN0b3JhZ2VJbml0TW9kYWwgPSBmdW5jdGlvbih0ZW1wbGF0ZVVybCwgc2l6ZSwgcGFyZW50Q2xhc3MpIHtcblx0XHRcdHBhcmVudENsYXNzID0gcGFyZW50Q2xhc3MgPyBwYXJlbnRDbGFzcyA6ICdpblN0b3JhZ2UnO1xuXHRcdFx0c2l6ZSA9IHNpemUgPyBzaXplIDogJ2xnJztcblx0XHRcdG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuXHRcdFx0XHRhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUocGFyZW50Q2xhc3MpKSxcblx0XHRcdFx0dGVtcGxhdGVVcmw6IHRlbXBsYXRlVXJsLFxuXHRcdFx0XHRzY29wZTogJHNjb3BlLFxuXHRcdFx0XHRzaXplOiBzaXplXG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdC8q5paw5aKe5ZWG5ZOBKi9cblx0XHR2YXIgdG1wUHV0U2FsZVByb2R1Y3RMaXN0ID0gW10sXG5cdFx0XHR0bXBQdXRTYWxlUHJvZHVjdElkTGlzdCA9IFtdO1xuXHRcdHZhciBnZXRQcm9kdWN0UGFyYW1zID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHRyZXR1cm4gXy5waWNrKHBhcmFtcywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHRcdFx0XHQvLyByZXR1cm4gdmFsdWUgPj0gMCAmJiB2YWx1ZSAhPSAtMTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlICE9IC0xO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQkc2NvcGUucHJvZHVjdE9mZnNldCA9IDA7XG5cdFx0JHNjb3BlLnByb2R1Y3RMaW1pdCA9IDU7XG5cdFx0dmFyIHNldE5ld1Byb2R1Y3RzVGFibGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdCRzY29wZS5uZXdQcm9kY3V0c1RhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuXHRcdFx0XHRjb3VudDogJHNjb3BlLnByb2R1Y3RMaW1pdFxuXHRcdFx0fSwge1xuXHRcdFx0XHRjb3VudHM6IFtdLFxuXHRcdFx0XHRwYWdpbmF0aW9uTWF4QmxvY2tzOiAxMyxcblx0XHRcdFx0cGFnaW5hdGlvbk1pbkJsb2NrczogMixcblx0XHRcdFx0Z2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHRcdFx0JHNjb3BlLnByb2R1Y3RPZmZzZXQgPSAkc2NvcGUucHJvZHVjdExpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKTtcblx0XHRcdFx0XHR2YXIgc2VhcmNoID0gZ2V0UHJvZHVjdFBhcmFtcygkc2NvcGUucHJvZHVjdFF1ZXJ5UGFyYW1zKTtcblx0XHRcdFx0XHRzZWFyY2gub2Zmc2V0ID0gJHNjb3BlLnByb2R1Y3RPZmZzZXQ7XG5cdFx0XHRcdFx0c2VhcmNoLmxpbWl0ID0gJHNjb3BlLnByb2R1Y3RMaW1pdDtcblx0XHRcdFx0XHRyZXR1cm4gcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0QnlLZXkoc2VhcmNoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRcdFx0cGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcblx0XHRcdFx0XHRcdHZhciBkYXRhID0gW107XG5cdFx0XHRcdFx0XHRhbmd1bGFyLmZvckVhY2gocmVzLmNvbnRlbnQsIGZ1bmN0aW9uKGQsIGksIGEpIHtcblx0XHRcdFx0XHRcdFx0ZC5oZWFkZXIuY2F0ZWdvcnkgPSBkLmNhdGVnb3J5O1xuXHRcdFx0XHRcdFx0XHRkLmhlYWRlci5wb3NpdGlvbnMgPSBkLnBvc2l0aW9ucztcblx0XHRcdFx0XHRcdFx0ZGF0YS5wdXNoKGQuaGVhZGVyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YW5ndWxhci5mb3JFYWNoKCRzY29wZS5wcm9kdWN0SXRlbXMsIGZ1bmN0aW9uKHYsIGspIHtcblxuXHRcdFx0XHRcdFx0XHRpbmRleCA9IF8uZmluZEluZGV4KGRhdGEsIHtcblx0XHRcdFx0XHRcdFx0XHRpZDogdi5pZCB8fCB2LnByb2R1Y3RJZFxuXHRcdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0XHRpZiAoaW5kZXggPj0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGRhdGFbaW5kZXhdLnNlbGVjdCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0ZGF0YVtpbmRleF0uaXNBZGRTZWxlY3QgPSAnaXNBZGRTZWxlY3QnO1xuXHRcdFx0XHRcdFx0XHRcdC8vIGRhdGEuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH07XG5cblx0XHR2YXIgcXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkc2NvcGUuY2F0ZWdvcnlMaXN0ID0gW3tcblx0XHRcdFx0aWQ6ICctMScsXG5cdFx0XHRcdGNhdGVnb3J5TmFtZTogJ+WFqOmDqOWTgeexuydcblx0XHRcdH1dO1xuXHRcdFx0JHNjb3BlLmN1ckNhdGVvdHlMaXN0ID0gJHNjb3BlLmNhdGVnb3J5TGlzdFswXTtcblx0XHRcdHByb2R1Y3RTZXJ2aWNlLnF1ZXJ5UHJvZHVjdENhdGVnb3J5TGlzdCgpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdGFuZ3VsYXIuZm9yRWFjaChyZXMsIGZ1bmN0aW9uKGNhdGVnb3J5LCBpbmRleCkge1xuXHRcdFx0XHRcdCRzY29wZS5jYXRlZ29yeUxpc3QucHVzaChjYXRlZ29yeSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvKlxuXHRcdCAqIOWIqea2puetiee6p1xuXHRcdCAqL1xuXHRcdCRzY29wZS5wcm9maXRMZXZlbERhdGEgPSBbe1xuXHRcdFx0cHJvZml0TGV2ZWw6IC0xLFxuXHRcdFx0bmFtZTogJ+WFqOmDqOWIqea2puetiee6pydcblx0XHR9LCB7XG5cdFx0XHRwcm9maXRMZXZlbDogMSxcblx0XHRcdG5hbWU6ICfkvY7liKnmtqbnrYnnuqcnXG5cdFx0fSwge1xuXHRcdFx0cHJvZml0TGV2ZWw6IDUsXG5cdFx0XHRuYW1lOiAn5Lit562J5Yip5ram562J57qnJ1xuXHRcdH0sIHtcblx0XHRcdHByb2ZpdExldmVsOiA5LFxuXHRcdFx0bmFtZTogJ+mrmOWIqea2puetiee6pydcblx0XHR9LCB7XG5cdFx0XHRwcm9maXRMZXZlbDogMCxcblx0XHRcdG5hbWU6ICfmnKrnn6UnXG5cdFx0fV07XG5cblx0XHQkc2NvcGUuY3VyUHJvZml0TGV2ZWxEYXRhID0ge1xuXHRcdFx0cHJvZml0TGV2ZWw6ICctMScsXG5cdFx0XHRuYW1lOiAn5YWo6YOo5Yip5ram562J57qnJ1xuXHRcdH07XG5cblx0XHQvL+aJk+W8gCDmlrDlk4HmlrDlop7llYblk4Fcblx0XHQkc2NvcGUuYWRkUHJvZHVjdFdpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JHNjb3BlLnByb2R1Y3RRdWVyeVBhcmFtcyA9IHt9O1xuXHRcdFx0cXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0KCk7XG5cdFx0XHQkc2NvcGUuaW5TdG9yYWdlSW5pdE1vZGFsKCdtb2RhbFByb2R1Y3RMaXN0JywgJycsICdyb3cnKTtcblx0XHR9O1xuXG5cdFx0Ly/lk4HnsbvpgInmi6lcblx0XHQkc2NvcGUuc2VsZWN0Q2F0ZWdvcnlDYWxsYmFjayA9IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdGlmIChpdGVtLmlkKSB7XG5cdFx0XHRcdCRzY29wZS5wcm9kdWN0UXVlcnlQYXJhbXMuY2F0ZWdvcnlJZCA9IGl0ZW0uaWQ7XG5cdFx0XHRcdHNldE5ld1Byb2R1Y3RzVGFibGUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdC8v5Yip5ram562J57qn6YCJ5oupXG5cdFx0JHNjb3BlLnByb2ZpdFNlbGVjdENhbGxiYWNrID0gZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0JHNjb3BlLnByb2R1Y3RRdWVyeVBhcmFtcy5wcm9maXRMZXZlbCA9IGl0ZW0ucHJvZml0TGV2ZWw7XG5cdFx0XHRzZXROZXdQcm9kdWN0c1RhYmxlKCk7XG5cdFx0fTtcblx0XHQvL+aQnOe0ouWVhuWTgVxuXHRcdCRzY29wZS5zZWFyY2hQcm9kdWN0ID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcblx0XHRcdCRzY29wZS5wcm9kdWN0UXVlcnlQYXJhbXMucHJvZHVjdE5hbWUgPSBxdWVyeVBhcmFtcy5wcm9kdWN0TmFtZTtcblx0XHRcdHNldE5ld1Byb2R1Y3RzVGFibGUoKTtcblx0XHR9O1xuXHRcdCRzY29wZS5rZXlQcmVzc1NlYXJjaFByb2R1Y3QgPSBmdW5jdGlvbihlLCBxdWVyeVBhcmFtcykge1xuXHRcdFx0aWYgKGUua2V5Q29kZSA9PSAxMykgeyAvL+Wbnui9pumUrlxuXHRcdFx0XHQkc2NvcGUuc2VhcmNoUHJvZHVjdChxdWVyeVBhcmFtcyk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHQkc2NvcGUuc2VsZWN0ZWQgPSBbXTtcblx0XHQkc2NvcGUuc2VsZWN0ZWRPYmogPSBbXTtcblx0XHR2YXIgdXBkYXRlU2VsZWN0ZWQgPSBmdW5jdGlvbihhY3Rpb24sIGlkLCBuYW1lKSB7XG5cdFx0XHRpZiAoYWN0aW9uID09ICdhZGQnICYmICRzY29wZS5zZWxlY3RlZC5pbmRleE9mKGlkKSA9PSAtMSkge1xuXHRcdFx0XHQkc2NvcGUuc2VsZWN0ZWQucHVzaChpZCk7XG5cdFx0XHRcdCRzY29wZS5zZWxlY3RlZE9iai5wdXNoKG5hbWUpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGFjdGlvbiA9PSAncmVtb3ZlJyAmJiAkc2NvcGUuc2VsZWN0ZWQuaW5kZXhPZihpZCkgIT0gLTEpIHtcblx0XHRcdFx0dmFyIGlkeCA9ICRzY29wZS5zZWxlY3RlZC5pbmRleE9mKGlkKTtcblx0XHRcdFx0JHNjb3BlLnNlbGVjdGVkLnNwbGljZShpZHgsIDEpO1xuXHRcdFx0XHQkc2NvcGUuc2VsZWN0ZWRPYmouc3BsaWNlKGlkeCwgMSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8v5ZWG5ZOB6YCJ5oupXG5cdFx0JHNjb3BlLmNoa2JveENoYW5nZSA9IGZ1bmN0aW9uKHByb2R1Y3QsICRldmVudCkge1xuXG5cdFx0XHR2YXIgY2hlY2tib3ggPSAkZXZlbnQudGFyZ2V0O1xuXHRcdFx0dmFyIGFjdGlvbiA9IChjaGVja2JveC5jaGVja2VkID8gJ2FkZCcgOiAncmVtb3ZlJyk7XG5cdFx0XHR1cGRhdGVTZWxlY3RlZChhY3Rpb24sIHByb2R1Y3QuaWQsIHByb2R1Y3QpO1xuXHRcdH07XG5cdFx0Ly/mlrDlop7llYblk4Eg56Gu6K6kXG5cdFx0JHNjb3BlLm9sZFNlbGVjdGVkT2JqID0gW107XG5cdFx0JHNjb3BlLmNvbmZpcm1QdXRTYWxlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcEl0ZW1zID0gJHNjb3BlLnByb2R1Y3RJdGVtcztcblx0XHRcdHZhciBzT2JqID0gJHNjb3BlLnNlbGVjdGVkT2JqO1xuXHRcdFx0dmFyIHZJZCwgdjFJZCwgZWxlbTtcblx0XHRcdGlmIChwSXRlbXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRfLmVhY2goc09iaiwgZnVuY3Rpb24odiwgaywgb2JqKSB7XG5cdFx0XHRcdFx0dklkID0gdi5pZCB8fCB2LnByb2R1Y3RJZDtcblx0XHRcdFx0XHRlbGVtID0gXy5maW5kV2hlcmUocEl0ZW1zLCB7XG5cdFx0XHRcdFx0XHRwcm9kdWN0SWQ6IHZJZFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGlmICghZWxlbSkge1xuXHRcdFx0XHRcdFx0ZWxlbSA9IGFuZ3VsYXIuY29weSh2KTtcblx0XHRcdFx0XHRcdGVsZW0ucHJvZHVjdElkID0gZWxlbS5pZDtcblx0XHRcdFx0XHRcdGVsZW0uaXRlbUlkID0gJyc7XG5cdFx0XHRcdFx0XHRlbGVtLmNvbmZpcm1OdW0gPSAwO1xuXHRcdFx0XHRcdFx0ZWxlbS5jb25maXJtUmVjb3JkID0gJyc7XG5cblx0XHRcdFx0XHRcdCRzY29wZS5wcm9kdWN0SXRlbXMucHVzaChlbGVtKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JHNjb3BlLnByb2R1Y3RJdGVtcyA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc2VsZWN0ZWRPYmopO1xuXG5cdFx0XHR9XG5cdFx0XHQkc2NvcGUuc2VsZWN0ZWRPYmogPSBbXTtcblx0XHRcdCRzY29wZS5zZWxlY3RlZCA9IFtdO1xuXG5cdFx0XHR0aGlzLiRjbG9zZSgpO1xuXHRcdH07XG5cblx0XHQvL+aWsOWinuWVhuWTgSDliKDpmaRcblx0XHQkc2NvcGUucmVtb3ZlUHV0U2FsZVByb2R1Y3QgPSBmdW5jdGlvbihpLCBpdGVtKSB7XG5cdFx0XHR2YXIgaWQgPSBpdGVtLmlkIHx8IGl0ZW0ucHJvZHVjdElkO1xuXHRcdFx0dmFyIGluZGV4ID0gXy5maW5kV2hlcmUoJHNjb3BlLnNlbGVjdGVkT2JqLCB7XG5cdFx0XHRcdGlkOiBpZFxuXHRcdFx0fSk7XG5cdFx0XHQkc2NvcGUucHJvZHVjdEl0ZW1zLnNwbGljZShpLCAxKTtcblx0XHR9O1xuXHRcdC8v5L+u5pS55piO57uGXG5cdFx0JHNjb3BlLnN0b2NrQ29uZmlybURldGFpbCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9yZGVyRGV0YWlsID0gJHNjb3BlLnN0b2NrT3JkZXJJbmZvRGF0YSxcblx0XHRcdFx0bmV3SXRlbXMgPSBbXSxcblx0XHRcdFx0bWUgPSB0aGlzO1xuXHRcdFx0YW5ndWxhci5mb3JFYWNoKCRzY29wZS5wcm9kdWN0SXRlbXMsIGZ1bmN0aW9uKHYsIGspIHtcblx0XHRcdFx0bmV3SXRlbXMucHVzaCh7XG5cdFx0XHRcdFx0aXRlbUlkOiB2Lml0ZW1JZCB8fCAnJyxcblx0XHRcdFx0XHRjb25maXJtTnVtOiB2LmNvbmZpcm1OdW0sXG5cdFx0XHRcdFx0Y29uZmlybVJlY29yZDogdi5jb25maXJtUmVjb3JkLFxuXHRcdFx0XHRcdHByb2R1Y3RJZDogdi5pZCB8fCB2LnByb2R1Y3RJZFxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0aW5TdG9yYWdlU2VydmljZS51cGRhdGVJblN0b3JhZ2VEZXRhaWwoe1xuXHRcdFx0XHRvcmRlcklkOiBvcmRlckRldGFpbC5vcmRlcklkLFxuXHRcdFx0XHRvcmRlclN0YXRlOiAxLFxuXHRcdFx0XHRpdGVtczogbmV3SXRlbXMsXG5cdFx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRtZS4kY2xvc2UoKTtcblx0XHRcdFx0JHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvL+WvvOWHukV4Y2VsXG5cdFx0JHNjb3BlLmV4cG9ydEV4Y2VsID0gZnVuY3Rpb24ob3JkZXIpIHtcblx0XHRcdHZhciBvcmRlclR5cGUgPSBvcmRlci5vcmRlclR5cGU7XG5cdFx0XHR2YXIgY29udGFpbmVyaWQ7XG5cdFx0XHRzd2l0Y2ggKG9yZGVyVHlwZSkge1xuXHRcdFx0XHRjYXNlICRzY29wZS50aWNrZXRUeXBlLkRFTElWRVJZX01PRElGWV9DT05GSVJNOlxuXHRcdFx0XHRcdGNvbnRhaW5lcmlkID0gJ2RlbGl2ZXJ5LWluLXN0b3JhZ2UtdGFibGUnO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICRzY29wZS50aWNrZXRUeXBlLlJFRlVORF9DT05GSVJNOlxuXHRcdFx0XHRcdGNvbnRhaW5lcmlkID0gJ3JlZnVuZC1pbi1zdG9yYWdlLXRhYmxlJztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdHZhciBkb20gPSBhbmd1bGFyLmVsZW1lbnQoJzxhPjwvYT4nKTtcblx0XHRcdGRvbVswXS5ocmVmID0gJChcIiNcIiArIGNvbnRhaW5lcmlkKS5leGNlbGV4cG9ydGpzKHtcblx0XHRcdFx0Y29udGFpbmVyaWQ6IGNvbnRhaW5lcmlkLFxuXHRcdFx0XHRkYXRhdHlwZTogJ3RhYmxlJyxcblx0XHRcdFx0cmV0dXJuVXJpOiAndHJ1ZSdcblx0XHRcdH0pO1xuXHRcdFx0ZG9tWzBdLmRvd25sb2FkID0gJHNjb3BlLnRpY2tldFR5cGUuREVTQ1tvcmRlclR5cGVdICsgJy0nICsgb3JkZXIuY29tcGFueU5hbWUgKyAnLScgKyBvcmRlci5zaGVsZk5hbWUgKyAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcob3JkZXIuY3JlYXRlVGltZSwgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKS54bHMnO1xuXHRcdFx0ZG9tWzBdLmNsaWNrKCk7XG5cdFx0fTtcblx0XHQvL+afpeeci+WFs+iBlOmAgei0p+WNlVxuXHRcdCRzY29wZS5jaGVja0RlbGl2ZXJ5T3JkZXIgPSBmdW5jdGlvbihyZWZJZCl7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UucXVlcnlEZWxpdmVyeURldGFpbCh7J29yZGVySWQnOiByZWZJZH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIgPSByZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIubmFtZSA9ICfpgIHotKfljZUnICsgJy0nICsgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIuY29tcGFueU5hbWUgKyAnLScgKyAkc2NvcGUuZGVsaXZlcnlPcmRlci5zaGVsZk5hbWUgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5kZWxpdmVyeU9yZGVyLmNyZWF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1dFNhbGVQcm9kdWN0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnN1cHBsZW1lbnRQcm9kdWN0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QgPSBbXTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZGVsaXZlcnlPcmRlci5pdGVtcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGl0ZW0uaXRlbVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5wdXRTYWxlUHJvZHVjdExpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5zdXBwbGVtZW50UHJvZHVjdExpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5wdWxsU2FsZVByb2R1Y3RMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlck1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaW5TdG9yYWdlJykpLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ29yZGVyL2RlbGl2ZXJ5T3JkZXJUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cdFx0fTtcblx0fSk7XG59OyIsIi8qXG4gKuS/oeaBr+aUtumbhmxqbFxuICppbmZvcm1hdGlvbkNvbnRyb2xsZXJcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcignaW5mb3JtYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsICRjb21waWxlLCAkZWxlbWVudCwgTmdUYWJsZVBhcmFtcywgc2hlbGZTZXJ2aWNlLCBjb21wYW55U2VydmljZSwgbW9kYWxTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBjb21wYW55SW5mb3JtYXRpb25DcmVhdGVNb2RhbDtcbiAgICAgICAgJHNjb3BlLmluZm9Nb2RlbCA9IHtcbiAgICAgICAgICAgIHN0YWZmTnVtYmVyOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICcwLTMw5Lq6JywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICczMC01MOS6uicsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAnNTAtMTAw5Lq6JywgdmFsdWU6IDMgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICcxMDAtMzAw5Lq6JywgdmFsdWU6IDQgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICczMDAtNTAw5Lq6JywgdmFsdWU6IDUgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICc1MDDkurrku6XkuIonLCB2YWx1ZTogNiB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZ2VuZGVyUmF0aW86IFtcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnqbonLCB2YWx1ZTogMCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+eUt+eUn+WBj+WkmicsIHZhbHVlOiAxIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5aWz55Sf5YGP5aSaJywgdmFsdWU6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnlLflpbPlnYfooaEnLCB2YWx1ZTogMyB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgb2ZmaWNlVGltZTogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAnOTY1JywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICc5OTUnLCB2YWx1ZTogMiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJzk2NicsIHZhbHVlOiAzIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAnOTk2JywgdmFsdWU6IDQgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHN0YWZmVHlwZTogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5oqA5pyv57G7JywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfplIDllK7nsbsnLCB2YWx1ZTogMiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+a3t+WQiOexuycsIHZhbHVlOiAzIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBvdmVydGltZTogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5aSaJywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICflsJEnLCB2YWx1ZTogMiB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZGVsaXZlcnlUaW1lOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICflt6XkvZzml6UnLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+W3peS9nOaXpSvlkajlha0nLCB2YWx1ZTogMiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+W3peS9nOaXpSvlkajmnKsnLCB2YWx1ZTogMyB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZGVsaXZlcnlDeWNsZTogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5LiA5ZGo5Lik5qyhJywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfkuIDlkajkuIDmrKEnLCB2YWx1ZTogMiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+S4pOWRqOS4gOasoScsIHZhbHVlOiAzIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5LiA5pyI5LiA5qyhJywgdmFsdWU6IDQgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHNpbmdsZVByaWNlOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICcwLTLlhYMnLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJzItNOWFgycsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAnNC0xMOWFgycsIHZhbHVlOiAzIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBwcmljZVByZWZlcjogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Lu35qC85LiN5pWP5oSfJywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfkuK3nrYnmt7fmkK0nLCB2YWx1ZTogMiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+S9juS7tycsIHZhbHVlOiAzIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBicmFuZExldmVsOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfml6DmiYDosJMnLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+Wkp+WTgeeJjCcsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn6L+b5Y+jJywgdmFsdWU6IDMgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICflm73kuqcnLCB2YWx1ZTogNCB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgY29tcGFueUF0bW9zcGhlcmU6IFtcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnqbonLCB2YWx1ZTogMCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+S/neWuiCcsIHZhbHVlOiAxIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5byA5pS+JywgdmFsdWU6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfmv4Dmg4UnLCB2YWx1ZTogMyB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgY29tcGFueUxldmVsOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfkvY7moaMnLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+S4reahoycsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn6auY5qGjJywgdmFsdWU6IDMgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHdlbGZhcmVDb25zaXN0OiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfml6Dnpo/liKknLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+aPkOS+m+WFjei0uembtumjnycsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn6KGl6LS06Zu26aOf6LS555SoJywgdmFsdWU6IDMgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGZpdmVtZXRlcjogW1xuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+epuicsIHZhbHVlOiAwIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5rKh5pyJJywgdmFsdWU6IDEgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfmnIknLCB2YWx1ZTogMiB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZm9vZFByZWZlcnM6IFtcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnqbonLCB2YWx1ZTogMCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+mlvOW5sicsIHZhbHVlOiAxIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn57OV54K5JywgdmFsdWU6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfohqjljJYnLCB2YWx1ZTogMyB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+ayueeCuCcsIHZhbHVlOiA0IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn57OW5p6cJywgdmFsdWU6IDUgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfonJzppa8nLCB2YWx1ZTogNiB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+WdmuaenCcsIHZhbHVlOiA3IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Yqg5belLeiCieexuycsIHZhbHVlOiA4IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Yqg5belLeixhuexuycsIHZhbHVlOiA5IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Yqg5belLeakjeeJqScsIHZhbHVlOiAxMCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+WGsuazoScsIHZhbHVlOiAxMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+WFtuS7licsIHZhbHVlOiAxMiB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZHJpbmtQcmVmZXJzOiBbXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn56m6JywgdmFsdWU6IDAgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnorPphbgnLCB2YWx1ZTogMSB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+aenOaxgScsIHZhbHVlOiAyIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn6Iy257G7JywgdmFsdWU6IDMgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICflkpbllaEnLCB2YWx1ZTogNCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+WGsumlricsIHZhbHVlOiA1IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Lmz5Yi25ZOBJywgdmFsdWU6IDYgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHByb2R1Y3RGdW5jdGlvbnM6IFtcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfnqbonLCB2YWx1ZTogMCB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+aXqemkkOexuycsIHZhbHVlOiAxIH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5Yqg54+t57G7JywgdmFsdWU6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICfop6PppovnsbsnLCB2YWx1ZTogMyB9LFxuICAgICAgICAgICAgICAgIHsgZGVzYzogJ+ino+a4tOexuycsIHZhbHVlOiA0IH0sXG4gICAgICAgICAgICAgICAgeyBkZXNjOiAn5YWF6aWl57G7JywgdmFsdWU6IDUgfSxcbiAgICAgICAgICAgICAgICB7IGRlc2M6ICflhYXnlLXnsbsnLCB2YWx1ZTogNiB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jb21wYW55ID0ge1xuICAgICAgICAgICAgY29tcGFueU5hbWU6ICcnLFxuICAgICAgICAgICAgY29tcGFueUlkOiAnJ1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY3JlYXRlUHJlZmVyQ29tcGFueSA9IHtcbiAgICAgICAgICAgIGNvbXBhbnlOYW1lOiAnJyxcbiAgICAgICAgICAgIGNvbXBhbnlJZDogJydcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnR5cGVIZWFkT3B0aW9ucyA9IFt7IGNvbXBhbnlOYW1lOiAnMTIzJywgY29tcGFuSWQ6ICcxMjMnIH0sIHsgY29tcGFueU5hbWU6ICcxMjM0NScsIGNvbXBhbklkOiAnMTIzNDUnIH0sIHsgY29tcGFueU5hbWU6ICcxMjM0NTY3JywgY29tcGFuSWQ6ICcxMjM0NTY3JyB9XTtcbiAgICAgICAgJHNjb3BlLnR5cGVIZWFkQ29uZmlncyA9IHtcbiAgICAgICAgICAgIGRlYm91bmNlOiB7XG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiA1MDAsXG4gICAgICAgICAgICAgICAgJ2JsdXInOiAyNTBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXR0ZXJTZXR0ZXI6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmluZm8gPSB7XG4gICAgICAgICAgICBjb21wYW55SWQ6ICRzY29wZS5jcmVhdGVQcmVmZXJDb21wYW55LmNvbXBhbnlJZCxcbiAgICAgICAgICAgIGNvbXBhbnlOYW1lOiAnJyxcbiAgICAgICAgICAgIHN0YWZmTnVtYmVyOiAnJyxcbiAgICAgICAgICAgIGdlbmRlclJhdGlvOiAnJyxcbiAgICAgICAgICAgIG9mZmljZVRpbWU6ICcnLFxuICAgICAgICAgICAgc3RhZmZUeXBlOiAnJyxcbiAgICAgICAgICAgIG92ZXJ0aW1lOiAnJyxcbiAgICAgICAgICAgIGRlbGl2ZXJ5UHJpY2U6ICcnLFxuICAgICAgICAgICAgbW9udGhCdWRnZXQ6ICcnLFxuICAgICAgICAgICAgZGVsaXZlcnlUaW1lOiAnJyxcbiAgICAgICAgICAgIGRlbGl2ZXJ5Q3ljbGU6ICcnLFxuICAgICAgICAgICAgZml2ZW1ldGVyOiAnJyxcbiAgICAgICAgICAgIHNoZWxmUG9zaXRpb25zOiBbXSxcbiAgICAgICAgICAgIGZvb2RQcmVmZXJzOiBbXSxcbiAgICAgICAgICAgIGZvb2RQcmVmZXJUeXBlOiBbXSxcbiAgICAgICAgICAgIGZvb2RQcmVmZXJOYW1lOiBbXSxcbiAgICAgICAgICAgIGRyaW5rUHJlZmVyczogW10sXG4gICAgICAgICAgICBkcmlua1ByZWZlclR5cGU6ICcnLFxuICAgICAgICAgICAgZHJpbmtQcmVmZXJOYW1lOiAnJyxcbiAgICAgICAgICAgIHByb2R1Y3RGdW5jdGlvbnM6IFtdLFxuICAgICAgICAgICAgcHJvZHVjdEZ1bmN0aW9uVHlwZTogJycsXG4gICAgICAgICAgICBQcm9kdWN0RnVuY3Rpb25TdHI6ICcnLFxuICAgICAgICAgICAgc2luZ2xlUHJpY2U6ICcnLFxuICAgICAgICAgICAgcHJpY2VQcmVmZXI6ICcnLFxuICAgICAgICAgICAgYnJhbmRMZXZlbDogJycsXG4gICAgICAgICAgICBjb21wYW55QXRtb3NwaGVyZTogJycsXG4gICAgICAgICAgICBjb21wYW55TGV2ZWw6ICcnLFxuICAgICAgICAgICAgd2VsZmFyZUNvbnNpc3Q6ICcnLFxuICAgICAgICAgICAgbm90ZTogJydcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmluZm9ybWF0aW9uSGVhZHNfYWxwaGEgPSBbe1xuICAgICAgICAgICAgdGl0bGU6ICflhazlj7jlkI3np7AnLFxuICAgICAgICAgICAgZmllbGQ6ICdjb21wYW55TmFtZSdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflkIjkvZzmqKHlvI8nLFxuICAgICAgICAgICAgZmllbGQ6ICdzdGF0dXNBbGlhcydcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfpo5/nianlgY/lpb0nLFxuICAgICAgICAgICAgZmllbGQ6ICdmb29kUHJlZmVycycsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgciwgaW5kZXgsIHNjb3BlLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBodG1sID0gW107XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHYsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiBpdGVtLnZhbHVlIH0pLmRlc2MgKyAnLScgKyBpdGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBodG1sLmpvaW4oJyB8ICcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+mlruaWmeWBj+WlvScsXG4gICAgICAgICAgICBmaWVsZDogJ2RyaW5rUHJlZmVycycsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgciwgaW5kZXgsIHNjb3BlLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBodG1sID0gW107XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHYsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiBpdGVtLnZhbHVlIH0pLmRlc2MgKyAnLScgKyBpdGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBodG1sLmpvaW4oJyB8ICcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+WVhuWTgeWKn+iDvScsXG4gICAgICAgICAgICBmaWVsZDogJ3Byb2R1Y3RGdW5jdGlvbnMnLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IFtdO1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh2LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaChfLmZpbmRXaGVyZSgkc2NvcGUuaW5mb01vZGVsW2ZpZWxkXSwgeyB2YWx1ZTogaXRlbS52YWx1ZSB9KS5kZXNjICsgJy0nICsgaXRlbS5uYW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaHRtbC5qb2luKCcgfCAnKTtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+WNleWTgeS7t+agvCcsXG4gICAgICAgICAgICBmaWVsZDogJ3NpbmdsZVByaWNlJyxcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2LCByLCBpbmRleCwgc2NvcGUsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5Lu35qC85YGP5aW9JyxcbiAgICAgICAgICAgIGZpZWxkOiAncHJpY2VQcmVmZXInLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUoJHNjb3BlLmluZm9Nb2RlbFtmaWVsZF0sIHsgdmFsdWU6IHYgfSkuZGVzYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflk4HniYzluqYnLFxuICAgICAgICAgICAgZmllbGQ6ICdicmFuZExldmVsJyxcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2LCByLCBpbmRleCwgc2NvcGUsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5YWs5Y+45rCb5Zu0JyxcbiAgICAgICAgICAgIGZpZWxkOiAnY29tcGFueUF0bW9zcGhlcmUnLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUoJHNjb3BlLmluZm9Nb2RlbFtmaWVsZF0sIHsgdmFsdWU6IHYgfSkuZGVzYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflhazlj7jmoaPmrKEnLFxuICAgICAgICAgICAgZmllbGQ6ICdjb21wYW55TGV2ZWwnLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUoJHNjb3BlLmluZm9Nb2RlbFtmaWVsZF0sIHsgdmFsdWU6IHYgfSkuZGVzYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfnpo/liKnnu4TmiJAnLFxuICAgICAgICAgICAgZmllbGQ6ICd3ZWxmYXJlQ29uc2lzdCcsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgciwgaW5kZXgsIHNjb3BlLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZSgkc2NvcGUuaW5mb01vZGVsW2ZpZWxkXSwgeyB2YWx1ZTogdiB9KS5kZXNjO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7IHRpdGxlOiAn5aSH5rOoJywgZmllbGQ6ICdub3RlJyB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+aTjeS9nCcsXG4gICAgICAgICAgICBmaWVsZDogJ2NvbW1hbmQnLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc21cIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGVuY2lsXCI+PC9zcGFuPjwvYnV0dG9uPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dO1xuICAgICAgICAkc2NvcGUuaW5mb3JtYXRpb25IZWFkcyA9IFt7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICflhazlj7jlkI3np7AnLFxuICAgICAgICAgICAgICAgIGZpZWxkOiAnY29tcGFueU5hbWUnXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICfotKfmnrbkvY3nva4nLFxuICAgICAgICAgICAgICAgIGZpZWxkOiAnc2hlbGZQb3NpdGlvbnMnLFxuICAgICAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2LCByLCBpbmRleCwgc2NvcGUsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHYsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHJpbmcgPSBpdGVtLnNoZWxmTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnBvc2l0aW9uSW1nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nICs9ICgnOjxpbWcgc3R5bGU9XCJ3aWR0aDoyNnB4O2hlaWdodDI2cHg7XCIgc3JjPVwiJyArIHdpbmRvdy5jZmcucGljVXJsICsgaXRlbS5wb3NpdGlvbkltZyArICdcIi8+Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIucHVzaChzdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8c3Bhbj4nICsgc3RyLmpvaW4oJycpICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+WFrOWPuOS6uuaVsCcsXG4gICAgICAgICAgICAgICAgZmllbGQ6ICdzdGFmZk51bWJlcicsXG4gICAgICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn55S35aWz5q+U5L6LJyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2dlbmRlclJhdGlvJyxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgciwgaW5kZXgsIHNjb3BlLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUoJHNjb3BlLmluZm9Nb2RlbFtmaWVsZF0sIHsgdmFsdWU6IHYgfSkuZGVzYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICfkuIrnj63ml7bpl7QnLFxuICAgICAgICAgICAgICAgIGZpZWxkOiAnb2ZmaWNlVGltZScsXG4gICAgICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn5Lq65ZGY57G75Z6LJyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ3N0YWZmVHlwZScsXG4gICAgICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn5Yqg54+t5oOF5Ya1JyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ292ZXJ0aW1lJyxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgciwgaW5kZXgsIHNjb3BlLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUoJHNjb3BlLmluZm9Nb2RlbFtmaWVsZF0sIHsgdmFsdWU6IHYgfSkuZGVzYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyB0aXRsZTogJ+W7uuiurumAgei0p+mHkeminS/mrKEnLCBmaWVsZDogJ2RlbGl2ZXJ5UHJpY2UnIH0sXG4gICAgICAgICAgICB7IHRpdGxlOiAn5q+P5pyI6aKE566XJywgZmllbGQ6ICdtb250aEJ1ZGdldCcgfSwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn6YCB6LSn5pe26Ze0JyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2RlbGl2ZXJ5Q3ljbGUnLFxuICAgICAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2LCByLCBpbmRleCwgc2NvcGUsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZSgkc2NvcGUuaW5mb01vZGVsW2ZpZWxkXSwgeyB2YWx1ZTogdiB9KS5kZXNjO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+mAgei0p+WRqOacnycsXG4gICAgICAgICAgICAgICAgZmllbGQ6ICdkZWxpdmVyeVRpbWUnLFxuICAgICAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2LCByLCBpbmRleCwgc2NvcGUsIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZSgkc2NvcGUuaW5mb01vZGVsW2ZpZWxkXSwgeyB2YWx1ZTogdiB9KS5kZXNjO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+WRqOi+uTAuNWtt5piv5ZCm5pyJ5bqXJyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2ZpdmVtZXRlcicsXG4gICAgICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGluZGV4LCBzY29wZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5pbmZvTW9kZWxbZmllbGRdLCB7IHZhbHVlOiB2IH0pLmRlc2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn5pON5L2cJyxcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2NvbW1hbmQnLFxuICAgICAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVwiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1wZW5jaWxcIj48L3NwYW4+PC9idXR0b24+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICAgICRzY29wZS5pbmZvcm1hdGlvblRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe30sIHtcbiAgICAgICAgICAgIGNvdW50czogW10sXG4gICAgICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnJlc2V0Q3JlYXRlQ29tcGFueU1vZGVsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuY3JlYXRlUHJlZmVyQ29tcGFueSA9IHtcbiAgICAgICAgICAgICAgICBjb21wYW55TmFtZTogJycsXG4gICAgICAgICAgICAgICAgY29tcGFueUlkOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRzY29wZS5pbmZvLmZvb2RQcmVmZXJzID0gW107XG4gICAgICAgICAgICAkc2NvcGUuaW5mby5kcmlua1ByZWZlcnMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5pbmZvLnByb2R1Y3RGdW5jdGlvbnMgPSBbXTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmdldFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKHZhbHVlKSB7IC8v5pCc57Si5Yqg6L29XG4gICAgICAgICAgICByZXR1cm4gY29tcGFueVNlcnZpY2UucXVlcnlDb21wYW55TGlzdCh7XG4gICAgICAgICAgICAgICAgcGFnZU5vOiAwLFxuICAgICAgICAgICAgICAgIGRlbFN0YXRlOiAwLFxuICAgICAgICAgICAgICAgIGNvbXBhbnlOYW1lOiB2YWx1ZVxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKGl0ZW0sIG1vZGVsLCBsYWJlbCwgZXZlbnQsIHR5cGUpIHsgLy/mkJzntKLpgInmi6lcbiAgICAgICAgICAgIGlmICh0eXBlID09ICdjcmVhdGUnKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVByZWZlckNvbXBhbnkgPSBpdGVtO1xuICAgICAgICAgICAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmTGlzdEJ5Q29tcGFueUlkKHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY3JlYXRlUHJlZmVyQ29tcGFueS5jb21wYW55SWRcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5mby5zaGVsZlBvc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVsZk5hbWU6IGl0ZW0uc2hlbGZOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWxmSWQ6IGl0ZW0uaWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnkgPSBpdGVtO1xuICAgICAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueUluZm9ybWF0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY29tcGFueS5jb21wYW55SWRcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmRldGFpbEluZm8uY29tcGFueU5hbWUgPSBpdGVtLmNvbXBhbnlOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIGl0ZW0uZGV0YWlsSW5mbykpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluZm9ybWF0aW9uVGFibGUuc2V0dGluZ3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNldDogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy/liJvlu7rkvIHkuJrkv6Hmga9cbiAgICAgICAgJHNjb3BlLm9wZW5DcmVhdGVDb21wYW55SW5mb3JtYXRpb25XaW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXNldENyZWF0ZUNvbXBhbnlNb2RlbCgpO1xuICAgICAgICAgICAgY29tcGFueUluZm9ybWF0aW9uQ3JlYXRlTW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2luZm9ybWF0aW9uQ3JlYXRlTW9kYWwnLFxuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiAkZWxlbWVudCxcbiAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgIG9rOiAkc2NvcGUuY3JlYXRlQ29tcGFueUluZm9ybWF0aW9uQ29uZmlybVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jcmVhdGVDb21wYW55SW5mb3JtYXRpb25Db25maXJtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5jcmVhdGVQcmVmZXJDb21wYW55LmNvbXBhbnlJZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5hbGVydCgn6K+36YCJ5oup5YWs5Y+477yBJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhbnlTZXJ2aWNlLmNyZWF0ZUNvbXBhbnlJbmZvcm1hdGlvbih7XG4gICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY3JlYXRlUHJlZmVyQ29tcGFueS5jb21wYW55SWQsXG4gICAgICAgICAgICAgICAgaW5mbzogJHNjb3BlLmluZm9cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+WIm+W7uuWWnOWlvVxuICAgICAgICAkc2NvcGUuYWRkUHJlZmVyID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgICAgICAgJHNjb3BlLmluZm9bdHlwZV0ucHVzaCh7XG4gICAgICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICcnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/liKDpmaTmtJflpb1cbiAgICAgICAgJHNjb3BlLmRlbGV0ZVByZWZlciA9IGZ1bmN0aW9uKHR5cGUsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgcHJlZmVycyA9ICRzY29wZS5pbmZvW3R5cGVdO1xuICAgICAgICAgICAgJHNjb3BlLmluZm9bdHlwZV0gPSBfLndpdGhvdXQocHJlZmVycywgcHJlZmVyc1tpbmRleF0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+S4i+aLieahhumAieaLqVxuICAgICAgICAkc2NvcGUuc2VsZWN0T3B0aW9uID0gZnVuY3Rpb24ob2JqLCB0eXBlLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGluZm9zID0gJHNjb3BlLmluZm9bdHlwZV07XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGluZm9zKSkge1xuICAgICAgICAgICAgICAgIGluZm9zW2luZGV4XS52YWx1ZSA9IG9iai52YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluZm9bdHlwZV0gPSBvYmoudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICB9KTtcbn07XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgdGFveGlhb2Zlbmcgb24gMjAxNi8xMS8yMy5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXBwKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoJ2lzc3VlRHluYW1pYycsIGZ1bmN0aW9uICgkc2NvcGUsIE5nVGFibGVQYXJhbXMsICR1aWJNb2RhbCwgbW9kYWxTZXJ2aWNlLCB1dGlsU2VydmljZSwgc3VpdGVTZXJ2aWNlLCBDT05TVEFOVFMsICRtZERpYWxvZywgb3JkZXJTZXJ2aWNlLCBwcmludFNlcnZpY2UpIHtcblxuICAgICAgICAkc2NvcGUuU1VJVEVfU1RBVFVTID0gQ09OU1RBTlRTLlNVSVRFX1NUQVRVUzsvL+Wll+mkkOeKtuaAgVxuICAgICAgICAkc2NvcGUuT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFOy8v6K6i5Y2V57G75Z6LXG4gICAgICAgICRzY29wZS5ERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTsvL+mAgei0p+WNleeKtuaAgVxuICAgICAgICAkc2NvcGUuSVNTVUVfQUNUSVZFID0gQ09OU1RBTlRTLklTU1VFX0FDVElWRTsvL+acn+WPt+exu+Wei1xuICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBpc3N1ZUlkOiAnJywgLy/mnJ/lj7dJRFxuICAgICAgICAgICAgY29tcGFueU5hbWU6ICcnLCAgICAvL+S8geS4muWQjeensFxuICAgICAgICAgICAgaXNzdWVTdGFydFRpbWU6ICcnLCAvL+WIm+W7uuacn+WPt+W8gOWni+aXtumXtFxuICAgICAgICAgICAgaXNzdWVFbmRUaW1lOiAnJywgICAgLy/liJvlu7rmnJ/lj7fnu5PmnZ/ml7bpl7RcbiAgICAgICAgICAgIGNvbXBhbnlJZDogJycsIC8v5YWs5Y+4SURcbiAgICAgICAgICAgIHNvcnRUeXBlOiAnJyAgLy/mjpLluo9cbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOacn+WPt+WunuaXtuWKqOaAgeWIl+ihqFxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLmlzc3VlRHluYW1pY0xpc3QgPSBmdW5jdGlvbiAocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgICAgICAgICAgY291bnQ6ICRzY29wZS5saW1pdFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGNvdW50czogW10sXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMjAsXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbk1pbkJsb2NrczogMixcbiAgICAgICAgICAgICAgICBnZXREYXRhOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRUeXBlOiRzY29wZS5xdWVyeVBhcmFtcy5zb3J0VHlwZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5jb21wYW55TmFtZSA9ICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKCRzY29wZS5xdWVyeVBhcmFtcy5pc3N1ZVN0YXJ0VGltZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuaXNzdWVTdGFydFRpbWUgPSAkc2NvcGUucXVlcnlQYXJhbXMuaXNzdWVTdGFydFRpbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTigkc2NvcGUucXVlcnlQYXJhbXMuaXNzdWVFbmRUaW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5pc3N1ZUVuZFRpbWUgPSAkc2NvcGUucXVlcnlQYXJhbXMuaXNzdWVFbmRUaW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWl0ZVNlcnZpY2UucXVlcnlJc3N1ZUR5bmFtaWMoYW5ndWxhci5jb3B5KHApKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tJbmZvKHV0aWxTZXJ2aWNlLmluZGV4QXJyYXkocmVzLmNvbnRlbnQsICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSkgKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5pc3N1ZUR5bmFtaWNMaXN0KCk7XG5cblxuXG4gICAgICAgIC8v5qC55o2u5LyB5Lia5pCc57SiXG4gICAgICAgICRzY29wZS5zZWFyY2hCeUNvbXBhbnkgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueU5hbWUgPSBjb21wYW55LmNvbXBhbnlOYW1lO1xuICAgICAgICAgICAgJHNjb3BlLmlzc3VlRHluYW1pY0xpc3QoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL+a4heepuuS8geS4muaQnOe0olxuICAgICAgICAkc2NvcGUuZW1wdHlDb21wYW55U2VhcmNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaJk+WNsFxuICAgICAgICAgKiDmiZPljbDljZXmja7liJfooahcbiAgICAgICAgICovXG4gICAgICAgIHZhciBwcmludE9yZGVyQXJyYXkgPSBbXTtcbiAgICAgICAgdmFyIGNoZWNrSW5mbyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKHByaW50T3JkZXJBcnJheSwge1xuICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBpdGVtLm9yZGVySWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jaGVja0FsbENmZyA9IHtcbiAgICAgICAgICAgIGZsYWc6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDli77pgIlcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbiAoZSwgb3JkZXIpIHtcbiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoXy5pc09iamVjdChlKSkge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3JkZXIuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgICAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBwcmludE9yZGVyQXJyYXkucHVzaChvcmRlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcHJpbnRPcmRlckFycmF5ID0gXy53aXRob3V0KHByaW50T3JkZXJBcnJheSwgb3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0QWxsT3JkZXIgPSBmdW5jdGlvbiAoZSwgZGF0YSwgY2hlY2thbGwpIHtcbiAgICAgICAgICAgIHZhciBzdCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCAhPT0gc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbihlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZCwgaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaJuemHj+aJk+WNsFxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnByaW50T3JkZXIgPSBmdW5jdGlvbiAob3JkZXJzKSB7XG4gICAgICAgICAgICB2YXIgdGVtcHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBhVGVtcHMgPSBbXTtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob3JkZXJzKSA9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICAgICAgYVRlbXBzID0gb3JkZXJzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhVGVtcHMgPSBbb3JkZXJzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhVGVtcHMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdGVtcHMucHVzaChpdGVtLmlkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gdmFyIGlkcyA9IHRlbXBzO1xuICAgICAgICAgICAgdmFyIGlkcyA9IHtcbiAgICAgICAgICAgICAgICBpZHM6dGVtcHNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzdWl0ZVNlcnZpY2UuaXNzdWVEeW5hbWljUHJpbnQoXG4gICAgICAgICAgICAgICAgLy8gaWRzOl8ucGx1Y2sob3JkZXJzLCdpZCcpXG4gICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KGlkcylcbiAgICAgICAgICAgICkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yZGVyRGV0YWlscyA9IHJlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNQcmludCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGVtcHMgPSBvcmRlclNlcnZpY2UucHJpbnRPcmRlckRvbXMob3JkZXJEZXRhaWxzLCAkc2NvcGUuT1JERVJfVFlQRS5JU1NVRURZTkFNSUMsICRzY29wZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGVtcHMpO1xuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBodG1scyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0ZW1wcyk7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0ZW1wcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW1bMF0uaW5uZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzLnB1c2goaXRlbVswXS5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcihodG1scyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGh0bWxzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuYmF0aE11bHRpUHJpbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAocHJpbnRPcmRlckFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wcmludE9yZGVyKHByaW50T3JkZXJBcnJheSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6JyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICfor7fpgInmi6npnIDopoHmiZPljbDnmoTnpajmja4nLFxuICAgICAgICAgICAgICAgICAgICBvazogJ+ehruiupCdcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiuouWNleaYjue7huaJk+WNsFxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLm9yZGVyRGV0YWlsUHJpbnQgPSBmdW5jdGlvbiAob3JkZXJUeXBlKSB7XG4gICAgICAgICAgICB2YXIgaHRtbCA9IG9yZGVyU2VydmljZS5nZXRQcmludEh0bWxJbk9yZGVyTW9kdWxlKG9yZGVyVHlwZSk7XG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGh0bWwpO1xuICAgICAgICAgICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIoaHRtbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOacn+WPt+iuouWNleaYjue7hlxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLmlzc3VlT3JkZXJEZXRhaWwgPSBmdW5jdGlvbiAoaXNzKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICAvL2FwcGVuZFRvOuWwhm1vZGFsIOWKoOi9veWIsOaMh+Wummlk55qERE9N6aG16Z2iXG4gICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaXNzdWVEeW5hbWljJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgLy90ZW1wbGF0ZVVybOWxnuaAp+WAvOaYr+S4gOS4qnVybOi3r+W+hCzot6/lvoTmjIflkJHkuIDkuKpodG1s5qih5p2/XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9pc3N1ZUR5bmFtaWNUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyAkc2NvcGUuaXNzID0gaXNzO1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtpc3N1ZUlkOiBpc3MuaXNzdWVJZCwgY29tcGFueUlkOiBpc3MuY29tcGFueUlkfTtcbiAgICAgICAgICAgIHN1aXRlU2VydmljZS5xdWVyeUlzc3VlQ2hhbmdlcyhwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIC8vIHJlc+eahOWAvOi1i+WAvOe7mSBpc3N1ZURldGFpbCDvvIznlKjkuo5IVE1MIOS4reeahOaVsOaNrua6kFxuICAgICAgICAgICAgICAgICRzY29wZS5pc3N1ZURldGFpbCA9IHJlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8v5o6S5bqPXG4gICAgICAgIC8qJHNjb3BlLnNvcnRCeUlzc3VlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5pc3N1ZUR5bmFtaWNMaXN0KFxuICAgICAgICAgICAgICAgICRzY29wZS5zb3J0VHlwZSA9IGl0ZW0uc29ydENvZGUgLy/pgJrov4flj4LmlbDkvKDnu5nmnI3liqHnq69cbiAgICAgICAgICAgICk7XG4gICAgICAgIH07Ki9cbiAgICAgICAgJHNjb3BlLnNvcnRCeUlzc3VlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zb3J0VHlwZSA9IGl0ZW0uc29ydENvZGU7XG4gICAgICAgICAgICAkc2NvcGUuaXNzdWVEeW5hbWljTGlzdCgpO1xuICAgICAgICB9O1xuICAgIH0pXG59O1xuXG5cbiIsIi8qKlxuICog5ZWG5ZOB5qCH562+566h55CGXG4gKiBsYWJlbHNNYW5hZ2VtZW50XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFwcCkge1xuICAgIGFwcC5jb250cm9sbGVyKCdsYWJlbHNNYW5hZ2VtZW50JywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkY29tcGlsZSwgbW9kYWxTZXJ2aWNlLCBsYWJlbHNNYW5hZ2VtZW50U2VydmljZSwgTmdUYWJsZVBhcmFtcykge1xuICAgICAgICAkc2NvcGUucGF0aHMgPSBbe1xuICAgICAgICAgICAgbmFtZTogJ+mmlumhtScsXG4gICAgICAgICAgICByb3V0ZTogJyNob21lJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5ZWG5ZOB566h55CGJyxcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZVxuICAgICAgICB9XTtcblxuXG4gICAgICAgICRzY29wZS50YWdzO1xuICAgICAgICAkc2NvcGUubGFiZWxOYW1lO1xuICAgICAgICAkc2NvcGUubGFiZWwgPSB7fTtcbiAgICAgICAgJHNjb3BlLmFkZExhYmVsID0ge307XG4gICAgICAgICRzY29wZS50YWdzTGlzdCA9IFtdO1xuICAgICAgICAkc2NvcGUubGFiZWxzTWFuYWdlbWVudFRhYmxlRGF0YSA9IFtdO1xuICAgICAgICAkc2NvcGUubmV3TGFiZWxzTWFuYWdlbWVudCA9IHt9O1xuICAgICAgICAkc2NvcGUubGFiZWxzTWFuYWdlbWVudElkID0gJyc7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDllYblk4HmoIfnrb4gLSDliJfooajmn6Xor6JcbiAgICAgICAgICog5o6l5Y+j5ZCNIC9jb21wYW55L2xhYmVsXG4gICAgICAgICAqIOivt+axguaWueazlSBHRVRcbiAgICAgICAgICogbGFiZWxOYW1lICDmoIfnrb7lkI3np7AgICBvZmZzZXQg5p2h55uu5YGP56e7IGxpbWl0ICAgXFzlvZPliY3pobXmmL7npLrmlbDmja7kuKrmlbBcbiAgICAgICAgICovXG5cbiAgICAgICAgJHNjb3BlLm9idGFpbkxhYmVzTGlzdCA9IGZ1bmN0aW9uICh0eXBlU29ydCkge1xuICAgICAgICAgICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgICAgICAgICAkc2NvcGUubGltaXQgPSAyMDtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAyMCxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLmdldExhYmVsc0xpc3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsTmFtZTogJHNjb3BlLmxhYmVsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHR5cGVTb3J0OiRzY29wZS50eXBlU29ydCAgLy8gJHNjb3BlLnR5cGVTb3J0ICDlj5Yg6LWL5YC8XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlU29ydDogdHlwZVNvcnQgLy8g5Y+WIHR5cGVTb3J0IOWPguaVsOWAvFxuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vYnRhaW5MYWJlc0xpc3QoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5qC55o2u5ZWG5ZOB5qCH562+5ZCN56ewIOafpeivolxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLmxhYmVsUXVlcnkgPSBmdW5jdGlvbiAobGFiZWxOYW1lKSB7XG4gICAgICAgICAgICBsYWJlbHNNYW5hZ2VtZW50U2VydmljZS5nZXRMYWJlbHNMaXN0KGxhYmVsTmFtZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9idGFpbkxhYmVzTGlzdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOa3u+WKoOagh+etviAgIOe8lui+keagh+etvlxuICAgICAgICAgKlxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnRhZ0VkaXQgPSBmdW5jdGlvbiAodFR5cGUpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5Yik5pat5omT5byAbW9kYWzml7bmmK/nvJbovpHov5jmmK/mt7vliqBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKHRUeXBlKSB7Ly/nvJbovpFcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkTGFiZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0VHlwZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgdGFnc05hbWU6IHRUeXBlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRUeXBlLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIG5vdGVOYW1lOiB0VHlwZS5yZW1hcmtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWZhdWx0SXRlbSA9IHsgLy/orr7nva7kuIvmi4npgInpobkg6buY6K6k5YC8XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0VHlwZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdFR5cGUudHlwZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgeyAvL+aWsOWinlxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRMYWJlbCA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWZhdWx0SXRlbSA9IHsgLy/orr7nva7kuIvmi4npgInpobkg6buY6K6k5YC8XG4gICAgICAgICAgICAgICAgICAgIGlkOiAwLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAn5pegJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xhYmVsc01hbmFnZW1lbnQnKSksXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FkZFRhZ3NNb2RhbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDmt7vliqAv57yW6L6R5qCH562+IC0g5LiL5ouJ5YiX6KGoLemAieaLqeagh+etvuexu+Wei1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0VGFnVHlwZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZExhYmVsLnR5cGUgPSBpdGVtLnR5cGU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDllYblk4HmoIfnrb4gLSDliKDpmaTllYblk4HmoIfnrb7lkI3np7BcbiAgICAgICAgICog5o6l5Y+j5ZCNIC9jb21wYW55L2xhYmVsL2RlbGV0ZV9uYW1lL+i/memHjOWhq+WGmWxhYmVsSWRcbiAgICAgICAgICog6K+35rGC5pa55rOVIERFTEVURVxuICAgICAgICAgKiDor7fmsYLlj4LmlbA6IGlkICAgIOS4u+mUrmlkXG4gICAgICAgICAqL1xuXG4gICAgICAgICRzY29wZS50YWdEZWxldGVDbGljayA9IGZ1bmN0aW9uIChpZCwgbmFtZSkge1xuICAgICAgICAgICAgJHNjb3BlLmxhYmVsc01hbmFnZW1lbnQgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5pZCA9IGlkO1xuICAgICAgICAgICAgJHNjb3BlLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgJHNjb3BlLm1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdsYWJlbHNNYW5hZ2VtZW50JykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdkZWxldGVUYWdNb2RlbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZGVsZXRlVGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICAgICAgbGFiZWxzTWFuYWdlbWVudFNlcnZpY2UuZGVsZXRlQ29tbW9kaXR5TGFiZWxOYW1lKHtcbiAgICAgICAgICAgICAgICBpZDogJHNjb3BlLmlkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2J0YWluTGFiZXNMaXN0KCk7XG4gICAgICAgICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5Yib5bu65ZWG5ZOB5qCH562+5ZCN56ewXG4gICAgICAgICAqIOa3u+WKoOagh+etvuehruiupFxuICAgICAgICAgKiBhZGRMYWJlbFxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLmFkZFRhZ3NDb25maXJtID0gZnVuY3Rpb24gKGFkZExhYmVsLCBzY29wZSkge1xuICAgICAgICAgICAgaWYgKGFkZExhYmVsLmlkKSB7IC8v57yW6L6RXG4gICAgICAgICAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0ge2lkOiBhZGRMYWJlbC5pZCwgdHlwZTogYWRkTGFiZWwudHlwZSwgbmFtZTogYWRkTGFiZWwudGFnc05hbWUsIHJlbWFyazogYWRkTGFiZWwubm90ZU5hbWV9O1xuICAgICAgICAgICAgICAgIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLm1vZGlmeWxhYmVsc05hbWUocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9idGFpbkxhYmVzTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICBtZS4kY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8v5paw5aKeXG4gICAgICAgICAgICAgICAgdmFyIG1lMiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKGFkZExhYmVsLnR5cGUgPT0gXCLml6BcIikge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuagh+etvuexu+Wei+S4jeiDveS4uifml6AnLOivt+mAieaLqeagh+etvuexu+WeiyEhIVwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zMiA9IHt0eXBlOiBhZGRMYWJlbC50eXBlLCBuYW1lOiBhZGRMYWJlbC50YWdzTmFtZSwgcmVtYXJrOiBhZGRMYWJlbC5ub3RlTmFtZX07XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLmNyZWF0ZUxhYmVsc05hbWUocGFyYW1zMikudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2J0YWluTGFiZXNMaXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZTIuJGNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDllYblk4HmoIfnrb4gLSDojrflj5bmoIfnrb7nsbvlnovliJfooahcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5xdWVyeVRhZ1R5cGVMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGFiZWxzTWFuYWdlbWVudFNlcnZpY2Uub2J0YWluTGFiZWxUeXBlTGlzdCgpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS50YWdzTGlzdCA9IHJlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUucXVlcnlUYWdUeXBlTGlzdCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDnrqHnkIbmoIfnrb7nsbvlnotcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS50YWdzVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5sYWJlbHNNYW5hZ2VtZW50ID0ge307XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlUYWdUeXBlTGlzdCgpO1xuICAgICAgICAgICAgJHNjb3BlLm1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdsYWJlbHNNYW5hZ2VtZW50JykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtYW5hZ2VtZW50VGFnVHlwZScsXG4gICAgICAgICAgICAgICAgdGFnc0xpc3Q6ICRzY29wZS50YWdzTGlzdFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5Yib5bu65qCH562+57G75Z6LXG4gICAgICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvY3JlYXRlX3R5cGVcbiAgICAgICAgICAgICAqIOivt+axguaWueazlSBQT1NUXG4gICAgICAgICAgICAgKiDor7fmsYLlj4LmlbA6IHR5cGUg5qCH562+57G75Z6LXG4gICAgICAgICAgICAgKiBuZXdUeXBlTmFtZSAgPT0gIHR5cGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgJHNjb3BlLmFkZFRhZ3NUeXBlID0gZnVuY3Rpb24gKG5ld1R5cGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBuZXdUeXBlTmFtZS50eXBlO1xuICAgICAgICAgICAgICAgIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLmNyZWF0ZUxhYmVsc1R5cGUodHlwZSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1R5cGVOYW1lLnR5cGUgPSBcIlwiOy8v5paw5aKe5ZCO5riF6ZmkaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5VGFnVHlwZUxpc3QoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5pu05paw5qCH562+57G75Z6LXG4gICAgICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvbW9kaWZ5X3R5cGVcbiAgICAgICAgICAgICAqIOivt+axguaWueazlSBQVVRcbiAgICAgICAgICAgICAqIOivt+axguWPguaVsCA6IGlkIOS4u+mUrmlkICAgdHlwZSDmoIfnrb7nsbvlnotcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgJHNjb3BlLm1vZGlmeVR5cGUgPSBmdW5jdGlvbiAodGFncykge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7dHlwZTogdGFncy50eXBlLCBpZDogdGFncy5pZH07XG4gICAgICAgICAgICAgICAgbGFiZWxzTWFuYWdlbWVudFNlcnZpY2UudXBkYXRlTGFiZWxUeXBlKHBhcmFtcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVRhZ1R5cGVMaXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ3MuaW5FZGl0ID0gIXRhZ3MuaW5FZGl0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDllYblk4HmoIfnrb4gLSDliKDpmaTmoIfnrb7nsbvlnotcbiAgICAgICAgICAgICAqIOaOpeWPo+WQjSAvY29tcGFueS9sYWJlbC9kZWxldGVfdHlwZS/ov5nph4zloavlhplsYWJlbElkXG4gICAgICAgICAgICAgKiDor7fmsYLmlrnms5UgREVMRVRFXG4gICAgICAgICAgICAgKiDor7fmsYLlj4LmlbA6IGlkICDkuLvplK5pZFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlVGFibGVUeWxlQ2xpY2sgPSBmdW5jdGlvbiAoaWQsIHR5cGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxzTWFuYWdlbWVudCA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5pZCA9IGlkO1xuICAgICAgICAgICAgICAgICRzY29wZS50eXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdsYWJlbHNNYW5hZ2VtZW50JykpLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RlbGV0ZVRhZ1R5cGVNb2RlbCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlTGFiZWxUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgbGFiZWxzTWFuYWdlbWVudFNlcnZpY2UuZGVsZXRlTGFiZWxUeXBlKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICRzY29wZS5pZFxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlUYWdUeXBlTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2J0YWluTGFiZXNMaXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIOmAieaLqeagh+etvuWbnuiwg1xuICAgICAgICAgICAgICogQHBhcmFtIHRhZ3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFRhZ3NDYWxsYmFjayA9IGZ1bmN0aW9uICh0YWdzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRhZ3MgPSB0YWdzO1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVRhZ1R5cGVMaXN0KHRhZ3MpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOagh+etvuexu+Wei+aOkuW6j1xuICAgICAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnNvcnRCeVRhZ3NUeXBlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIC8vICRzY29wZS50eXBlU29ydCA9IGl0ZW0uc29ydENvZGU7IC8vIOi1i+WAvCDkvKDnu5nmnI3liqHnq69cbiAgICAgICAgICAgICRzY29wZS5vYnRhaW5MYWJlc0xpc3QoXG4gICAgICAgICAgICAgICAgJHNjb3BlLnR5cGVTb3J0ID0gaXRlbS5zb3J0Q29kZSAgLy8g6YCa6L+H5Y+C5pWw5Lyg57uZ5pyN5Yqh56uvXG4gICAgICAgICAgICApO1xuICAgICAgICB9O1xuICAgIH0pO1xufTtcblxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ25ld1Byb2R1Y3RSZWNvbW1lbmRDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBuZXdQcm9kdWN0U2VydmljZSwgTmdUYWJsZVBhcmFtcywgbW9kYWxTZXJ2aWNlLCBuZXdQcm9kdWN0U2VydmljZSwgIHByb2R1Y3RTZXJ2aWNlLCAkZWxlbWVudCwgJGNvbXBpbGUsICR0ZW1wbGF0ZUNhY2hlLCB1dGlsU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgJHNjb3BlLmxhYmVsTGlzdCA9IFtdO1xuICAgICRzY29wZS5wcm9kdWN0ID0ge307XG4gICAgJHNjb3BlLnByb2ZpdExldmVsID0gQ09OU1RBTlRTLlBST0ZJVF9MRVZFTDtcbiAgICAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcyA9IHt9O1xuICAgICRzY29wZS5jYXRlb3R5TGlzdCA9IFtdO1xuICAgICRzY29wZS5sYXN0VXBkYXRlVGltZSA9ICcnOyAvLyDplIDllK7mlbDmja7mm7TmlrDkuo5cblxuICAgIC8v6KGo5qC86K6+572uXG4gICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge307XG4gICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgdmFyIHRtcFB1dFNhbGVPYmogPSB7fTtcblxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICB9LCB7XG4gICAgICBjb3VudHM6IFtdLFxuICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMjAsXG4gICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICRzY29wZS5vZmZzZXQgPSAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpO1xuICAgICAgICB2YXIgc2VhcmNoID0gZ2V0UGFyYW1zKCk7XG4gICAgICAgIHNlYXJjaC5vZmZzZXQgPSAkc2NvcGUub2Zmc2V0O1xuICAgICAgICBzZWFyY2gubGltaXQgPSAkc2NvcGUubGltaXQ7XG4gICAgICAgIHJldHVybiBuZXdQcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RCeUtleShzZWFyY2gpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLmxhc3RVcGRhdGVUaW1lID0gcmVzLmxhc3RVcGRhdGVUaW1lO1xuICAgICAgICAgIHJldHVybiBuZXdQcm9kdWN0U2VydmljZS5pbmRleERhdGEocmVzLmxpc3QsICRzY29wZS5vZmZzZXQgKyAxKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdmFyIGdldFBhcmFtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHRlbXAgPSAkc2NvcGUucXVlcnlQYXJhbXM7XG4gICAgICB0ZW1wW3RlbXAubWFya0lkXSA9IHRlbXAucXVlcnlOYW1lO1xuICAgICAgcmV0dXJuIF8ub21pdCh0ZW1wLCAnbWFya0lkJywgJ3F1ZXJ5TmFtZScpO1xuICAgIH07XG4gICAgLy/pgInmi6lcbiAgICAkc2NvcGUucXVlcnlQcm9kdWN0Q29uZmlnID0ge1xuICAgICAgbmFtZVR5cGVEYXRhOiBbe1xuICAgICAgICBtYXJrSWQ6ICdwcm9kdWN0TmFtZScsIGRlc2M6ICfllYblk4EnXG4gICAgICB9LCB7XG4gICAgICAgIG1hcmtJZDogJ3NrdUNvZGUnLCBkZXNjOiAn5ZWG5ZOB57yW56CBJ1xuICAgICAgfV0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtc1tcIm1hcmtJZFwiXSA9IGl0ZW0ubWFya0lkO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvL+Wbnui9pumUruafpeivolxuICAgICRzY29wZS5wcm9kdWN0S2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICBpZiAoa2V5Y29kZSA9PSAxMykge1xuICAgICAgICAkc2NvcGUucHJvZHVjdFNlYXJjaCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/mn6Xor6Ig5ZWG5ZOB5ZCN56ewXG4gICAgJHNjb3BlLnByb2R1Y3RTZWFyY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS50YWJsZVBhcmFtcy5zZXR0aW5ncyh7XG4gICAgICAgIGRhdGFzZXQ6IFtdXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8g6YCJ5Lit5Yeg5p2h5pWw5o2u6L+b6KGM5a+85Ye6ZXhjZWxcbiAgICAvLyDkuIvpnaLku6PnoIHkuLrlr7zlh7pFeGNlbOWBmuWHhuWkh1xuICAgIHZhciBleGNlbFRlbXBsYXRlID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KCdwcm9kdWN0L25ld1Byb2R1Y3RUYWJsZVRlbXBsYXRlLmh0bWwnKSkoJHNjb3BlKTtcbiAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydEV4Y2VsV3JhcCcpKS5hcHBlbmQoZXhjZWxUZW1wbGF0ZSk7XG5cbiAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0TGlzdCA9IFtdOyAvL+mAieS4reeahOWVhuWTgeWIl+ihqFxuICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbihlLCBwcm9kdWN0KSB7XG4gICAgICB2YXIgaXNDaGVja2VkID0gXy5pc09iamVjdChlKSA/IGUuY3VycmVudFRhcmdldC5jaGVja2VkIDogZTtcbiAgICAgIHByb2R1Y3QuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkUHJvZHVjdExpc3QucHVzaChwcm9kdWN0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0ID0gXy53aXRob3V0KCRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0LFxuICAgICAgICAgIHByb2R1Y3QpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyDlr7zlh7pleGNlbFxuICAgICRzY29wZS5leHBvcnRFeGNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghJHNjb3BlLnNlbGVjdGVkUHJvZHVjdExpc3QubGVuZ3RoKSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+ivt+WFiOmAieaLqemcgOWvvOWHuueahOaWsOWTgScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICBkb21bMF0uaHJlZiA9ICQoJyNleHBvcnQtY29tcGFueS10YWJsZScpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICBjb250YWluZXJpZDogJ2V4cG9ydC1jb21wYW55LXRhYmxlJyxcbiAgICAgICAgZGF0YXR5cGU6ICd0YWJsZScsXG4gICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICB9KTtcbiAgICAgIGRvbVswXS5kb3dubG9hZCA9ICfmlrDlk4HmjqjojZDliJfooagueGxzJztcbiAgICAgIGRvbVswXS5jbGljaygpO1xuICAgIH07XG5cbiAgICAvLyDmt7vliqDmlrDlk4HvvIzlj4LogIPmi6PotKfljZVcbiAgICAkc2NvcGUub3BlbkFkZE1vZGFsID0gZnVuY3Rpb24gKHRlbXBsYXRlVXJsKSB7XG4gICAgICAkc2NvcGUuYWRkTW9kZWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9kdWN0JykpLFxuICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGVVcmwsXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHNpemU6ICdsZydcbiAgICAgIH0pO1xuXG4gICAgICAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgc2V0TmV3UHJvZHVjdHNUYWJsZSgpO1xuICAgICAgcXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0KCk7XG4gICAgfTtcblxuICAgIC8v5p+l6K+i5ZWG5ZOB57G75Yir5YiX6KGoXG4gICAgdmFyIHF1ZXJ5UHJvZHVjdENhdGVnb3J5TGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0KCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmNhdGVvdHlMaXN0ID0gW3tcbiAgICAgICAgICBjb2RlOiAnLTEnLFxuICAgICAgICAgIGRlc2M6IFwi5YWo6YOo5ZOB57G7XCJcbiAgICAgICAgfV07XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChyZXMsIGZ1bmN0aW9uKGNhdGVnb3J5LCBpbmRleCkge1xuICAgICAgICAgIHZhciBpdGVtID0geyAnY29kZSc6IGNhdGVnb3J5LmlkLCAnZGVzYyc6IGNhdGVnb3J5LmNhdGVnb3J5TmFtZSB9O1xuICAgICAgICAgICRzY29wZS5jYXRlb3R5TGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLnByb2ZpdExpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICBjbHNPck5hbWU6ICdQUk9GSVRfTEVWRUwnLFxuICAgICAgZGVmYXVsdE9iajogeyAnLTEnOiAn5YWo6YOo5Yip5ram562J57qnJyB9XG4gICAgfSk7XG5cbiAgICAvLyDmlrDlk4HkuIrmnrZtb2RhbOS4reeahOihqOagvOaVsOaNrlxuICAgIHZhciBzZXROZXdQcm9kdWN0c1RhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUub2Zmc2V0MiA9IDA7XG4gICAgICAkc2NvcGUubGltaXQyID0gMTA7XG4gICAgICAkc2NvcGUubmV3UHJvZGN1dHNUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgY291bnQ6ICRzY29wZS5saW1pdDJcbiAgICAgIH0sIHtcbiAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMTMsXG4gICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgIC8vIOavj+asoeWPlumHjeaWsOa4suafk+ihqOagvOeahOaXtuWAme+8jOa4healmuS5i+WJjemAieaLqeeahOaVsOaNrlxuICAgICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3RzID0gW107XG4gICAgICAgICAgcmV0dXJuIG5ld1Byb2R1Y3RTZXJ2aWNlLnF1ZXJ5QWxsUHJvZHVjdCh7XG4gICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5saW1pdDIgKiAocGFyYW1zLnBhZ2UoKSAtIDEpLFxuICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdDIsXG4gICAgICAgICAgICBwcm9kdWN0VGFnczogWy0xXSwgLy8g5p+l6K+i5ZWG5ZOB5bqT5Lit6Z2e5paw5ZOB55qE5ZWG5ZOBXG4gICAgICAgICAgICBwcm9kdWN0TmFtZTogJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMucHJvZHVjdE5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeUlkOiAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcy5jYXRlZ29yeUlkLFxuICAgICAgICAgICAgcHJvZml0TGV2ZWw6ICRzY29wZS5uZXdQcm9kdWN0c1F1ZXJ5UGFyYW1zLnByb2ZpdExldmVsLFxuICAgICAgICAgICAgaXNEZWxldGVkOiAwXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3UHJvZHVjdFNlcnZpY2UuX3BhcnNlT3RoZXJTaGVsZlByb2R1Y3RzKHJlcy5jb250ZW50LFxuICAgICAgICAgICAgICBfLmtleXModG1wUHV0U2FsZU9iaikpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy/llYblk4HpgInmi6lcbiAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0cyA9IFtdO1xuICAgICRzY29wZS5jaGtib3hDaGFuZ2UgPSBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICB2YXIgcHJvZHVjdElkID0gcHJvZHVjdC5pZDtcbiAgICAgIGlmIChwcm9kdWN0LnNlbGVjdCkge1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0cy5wdXNoKHByb2R1Y3RJZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0cyA9IF8ud2l0aG91dCgkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0cywgcHJvZHVjdElkKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy/lk4HnsbvpgInmi6lcbiAgICAkc2NvcGUuc2VsZWN0Q2F0ZWdvcnlDYWxsYmFjayA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNvZGUpIHtcbiAgICAgICAgaXRlbS5jb2RlICE9PSAnLTEnID8gJHNjb3BlLm5ld1Byb2R1Y3RzUXVlcnlQYXJhbXMuY2F0ZWdvcnlJZCA9XG4gICAgICAgICAgICBpdGVtLmNvZGUgOiAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcy5jYXRlZ29yeUlkID1cbiAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgc2V0TmV3UHJvZHVjdHNUYWJsZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/liKnmtqbnrYnnuqfpgInmi6lcbiAgICAkc2NvcGUuc2VsZWN0UHJvZml0Q2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpZiAoaXRlbS5jb2RlKSB7XG4gICAgICAgIGl0ZW0uY29kZSAhPT0gJy0xJyA/ICRzY29wZS5uZXdQcm9kdWN0c1F1ZXJ5UGFyYW1zLnByb2ZpdExldmVsID1cbiAgICAgICAgICAgIGl0ZW0uY29kZSA6ICRzY29wZS5uZXdQcm9kdWN0c1F1ZXJ5UGFyYW1zLnByb2ZpdExldmVsID1cbiAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgc2V0TmV3UHJvZHVjdHNUYWJsZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/mkJzntKLllYblk4FcbiAgICAkc2NvcGUuc2VhcmNoUHJvZHVjdCA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICAkc2NvcGUubmV3UHJvZHVjdHNRdWVyeVBhcmFtcy5wcm9kdWN0TmFtZSA9IHF1ZXJ5UGFyYW1zLnByb2R1Y3ROYW1lO1xuICAgICAgc2V0TmV3UHJvZHVjdHNUYWJsZSgpO1xuICAgIH07XG4gICAgJHNjb3BlLmtleVByZXNzU2VhcmNoUHJvZHVjdCA9IGZ1bmN0aW9uKGUsIHF1ZXJ5UGFyYW1zKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7IC8v5Zue6L2m6ZSuXG4gICAgICAgICRzY29wZS5zZWFyY2hQcm9kdWN0KHF1ZXJ5UGFyYW1zKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8g56Gu6K6k5re75Yqg5paw5ZOBXG4gICAgJHNjb3BlLmNvbmZpcm1BZGROZXdQcm9kdWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgbmV3UHJvZHVjdFNlcnZpY2UuYWRkTmV3UHJvZHVjdHMoe1xuICAgICAgICBwcm9kdWN0SWRzOiAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0c1xuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgJHNjb3BlLmFkZE1vZGVsLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8g5Yig6Zmk5paw5ZOBXG4gICAgJHNjb3BlLmRlbGV0ZUZvcm0gPSB7fTtcbiAgICAkc2NvcGUuZGVsZXRlTmV3UHJvZHVjdCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAkc2NvcGUuZGVsZXRlRm9ybSA9IHt9O1xuICAgICAgJHNjb3BlLmRlbGV0ZUZvcm0ucHJvZHVjdElkID0gaWQ7XG4gICAgICBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9kdWN0JykpLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ25ld1Byb2R1Y3REZWxldGUnLFxuICAgICAgICBzY29wZTogJHNjb3BlXG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5uZXdQcm9kdWN0RGVsZXRlU2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgIG5ld1Byb2R1Y3RTZXJ2aWNlLmRlbGV0ZU5ld1Byb2R1Y3Qoe1xuICAgICAgICBpZDogJHNjb3BlLmRlbGV0ZUZvcm0ucHJvZHVjdElkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIOWIh+aNouaWsOWTgeaOqOiNkOS4rSAx77yM5b6F5o6o6I2Q54q25oCBIDDvvIxcbiAgICAkc2NvcGUudG9nZ2xlUHJvZHVjdFN0YXR1cyA9IGZ1bmN0aW9uIChwcm9JZCwgbmV3UmVjb21tZW5kKSB7XG4gICAgICBuZXdSZWNvbW1lbmQgPSBuZXdSZWNvbW1lbmQgPT0gMSA/IDAgOiAxO1xuICAgICAgbmV3UHJvZHVjdFNlcnZpY2UuY2hhbmdlTmV3UHJvZHVjdFN0YXR1cyh7XG4gICAgICAgIGlkOiBwcm9JZCxcbiAgICAgICAgbmV3UmVjb21tZW5kOiBuZXdSZWNvbW1lbmRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICB9KVxuICAgIH07XG5cbiAgICAkc2NvcGUucHJvZHVjdCA9IHtcbiAgICAgIGlkOiAnJyxcbiAgICAgIHByb2R1Y3ROYW1lOiAnJyxcbiAgICAgIGNhdGVnb3J5SWQ6ICcnLFxuICAgICAgc2t1Q29kZTogJycsXG4gICAgICBwcmljZTogJycsXG4gICAgICByZWNvbW1lbmRUaW1lczogJycsIC8vIOaOqOiNkOasoeaVsFxuICAgICAgcmVjb21tZW5kUmF0ZTogJycsIC8vIOaOqOiNkOaLo+i0p+eOh1xuICAgICAgZGVsaXZlcnlCYWNrUmF0ZTogJycsXG4gICAgICBzaGlwbWVudFJhdGU6ICcnLFxuICAgICAgc3RvY2s6ICcnLFxuICAgICAgYXZhaWxhYmxlU3RvY2s6ICcnLFxuXG4gICAgICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaWQgPSAnJztcbiAgICAgICAgdGhpcy5wcm9kdWN0TmFtZSA9ICcnO1xuICAgICAgICB0aGlzLmNhdGVnb3J5SWQgPSAnJztcbiAgICAgICAgdGhpcy5za3VDb2RlID0gJyc7XG4gICAgICAgIHRoaXMucHJpY2UgPSAnJztcbiAgICAgICAgdGhpcy5yZWNvbW1lbmRUaW1lcyA9ICcnO1xuICAgICAgICB0aGlzLnJlY29tbWVuZFJhdGUgPSAnJztcbiAgICAgICAgdGhpcy5kZWxpdmVyeUJhY2tSYXRlID0gJyc7XG4gICAgICAgIHRoaXMuc2hpcG1lbnRSYXRlID0gJyc7XG4gICAgICAgIHRoaXMuc3RvY2sgPSAnJztcbiAgICAgICAgdGhpcy5hdmFpbGFibGVTdG9jayA9ICcnO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoJ29yZGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGNvbXBpbGUsICR0ZW1wbGF0ZUNhY2hlLCAkbWREaWFsb2csIG1vZGFsU2VydmljZSwgcHJpbnRTZXJ2aWNlLCBvcmRlclNlcnZpY2UsIE5nVGFibGVQYXJhbXMsIHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgJHNjb3BlLnV0aWxTZXJ2aWNlID0gdXRpbFNlcnZpY2U7XG4gICAgICAgICRzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgICRzY29wZS5ERUxJVkVSWV9VUkdFTkNZID0gQ09OU1RBTlRTLkRFTElWRVJZX1VSR0VOQ1k7XG4gICAgICAgICRzY29wZS5DT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgICAgICAkc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuXG4gICAgICAgIHZhciBERUxJVkVSWV9VUkdFTkNZID0gQ09OU1RBTlRTLkRFTElWRVJZX1VSR0VOQ1k7XG4gICAgICAgIHZhciBDT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgICAgICB2YXIgT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFO1xuICAgICAgICB2YXIgREVMSVZFUllfU1RBVEUgPSBDT05TVEFOVFMuREVMSVZFUllfU1RBVEU7XG4gICAgICAgIHZhciBSRUZVTkRfU1RBVEUgPSBDT05TVEFOVFMuUkVGVU5EX1NUQVRFO1xuICAgICAgICB2YXIgSU5WRU5UT1JZX1NUQVRFID0gQ09OU1RBTlRTLklOVkVOVE9SWV9TVEFURTtcbiAgICAgICAgdmFyIFNFVFRMRU1FTlRfU1RBVEUgPSBDT05TVEFOVFMuU0VUVExFTUVOVF9TVEFURTtcblxuICAgICAgICAkc2NvcGUub2Zmc2V0O1xuICAgICAgICAkc2NvcGUubGltaXQ7XG4gICAgICAgICRzY29wZS5jdXJPcmRlclR5cGUgPSB7IGRlc2M6ICflhajpg6jljZXmja7nsbvlnosnIH07XG4gICAgICAgICRzY29wZS5vcmRlclR5cGVMaXN0ID0gW3sgZGVzYzogJ+WFqOmDqOWNleaNruexu+WeiycgfSxcbiAgICAgICAgICAgIHsgZGVzYzogT1JERVJfVFlQRS5ERVNDW09SREVSX1RZUEUuREVMSVZFUlldLCBvcmRlclR5cGU6IE9SREVSX1RZUEUuREVMSVZFUlkgfSxcbiAgICAgICAgICAgIHsgZGVzYzogT1JERVJfVFlQRS5ERVNDW09SREVSX1RZUEUuUkVGVU5EXSwgb3JkZXJUeXBlOiBPUkRFUl9UWVBFLlJFRlVORCB9LFxuICAgICAgICAgICAgeyBkZXNjOiBPUkRFUl9UWVBFLkRFU0NbT1JERVJfVFlQRS5JTlZFTlRPUlldLCBvcmRlclR5cGU6IE9SREVSX1RZUEUuSU5WRU5UT1JZIH0sXG4gICAgICAgICAgICB7IGRlc2M6IE9SREVSX1RZUEUuREVTQ1tPUkRFUl9UWVBFLlNFVFRMRU1FTlRdLCBvcmRlclR5cGU6IE9SREVSX1RZUEUuU0VUVExFTUVOVCB9XG4gICAgICAgIF07XG4gICAgICAgICRzY29wZS5pc1VwZGF0ZVRpbWVDaG9pY2VzID0gQ09OU1RBTlRTLmdldExpc3QoJ0lOVk9JQ0VfVElNRV9UWVBFJywgZmFsc2UpO1xuICAgICAgICAkc2NvcGUuaXNQYWlkTGlzdCA9IFt7IGRlc2M6ICflhajpg6jku5jmrL7nirbmgIEnLCBjb2RlOiAnJyB9LCB7IGRlc2M6ICfmnKrku5jmrL4nLCBjb2RlOiAnMCcgfSwgeyBkZXNjOiAn5bey5LuY5qy+JywgY29kZTogJzEnIH1dO1xuICAgICAgICAkc2NvcGUuaW52b2ljZU5lZWRTdGF0ZUxpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCgnSU5WT0lDRV9ORUVEX1NUQVRFJywgdHJ1ZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHsgJyc6ICflhajpg6jlvIDnpajpnIDmsYInIH0pO1xuICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlciA9IHt9O1xuICAgICAgICAkc2NvcGUucmVmdW5kT3JkZXIgPSB7fTtcbiAgICAgICAgJHNjb3BlLmludmVudG9yeU9yZGVyID0ge307XG4gICAgICAgICRzY29wZS5zZXR0bGVtZW50T3JkZXIgPSB7fTtcblxuICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBjcmVhdGVTdGFydFRpbWU6ICcnLFxuICAgICAgICAgICAgY3JlYXRlRW5kVGltZTogJycsXG4gICAgICAgICAgICB1cGRhdGVTdGFydFRpbWU6ICcnLFxuICAgICAgICAgICAgdXBkYXRlRW5kVGltZTogJycsXG4gICAgICAgICAgICBpc0ludm9pY2U6ICcnLCAvLzAg5LiN6ZyA6KaB5byA56WoICAx6ZyA6KaB5byA56WoXG4gICAgICAgICAgICBpc1BhaWQ6ICcnLCAvLyAwIOayoeaciSAgMSDlt7LmlK/ku5hcbiAgICAgICAgICAgIGlzVXBhdGVUaW1lOiAwLFxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0SXNVcGFkYXRlID0gZnVuY3Rpb24oY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUgPSBwYXJzZUludChjaG9pY2UuY29kZSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RJc1BhaWQgPSBmdW5jdGlvbihjaG9pY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5pc1BhaWQgPSBjaG9pY2UuY29kZTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlclRhYmxlLnJlbG9hZCgpO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyVGFibGUucGFnZSgxKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEludm9pY2VuTmVlZFN0YXRlID0gZnVuY3Rpb24oY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNJbnZvaWNlID0gY2hvaWNlLmNvZGU7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlclRhYmxlLnBhZ2UoMSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzZXRPcmRlclRhYmxlID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSA9ICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSB8fCB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJyk7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheSB8fCB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKTtcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAxMyxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogKHBhcmFtcy5wYWdlKCkgLSAxKSAqICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlclR5cGU6ICRzY29wZS5jdXJPcmRlclR5cGUub3JkZXJUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFueU5hbWU6ICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55TmFtZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzSW52b2ljZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuaXNJbnZvaWNlID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzSW52b2ljZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzUGFpZCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuaXNQYWlkID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzUGFpZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzVXBhdGVUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnVwZGF0ZVN0YXJ0VGltZSA9IG5ldyBEYXRlKCRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSArICcgMDA6MDA6MDAnKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnVwZGF0ZUVuZFRpbWUgPSBuZXcgRGF0ZSgkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ICsgJyAyMzo1OTo1OScpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuY3JlYXRlU3RhcnRUaW1lID0gbmV3IERhdGUoJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0RGF5ICsgJyAwMDowMDowMCcpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuY3JlYXRlRW5kVGltZSA9IG5ldyBEYXRlKCRzY29wZS5xdWVyeVBhcmFtcy5lbmREYXkgKyAnIDIzOjU5OjU5JykuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyU2VydmljZS5xdWVyeU9yZGVyTGlzdChwKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0luZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHNldE9yZGVyVGFibGUoKTtcbiAgICAgICAgLy/mkJzntKLljZXmja5cbiAgICAgICAgJHNjb3BlLnNlYXJjaE9yZGVycyA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zIHx8IHt9O1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lID0gcXVlcnlQYXJhbXMuY29tcGFueU5hbWU7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnREYXkgPSBxdWVyeVBhcmFtcy5zdGFydFRpbWUgPyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUocXVlcnlQYXJhbXMuc3RhcnRUaW1lLCAneXl5eS1NTS1kZCcpIDpcbiAgICAgICAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJyk7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ID0gcXVlcnlQYXJhbXMuZW5kVGltZSA/IHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZShxdWVyeVBhcmFtcy5lbmRUaW1lLCAneXl5eS1NTS1kZCcpIDpcbiAgICAgICAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKTtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5pc1VwYXRlVGltZSA9IHF1ZXJ5UGFyYW1zLmlzVXBhdGVUaW1lO1xuICAgICAgICAgICAgc2V0T3JkZXJUYWJsZSgpO1xuICAgICAgICB9O1xuICAgICAgICAvL+iOt+WPluWNleaNrueKtuaAgeaPj+i/sFxuICAgICAgICAkc2NvcGUuZ2V0T3JkZXJTdGF0ZURlc2MgPSBmdW5jdGlvbihvcmRlclR5cGUsIG9yZGVyU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBvcmRlclN0YXRlRGVzYyA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChvcmRlclR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyU3RhdGVEZXNjID0gREVMSVZFUllfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlJFRlVORDpcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJTdGF0ZURlc2MgPSBSRUZVTkRfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLklOVkVOVE9SWTpcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJTdGF0ZURlc2MgPSBJTlZFTlRPUllfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlNFVFRMRU1FTlQ6XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyU3RhdGVEZXNjID0gU0VUVExFTUVOVF9TVEFURS5ERVNDW29yZGVyU3RhdGVdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvcmRlclN0YXRlRGVzYztcbiAgICAgICAgfTtcbiAgICAgICAgLy/pgInmi6nljZXmja7nsbvlnotcbiAgICAgICAgJHNjb3BlLnNlbGVjdE9yZGVyVHlwZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcblxuICAgICAgICAgICAgJHNjb3BlLmN1ck9yZGVyVHlwZSA9IGl0ZW07XG4gICAgICAgICAgICBzZXRPcmRlclRhYmxlKCk7XG4gICAgICAgIH07XG4gICAgICAgIC8v5piO57uGXG4gICAgICAgICRzY29wZS5jaGVja09yZGVyRGV0YWlsID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBvcmRlcklkKSB7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UuY2hlY2tPcmRlckRldGFpbChvcmRlclR5cGUsIG9yZGVySWQsICRzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgIC8v6I635Y+W6YCB6LSn5Y2V6K+m5oOFXG4gICAgICAgIHZhciBnZXREZWxpdmVyeURldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5RGV0YWlsKHsgJ29yZGVySWQnOiBvcHRzLm9yZGVySWQgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlciA9IHJlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5uYW1lID0gJ+mAgei0p+WNlScgKyAnLScgKyAkc2NvcGUuZGVsaXZlcnlPcmRlci5jb21wYW55TmFtZSArICctJyArICRzY29wZS5kZWxpdmVyeU9yZGVyLnNoZWxmTmFtZSArXG4gICAgICAgICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZygkc2NvcGUuZGVsaXZlcnlPcmRlci5jcmVhdGVUaW1lLCAneXl5eU1NZGRoaG1tc3MnKSArICcpJztcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5wdXRTYWxlUHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5zdXBwbGVtZW50UHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcnlPcmRlci5wdWxsU2FsZVByb2R1Y3RMaXN0ID0gW107XG5cbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmRlbGl2ZXJ5T3JkZXIuaXRlbXMsIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwYXJzZUludChpdGVtLml0ZW1UeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1dFNhbGVQcm9kdWN0TGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnN1cHBsZW1lbnRQcm9kdWN0TGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG9wdHMuZGlkTG9hZERhdGEoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+iOt+WPlumAgOi0p+WNleivpuaDhVxuICAgICAgICB2YXIgZ2V0UmVmdW5kRGV0YWlsID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5UmVmdW5kRGV0YWlsKHsgJ29yZGVySWQnOiBvcHRzLm9yZGVySWQgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVmdW5kT3JkZXIgPSByZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZnVuZE9yZGVyLm5hbWUgPSAn6YCA6LSn5Y2VJyArICctJyArICRzY29wZS5yZWZ1bmRPcmRlci5jb21wYW55TmFtZSArICctJyArICRzY29wZS5yZWZ1bmRPcmRlci5zaGVsZk5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoJHNjb3BlLnJlZnVuZE9yZGVyLmNyZWF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgICAgIG9wdHMuZGlkTG9hZERhdGEoKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfTtcbiAgICAgICAgLy/ojrflj5bnm5jngrnljZXor6bmg4VcbiAgICAgICAgdmFyIGdldEludmVudG9yeURldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5xdWVyeUludmVudG9yeURldGFpbCh7ICdvcmRlcklkJzogb3B0cy5vcmRlcklkIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludmVudG9yeU9yZGVyID0gcmVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnZlbnRvcnlPcmRlci5uYW1lID0gJ+ebmOeCueWNlScgKyAnLScgKyAkc2NvcGUuaW52ZW50b3J5T3JkZXIuY29tcGFueU5hbWUgKyAnLScgKyAkc2NvcGUuaW52ZW50b3J5T3JkZXIuc2hlbGZOYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5pbnZlbnRvcnlPcmRlci5jcmVhdGVUaW1lLCAneXl5eU1NZGRoaG1tc3MnKSArICcpJztcbiAgICAgICAgICAgICAgICBvcHRzLmRpZExvYWREYXRhKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/ojrflj5bnu5PnrpfljZXor6bmg4VcbiAgICAgICAgdmFyIGdldFNldHRsZW1lbnREZXRhaWwgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UucXVlcnlTZXR0bGVtZW50RGV0YWlsKHsgJ29yZGVySWQnOiBvcHRzLm9yZGVySWQgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2V0dGxlbWVudE9yZGVyID0gb3JkZXJTZXJ2aWNlLl9wYXJzZVNldHRsZW1lbnREZXRhaWxEYXRhKHJlcyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldHRsZW1lbnRPcmRlci5uYW1lID0gJ+e7k+eul+WNlScgKyAnLScgKyAkc2NvcGUuc2V0dGxlbWVudE9yZGVyLmNvbXBhbnlOYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5zZXR0bGVtZW50T3JkZXIuY3JlYXRlVGltZSwgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICAgICAgb3B0cy5kaWRMb2FkRGF0YSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8v6K+m57uGTW9kYWzkuK3lr7zlh7pFeGNlbO+8iOenu+iHs3NlcnZpY2XvvIlcbiAgICAgICAgLy/liJfooajkuK3lr7zlh7pFeGNlbFxuICAgICAgICAkc2NvcGUuZXhwb3J0RXhjZWxPbkxpc3QgPSBmdW5jdGlvbihvcmRlclR5cGUsIG9yZGVySWQpIHtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5leHBvcnRFeGNlbChvcmRlclR5cGUsIG9yZGVySWQsICRzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgIC8q5omT5Y2wKi9cbiAgICAgICAgLy/miZPljbDljZXmja7liJfooahcbiAgICAgICAgdmFyIHByaW50T3JkZXJBcnJheSA9IFtdO1xuICAgICAgICB2YXIgY2hlY2tJbmZvID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKHByaW50T3JkZXJBcnJheSwge1xuICAgICAgICAgICAgICAgICAgICBvcmRlcklkOiBpdGVtLm9yZGVySWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jaGVja0FsbENmZyA9IHtcbiAgICAgICAgICAgIGZsYWc6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIC8v5Yu+6YCJXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbihlLCBvcmRlcikge1xuICAgICAgICAgICAgdmFyIGlzQ2hlY2tlZDtcbiAgICAgICAgICAgIGlmIChfLmlzT2JqZWN0KGUpKSB7XG4gICAgICAgICAgICAgICAgaXNDaGVja2VkID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcmRlci5jaGVja2VkID0gaXNDaGVja2VkO1xuICAgICAgICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHByaW50T3JkZXJBcnJheS5wdXNoKG9yZGVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrQWxsQ2ZnLmZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBwcmludE9yZGVyQXJyYXkgPSBfLndpdGhvdXQocHJpbnRPcmRlckFycmF5LCBvcmRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RBbGxPcmRlciA9IGZ1bmN0aW9uKGUsIGRhdGEsIGNoZWNrYWxsKSB7XG4gICAgICAgICAgICB2YXIgc3QgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCAhPT0gc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbihlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZCwgaXRlbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8v5omT5Y2wXG4gICAgICAgICRzY29wZS5wcmludE9yZGVyID0gZnVuY3Rpb24ob3JkZXJzKSB7XG4gICAgICAgICAgICB2YXIgc2V0dGxlbWVudE9yZGVySWRzID0gW107XG4gICAgICAgICAgICB2YXIgaW52ZW50b3J5T3JkZXJJZHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBkZWxpdmVyeU9yZGVySWRzID0gW107XG4gICAgICAgICAgICB2YXIgcmV0dXJuT3JkZXJJZHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBvcmRlckFycmF5ID0gW107XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9yZGVycykgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgICAgICAgIG9yZGVyQXJyYXkgPSBvcmRlcnM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9yZGVyQXJyYXkgPSBbb3JkZXJzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcmRlckFycmF5LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChpdGVtLm9yZGVyVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxpdmVyeU9yZGVySWRzLnB1c2goaXRlbS5vcmRlcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuUkVGVU5EOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuT3JkZXJJZHMucHVzaChpdGVtLm9yZGVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JTlZFTlRPUlk6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZlbnRvcnlPcmRlcklkcy5wdXNoKGl0ZW0ub3JkZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlNFVFRMRU1FTlQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0bGVtZW50T3JkZXJJZHMucHVzaChpdGVtLm9yZGVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UucXVlcnlPcmRlckRldGFpbHMoe1xuICAgICAgICAgICAgICAgIHNldHRsZW1lbnRPcmRlcklkczogc2V0dGxlbWVudE9yZGVySWRzLFxuICAgICAgICAgICAgICAgIGludmVudG9yeU9yZGVySWRzOiBpbnZlbnRvcnlPcmRlcklkcyxcbiAgICAgICAgICAgICAgICBkZWxpdmVyeU9yZGVySWRzOiBkZWxpdmVyeU9yZGVySWRzLFxuICAgICAgICAgICAgICAgIHJldHVybk9yZGVySWRzOiByZXR1cm5PcmRlcklkc1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2V0dGxlbWVudE9yZGVyRGV0YWlscyA9IHJlcy5zZXR0bGVtZW50T3JkZXJEZXRhaWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHZhciBpbnZlbnRvcnlPcmRlckRldGFpbHMgPSByZXMuaW52ZW50b3J5T3JkZXJEZXRhaWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHZhciBkZWxpdmVyeU9yZGVyRGV0YWlscyA9IHJlcy5kZWxpdmVyeU9yZGVyRGV0YWlscyB8fCBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcmV0dXJuT3JkZXJEZXRhaWxzID0gcmVzLnJldHVybk9yZGVyRGV0YWlscyB8fCBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJzID0gJChbXSkuY29uY2F0KHNldHRsZW1lbnRPcmRlckRldGFpbHMsIGludmVudG9yeU9yZGVyRGV0YWlscywgZGVsaXZlcnlPcmRlckRldGFpbHMsIHJldHVybk9yZGVyRGV0YWlscyk7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXBzID0gW107XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNldHRsZW1lbnRPcmRlckRldGFpbHMsIGZ1bmN0aW9uKGRldGFpbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3JkZXJUeXBlID0gT1JERVJfVFlQRS5TRVRUTEVNRU5UO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcGUgPSBvcmRlclNlcnZpY2UucGFyc2VQcmludE9yZGVyU2NvcGUob3JkZXJUeXBlLCBkZXRhaWwsICRzY29wZS4kbmV3KHRydWUpKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXNQcmludCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBzLnB1c2goYW5ndWxhci5lbGVtZW50KCc8ZGl2PjwvZGl2PicpLmFwcGVuZChvcmRlclNlcnZpY2UuZ2V0VGVtcGxhdGVEb21CeVR5cGUob3JkZXJUeXBlLCBzY29wZSkpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW52ZW50b3J5T3JkZXJEZXRhaWxzLCBmdW5jdGlvbihkZXRhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9yZGVyVHlwZSA9IE9SREVSX1RZUEUuSU5WRU5UT1JZO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcGUgPSBvcmRlclNlcnZpY2UucGFyc2VQcmludE9yZGVyU2NvcGUob3JkZXJUeXBlLCBkZXRhaWwsICRzY29wZS4kbmV3KHRydWUpKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXNQcmludCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBzLnB1c2goYW5ndWxhci5lbGVtZW50KCc8ZGl2PjwvZGl2PicpLmFwcGVuZChvcmRlclNlcnZpY2UuZ2V0VGVtcGxhdGVEb21CeVR5cGUob3JkZXJUeXBlLCBzY29wZSkpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGVsaXZlcnlPcmRlckRldGFpbHMsIGZ1bmN0aW9uKGRldGFpbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3JkZXJUeXBlID0gT1JERVJfVFlQRS5ERUxJVkVSWTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gb3JkZXJTZXJ2aWNlLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgZGV0YWlsLCAkc2NvcGUuJG5ldyh0cnVlKSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmlzUHJpbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wcy5wdXNoKGFuZ3VsYXIuZWxlbWVudCgnPGRpdj48L2Rpdj4nKS5hcHBlbmQob3JkZXJTZXJ2aWNlLmdldFRlbXBsYXRlRG9tQnlUeXBlKG9yZGVyVHlwZSwgc2NvcGUpKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHJldHVybk9yZGVyRGV0YWlscywgZnVuY3Rpb24oZGV0YWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcmRlclR5cGUgPSBPUkRFUl9UWVBFLlJFRlVORDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gb3JkZXJTZXJ2aWNlLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgZGV0YWlsLCAkc2NvcGUuJG5ldyh0cnVlKSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmlzUHJpbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wcy5wdXNoKGFuZ3VsYXIuZWxlbWVudCgnPGRpdj48L2Rpdj4nKS5hcHBlbmQob3JkZXJTZXJ2aWNlLmdldFRlbXBsYXRlRG9tQnlUeXBlKG9yZGVyVHlwZSwgc2NvcGUpKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlbXBzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1scy5wdXNoKGl0ZW1bMF0uaW5uZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIoaHRtbHMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5iYXRoTXVsdGlQcmludCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHByaW50T3JkZXJBcnJheS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJpbnRPcmRlcihwcmludE9yZGVyQXJyYXkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdygkbWREaWFsb2cuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+aPkOekuicsXG4gICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50OiAn6K+36YCJ5oup6ZyA6KaB5omT5Y2w55qE56Wo5o2uJyxcbiAgICAgICAgICAgICAgICAgICAgb2s6ICfnoa7orqQnXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdwaWNrT3JkZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCwgJGludGVycG9sYXRlLFxuICAgICRjb21waWxlLCAkdGVtcGxhdGVDYWNoZSwgJG1kRGlhbG9nLCBOZ1RhYmxlUGFyYW1zLCBwcmludFNlcnZpY2UsXG4gICAgb3JkZXJTZXJ2aWNlLCBDT05TVEFOVFMsIHV0aWxTZXJ2aWNlLCBtb2RhbFNlcnZpY2UpIHtcbiAgICAkc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICRzY29wZS5ERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTtcbiAgICAkc2NvcGUuREVMSVZFUllfVVJHRU5DWSA9IENPTlNUQU5UUy5ERUxJVkVSWV9VUkdFTkNZO1xuICAgICRzY29wZS5DT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgIHZhciBERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTtcbiAgICB2YXIgREVMSVZFUllfVVJHRU5DWSA9IENPTlNUQU5UUy5ERUxJVkVSWV9VUkdFTkNZO1xuICAgIHZhciBDT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgIHZhciBvZmZzZXQgPSAwO1xuICAgIHZhciBsaW1pdCA9IDEwMDAwO1xuICAgIHZhciBjdXJBY3RpdmVUYWIgPSAwO1xuXG4gICAgJHNjb3BlLnV0aWxTZXJ2aWNlID0gdXRpbFNlcnZpY2U7XG4gICAgJHNjb3BlLm9yZGVyO1xuICAgICRzY29wZS5vcGVyYXRlT3JkZXJRdWVyeVBhcmFtcyA9IHt9O1xuICAgICRzY29wZS53YXJlaG91c2VPcmRlclF1ZXJ5UGFyYW1zID0ge307XG4gICAgJHNjb3BlLndhcmVob3VzZU9yZGVyU3RhdGVzID0gW3sgZGVzYzogJ+aJgOacieeKtuaAgScsIG9yZGVyU3RhdGU6IC0xIH0sIHtcbiAgICAgIGRlc2M6IERFTElWRVJZX1NUQVRFXG4gICAgICAgIC5ERVNDW0RFTElWRVJZX1NUQVRFLldBSVRfUElDS10sXG4gICAgICBvcmRlclN0YXRlOiBERUxJVkVSWV9TVEFURS5XQUlUX1BJQ0tcbiAgICB9LCB7XG4gICAgICBkZXNjOiBERUxJVkVSWV9TVEFURS5ERVNDW0RFTElWRVJZX1NUQVRFLlBJQ0tJTkddLFxuICAgICAgb3JkZXJTdGF0ZTogREVMSVZFUllfU1RBVEVcbiAgICAgICAgLlBJQ0tJTkdcbiAgICB9XTtcbiAgICAkc2NvcGUuY3VyT3JkZXJTdGF0ZSA9ICRzY29wZS53YXJlaG91c2VPcmRlclN0YXRlc1swXTtcblxuICAgICRzY29wZS5vcGVyYXRlT3JkZXJzVGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7IGNvdW50OiBsaW1pdCB9LCB7XG4gICAgICBjb3VudHM6IFtdXG4gICAgfSk7XG4gICAgJHNjb3BlLndhcmVob3VzZU9yZGVydGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7IGNvdW50OiBsaW1pdCB9LCB7XG4gICAgICBjb3VudHM6IFtdXG4gICAgfSk7XG4gICAgLy/liKDpmaQg5ouj6LSn5Y2VXG4gICAgJHNjb3BlLmRlbGV0ZURlbGl2ZXJ5T3JkZXIgPSBmdW5jdGlvbihvcmRlcklkKSB7XG4gICAgICBpZiAoY29uZmlybSgn5oKo5piv5ZCm56Gu6K6k5Yig6Zmk6K+l5Y2V5o2uPycpKSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSB7ICdvcmRlcklkJzogb3JkZXJJZCB9O1xuICAgICAgICBvcmRlclNlcnZpY2UuZGVsZXRlRGVsaXZlcnlPcmRlcihwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgYWxlcnQoJ+WIoOmZpOaIkOWKnycpO1xuICAgICAgICAgICRzY29wZS5zZWFyY2hPcGVyYXRlT3JkZXJzKCRzY29wZS5xdWVyeVBhcmFtcyk7XG5cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+afpeivoiDov5DokKXljZXmja5cbiAgICAkc2NvcGUuc2VhcmNoT3BlcmF0ZU9yZGVycyA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICAkc2NvcGUub3BlcmF0ZU9yZGVyUXVlcnlQYXJhbXMgPSBxdWVyeVBhcmFtcyB8fCAkc2NvcGUub3BlcmF0ZU9yZGVyUXVlcnlQYXJhbXM7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgbGltaXQ6IGxpbWl0LFxuICAgICAgICBvcmRlclN0YXRlczogW0RFTElWRVJZX1NUQVRFLklOSVQsIERFTElWRVJZX1NUQVRFLlJFVFVSTl9JTklUXSxcbiAgICAgICAgY29tcGFueUlkOiAkc2NvcGUub3BlcmF0ZU9yZGVyUXVlcnlQYXJhbXMuY29tcGFueUlkXG4gICAgICB9O1xuICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5RGVsaXZlcnlMaXN0KHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLm9wZXJhdGVPcmRlcnNUYWJsZVBhcmFtcy5zZXR0aW5ncyh7XG4gICAgICAgICAgZGF0YXNldDogcmVzLmNvbnRlbnRcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5riF56m66L+Q6JCl6aG15Y2h5LiL55qE5YWs5Y+45pCc57SiXG4gICAgJHNjb3BlLmVtcHR5Q29tcGFueVNlYXJjaEluT3BlcmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgZGVsZXRlICRzY29wZS5vcGVyYXRlT3JkZXJRdWVyeVBhcmFtcy5jb21wYW55SWQ7XG4gICAgICAkc2NvcGUuc2VhcmNoT3BlcmF0ZU9yZGVycygpO1xuICAgIH07XG5cbiAgICAvL+afpeivoiDku5PlupPljZXmja5cbiAgICAkc2NvcGUuc2VhcmNoV2FyZWhvdXNlT3JkZXJzID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcbiAgICAgIHF1ZXJ5UGFyYW1zID0gcXVlcnlQYXJhbXMgfHwge307XG4gICAgICBpZiAocXVlcnlQYXJhbXMub3JkZXJTdGF0ZXMpIHtcbiAgICAgICAgJHNjb3BlLndhcmVob3VzZU9yZGVyUXVlcnlQYXJhbXMub3JkZXJTdGF0ZXMgPSBxdWVyeVBhcmFtcy5vcmRlclN0YXRlcztcbiAgICAgIH0gZWxzZSBpZiAocXVlcnlQYXJhbXMuY29tcGFueUlkKSB7XG4gICAgICAgICRzY29wZS53YXJlaG91c2VPcmRlclF1ZXJ5UGFyYW1zLmNvbXBhbnlJZCA9IHF1ZXJ5UGFyYW1zLmNvbXBhbnlJZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS53YXJlaG91c2VPcmRlclF1ZXJ5UGFyYW1zID0ge307XG4gICAgICB9XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgbGltaXQ6IGxpbWl0LFxuICAgICAgICBvcmRlclN0YXRlczogJHNjb3BlLndhcmVob3VzZU9yZGVyUXVlcnlQYXJhbXMub3JkZXJTdGF0ZXMgfHwgW1xuICAgICAgICAgIERFTElWRVJZX1NUQVRFLldBSVRfUElDSywgREVMSVZFUllfU1RBVEUuUElDS0lOR1xuICAgICAgICBdLFxuICAgICAgICBjb21wYW55SWQ6ICRzY29wZS53YXJlaG91c2VPcmRlclF1ZXJ5UGFyYW1zLmNvbXBhbnlJZFxuICAgICAgfTtcbiAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5TGlzdChwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS53YXJlaG91c2VPcmRlcnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiByZXMuY29udGVudFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/muIXnqbrku5PlupPpobXljaHkuIvnmoTlhazlj7jmkJzntKJcbiAgICAkc2NvcGUuZW1wdHlDb21wYW55U2VhcmNoSW5XYXJlaG91c2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGRlbGV0ZSAkc2NvcGUud2FyZWhvdXNlT3JkZXJRdWVyeVBhcmFtcy5jb21wYW55SWQ7XG4gICAgICAkc2NvcGUuc2VhcmNoV2FyZWhvdXNlT3JkZXJzKCk7XG4gICAgfTtcbiAgICAvL+W9k+WJjeiusOW9leihjOaYr+WQpumcgOimgemrmOS6rlxuICAgICRzY29wZS5zaG91bGRSb3dIaWdobGlnaHQgPSBmdW5jdGlvbihvcmRlcikge1xuICAgICAgcmV0dXJuIHBhcnNlSW50KG9yZGVyLnJldHVyblRpbWVzKTtcbiAgICB9O1xuICAgICRzY29wZS50YWJBY3RpdmUgPSBmdW5jdGlvbih0YWJJbmRleCkge1xuICAgICAgY3VyQWN0aXZlVGFiID0gdGFiSW5kZXg7XG4gICAgICBzd2l0Y2ggKHRhYkluZGV4KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAkc2NvcGUuc2VhcmNoT3BlcmF0ZU9yZGVycygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgJHNjb3BlLmN1ck9yZGVyU3RhdGUgPSAkc2NvcGUud2FyZWhvdXNlT3JkZXJTdGF0ZXNbMF07XG4gICAgICAgICAgJHNjb3BlLnNlYXJjaFdhcmVob3VzZU9yZGVycygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/moLnmja7mi6PotKfljZXnirbmgIEg5p+l6K+iXG4gICAgJHNjb3BlLnNlbGVjdFdhcmVob3VzZU9yZGVyU3RhdGUgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpZiAoIWl0ZW0ub3JkZXJTdGF0ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgb3JkZXJTdGF0ZXMgPSBpdGVtLm9yZGVyU3RhdGUgPiAwID8gW2l0ZW0ub3JkZXJTdGF0ZV0gOiBbXG4gICAgICAgIERFTElWRVJZX1NUQVRFLldBSVRfUElDSywgREVMSVZFUllfU1RBVEUuUElDS0lOR1xuICAgICAgXTtcbiAgICAgICRzY29wZS5zZWFyY2hXYXJlaG91c2VPcmRlcnMoeyBvcmRlclN0YXRlczogb3JkZXJTdGF0ZXMgfSk7XG5cbiAgICB9O1xuICAgIC8v6YCJ5Lit5ouj6LSn5Y2VXG4gICAgJHNjb3BlLnNlbGVjdFBpY2tPcmRlciA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICBvcmRlci5zZWxlY3RlZCA9ICFvcmRlci5zZWxlY3RlZDtcbiAgICB9O1xuICAgIC8v5omT5byA5ouj6LSn5Y2V6K+m5oOFXG4gICAgJHNjb3BlLm9wZW5QaWNrT3JkZXJNb2RhbCA9IGZ1bmN0aW9uKG9yZGVySWQsIGUpIHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBnZXRQaWNrT3JkZXJEZXRhaWwoe1xuICAgICAgICBvcmRlcklkOiBvcmRlcklkLFxuICAgICAgICBkaWRMb2FkRGF0YTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHNjb3BlLnBpY2tPcmRlck1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAgICdwaWNrLW9yZGVyJykpLFxuICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGlja09yZGVyL3BpY2tPcmRlclRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgc2l6ZTogJ2xnJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5maWx0ZXJJdGVtcyA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLml0ZW1UeXBlICE9IDM7XG4gICAgfTtcblxuICAgIC8v5omT5byA6YCA5Zue55CG55SxIOWhq+WGmeahhlxuICAgICRzY29wZS5vcGVuUmV0dXJuUmVhc29uTW9kYWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5yZXR1cm5SZWFzb25Nb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgJ3BpY2stb3JkZXInKSksXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWxSZXR1cm5SZWFzb24nXG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5aGr5a6M6YCA5Zue55CG55SxIOehruiupFxuICAgICRzY29wZS5jb25maXJtUmV0dXJuID0gZnVuY3Rpb24ocmV0dXJuUGFyYW1zKSB7XG4gICAgICByZXR1cm5QYXJhbXMub3JkZXJJZCA9ICRzY29wZS5vcmRlci5vcmRlcklkO1xuICAgICAgcmV0dXJuUGFyYW1zLm9yZGVyU3RhdGUgPSBERUxJVkVSWV9TVEFURS5SRVRVUk5fSU5JVDtcbiAgICAgIG9yZGVyU2VydmljZS5tb2RpZnlEZWxpdmVyeVN0YXRlKHJldHVyblBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnBpY2tPcmRlck1vZGFsLmNsb3NlKCk7XG4gICAgICAgICRzY29wZS5yZXR1cm5SZWFzb25Nb2RhbC5jbG9zZSgpO1xuICAgICAgICAkc2NvcGUudGFiQWN0aXZlKGN1ckFjdGl2ZVRhYik7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5omT5Y2wXG4gICAgJHNjb3BlLnByaW50UGlja09yZGVyID0gZnVuY3Rpb24oc2NvcGUsIG9yZGVySWQpIHtcbiAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5jb25maXJtKHtcbiAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICB0ZXh0Q29udGVudDogJ+aYr+WQpuehruiupOaJk+WNsOW5tuW8gOWni+aLo+i0p++8nycsXG4gICAgICAgIG9rOiAn56Gu6K6kJyxcbiAgICAgICAgY2FuY2VsOiAn5Y+W5raIJ1xuICAgICAgfSkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSB7IG9yZGVyU3RhdGU6IERFTElWRVJZX1NUQVRFLlBJQ0tJTkcgfTtcbiAgICAgICAgaWYgKG9yZGVySWQpIHtcbiAgICAgICAgICBwYXJhbXMub3JkZXJJZCA9IG9yZGVySWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFyYW1zLm9yZGVySWQgPSAkc2NvcGUub3JkZXIub3JkZXJJZDtcbiAgICAgICAgfVxuICAgICAgICBvcmRlclNlcnZpY2UubW9kaWZ5RGVsaXZlcnlTdGF0ZShwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgdmFyIGh0bWwgPSAnJztcbiAgICAgICAgICAkc2NvcGUucGlja09yZGVyTW9kYWwgJiYgJHNjb3BlLnBpY2tPcmRlck1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgJHNjb3BlLnRhYkFjdGl2ZShjdXJBY3RpdmVUYWIpO1xuICAgICAgICAgIC8v5omT5Y2wXG4gICAgICAgICAgdmFyIHMgPSBzY29wZS4kbmV3KCk7XG4gICAgICAgICAgdmFyIHRlbXA7XG4gICAgICAgICAgcy5wcmludE9yZGVyID0gc2NvcGUub3JkZXI7XG4gICAgICAgICAgcy5wcmludE9yZGVyLnByb2R1Y3RMaXN0ID0gW107XG4gICAgICAgICAgXy5lYWNoKHMucHJpbnRPcmRlci5pdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgaXRlbS5wb3NpdGlvblN0ciA9IF8ucGx1Y2soaXRlbS5wb3NpdGlvbnMsXG4gICAgICAgICAgICAgICduYW1lJykuam9pbignPGJyLz4nKTtcbiAgICAgICAgICAgIGlmIChpdGVtLml0ZW1UeXBlICE9IDMpIHtcbiAgICAgICAgICAgICAgcy5wcmludE9yZGVyLnByb2R1Y3RMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGVtcCA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdj48L2Rpdj4nKS5hcHBlbmQoc2NvcGUuY29tcGlsZVByaW50VGVtcGxhdGUoXG4gICAgICAgICAgICBzKSk7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0ZW1wWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICBwcmludFNlcnZpY2UucHJpbnRCeURlZmF1bHRQcmludGVyKHRlbXBbMF0uaW5uZXJIVE1MLFxuICAgICAgICAgICAgICBmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUucHJpbnRQaWNrT3JkZXJJblRhYmxlID0gZnVuY3Rpb24oc2NvcGUsIG9yZGVyKSB7XG4gICAgICBpZiAob3JkZXIub3JkZXJTdGF0ZSA9PSBERUxJVkVSWV9TVEFURS5XQUlUX1BJQ0spIHsgLy/lvoXmjaHotKdcbiAgICAgICAgJHNjb3BlLnByaW50UGlja09yZGVyKHNjb3BlLCBvcmRlci5vcmRlcklkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5iYXRjaFByaW50KHNjb3BlLCBbb3JkZXIub3JkZXJJZF0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/noa7orqTlh7rlupNcbiAgICAkc2NvcGUuY29uZmlybVBpY2tpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG9yZGVyU3RhdGU6IERFTElWRVJZX1NUQVRFLldBSVRfQ09NRklSTSxcbiAgICAgICAgb3JkZXJJZDogJHNjb3BlLm9yZGVyLm9yZGVySWQsXG4gICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLm9yZGVyLmNvbXBhbnlJZFxuICAgICAgfTtcbiAgICAgIG9yZGVyU2VydmljZS5tb2RpZnlEZWxpdmVyeVN0YXRlKHBhcmFtcykudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLnBpY2tPcmRlck1vZGFsLmNsb3NlKCk7XG4gICAgICAgICRzY29wZS50YWJBY3RpdmUoY3VyQWN0aXZlVGFiKTtcbiAgICAgICAgLy8gLy/miZPljbBcbiAgICAgICAgLy8gb3JkZXJTZXJ2aWNlLmdldENvbXBpbGVkRGVsaXZlcnlPcmRlcih7XG4gICAgICAgIC8vICAgICBvcmRlcklkOiAkc2NvcGUub3JkZXIub3JkZXJJZCxcbiAgICAgICAgLy8gICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIC8vICAgICBzdWNjZXNzOiBmdW5jdGlvbih0ZW1wKSB7XG4gICAgICAgIC8vICAgICAgICAgJHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgICAgICAgICBwcmludFNlcnZpY2UucHJpbnRCeURlZmF1bHRQcmludGVyKHRlbXAuZmluZCgndGFibGUnKS5wYXJlbnQoKS5odG1sKCkpO1xuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mibnph4/miZPljbBcbiAgICAkc2NvcGUuY29tcGlsZVByaW50VGVtcGxhdGUgPSBmdW5jdGlvbihzY29wZSkge1xuICAgICAgcmV0dXJuICRjb21waWxlKCR0ZW1wbGF0ZUNhY2hlLmdldCgncHJpbnQvcGlja09yZGVyVGVtcGxhdGUuaHRtbCcpKVxuICAgICAgICAoc2NvcGUpO1xuICAgIH07XG4gICAgJHNjb3BlLmNvbXBpbGVEZWxpdmVyeVRlbXBsYXRlID0gZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgIHJldHVybiAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQoXG4gICAgICAgICdvcmRlci9kZWxpdmVyeU9yZGVyVGVtcGxhdGUuaHRtbCcpKShzY29wZSk7XG4gICAgfTtcbiAgICAkc2NvcGUuYmF0Y2hQcmludCA9IGZ1bmN0aW9uKHNjb3BlLCBvcmRlcklkcykge1xuICAgICAgaWYgKCRzY29wZS5zZWxlY3RPcmRlcnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgYWxlcnQoJ+ivt+WFiOmAieaLqemcgOimgeWkhOeQhueahOWNleaNricpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvL+iOt+WPluaJuemHj+mAieS4reiKgueCuVxuICAgICAgLy/or7fmsYLmibnph4/mi6PotKfljZXor6bmg4VcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG9yZGVySWRzOiBbXSxcbiAgICAgICAgb3JkZXJTdGF0ZTogREVMSVZFUllfU1RBVEUuV0FJVF9DT01GSVJNXG4gICAgICB9O1xuICAgICAgaWYgKG9yZGVySWRzICYmIG9yZGVySWRzLmxlbmd0aCkge1xuICAgICAgICBwYXJhbXMub3JkZXJJZHMgPSBvcmRlcklkcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtcy5vcmRlcklkcyA9IF8ucGx1Y2soXy53aGVyZSgkc2NvcGUud2FyZWhvdXNlT3JkZXJ0YWJsZVBhcmFtc1xuICAgICAgICAgIC5kYXRhLCB7IHNlbGVjdGVkOiB0cnVlIH0pLCAnb3JkZXJJZCcpO1xuICAgICAgfVxuICAgICAgcGFyYW1zLm9mZnNldCA9IDA7XG4gICAgICBwYXJhbXMubGltaXQgPSBwYXJhbXMub3JkZXJJZHMubGVuZ3RoO1xuICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5RGVsaXZlcnlEZXRhaWxMaXN0KHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgLy/lm57osIPnvJbor5HmqKHmnb9cbiAgICAgICAgdmFyIG9yZGVycyA9IHJlcy5jb250ZW50O1xuICAgICAgICB2YXIgdGVtcHMgPSBbXTtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKG9yZGVycywgZnVuY3Rpb24ob3JkZXIpIHtcbiAgICAgICAgICB2YXIgdDtcbiAgICAgICAgICB2YXIgcyA9IHNjb3BlLiRuZXcodHJ1ZSk7XG4gICAgICAgICAgcy5ERUxJVkVSWV9VUkdFTkNZID0gREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgICBzLkNPTVBBTllfVFlQRSA9IENPTVBBTllfVFlQRTtcbiAgICAgICAgICBzLnV0aWxTZXJ2aWNlID0gdXRpbFNlcnZpY2U7XG4gICAgICAgICAgcy5wcmludE9yZGVyID0gb3JkZXI7XG4gICAgICAgICAgcy5wcmludE9yZGVyLnByb2R1Y3RMaXN0ID0gW107XG4gICAgICAgICAgXy5lYWNoKHMucHJpbnRPcmRlci5pdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgaXRlbS5wb3NpdGlvblN0ciA9IF8ucGx1Y2soaXRlbS5wb3NpdGlvbnMsXG4gICAgICAgICAgICAgICduYW1lJykuam9pbignPGJyLz4nKTtcbiAgICAgICAgICAgIGlmIChpdGVtLml0ZW1UeXBlICE9IDMpIHtcbiAgICAgICAgICAgICAgcy5wcmludE9yZGVyLnByb2R1Y3RMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdCA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdj48L2Rpdj4nKS5hcHBlbmQoc2NvcGUuY29tcGlsZVByaW50VGVtcGxhdGUoXG4gICAgICAgICAgICBzKSk7XG4gICAgICAgICAgdGVtcHMucHVzaCh0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0ZW1wID0gW107XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlbXBzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICB0ZW1wLnB1c2goaXRlbVswXS5pbm5lckhUTUwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIodGVtcCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+aJuemHj+WIh+aNoueKtuaAgVxuICAgICRzY29wZS5iYXRjaE1vZGlmeVN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoJHNjb3BlLnNlbGVjdE9yZGVycy5sZW5ndGggPT0gMCkge1xuICAgICAgICBhbGVydCgn6K+35YWI6YCJ5oup6ZyA6KaB5aSE55CG55qE5Y2V5o2uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBmID0gJHNjb3BlLnNlbGVjdE9yZGVyc1swXTtcbiAgICAgIHZhciByID0gXy5maW5kKCRzY29wZS5zZWxlY3RPcmRlcnMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0ub3JkZXJTdGF0ZSAhPSBmLm9yZGVyU3RhdGU7XG4gICAgICB9KTtcbiAgICAgIGlmIChyKSB7XG4gICAgICAgIGFsZXJ0KCfmi6PotKfljZXnirbmgIHkuI3lkIzvvIzml6Dms5Xmibnph4/lpITnkIYnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGNvbmZpcm1Db250ZW50ID0gZi5vcmRlclN0YXRlID09IERFTElWRVJZX1NUQVRFLldBSVRfUElDSyA/XG4gICAgICAgICfmmK/lkKbnoa7orqTmiYDpgInmi6PotKfljZXlvIDlp4vmi6PotKc/JyA6XG4gICAgICAgICfmmK/lkKbnoa7orqTmiYDpgInmi6PotKfljZXllYblk4Hlt7Llh7rlupPvvIzlubbliIfmjaLkuLrpgIHotKfljZU/JztcblxuICAgICAgaWYgKGNvbmZpcm0oY29uZmlybUNvbnRlbnQpKSB7XG4gICAgICAgIG9yZGVyU2VydmljZS5iYXRjaFVwZGF0ZURlbGl2ZXJ5T3JkZXJTdGF0ZSh7XG4gICAgICAgICAgb3JkZXJJZHM6IF8ucGx1Y2soJHNjb3BlLnNlbGVjdE9yZGVycywgJ29yZGVySWQnKVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS50YWJBY3RpdmUoY3VyQWN0aXZlVGFiKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICB9O1xuICAgIC8v6I635Y+W5ouj6LSn5Y2V6K+m5oOFXG4gICAgdmFyIGdldFBpY2tPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5RGV0YWlsKHsgb3JkZXJJZDogb3B0cy5vcmRlcklkIH0pLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlYnVnZ2VyXG4gICAgICAgICAgJHNjb3BlLm9yZGVyID0gcmVzO1xuICAgICAgICAgICRzY29wZS5vcmRlci5uYW1lID0gJ+aLo+i0p+WNlScgKyAnLScgKyAkc2NvcGUub3JkZXIuY29tcGFueU5hbWUgK1xuICAgICAgICAgICAgJy0nICsgJHNjb3BlLm9yZGVyLnNoZWxmTmFtZSArICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhcbiAgICAgICAgICAgICAgJHNjb3BlLm9yZGVyLnVwZGF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgIG9wdHMuZGlkTG9hZERhdGEoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+ivpuaDhemhtemdoiDlr7zlh7pcbiAgICAkc2NvcGUuZXhwb3J0RXhjZWxPbkRldGFpbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGRvbSA9IGFuZ3VsYXIuZWxlbWVudCgnPGE+PC9hPicpO1xuICAgICAgZG9tWzBdLmhyZWYgPSAkKCcjcGljay1vcmRlci10YWJsZScpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICBjb250YWluZXJpZDogJ3BpY2stb3JkZXItdGFibGUnLFxuICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgIH0pO1xuICAgICAgZG9tWzBdLmRvd25sb2FkID0gJHNjb3BlLm9yZGVyLm5hbWUgKyAnLnhscyc7XG4gICAgICBkb21bMF0uY2xpY2soKTtcbiAgICB9O1xuICAgIC8v5pyq5Yqg6L296K+m5oOF6aG16Z2i55qE5oOF5Ya15LiLIOWvvOWHulxuICAgICRzY29wZS5leHBvcnRFeGNlbE5lZWRMb2FkRGV0YWlsID0gZnVuY3Rpb24ob3JkZXJJZCwgZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgdmFyIGV4Y2VsVGVtcGxhdGUgPSAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQoXG4gICAgICAgICdwaWNrT3JkZXIvcGlja09yZGVyVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRFeGNlbFdyYXAnKSkuYXBwZW5kKFxuICAgICAgICBleGNlbFRlbXBsYXRlKTtcbiAgICAgIGdldFBpY2tPcmRlckRldGFpbCh7XG4gICAgICAgIG9yZGVySWQ6IG9yZGVySWQsXG4gICAgICAgIGRpZExvYWREYXRhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICAgICAgICBkb21bMF0uaHJlZiA9ICQoJyNwaWNrLW9yZGVyLXRhYmxlJykuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgICAgICAgIGNvbnRhaW5lcmlkOiBcInBpY2stb3JkZXItdGFibGVcIixcbiAgICAgICAgICAgICAgZGF0YXR5cGU6ICd0YWJsZScsXG4gICAgICAgICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRvbVswXS5kb3dubG9hZCA9ICRzY29wZS5vcmRlci5uYW1lICsgJy54bHMnO1xuICAgICAgICAgICAgZG9tWzBdLmNsaWNrKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLiR3YXRjaCgnd2FyZWhvdXNlT3JkZXJ0YWJsZVBhcmFtcy5kYXRhJywgZnVuY3Rpb24obmV3VmFsdWUsXG4gICAgICBvbGRWYWx1ZSkge1xuICAgICAgJHNjb3BlLnNlbGVjdE9yZGVycyA9IF8ud2hlcmUoJHNjb3BlLndhcmVob3VzZU9yZGVydGFibGVQYXJhbXMuZGF0YSwgeyBzZWxlY3RlZDogdHJ1ZSB9KTtcbiAgICB9LCB0cnVlKTtcbiAgfSk7XG59IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcigncG9zaXRpb25NYW5hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBOZ1RhYmxlUGFyYW1zLCBtb2RhbFNlcnZpY2UsIHBvc2l0aW9uU2VydmljZSwgJG1kRGlhbG9nKSB7XG4gICAgICAgICRzY29wZS5saW1pdCA9IDI1O1xuICAgICAgICAkc2NvcGUucG9zaXRpb24gPSB7fTtcbiAgICAgICAgdmFyIGxvYWRQb3NpdGlvblRhYmxlID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zID0gcXVlcnlQYXJhbXMgfHwge307XG4gICAgICAgICAgICAkc2NvcGUucG9zaXRpb25UYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAyNSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9zaXRpb25TZXJ2aWNlLnF1ZXJ5UG9zaXRpb25zQnlQYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogKHBhcmFtcy5wYWdlKCkgLSAxKSAqICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0VHlwZTogcXVlcnlQYXJhbXMuc29ydFR5cGVcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBsb2FkUG9zaXRpb25UYWJsZSgpO1xuICAgICAgICAvL+aJk+W8gOS7k+S9jee8lui+kVxuICAgICAgICAkc2NvcGUub3BlblBvc2l0aW9uRWRpdE1vZGFsID0gZnVuY3Rpb24obW9kZSwgcG9zaXRpb24pIHtcbiAgICAgICAgICAgICRzY29wZS5wb3NpdGlvbiA9IHt9O1xuICAgICAgICAgICAgaWYgKG1vZGUgPT0gJ2VkaXQnKSB7IC8v57yW6L6R5qih5byPXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc2l0aW9uID0gYW5ndWxhci5jb3B5KHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5wb3NpdGlvbkVkaXRNb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncG9zaXRpb24tbWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwb3NpdGlvbkVkaXRNb2RhbCcsXG4gICAgICAgICAgICAgICAgc2l6ZTonc20nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/mj5DkuqTku5PkvY3nvJbovpFcbiAgICAgICAgJHNjb3BlLnN1Ym1pdFBvc2l0aW9uRWRpdCA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3JNc2cgPSAnJztcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbi5yb3cubGVuZ3RoICE9IDMpIHtcbiAgICAgICAgICAgICAgICBlcnJvck1zZyA9ICdcXCfmjpJcXCfpnIDkuLoz5L2N5pW05pWwJztcbiAgICAgICAgICAgIH1lbHNlIGlmIChwb3NpdGlvbi5sYXllci5sZW5ndGggIT0gMikge1xuICAgICAgICAgICAgICAgIGVycm9yTXNnID0gJ1xcJ+WxglxcJ+mcgOS4ujLkvY3mlbTmlbAnO1xuICAgICAgICAgICAgfWVsc2UgaWYgKHBvc2l0aW9uLmxvY2F0aW9uLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JNc2cgPSAnXFwn5L2N572uXFwn6ZyA5Li6M+S9jeaVtOaVsCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXJyb3JNc2cubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICflpLHotKUnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudDogZXJyb3JNc2csXG4gICAgICAgICAgICAgICAgICAgIG9rOiAn5YWz6ZetJyxcbiAgICAgICAgICAgICAgICAgICAgekluZGV4OiA5OTk5OTk5OTlcbiAgICAgICAgICAgICAgICB9KS5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBvc2l0aW9uLmlkID09ICd1bmRlZmluZWQnKSB7IC8v5paw5aKeXG4gICAgICAgICAgICAgICAgcG9zaXRpb25TZXJ2aWNlLmNyZWF0ZVBvc2l0aW9uKHBvc2l0aW9uKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucG9zaXRpb25FZGl0TW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgbG9hZFBvc2l0aW9uVGFibGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8v57yW6L6RXG4gICAgICAgICAgICAgICAgcG9zaXRpb25TZXJ2aWNlLm1vZGlmeVBvc2l0aW9uKHBvc2l0aW9uKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucG9zaXRpb25FZGl0TW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgbG9hZFBvc2l0aW9uVGFibGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy/mjInnvJbnoIHmjpLluo9cbiAgICAgICAgJHNjb3BlLnNvcnRCeU5hbWUgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICBsb2FkUG9zaXRpb25UYWJsZSh7XG4gICAgICAgICAgICAgICAgc29ydFR5cGU6IGl0ZW0uc29ydENvZGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgfSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdwcm9kdWN0Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1kUGFuZWwsIHByb2R1Y3RTZXJ2aWNlLFxuICAgIHV0aWxTZXJ2aWNlLCBOZ1RhYmxlUGFyYW1zLCBtb2RhbFNlcnZpY2UsIENPTlNUQU5UUywgcG9zaXRpb25TZXJ2aWNlLFxuICAgIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLCRjb21waWxlLCR0ZW1wbGF0ZUNhY2hlLG9yZGVyU2VydmljZSkge1xuICAgICRzY29wZS5sZXZlbE9uZUNhdGVnb3J5TGlzdCA9IFtdO1xuICAgICRzY29wZS5sZXZlbFR3b0NhdGVnb3J5TGlzdCA9IFtdO1xuICAgICRzY29wZS5icmFuZEF3YXJlbmVzc0xpc3QgPSBbXTtcbiAgICAkc2NvcGUuYnJhbmRHcmFkZUxpc3QgPSBbXTtcbiAgICAkc2NvcGUub3JpZ2luUGxhY2VMaXN0ID0gW107XG4gICAgJHNjb3BlLmxhYmVsTGlzdCA9IFtdO1xuICAgICRzY29wZS5wcm9kdWN0ID0ge307XG4gICAgJHNjb3BlLnByb2R1Y3RQb3NpdGlvbkRhdGEgPSBbXTtcbiAgICAkc2NvcGUuaW1nUHJlZml4ID0gd2luZG93LmNmZy5waWNVcmw7XG4gICAgJHNjb3BlLkNPTlNUQU5UUyA9IENPTlNUQU5UUztcbiAgICB2YXIgQ0FURUdPUllfTEVWRUwgPSBDT05TVEFOVFMuQ0FURUdPUllfTEVWRUw7XG4gICAgdmFyIFBST0RVQ1RfRElDX1RZUEUgPSBDT05TVEFOVFMuUFJPRFVDVF9ESUNfVFlQRTtcbiAgICAkc2NvcGUucHJvZHVjdFRhZ3NEYXRhID0gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgY2xzT3JOYW1lOiAnUFJPRFVDVF9UQUcnLFxuICAgICAgaGFzRGVmYXVsdDogZmFsc2VcbiAgICB9KTtcbiAgICAvL+ihqOagvOiuvue9rlxuICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHt9O1xuICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICB9LCB7XG4gICAgICBjb3VudHM6IFtdLFxuICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMjAsXG4gICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHJldHVybiBsYWJlbHNNYW5hZ2VtZW50U2VydmljZS5nZXRBbGxMYWJlbExpc3QoKS50aGVuKFxuICAgICAgICAgIGZ1bmN0aW9uKFxuICAgICAgICAgICAgbGFiZWxSZXMpIHtcbiAgICAgICAgICAgICRzY29wZS5sYWJlbExpc3QgPSBsYWJlbFJlcztcbiAgICAgICAgICAgICRzY29wZS5sYWJlbENvbmZpZy5zZXRMaXN0KGxhYmVsUmVzKTtcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpO1xuICAgICAgICAgICAgdmFyIHNlYXJjaCA9IGdldFBhcmFtcygpO1xuICAgICAgICAgICAgc2VhcmNoLm9mZnNldCA9ICRzY29wZS5vZmZzZXQ7XG4gICAgICAgICAgICBzZWFyY2gubGltaXQgPSAkc2NvcGUubGltaXQ7XG4gICAgICAgICAgICByZXR1cm4gcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0QnlLZXkoc2VhcmNoKS50aGVuKFxuICAgICAgICAgICAgICBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcHJvZHVjdFNlcnZpY2UuX3BhcnNlUHJvZHVjdExpc3REYXRhKFxuICAgICAgICAgICAgICAgICAgcmVzLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAkc2NvcGUubGFiZWxMaXN0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tJbmZvKHByb2R1Y3RTZXJ2aWNlLmluZGV4RGF0YShkYXRhLCAkc2NvcGUub2Zmc2V0ICtcbiAgICAgICAgICAgICAgICAgIDEpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdmFyIGdldFBhcmFtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gZGVidWdnZXJcbiAgICAgIHZhciB0ZW1wID0gJHNjb3BlLnF1ZXJ5UGFyYW1zO1xuICAgICAgdGVtcFt0ZW1wLm1hcmtJZF0gPSB0ZW1wLnF1ZXJ5TmFtZTtcbiAgICAgIHJldHVybiBfLm9taXQodGVtcCwgJ21hcmtJZCcsICdxdWVyeU5hbWUnKTtcbiAgICB9O1xuICAgIC8v6YCJ5oupXG4gICAgJHNjb3BlLnF1ZXJ5UHJvZHVjdENvbmZpZyA9IHtcbiAgICAgIG5hbWVUeXBlRGF0YTogW3tcbiAgICAgICAgbWFya0lkOiAncHJvZHVjdE5hbWUnLFxuICAgICAgICBkZXNjOiAn5ZWG5ZOBJ1xuICAgICAgfSwge1xuICAgICAgICBtYXJrSWQ6ICdwb3NpdGlvbk5hbWUnLFxuICAgICAgICBkZXNjOiAn5LuT5L2NJ1xuICAgICAgfSwge1xuICAgICAgICBtYXJrSWQ6ICdza3VDb2RlJyxcbiAgICAgICAgZGVzYzogJ+WVhuWTgee8lueggSdcbiAgICAgIH1dLFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXNbXCJtYXJrSWRcIl0gPSBpdGVtLm1hcmtJZDtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGV4Y2VsVGVtcGxhdGUgPSAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQoXG4gICAgICAncHJvZHVjdC9wcm9kdWN0TGlzdEV4Y2VsVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0RXhjZWxXcmFwJykpLmFwcGVuZChcbiAgICAgIGV4Y2VsVGVtcGxhdGUpO1xuICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0ID0gW107XG4gICAgdmFyIGNoZWNrSW5mbyA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKCRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0LCB7XG4gICAgICAgICAgaWQ6IGl0ZW0uaWRcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9O1xuICAgICRzY29wZS5jaGVja0FsbENmZyA9IHtcbiAgICAgIGZsYWc6IGZhbHNlXG4gICAgfTtcbiAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24oZSwgcHJvKSB7XG4gICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgaXNDaGVja2VkID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgfVxuICAgICAgcHJvLmNoZWNrZWQgPSBpc0NoZWNrZWQ7XG4gICAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0LnB1c2gocHJvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5jaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0ID0gXy53aXRob3V0KCRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0LCBwcm8pO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLnNlbGVjdEFsbFByb2R1Y3QgPSBmdW5jdGlvbihlLCBkYXRhKSB7XG4gICAgICB2YXIgc3QgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmNoZWNrZWQgIT09IHN0KSB7XG4gICAgICAgICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbihlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZCwgaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/lm57ovabplK7mn6Xor6IgXG4gICAgJHNjb3BlLnByb2R1Y3RLZXl1cCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBrZXljb2RlID0gd2luZG93LmV2ZW50ID8gZS5rZXlDb2RlIDogZS53aGljaDtcbiAgICAgIGlmIChrZXljb2RlID09IDEzKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0U2VhcmNoKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS5leHBvcnRFeGNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZFByb2R1Y3RMaXN0Lmxlbmd0aCkge1xuICAgICAgICBvcmRlclNlcnZpY2UuZm9ybUV4Y2VsKCdleHBvcnRFeGNlbFdyYXAnLCAn5ZWG5ZOB5YiX6KGoJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cuYWxlcnQoJ+ivt+mAieaLqeWvvOWHuumhuScpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/mn6Xor6Ig5ZWG5ZOB5ZCN56ewXG4gICAgJHNjb3BlLnByb2R1Y3RTZWFyY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS50YWJsZVBhcmFtcy5zZXR0aW5ncyh7XG4gICAgICAgIGRhdGFzZXQ6IFtdXG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5o6S5bqPXG4gICAgJHNjb3BlLnNvcnQgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc29ydFR5cGUgPSBpdGVtLnNvcnRDb2RlO1xuICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgZGF0YXNldDogW11cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/liKnmtqbnrYnnuqcg562b6YCJXG4gICAgJHNjb3BlLnByb2ZpdExldmVsRmlsdGVyID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnUFJPRklUX0xFVkVMJyxcbiAgICAgICAgICBjb2RlS2V5OiAncHJvZml0TGV2ZWwnLFxuICAgICAgICAgIHZhbHVlS2V5OiAnbmFtZScsXG4gICAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICAgJyc6ICflhajpg6jliKnmtqbnrYnnuqcnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5wcm9maXRMZXZlbCA9IGl0ZW0ucHJvZml0TGV2ZWw7XG4gICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5zZXR0aW5ncyh7XG4gICAgICAgICAgZGF0YXNldDogW11cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+S4gOe6p+WTgeexuyDnrZvpgIlcbiAgICAkc2NvcGUubGV2ZWxPbmVDYXRlZ29yeUZpbHRlciA9IHtcbiAgICAgIGxpc3Q6IFtdLFxuICAgICAgZGVmYXVsdEl0ZW06IHtcbiAgICAgICAgY2F0ZWdvcnlOYW1lOiAn5YWo6YOo5LiA57qn5ZOB57G7J1xuICAgICAgfSxcbiAgICAgIHNldExpc3Q6IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gYW5ndWxhci5jb3B5KGxpc3QpO1xuICAgICAgICB0aGlzLmxpc3QudW5zaGlmdCh0aGlzLmRlZmF1bHRJdGVtKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jYXRlZ29yeUlkID0gaXRlbS5pZDtcbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLmxldmVsVHdvQ2F0ZWdvcnlGaWx0ZXIuY2xlYXJMaXN0KCk7XG4gICAgICAgIGlmIChpdGVtLmlkKSB7XG4gICAgICAgICAgcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0KHtcbiAgICAgICAgICAgIHBhcmVudENhdGVnb3J5SWQ6IGl0ZW0uaWRcbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLmxldmVsVHdvQ2F0ZWdvcnlGaWx0ZXIuc2V0TGlzdChyZXMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+S6jOe6p+WTgeexuyDnrZvpgIlcbiAgICAkc2NvcGUubGV2ZWxUd29DYXRlZ29yeUZpbHRlciA9IHtcbiAgICAgIGxpc3Q6IFtdLFxuICAgICAgZGVmYXVsdEl0ZW06IHtcbiAgICAgICAgY2F0ZWdvcnlOYW1lOiAn5YWo6YOo5LqM57qn5ZOB57G7J1xuICAgICAgfSxcbiAgICAgIHNldExpc3Q6IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gYW5ndWxhci5jb3B5KGxpc3QpO1xuICAgICAgICB0aGlzLmxpc3QudW5zaGlmdCh0aGlzLmRlZmF1bHRJdGVtKTtcbiAgICAgIH0sXG4gICAgICBjbGVhckxpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmxpc3QgPSBbXTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zdWJDYXRlZ29yeUlkID0gaXRlbS5pZDtcbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v54m55q6K5qCH6K+GIOetm+mAiVxuICAgICRzY29wZS5wcm9kdWN0VGFnRmlsdGVyID0ge1xuICAgICAgZ2V0TGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgY2xzT3JOYW1lOiAnUFJPRFVDVF9UQUcnLFxuICAgICAgICAgIGNvZGVLZXk6ICdwcm9kdWN0VGFnJyxcbiAgICAgICAgICB2YWx1ZUtleTogJ25hbWUnLFxuICAgICAgICAgIGRlZmF1bHRPYmo6IHtcbiAgICAgICAgICAgICcnOiAn5YWo6YOoJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBkZWxldGUgJHNjb3BlLnF1ZXJ5UGFyYW1zLnByb2R1Y3RUYWdzO1xuICAgICAgICBpZiAoaXRlbS5wcm9kdWN0VGFnKSB7XG4gICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLnByb2R1Y3RUYWdzID0gW2l0ZW0ucHJvZHVjdFRhZ107XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8vTW9kYWxcbiAgICAkc2NvcGUucHJvZHVjdEluaXRNb2RhbCA9IGZ1bmN0aW9uKHRlbXBsYXRlVXJsLCBzaXplKSB7XG4gICAgICBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICdwcm9kdWN0JykpLFxuICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGVVcmwsXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHNpemU6IHNpemVcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLypcbiAgICAgKueuoeeQhuWTgeexu1xuICAgICAqL1xuICAgIC8v5Yid5aeL5YyW5ZOB57G7XG4gICAgdmFyIGNhdGVnb3J5SW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgbG9hZENhdGVnb3J5TGlzdCgwKTtcbiAgICB9O1xuICAgIC8v5Yqg6L295ZOB57G7XG4gICAgdmFyIGxvYWRDYXRlZ29yeUxpc3QgPSBmdW5jdGlvbihwYXJlbnRDYXRlZ29yeUlkKSB7XG4gICAgICBwcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RDYXRlZ29yeUxpc3Qoe1xuICAgICAgICBwYXJlbnRDYXRlZ29yeUlkOiBwYXJlbnRDYXRlZ29yeUlkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBpZiAoIXBhcmVudENhdGVnb3J5SWQpIHsgLy/kuIDnuqflk4HnsbtcbiAgICAgICAgICAkc2NvcGUubGV2ZWxPbmVDYXRlZ29yeUxpc3QgPSBhbmd1bGFyLmNvcHkocmVzKTtcbiAgICAgICAgICAkc2NvcGUubGV2ZWxPbmVDYXRlZ29yeUZpbHRlci5zZXRMaXN0KHJlcyk7XG4gICAgICAgICAgaWYgKCRzY29wZS5sZXZlbE9uZUNhdGVnb3J5TGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRMZXZlbE9uZUNhdGVnb3J5ID0gJHNjb3BlLmxldmVsT25lQ2F0ZWdvcnlMaXN0W1xuICAgICAgICAgICAgICAwXTtcbiAgICAgICAgICAgIGxvYWRDYXRlZ29yeUxpc3QoJHNjb3BlLnNlbGVjdGVkTGV2ZWxPbmVDYXRlZ29yeS5pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgeyAvL+S6jOe6p+WTgeexu1xuICAgICAgICAgICRzY29wZS5sZXZlbFR3b0NhdGVnb3J5TGlzdCA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aCAvIDI7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgICAgICAgIHRlbXAucHVzaChyZXNbaSAqIDJdKTtcbiAgICAgICAgICAgIGlmIChyZXNbaSAqIDIgKyAxXSkge1xuICAgICAgICAgICAgICB0ZW1wLnB1c2gocmVzW2kgKiAyICsgMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmxldmVsVHdvQ2F0ZWdvcnlMaXN0LnB1c2godGVtcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5sZXZlbE9uZUNhdGVnb3J5TWFuYWdlTGlzdCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLmlkICE9ICcwJztcbiAgICB9O1xuICAgIC8v5omT5byA5LiA57qn5ZOB57G757yW6L6R5qGGXG4gICAgJHNjb3BlLm9wZW5MZXZlbE9uZUVkaXRXaW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5wcm9kdWN0SW5pdE1vZGFsKCdsZXZlbE9uZUNhdGVnb3J5RWRpdCcsICdsZycpO1xuICAgIH07XG4gICAgLy/liJvlu7rlk4HnsbtcbiAgICAkc2NvcGUuY3JlYXRlQ2F0ZWdvcnkgPSBmdW5jdGlvbihjYXRlZ29yeSwgY2F0ZWdvcnlMZXZlbCkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgY2F0ZWdvcnlOYW1lOiBjYXRlZ29yeS5jYXRlZ29yeU5hbWUsXG4gICAgICAgIGNhdGVnb3J5TGV2ZWw6IGNhdGVnb3J5TGV2ZWwsXG4gICAgICAgIHBpY2tpbmdWYWx1ZTogY2F0ZWdvcnkucGlja2luZ1ZhbHVlXG4gICAgICB9XG4gICAgICBpZiAoY2F0ZWdvcnlMZXZlbCA9PSBDQVRFR09SWV9MRVZFTC5UV08pIHsgLy/kuoznuqflk4HnsbtcbiAgICAgICAgcGFyYW1zLmlkID0gJHNjb3BlLnNlbGVjdGVkTGV2ZWxPbmVDYXRlZ29yeS5pZDtcbiAgICAgIH1cbiAgICAgIHByb2R1Y3RTZXJ2aWNlLmNyZWF0ZVByb2R1Y3RDYXRlZ29yeShwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIC8v5paw5aKe5ZCO5riF56m6aW5wdXRcbiAgICAgICAgY2F0ZWdvcnkuY2F0ZWdvcnlOYW1lID0gXCJcIjtcbiAgICAgICAgY2F0ZWdvcnkucGlja2luZ1ZhbHVlID0gXCJcIjtcbiAgICAgICAgaWYgKGNhdGVnb3J5TGV2ZWwgPT0gQ0FURUdPUllfTEVWRUwuT05FKSB7IC8v5LiA57qn5ZOB57G7XG4gICAgICAgICAgbG9hZENhdGVnb3J5TGlzdCgwKTtcbiAgICAgICAgfSBlbHNlIGlmIChjYXRlZ29yeUxldmVsID09IENBVEVHT1JZX0xFVkVMLlRXTykgeyAvL+S6jOe6p+WTgeexu1xuICAgICAgICAgIGxvYWRDYXRlZ29yeUxpc3QoJHNjb3BlLnNlbGVjdGVkTGV2ZWxPbmVDYXRlZ29yeS5pZCk7XG4gICAgICAgICAgJHNjb3BlLmFkZExldmVsVHdvID0ge307XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/kv67mlLnlk4HnsbtcbiAgICAkc2NvcGUubW9kaWZ5Q2F0ZWdvcnkgPSBmdW5jdGlvbihjYXRlZ29yeSwgY2F0ZWdvcnlMZXZlbCkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgaWQ6IGNhdGVnb3J5LmlkLFxuICAgICAgICBjYXRlZ29yeU5hbWU6IGNhdGVnb3J5LmNhdGVnb3J5TmFtZSxcbiAgICAgICAgY2F0ZWdvcnlMZXZlbDogY2F0ZWdvcnlMZXZlbCxcbiAgICAgICAgcGlja2luZ1ZhbHVlOiBjYXRlZ29yeS5waWNraW5nVmFsdWVcbiAgICAgIH1cbiAgICAgIHByb2R1Y3RTZXJ2aWNlLm1vZGlmeVByb2R1Y3RDYXRlZ29yeShwYXJhbXMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIGlmIChjYXRlZ29yeUxldmVsID09IENBVEVHT1JZX0xFVkVMLk9ORSkgeyAvL+S4gOe6p+WTgeexu1xuICAgICAgICAgIGxvYWRDYXRlZ29yeUxpc3QoMCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2F0ZWdvcnlMZXZlbCA9PSBDQVRFR09SWV9MRVZFTC5UV08pIHsgLy/kuoznuqflk4HnsbtcbiAgICAgICAgICBsb2FkQ2F0ZWdvcnlMaXN0KCRzY29wZS5zZWxlY3RlZExldmVsT25lQ2F0ZWdvcnkuaWQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8v5Yig6Zmk5ZOB57G7XG4gICAgJHNjb3BlLmRlbGV0ZUNhdGVnb3J5ID0gZnVuY3Rpb24oY2F0ZWdvcnksIGNhdGVnb3J5TGV2ZWwpIHtcbiAgICAgIGlmIChjb25maXJtKCfmmK/lkKbnoa7orqTliKDpmaTor6Xlk4HnsbsnKSkge1xuICAgICAgICBwcm9kdWN0U2VydmljZS5kZWxldGVQcm9kdWN0Q2F0ZWdvcnkoe1xuICAgICAgICAgIGlkOiBjYXRlZ29yeS5pZFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGlmIChjYXRlZ29yeUxldmVsID09IENBVEVHT1JZX0xFVkVMLk9ORSkgeyAvL+S4gOe6p+WTgeexu1xuICAgICAgICAgICAgbG9hZENhdGVnb3J5TGlzdCgwKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNhdGVnb3J5TGV2ZWwgPT0gQ0FURUdPUllfTEVWRUwuVFdPKSB7IC8v5LqM57qn5ZOB57G7XG4gICAgICAgICAgICBsb2FkQ2F0ZWdvcnlMaXN0KCRzY29wZS5zZWxlY3RlZExldmVsT25lQ2F0ZWdvcnkuaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+mAieaLqeS4gOe6p+WTgeexu1xuICAgICRzY29wZS5zZWxlY3RMZXZlbE9uZSA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAkc2NvcGUuc2VsZWN0ZWRMZXZlbE9uZUNhdGVnb3J5ID0gJHNjb3BlLmxldmVsT25lQ2F0ZWdvcnlMaXN0W1xuICAgICAgICBpbmRleF07XG4gICAgICBsb2FkQ2F0ZWdvcnlMaXN0KCRzY29wZS5zZWxlY3RlZExldmVsT25lQ2F0ZWdvcnkuaWQpO1xuICAgIH07XG4gICAgLy/liJ3lp4vljJbku5PkvY1cbiAgICB2YXIgcG9zaXRpb25Jbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBwb3NpdGlvblNlcnZpY2UucXVlcnlBbGxQb3NpdGlvbnMoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUucHJvZHVjdFBvc2l0aW9uRGF0YSA9IHJlcztcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/lvLnlh7rnrqHnkIblk4HnsbtcbiAgICAkc2NvcGUuY2F0ZWdvcnlNYW5hZ2VXaW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5wcm9kdWN0SW5pdE1vZGFsKCdwcm9kdWN0Q2F0ZWdvcnlNYW5hZ2UnKTtcbiAgICAgIGNhdGVnb3J5SW5pdCgpO1xuICAgIH07XG4gICAgLypcbiAgICAgKiDllYblk4HnmoTkv67mlLnvvIznvJbovpHvvIzkv53lrZjvvIzliKDpmaRcbiAgICAgKi9cbiAgICAvL+a3u+WKoOWVhuWTgSDmlrDlop4v5L+u5pS5XG4gICAgJHNjb3BlLnByb2R1Y3RFZGl0V2luID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgIGxhYmVsc01hbmFnZW1lbnRTZXJ2aWNlLmdldEFsbExhYmVsTGlzdCgpLnRoZW4oZnVuY3Rpb24obGFiZWxSZXMpIHtcbiAgICAgICAgJHNjb3BlLmxhYmVsTGlzdCA9IGxhYmVsUmVzO1xuICAgICAgICAkc2NvcGUubGFiZWxDb25maWcuc2V0TGlzdChsYWJlbFJlcyk7XG4gICAgICB9KTtcbiAgICAgIC8v6YeN572u5aSa6YCJXG4gICAgICByZXNldE11bHRpU2VsZWN0KCRzY29wZS5wcm9kdWN0UG9zaXRpb25EYXRhKTtcbiAgICAgIHJlc2V0TXVsdGlTZWxlY3QoJHNjb3BlLnByb2R1Y3RUYWdzRGF0YSk7XG4gICAgICBpZiAodHlwZW9mIGlkID09ICd1bmRlZmluZWQnKSB7IC8v5paw5aKe5qih5byPXG4gICAgICAgICRzY29wZS5wcm9kdWN0LnJlc2V0KCk7XG4gICAgICAgICRzY29wZS5wcm9kdWN0TGV2ZWxUd29DYXRlZ29yeUNvbmZpZy5yZXNldCgpO1xuICAgICAgICAkc2NvcGUucHJvZHVjdEluaXRNb2RhbCgncHJvZHVjdEVkaXQnLCAnbGcnKTtcbiAgICAgIH0gZWxzZSB7IC8v5L+u5pS55qih5byPXG4gICAgICAgIHByb2R1Y3RTZXJ2aWNlLmdldFByb2R1Y3RCeUlkKHtcbiAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9IHByb2R1Y3RTZXJ2aWNlLl9wYXJzZVByb2R1Y3REYXRhKHJlcywgJHNjb3BlLmxhYmVsTGlzdCk7XG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3QgPSBhbmd1bGFyLmV4dGVuZCgkc2NvcGUucHJvZHVjdCwgZGF0YSk7XG4gICAgICAgICAgXy5lYWNoKGRhdGEucG9zaXRpb25JZHMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHsgLy/ku5PkvY0g6buY6K6k6YCJ5LitXG4gICAgICAgICAgICBfLmZpbmRXaGVyZSgkc2NvcGUucHJvZHVjdFBvc2l0aW9uRGF0YSwge1xuICAgICAgICAgICAgICBpZDogdmFsdWUuaWRcbiAgICAgICAgICAgIH0pLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBfLmVhY2goZGF0YS5wcm9kdWN0VGFncywgZnVuY3Rpb24odGFnSWQpIHsgLy/nibnmrormoIfor4Yg6buY6K6k6YCJ5LitXG4gICAgICAgICAgICBfLmZpbmRXaGVyZSgkc2NvcGUucHJvZHVjdFRhZ3NEYXRhLCB7XG4gICAgICAgICAgICAgIGNvZGU6IHRhZ0lkXG4gICAgICAgICAgICB9KS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3RJbml0TW9kYWwoJ3Byb2R1Y3RFZGl0JywgJ2xnJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/ph43nva7lpJrpgIlcbiAgICB2YXIgcmVzZXRNdWx0aVNlbGVjdCA9IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgIF8uZWFjaChsaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/ojrflj5bllYblk4HmlbDmja7lrZflhbhcbiAgICB2YXIgbG9hZFByb2R1Y3REaWN0aW9uYXJ5ID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0RGljdGlvbmFyeSh7XG4gICAgICAgIHR5cGU6IHR5cGVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgIGNhc2UgUFJPRFVDVF9ESUNfVFlQRS5PUklHSU5fUExBQ0U6XG4gICAgICAgICAgICAkc2NvcGUub3JpZ2luUGxhY2VMaXN0ID0gcmVzO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBQUk9EVUNUX0RJQ19UWVBFLkJSQU5EX0FXQVJFTkVTUzpcbiAgICAgICAgICAgICRzY29wZS5icmFuZEF3YXJlbmVzc0xpc3QgPSByZXM7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFBST0RVQ1RfRElDX1RZUEUuQlJBTkRfR1JBREU6XG4gICAgICAgICAgICAkc2NvcGUuYnJhbmRHcmFkZUxpc3QgPSByZXM7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WIqea2plxuICAgICRzY29wZS5wcm9maXRMZXZlbENvbmZpZyA9IHtcbiAgICAgIGdldERlZmF1bHRJdGVtOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuZ2V0TGlzdCgpO1xuICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgIHByb2ZpdExldmVsOiB2YWx1ZVxuICAgICAgICB9KSB8fCB7XG4gICAgICAgICAgbmFtZTogJ+aXoCdcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBnZXRMaXN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENPTlNUQU5UUy5nZXRMaXN0KHtcbiAgICAgICAgICBjbHNPck5hbWU6ICdQUk9GSVRfTEVWRUwnLFxuICAgICAgICAgIGhhc0RlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgIGNvZGVLZXk6ICdwcm9maXRMZXZlbCcsXG4gICAgICAgICAgdmFsdWVLZXk6ICduYW1lJ1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihyZWNvcmQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiByZWNvcmQucHJvZml0TGV2ZWwgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAkc2NvcGUucHJvZHVjdC5wcm9maXRMZXZlbCA9IHJlY29yZC5wcm9maXRMZXZlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgLy/ljp/kuqflnLBcbiAgICAkc2NvcGUucHJvZHVjdE9yaWdpblBsYWNlQ29uZmlnID0ge1xuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gJHNjb3BlLm9yaWdpblBsYWNlTGlzdDtcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKG9wdGlvbnMsIHtcbiAgICAgICAgICBpZDogdmFsdWVcbiAgICAgICAgfSkgfHwge1xuICAgICAgICAgIG5hbWU6ICfml6AnXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0Lm9yaWdpblBsYWNlID0gcmVjb3JkLmlkO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/lk4HniYzorqTnn6XluqZcbiAgICAkc2NvcGUucHJvZHVjdEJyYW5kQXdhcmVuZXNzQ29uZmlnID0ge1xuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gJHNjb3BlLmJyYW5kQXdhcmVuZXNzTGlzdDtcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKG9wdGlvbnMsIHtcbiAgICAgICAgICBpZDogdmFsdWVcbiAgICAgICAgfSkgfHwge1xuICAgICAgICAgIG5hbWU6ICfml6AnXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0LmJyYW5kQXdhcmVuZXNzID0gcmVjb3JkLmlkO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/lk4HniYzmoaPmrKFcbiAgICAkc2NvcGUucHJvZHVjdEJyYW5kR3JhZGVDb25maWcgPSB7XG4gICAgICBnZXREZWZhdWx0SXRlbTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSAkc2NvcGUuYnJhbmRHcmFkZUxpc3Q7XG4gICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7XG4gICAgICAgICAgaWQ6IHZhbHVlXG4gICAgICAgIH0pIHx8IHtcbiAgICAgICAgICBuYW1lOiAn5pegJ1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uKHJlY29yZCkge1xuICAgICAgICAkc2NvcGUucHJvZHVjdC5icmFuZEdyYWRlID0gcmVjb3JkLmlkO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/kuIDnuqflk4Hnsbsg6K6+572uXG4gICAgJHNjb3BlLnByb2R1Y3RMZXZlbE9uZUNhdGVnb3J5Q29uZmlnID0ge1xuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gJHNjb3BlLmxldmVsT25lQ2F0ZWdvcnlMaXN0O1xuICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgIGlkOiB2YWx1ZVxuICAgICAgICB9KSB8fCB7XG4gICAgICAgICAgY2F0ZWdvcnlOYW1lOiAn5pegJ1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uKHJlY29yZCkge1xuICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICBpZiAocmVjb3JkLmlkKSB7XG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3QuY2F0ZWdvcnlJZCA9IHJlY29yZC5pZDtcbiAgICAgICAgICBwcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RDYXRlZ29yeUxpc3Qoe1xuICAgICAgICAgICAgcGFyZW50Q2F0ZWdvcnlJZDogcmVjb3JkLmlkXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9kdWN0TGV2ZWxUd29DYXRlZ29yeUNvbmZpZy5zZXRMaXN0KHJlcyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5LqM57qn5ZOB57G7IOiuvue9rlxuICAgICRzY29wZS5wcm9kdWN0TGV2ZWxUd29DYXRlZ29yeUNvbmZpZyA9IHtcbiAgICAgIGxpc3Q6IFtdLFxuICAgICAgc2V0TGlzdDogZnVuY3Rpb24obGlzdCkge1xuICAgICAgICB0aGlzLmxpc3QgPSBhbmd1bGFyLmNvcHkobGlzdCk7XG4gICAgICB9LFxuICAgICAgZ2V0RGVmYXVsdEl0ZW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5saXN0O1xuICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgICAgaWQ6IHZhbHVlXG4gICAgICAgICAgfSkgfHwge1xuICAgICAgICAgICAgY2F0ZWdvcnlOYW1lOiAn5pegJ1xuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8ge1xuICAgICAgICAgICAgY2F0ZWdvcnlOYW1lOiAkc2NvcGUucHJvZHVjdC5zdWJDYXRlZ29yeU5hbWUgfHwgJ+aXoCcsXG4gICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgIGNhdGVnb3J5TmFtZTogJ+aXoCdcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0LnN1YkNhdGVnb3J5SWQgPSByZWNvcmQuaWQ7XG4gICAgICB9LFxuICAgICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmxpc3QgPSBbXTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5qCH562+IOiuvue9rlxuICAgICRzY29wZS5sYWJlbENvbmZpZyA9IHtcbiAgICAgIGxpbmVzbGlzdDogW10sXG4gICAgICBzZXRMaXN0OiBmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgIHRoaXMubGluZXNsaXN0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGggLyAzOyBpKyspIHtcbiAgICAgICAgICB2YXIgdGVtcCA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgaisrKSB7XG4gICAgICAgICAgICBpZiAobGlzdFtpICogMyArIGpdKSB7XG4gICAgICAgICAgICAgIHZhciByID0gbGlzdFtpICogMyArIGpdO1xuICAgICAgICAgICAgICByLnBhcmVudEluZGV4ID0gaSAqIDMgKyBqO1xuICAgICAgICAgICAgICBfLmVhY2goci5lbnRyaWVzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5wYXJlbnRJbmRleCA9IGkgKiAzICsgajtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHRlbXAucHVzaChyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5saW5lc2xpc3QucHVzaCh0ZW1wKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldERlZmF1bHRJdGVtOiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSAkc2NvcGUubGFiZWxMaXN0W2luZGV4XS5lbnRyaWVzO1xuICAgICAgICByZXR1cm4gXy5maW5kV2hlcmUob3B0aW9ucywge1xuICAgICAgICAgIGlkOiB2YWx1ZVxuICAgICAgICB9KSB8fCB7XG4gICAgICAgICAgbmFtZTogJ+aXoCdcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihyZWNvcmQpIHtcbiAgICAgICAgdmFyIHQgPSBfLnJlamVjdCgkc2NvcGUucHJvZHVjdC5sYWJlbER0b3MsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4gaXRlbS50eXBlID09IHJlY29yZC50eXBlO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3QubGFiZWxEdG9zID0gdDtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3QubGFiZWxEdG9zLnB1c2gocmVjb3JkKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v6L+b6LSnIOi/h+acnyDmjZ/ogJdcbiAgICAkc2NvcGUudHlwZVN0ciA9ICcnO1xuICAgICRzY29wZS50aXBTdHIgPSAnJztcbiAgICAkc2NvcGUubW9kYWxNb2RpZnlzdG9jayA9IGZ1bmN0aW9uKHN0cklkLCBzaXplLCB0eXBlU3RyKSB7XG4gICAgICBzd2l0Y2ggKHR5cGVTdHIpIHtcbiAgICAgICAgY2FzZSAnYWRkJzogLy8xXG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3Quc3RvY2tEZWx0YVR5cGUgPSBDT05TVEFOVFMuU1RPQ0tfTU9ESUZZX1RZUEUuSU1QT1JUO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdleHBpcmUnOiAvLzRcbiAgICAgICAgICAkc2NvcGUucHJvZHVjdC5zdG9ja0RlbHRhVHlwZSA9IENPTlNUQU5UUy5TVE9DS19NT0RJRllfVFlQRS5FWFBJUkU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3dhc3RlJzogLy82XG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3Quc3RvY2tEZWx0YVR5cGUgPSBDT05TVEFOVFMuU1RPQ0tfTU9ESUZZX1RZUEUuV0FTVEU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICAkc2NvcGUudHlwZVN0ciA9IHR5cGVTdHI7XG4gICAgICAkc2NvcGUudGlwU3RyID0gQ09OU1RBTlRTLlNUT0NLX01PRElGWV9UWVBFLkRFU0NbJHNjb3BlLnByb2R1Y3Quc3RvY2tEZWx0YVR5cGVdO1xuICAgICAgJHNjb3BlLnByb2R1Y3RJbml0TW9kYWwoc3RySWQsIHNpemUpO1xuICAgIH07XG4gICAgJHNjb3BlLm9wZXJhdGVTdG9jayA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBzdG9jayA9ICRzY29wZS5wcm9kdWN0LnN0b2NrO1xuICAgICAgaWYgKCRzY29wZS5wcm9kdWN0LnN0b2NrRGVsdGFUeXBlID09IENPTlNUQU5UUy5TVE9DS19NT0RJRllfVFlQRS5JTVBPUlQpIHtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3Quc3RvY2sgPSAkc2NvcGUucHJvZHVjdC5zdG9jayArIGRhdGE7XG4gICAgICAgICRzY29wZS5wcm9kdWN0LnN0b2NrRGVsdGEgPSBkYXRhO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHN0b2NrIDwgZGF0YSkge1xuICAgICAgICAgIHdpbmRvdy5hbGVydCgn5bqT5a2Y5LiN5aSf77yB6K+36LCD5pW06L6T5YWl5pWw5o2u77yBJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5wcm9kdWN0LnN0b2NrID0gJHNjb3BlLnByb2R1Y3Quc3RvY2sgLSBkYXRhO1xuICAgICAgICAkc2NvcGUucHJvZHVjdC5zdG9ja0RlbHRhID0gLWRhdGE7XG4gICAgICB9XG4gICAgICB0aGlzLiRjbG9zZSgpO1xuICAgIH07XG4gICAgLy/kv53lrZjllYblk4FcbiAgICAkc2NvcGUucHJvZHVjdFNhdmUgPSBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgdmFyIGVycm9yTXNnID0gJHNjb3BlLnByb2R1Y3QuY2hlY2tDb21wbGV0ZSgpO1xuICAgICAgaWYgKGVycm9yTXNnLmxlbmd0aCkge1xuICAgICAgICBhbGVydChlcnJvck1zZyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8v5LuT5L2NXG4gICAgICBwcm9kdWN0LnBvc2l0aW9uSWRzID0gXy5wbHVjayhwcm9kdWN0LnBvc2l0aW9uT3V0UHV0RGF0YSwgJ2lkJyk7XG4gICAgICAvL+agh+etvlxuICAgICAgcHJvZHVjdC5sYWJlbElkTGlzdCA9IF8ucGx1Y2socHJvZHVjdC5sYWJlbER0b3MsICdpZCcpO1xuICAgICAgLy/nibnmrormoIfor4ZcbiAgICAgIHByb2R1Y3QucHJvZHVjdFRhZ3MgPSBfLnBsdWNrKHByb2R1Y3Quc2VsZWN0UHJvZHVjdFRhZ3NEYXRhLFxuICAgICAgICAnY29kZScpO1xuICAgICAgdmFyIHNhdmVQYXJhbXMgPSBhbmd1bGFyLmNvcHkocHJvZHVjdCk7XG4gICAgICBzYXZlUGFyYW1zLm9yaWdpblByaWNlID0gdXRpbFNlcnZpY2UuZ2V0UG9pbnRJbnQoc2F2ZVBhcmFtcy5vcmlnaW5QcmljZSk7XG4gICAgICBzYXZlUGFyYW1zLnByaWNlID0gdXRpbFNlcnZpY2UuZ2V0UG9pbnRJbnQoc2F2ZVBhcmFtcy5wcmljZSk7XG4gICAgICBpZiAoc2F2ZVBhcmFtcy5pZCkge1xuICAgICAgICBwcm9kdWN0U2VydmljZS5zYXZlT2xkUHJvZHVjdChzYXZlUGFyYW1zKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgICBtZS4kY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzYXZlUGFyYW1zLnN0b2NrQWxhcm0gPSA5OTk5OTk7XG4gICAgICAgIHNhdmVQYXJhbXMuaW50cm8gPSAnLSc7XG4gICAgICAgIHNhdmVQYXJhbXMuZGV0YWlsID0gJy0nO1xuICAgICAgICBzYXZlUGFyYW1zLmltZ3MgPSBbJy0nXTtcbiAgICAgICAgcHJvZHVjdFNlcnZpY2Uuc2F2ZU5ld1Byb2R1Y3Qoc2F2ZVBhcmFtcykudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/liKDpmaTllYblk4FcbiAgICAkc2NvcGUuZGVsZXRlRm9ybSA9IHt9O1xuICAgICRzY29wZS5wcm9kdWN0RGVsZXRlV2luID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICRzY29wZS5kZWxldGVGb3JtID0ge307XG4gICAgICAkc2NvcGUuZGVsZXRlRm9ybS5wcm9kdWN0SWQgPSBpZDtcbiAgICAgICRzY29wZS5wcm9kdWN0SW5pdE1vZGFsKCdwcm9kdWN0RGVsZXRlJyk7XG4gICAgfTtcbiAgICAkc2NvcGUucHJvZHVjdERlbGV0ZVNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICBwcm9kdWN0U2VydmljZS5kZWxldGVQcm9kdWN0KHtcbiAgICAgICAgaWQ6ICRzY29wZS5kZWxldGVGb3JtLnByb2R1Y3RJZFxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICBtZS4kY2xvc2UoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLnNob3dCaWdJbWFnZSA9IGZ1bmN0aW9uKGNvdmVyKSB7fTtcbiAgICAkc2NvcGUuaW5wdXREYXRhID0gW3tcbiAgICAgIG5hbWU6ICdPcGVyYSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnSW50ZXJuZXQgRXhwbG9yZXInXG4gICAgfSwge1xuICAgICAgbmFtZTogJ0ZpcmVmb3gnXG4gICAgfV07XG4gICAgJHNjb3BlLmxvY2FsTGFuZyA9IHtcbiAgICAgIHNlbGVjdEFsbDogXCLlhajpgIlcIixcbiAgICAgIHNlbGVjdE5vbmU6IFwi5YWo5LiN6YCJXCIsXG4gICAgICByZXNldDogXCLph43nva5cIixcbiAgICAgIHNlYXJjaDogXCLovpPlhaXlhbPplK7lrZfmkJzntKJcIixcbiAgICAgIG5vdGhpbmdTZWxlY3RlZDogXCLml6BcIlxuICAgIH07XG4gICAgY2F0ZWdvcnlJbml0KCk7XG4gICAgcG9zaXRpb25Jbml0KCk7XG4gICAgLy/ljp/kuqflnLBcbiAgICBsb2FkUHJvZHVjdERpY3Rpb25hcnkoUFJPRFVDVF9ESUNfVFlQRS5PUklHSU5fUExBQ0UpO1xuICAgIC8v5ZOB54mM6K6k55+l5bqmXG4gICAgbG9hZFByb2R1Y3REaWN0aW9uYXJ5KFBST0RVQ1RfRElDX1RZUEUuQlJBTkRfQVdBUkVORVNTKTtcbiAgICAvL+WTgeeJjOaho+asoVxuICAgIGxvYWRQcm9kdWN0RGljdGlvbmFyeShQUk9EVUNUX0RJQ19UWVBFLkJSQU5EX0dSQURFKTtcbiAgICAvKipcbiAgICAgKiDmjInnvJbnoIHmjpLluo9cbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgICRzY29wZS5zb3J0QnlQb3NpdGlvbiA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zb3J0VHlwZSA9IGl0ZW0uc29ydENvZGU7XG4gICAgICAkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUucHJvZHVjdFN0b2NrQ2hhbmdlTG9nUGFuZWw7XG4gICAgJHNjb3BlLnByb2R1Y3RTdG9ja0NoYW5nZUxvZ3MgPSBbXTtcbiAgICAkc2NvcGUucHJvZHVjdFN0b2NrQ2hhbmdlTG9nSWQ7XG4gICAgdmFyIHN0b2NrQ2hhbmdlTG9nTGltaXQgPSAxMDtcbiAgICAkc2NvcGUucHJvZHVjdFN0b2NrQ2hhbmdlTG9nVGFibGUgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICBjb3VudDogc3RvY2tDaGFuZ2VMb2dMaW1pdFxuICAgIH0sIHtcbiAgICAgIGNvdW50czogW10sXG4gICAgICBnZXREYXRhOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIHAgPSB7fTtcbiAgICAgICAgdmFyIG9mZnNldCA9IHN0b2NrQ2hhbmdlTG9nTGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpO1xuICAgICAgICBwID0ge1xuICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgIGxpbWl0OiBzdG9ja0NoYW5nZUxvZ0xpbWl0LFxuICAgICAgICAgIGlkOiAkc2NvcGUucHJvZHVjdFN0b2NrQ2hhbmdlTG9nSWRcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHByb2R1Y3RTZXJ2aWNlLmdldFByb2R1Y3RTdG9ja0NoYW5nZUxvZyhwKS50aGVuKFxuICAgICAgICAgIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RTdG9ja0NoYW5nZUxvZ3MgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gdXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgb2Zmc2V0ICtcbiAgICAgICAgICAgICAgMSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7O1xuICAgIC8v5bqT5a2Y5L+u5pS56K6w5b2VXG4gICAgJHNjb3BlLnNob3dQcm9kdWN0U3RvY2tDaGFuZ2VMb2cgPSBmdW5jdGlvbihwcm9kdWN0LCBlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgJHNjb3BlLnByb2R1Y3RTdG9ja0NoYW5nZUxvZ0lkID0gcHJvZHVjdC5pZDtcbiAgICAgICRzY29wZS5wcm9kdWN0SW5pdE1vZGFsKCdtb2RhbC1wcm9kdWN0c3RvY2tjaGFuZ2Vsb2dwYW5lbCcsICdtZCcpO1xuICAgIH07XG4gICAgJHNjb3BlLnByb2R1Y3QgPSB7XG4gICAgICBpZDogJycsXG4gICAgICBza3VDb2RlOiAnJyxcbiAgICAgIHByb2R1Y3ROYW1lOiAnJyxcbiAgICAgIG5ldDogJycsXG4gICAgICBuZXRVbml0OiAnJyxcbiAgICAgIHByb2ZpdExldmVsOiAnJyxcbiAgICAgIG9yaWdpblBsYWNlOiAnJyxcbiAgICAgIG9yaWdpblByaWNlOiAnJyxcbiAgICAgIHByaWNlOiAnJyxcbiAgICAgIGV4cGlyeURhdGU6ICcnLFxuICAgICAgYnJhbmRBd2FyZW5lc3M6ICcnLFxuICAgICAgYnJhbmRHcmFkZTogJycsXG4gICAgICBjYXRlZ29yeUlkOiAnJyxcbiAgICAgIHN1YkNhdGVnb3J5SWQ6ICcnLFxuICAgICAgbGFiZWxJZExpc3Q6IFtdLFxuICAgICAgc2hvd0xhYmVsSWRMaXN0OiBbXSxcbiAgICAgIGxhYmVsRHRvczogW10sXG4gICAgICBzdG9jazogMCxcbiAgICAgIGNvdmVyOiAnJyxcbiAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pZCA9ICcnO1xuICAgICAgICB0aGlzLnNrdUNvZGUgPSAnJztcbiAgICAgICAgdGhpcy5wcm9kdWN0TmFtZSA9ICcnO1xuICAgICAgICB0aGlzLm5ldCA9ICcnO1xuICAgICAgICB0aGlzLm5ldFVuaXQgPSAnJztcbiAgICAgICAgdGhpcy5wcm9maXRMZXZlbCA9ICcnO1xuICAgICAgICB0aGlzLm9yaWdpblBsYWNlID0gJyc7XG4gICAgICAgIHRoaXMub3JpZ2luUHJpY2UgPSAnJztcbiAgICAgICAgdGhpcy5wcmljZSA9ICcnO1xuICAgICAgICB0aGlzLmV4cGlyeURhdGUgPSAnJztcbiAgICAgICAgdGhpcy5icmFuZEF3YXJlbmVzcyA9ICcnO1xuICAgICAgICB0aGlzLmJyYW5kR3JhZGUgPSAnJztcbiAgICAgICAgdGhpcy5jYXRlZ29yeUlkID0gJyc7XG4gICAgICAgIHRoaXMuc3ViQ2F0ZWdvcnlJZCA9ICcnO1xuICAgICAgICB0aGlzLmxhYmVsSWRMaXN0ID0gW107XG4gICAgICAgIHRoaXMuc2hvd0xhYmVsSWRMaXN0ID0gW107XG4gICAgICAgIHRoaXMubGFiZWxEdG9zID0gW107XG4gICAgICAgIHRoaXMuc3RvY2sgPSAwO1xuICAgICAgICB0aGlzLmNvdmVyID0gJyc7XG4gICAgICB9LFxuICAgICAgY2hlY2tDb21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlcnJvck1zZyA9IFwiXCI7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5wcm9maXRMZXZlbCA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIGVycm9yTXNnID0gJ+ivt+mAieaLqeWIqea2puetiee6pyc7XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMub3JpZ2luUGxhY2UpIHtcbiAgICAgICAgICBlcnJvck1zZyA9ICfor7fpgInmi6nljp/kuqflnLAnO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmJyYW5kQXdhcmVuZXNzKSB7XG4gICAgICAgICAgZXJyb3JNc2cgPSAn6K+36YCJ5oup5ZOB54mM6K6k55+l5bqmJztcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5icmFuZEdyYWRlKSB7XG4gICAgICAgICAgZXJyb3JNc2cgPSAn6K+36YCJ5oup5ZOB54mM5qGj5qyhJztcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5jYXRlZ29yeUlkKSB7XG4gICAgICAgICAgZXJyb3JNc2cgPSAn6K+36YCJ5oup5ZOB57G7JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXJyb3JNc2c7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuY29udHJvbGxlcigncHJvbW90aW9uT3JkZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkY29tcGlsZSxcbiAgICBvcmRlclNlcnZpY2UsXG4gICAgJHRlbXBsYXRlQ2FjaGUsICRtZERpYWxvZywgbW9kYWxTZXJ2aWNlLCBwcmludFNlcnZpY2UsIG9yZGVyU2VydmljZSxcbiAgICBOZ1RhYmxlUGFyYW1zLCB1dGlsU2VydmljZSwgQ09OU1RBTlRTLCBjb21wYW55U2VydmljZSxcbiAgICBwcm9tb3Rpb25TZXJ2aWNlLFxuICAgICRmaWx0ZXIpIHtcbiAgICAkc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAkc2NvcGUuT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFO1xuICAgICRzY29wZS5DT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgICRzY29wZS5TRVRUTEVNRU5UX1NUQVRFID0gQ09OU1RBTlRTLlNFVFRMRU1FTlRfU1RBVEU7XG4gICAgJHNjb3BlLlBST01PVElPTl9PUkRFUl9TVEFUVVMgPSBDT05TVEFOVFMuUFJPTU9USU9OX09SREVSX1NUQVRVUztcbiAgICAkc2NvcGUuVGVhX1BlcmlvZF9UeXBlID0gQ09OU1RBTlRTLlRlYV9QZXJpb2RfVHlwZTtcbiAgICAkc2NvcGUuY3VycmVudE9yZGVySWQ7XG5cbiAgICB2YXIgQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICB2YXIgT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFO1xuICAgIHZhciBERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTtcbiAgICB2YXIgUkVGVU5EX1NUQVRFID0gQ09OU1RBTlRTLlJFRlVORF9TVEFURTtcbiAgICB2YXIgSU5WRU5UT1JZX1NUQVRFID0gQ09OU1RBTlRTLklOVkVOVE9SWV9TVEFURTtcbiAgICB2YXIgU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgIHZhciBUZWFfUGVyaW9kX1R5cGUgPSBDT05TVEFOVFMuVGVhX1BlcmlvZF9UeXBlO1xuICAgIHZhciBQcm9tb3Rpb25fU2VhcmNoX1R5cGUgPSBDT05TVEFOVFMuUHJvbW90aW9uX1NlYXJjaF9UeXBlXG4gICAgJHNjb3BlLm9mZnNldDtcbiAgICAkc2NvcGUubGltaXQ7XG4gICAgJHNjb3BlLmlzVXBkYXRlVGltZUNob2ljZXMgPSBbeyBkZXNjOiAn5LiL5Y2V5pe26Ze0JywgY29kZTogJzAnIH0sIHtcbiAgICAgIGRlc2M6ICfpooTnuqbpgIHotKfml7bpl7QnLFxuICAgICAgY29kZTogJzEnXG4gICAgfV07XG4gICAgJHNjb3BlLlNlYXJjaENob2ljZXMgPSBbeyBkZXNjOiAn5omL5py65Y+3JywgY29kZTogJzEnIH0sIHsgZGVzYzogJ+S8geS4muWQjeensCcsXG4gICAgICAgIGNvZGU6ICcyJyB9LFxuICAgICAgeyBkZXNjOiAn6IGU57O75Lq6JywgY29kZTogJzMnIH1cbiAgICBdO1xuICAgICRzY29wZS5vcmRlclR5cGVMaXN0ID0gW3sgZGVzYzogJ+WFqOmDqOiuouWNlScsIGNvZGU6ICcwJyB9LCB7IGRlc2M6ICflvoXnoa7orqQnLFxuICAgICAgICBjb2RlOiAnMScgfSxcbiAgICAgIHsgZGVzYzogJ+W+heS7mOWwvuasvicsIGNvZGU6ICcyJyB9LCB7IGRlc2M6ICflvoXlj5HotKcnLCBjb2RlOiAnMycgfSwge1xuICAgICAgICBkZXNjOiAn5bey5Y+R6LSnJyxcbiAgICAgICAgY29kZTogJzQnXG4gICAgICB9LCB7IGRlc2M6ICflt7LmlLbotKcnLCBjb2RlOiAnNScgfSwgeyBkZXNjOiAn5bey5Y+W5raIJywgY29kZTogJzYnIH1cbiAgICBdO1xuXG5cbiAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICBjcmVhdGVTdGFydERheTogJycsXG4gICAgICBjcmVhdGVFbmREYXk6ICcnLFxuICAgICAgdXBkYXRlU3RhcnREYXk6ICcnLFxuICAgICAgdXBkYXRlRW5kRGF5OiAnJyxcbiAgICAgIGlzUGFpZDogJycsIC8vIDAg5rKh5pyJICAxIOW3suaUr+S7mFxuICAgICAgaXNVcGF0ZVRpbWU6IDAsXG4gICAgICB0ZWw6IFwiXCIsXG4gICAgICBuYW1lOiBcIlwiLFxuICAgICAgc3RhdHVzOiBcIlwiLFxuICAgICAgY3VyT3JkZXJUeXBlOiBcIlwiLFxuICAgICAgc2VhcmNoU2VsZWN0OiBQcm9tb3Rpb25fU2VhcmNoX1R5cGUuVEVMXG4gICAgfTtcblxuICAgIHZhciBzZXRPcmRlclRhYmxlID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSA9ICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSB8fFxuICAgICAgICB1dGlsU2VydmljZVxuICAgICAgICAucGFyc2VUaW1lQnlEYXRlRGlzKG5ldyBEYXRlKCksIC03LCAneXl5eS1NTS1kZCcpO1xuICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheSA9ICRzY29wZS5xdWVyeVBhcmFtcy5lbmREYXkgfHxcbiAgICAgICAgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlEYXRlKFxuICAgICAgICAgIG5ldyBEYXRlKCksICd5eXl5LU1NLWRkJyk7XG4gICAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICAgJHNjb3BlLm9yZGVyVGFibGUgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgIH0sIHtcbiAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMTMsXG4gICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgIHZhciBwID0ge1xuICAgICAgICAgICAgb2Zmc2V0OiAocGFyYW1zLnBhZ2UoKSAtIDEpICogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdFxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5zZWFyY2hTZWxlY3QgPT1cbiAgICAgICAgICAgIFByb21vdGlvbl9TZWFyY2hfVHlwZS5URUwpIHtcbiAgICAgICAgICAgIGlmICgvXigxM1swLTldfDE0WzAtOV18MTVbMC05XXwxOFswLTldKVxcZHs4fSQvaS50ZXN0KFxuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtc1xuICAgICAgICAgICAgICAgIC5uYW1lKSB8fCAkc2NvcGUucXVlcnlQYXJhbXMubmFtZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgICBwLmNvbnRhY3RQaG9uZSA9ICRzY29wZS5xdWVyeVBhcmFtcy5uYW1lXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhbGVydCgn6K+36L6T5YWl5q2j56Gu5qC85byP55qE5omL5py65Y+356CBJyk7XG4gICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5uYW1lID0gJydcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLnF1ZXJ5UGFyYW1zLnNlYXJjaFNlbGVjdCA9PVxuICAgICAgICAgICAgUHJvbW90aW9uX1NlYXJjaF9UeXBlXG4gICAgICAgICAgICAuQ09NUEFOWSkge1xuICAgICAgICAgICAgcC5jb21wYW55TmFtZSA9ICRzY29wZS5xdWVyeVBhcmFtcy5uYW1lXG4gICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUucXVlcnlQYXJhbXMuc2VhcmNoU2VsZWN0ID09XG4gICAgICAgICAgICBQcm9tb3Rpb25fU2VhcmNoX1R5cGVcbiAgICAgICAgICAgIC5OYW1lKSB7XG4gICAgICAgICAgICBwLmNvbnRhY3ROYW1lID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLm5hbWVcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5jdXJPcmRlclR5cGUpIHtcbiAgICAgICAgICAgIHAuc3RhdHVzID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmN1ck9yZGVyVHlwZTtcbiAgICAgICAgICB9XG5cblxuICAgICAgICAgIGlmICgkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUpIHtcblxuICAgICAgICAgICAgcC5kZWxpdmVyeVRpbWVTdGFydCA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0RGF5XG4gICAgICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgIC8tL2csICcvJykpO1xuICAgICAgICAgICAgcC5kZWxpdmVyeVRpbWVFbmQgPSBEYXRlLnBhcnNlKCRzY29wZS5xdWVyeVBhcmFtcy5lbmREYXlcbiAgICAgICAgICAgICAgLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgLy0vZywgJy8nKSArICcgMjM6NTk6NTknKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcC5jcmVhdGVUaW1lU3RhcnQgPSBEYXRlLnBhcnNlKCRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheVxuICAgICAgICAgICAgICAucmVwbGFjZShcbiAgICAgICAgICAgICAgICAvLS9nLCAnLycpKTtcbiAgICAgICAgICAgIHAuY3JlYXRlVGltZUVuZCA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheVxuICAgICAgICAgICAgICAucmVwbGFjZSgvLS9nLFxuICAgICAgICAgICAgICAgICcvJykgKyAnIDIzOjU5OjU5Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIG9yZGVyU2VydmljZS5xdWVyeVByb21vdGlvbkxpc3QocCkudGhlbihmdW5jdGlvbihcbiAgICAgICAgICAgIHJlcykge1xuICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gJHNjb3BlLmFkZFJlZnVuZFR5cGUocmVzLmNvbnRlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrSW5mbyh1dGlsU2VydmljZS5pbmRleEFycmF5KGRhdGEsXG4gICAgICAgICAgICAgICRzY29wZS5saW1pdCAqIChcbiAgICAgICAgICAgICAgICBwYXJhbXMucGFnZSgpIC0gMSkgKyAxKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzZXRPcmRlclRhYmxlKCk7XG4gICAgLy8g5LiL5Y2I6Iy257G75Z6L6L2s5o2iXG4gICAgJHNjb3BlLmFkZFJlZnVuZFR5cGUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0YSkgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgIHRlYUFycmF5ID0gZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0ZWFBcnJheSA9IFtkYXRhXTtcbiAgICAgICAgfVxuICAgICAgICBhbmd1bGFyLmZvckVhY2godGVhQXJyYXksIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgICBpZiAoaXRlbS5vcmRlci5zdGF0dXMgPT0gNyB8fCBpdGVtLm9yZGVyLnN0YXR1cyA9PSA4KSB7XG4gICAgICAgICAgICBpdGVtLm9yZGVyLnJlZnVuZCA9ICfmnKrpgIDmrL4nXG4gICAgICAgICAgfSBlbHNlIGlmIChpdGVtLm9yZGVyLnN0YXR1cyA9PSA5KSB7XG4gICAgICAgICAgICBpdGVtLm9yZGVyLnJlZnVuZCA9ICflt7LpgIDmrL4nXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGl0ZW0ub3JkZXIucmVmdW5kID0gJy0tJ1xuXG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiB0ZWFBcnJheTtcbiAgICAgIH1cbiAgICAgIC8v5pCc57Si5Y2V5o2uc2VhcmNoVGVhXG4gICAgJHNjb3BlLnNlYXJjaFRlYSA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICBxdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zIHx8IHt9O1xuICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLm5hbWUgPSBxdWVyeVBhcmFtcy5uYW1lIHx8IFwiXCI7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc2VhcmNoU2VsZWN0ID0gcXVlcnlQYXJhbXMuc2VhcmNoU2VsZWN0O1xuICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0RGF5ID0gcXVlcnlQYXJhbXMuc3RhcnRUaW1lID8gdXRpbFNlcnZpY2VcbiAgICAgICAgLnBhcnNlVGltZUJ5RGF0ZShcbiAgICAgICAgICBxdWVyeVBhcmFtcy5zdGFydFRpbWUsICd5eXl5LU1NLWRkJykgOlxuICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJyk7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ID0gcXVlcnlQYXJhbXMuZW5kVGltZSA/IHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZShcbiAgICAgICAgICBxdWVyeVBhcmFtcy5lbmRUaW1lLCAneXl5eS1NTS1kZCcpIDpcbiAgICAgICAgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlEYXRlKG5ldyBEYXRlKCksICd5eXl5LU1NLWRkJyk7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUgPSBxdWVyeVBhcmFtcy5pc1VwYXRlVGltZTtcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zZWFyY2hTZWxlY3QgPSBxdWVyeVBhcmFtcy5zZWFyY2hTZWxlY3Q7XG4gICAgICBzZXRPcmRlclRhYmxlKCk7XG4gICAgfTtcbiAgICAvL+mAieaLqeWNleaNruexu+Wei1xuICAgICRzY29wZS5zZWxlY3RPcmRlclR5cGUgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpZiAoaXRlbS5jb2RlID09IDApIHtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmN1ck9yZGVyVHlwZSA9IFsyLCAzLCA0LCA1LCA2LCA4LCA5XTtcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS5jb2RlID09IDYpIHtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmN1ck9yZGVyVHlwZSA9IFs4LCA5XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jdXJPcmRlclR5cGUgPSBwYXJzZUludChpdGVtLmNvZGUpICsgMTtcbiAgICAgIH1cblxuICAgICAgc2V0T3JkZXJUYWJsZSgpO1xuICAgIH07XG4gICAgJHNjb3BlLnNob3dEZXRhaWwgPSBmdW5jdGlvbihvcmRlcikge1xuICAgICAgJHNjb3BlLmN1cnJlbnRPcmRlciA9IG9yZGVyO1xuICAgICAgJHNjb3BlLmN1cnJlbnRPcmRlcklkID0gb3JkZXIub3JkZXIuaWQ7XG4gICAgICAkc2NvcGUuY2hlY2tPcmRlckRldGFpbChPUkRFUl9UWVBFLlBST01PVElPTiwgb3JkZXIub3JkZXIuaWQpO1xuICAgIH07XG4gICAgLy/mmI7nu4ZcbiAgICAkc2NvcGUuY2hlY2tPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgb3JkZXJJZCwgc2NvcGUsXG4gICAgICBpc1VwZGF0ZSkge1xuICAgICAgLy8kc2NvcGUuY29tcGFueU5hbWU9Y29tcGFueU5hbWU7XG4gICAgICBvcmRlclNlcnZpY2UuY2hlY2tPcmRlckRldGFpbChvcmRlclR5cGUsIG9yZGVySWQsICRzY29wZSxcbiAgICAgICAgaXNVcGRhdGUpO1xuICAgIH07XG4gICAgLyrmiZPljbAqL1xuICAgIC8v5omT5Y2w5Y2V5o2u5YiX6KGoXG4gICAgdmFyIHByaW50T3JkZXJBcnJheSA9IFtdO1xuICAgIHZhciBjaGVja0luZm8gPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKHByaW50T3JkZXJBcnJheSwge1xuICAgICAgICAgIG9yZGVySWQ6IGl0ZW0ub3JkZXJJZFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG4gICAgJHNjb3BlLmNoZWNrQWxsQ2ZnID0ge1xuICAgICAgZmxhZzogZmFsc2VcbiAgICB9O1xuICAgIC8v5Yu+6YCJXG4gICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbiA9IGZ1bmN0aW9uKGUsIG9yZGVyKSB7XG4gICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgaXNDaGVja2VkID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgfVxuICAgICAgb3JkZXIuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgcHJpbnRPcmRlckFycmF5LnB1c2gob3JkZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmNoZWNrQWxsQ2ZnLmZsYWcgPSBmYWxzZTtcbiAgICAgICAgcHJpbnRPcmRlckFycmF5ID0gXy53aXRob3V0KHByaW50T3JkZXJBcnJheSwgb3JkZXIpO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLnNlbGVjdEFsbE9yZGVyID0gZnVuY3Rpb24oZSwgZGF0YSwgY2hlY2thbGwpIHtcbiAgICAgIHZhciBzdCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCAhPT0gc3QpIHtcbiAgICAgICAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uKGUuY3VycmVudFRhcmdldC5jaGVja2VkLCBpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+aJuemHj+aJk+WNsFxuICAgICRzY29wZS5wcmludE9yZGVyID0gZnVuY3Rpb24ob3JkZXJzKSB7XG4gICAgICAvLyBkZWJ1Z2dlclxuICAgICAgdmFyIHByb21vdGlvbk9yZGVySWRzID0gW107XG4gICAgICB2YXIgb3JkZXJBcnJheSA9IFtdO1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvcmRlcnMpID09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICAgICAgb3JkZXJBcnJheSA9IG9yZGVycztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9yZGVyQXJyYXkgPSBbb3JkZXJzXTtcbiAgICAgIH1cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcmRlckFycmF5LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHByb21vdGlvbk9yZGVySWRzLnB1c2goaXRlbS5vcmRlci5pZCk7XG4gICAgICB9KTtcbiAgICAgIG9yZGVyU2VydmljZS5xdWVyeVByb21vdGlvbkxpc3Qoe1xuICAgICAgICBpZHM6IHByb21vdGlvbk9yZGVySWRzXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICB2YXIgcHJvbW90aW9uT3JkZXJEZXRhaWxzID0gcmVzLmNvbnRlbnQgfHwgW107XG4gICAgICAgIHZhciB0ZW1wcyA9IFtdO1xuICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJvbW90aW9uT3JkZXJEZXRhaWxzLCBmdW5jdGlvbihkZXRhaWwpIHtcbiAgICAgICAgICB2YXIgc2NvcGUgPSBvcmRlclNlcnZpY2UucHJvbW90aW9uT3JkZXJTY29wZShcbiAgICAgICAgICAgIE9SREVSX1RZUEUuUFJPTU9USU9OLFxuICAgICAgICAgICAgZGV0YWlsLCAkc2NvcGUuJG5ldyh0cnVlKSk7XG4gICAgICAgICAgc2NvcGUuaXNQcmludCA9IHRydWU7XG4gICAgICAgICAgdGVtcHMucHVzaChhbmd1bGFyLmVsZW1lbnQoJzxkaXY+PC9kaXY+JykuYXBwZW5kKFxuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLmdldFRlbXBsYXRlRG9tQnlUeXBlKFxuICAgICAgICAgICAgICBPUkRFUl9UWVBFLlBST01PVElPTiwgc2NvcGUpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGh0bWxzID0gW107XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlbXBzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICBodG1scy5wdXNoKGl0ZW1bMF0uaW5uZXJIVE1MKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBwcmludFNlcnZpY2UucHJpbnRCeURlZmF1bHRQcmludGVyKGh0bWxzKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8vIOivpuaDhemhteaJk+WNsFxuICAgICRzY29wZS5wcmludFRlYUh0bWwgPSBmdW5jdGlvbihvcmRlclR5cGUpIHtcbiAgICAgIHZhciBodG1sID0gb3JkZXJTZXJ2aWNlLmdldFByaW50SHRtbEluT3JkZXJNb2R1bGUob3JkZXJUeXBlKTtcbiAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgIHByaW50U2VydmljZS5wcmludEJ5RGVmYXVsdFByaW50ZXIoaHRtbCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5iYXRoTXVsdGlQcmludCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHByaW50T3JkZXJBcnJheS5sZW5ndGgpIHtcbiAgICAgICAgJHNjb3BlLnByaW50T3JkZXIocHJpbnRPcmRlckFycmF5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgIHRleHRDb250ZW50OiAn6K+36YCJ5oup6ZyA6KaB5omT5Y2w55qE56Wo5o2uJyxcbiAgICAgICAgICBvazogJ+ehruiupCdcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLmtleXJlbWFyayA9IGZ1bmN0aW9uKGUsIHJlbWFyaywgaWQpIHtcbiAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHsgLy/lm57ovabplK5cbiAgICAgICAgb3JkZXJTZXJ2aWNlLm1vZGlmeVJlbWFyayh7XG4gICAgICAgICAgb3JkZXJJZDogaWQsXG4gICAgICAgICAgcmVtYXJrOiByZW1hcmtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgJHNjb3BlLnBheUZ1bGxEaWFsb2c7XG4gICAgJHNjb3BlLnNlbmREaWFsb2c7XG4gICAgJHNjb3BlLnJlZnVuZERpYWxvZztcbiAgICAkc2NvcGUucGF5RnVsbFBhcmFtcyA9IHtcbiAgICAgIG5vdGU6ICcnXG4gICAgfTtcbiAgICAkc2NvcGUuc2VuZFBhcmFtcyA9IHtcbiAgICAgIGV4cHJlc3NOYW1lOiAnJyxcbiAgICAgIGV4cHJlc3NOdW1iZXI6ICcnXG4gICAgfTtcbiAgICAkc2NvcGUucmVjb3JkTW9kYWw7XG4gICAgJHNjb3BlLnJlY29yZFBhcmFtcyA9IHt9O1xuICAgICRzY29wZS5vcGVuUmVjb3JkTW9kYWwgPSBmdW5jdGlvbihvcmRlciwgcmVjb3JkVHlwZSkge1xuICAgICAgJHNjb3BlLnJlY29yZFBhcmFtcy50eXBlID0gcmVjb3JkVHlwZTtcbiAgICAgICRzY29wZS5yZWNvcmRQYXJhbXMub3JkZXJJZCA9IG9yZGVyLm9yZGVyLmlkO1xuICAgICAgJHNjb3BlLnJlY29yZFBhcmFtcy5vcHRSZWNvcmQgPSAnJztcbiAgICAgICRzY29wZS5yZWNvcmRNb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgJ3Byb21vdGlvbicpKSxcbiAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2RhbFJlY29yZCdcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLnJlZnJlc2hNb2RlbCA9IGZ1bmN0aW9uKG9yZGVySWQpIHtcbiAgICAgICRzY29wZS5jaGVja09yZGVyRGV0YWlsKE9SREVSX1RZUEUuUFJPTU9USU9OLCBvcmRlcklkLCAkc2NvcGUsXG4gICAgICAgIHRydWUpO1xuICAgIH07XG4gICAgLy/lj5bmtojmraTljZVcbiAgICAkc2NvcGUuY2FjZWxPcmRlciA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICB2YXIgc3RhdHVzID0gb3JkZXIub3JkZXIuc3RhdHVzO1xuICAgICAgcHJvbW90aW9uU2VydmljZS5jYW5jZWxQYXltZW50T3JkZXIoe1xuICAgICAgICBvcmRlcklkOiBvcmRlci5vcmRlci5pZFxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLnByb21vdGlvbi5jbG9zZSgpO1xuICAgICAgICBzZXRPcmRlclRhYmxlKCk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy/mjqXmlLZcbiAgICAkc2NvcGUucmVjZWl2ZU9yZGVyID0gZnVuY3Rpb24ob3JkZXIpIHtcbiAgICAgICRzY29wZS5vcGVuUmVjb3JkTW9kYWwob3JkZXIsIENPTlNUQU5UUy5HT09EU0NIT09TRV9PUkRFUl9TVEFURS5WRVJJRklFRCk7XG4gICAgfTtcbiAgICAvL+S7mOWwvuasvlxuICAgICRzY29wZS5wYXlGdWxsT3JkZXIgPSBmdW5jdGlvbihvcmRlcikge1xuICAgICAgJHNjb3BlLnBheUZ1bGxDb3VudCA9IHBhcnNlRmxvYXQocGFyc2VJbnQob3JkZXIub3JkZXIuYWN0dWFsUHJpY2UpICpcbiAgICAgICAgMTAwIC0gcGFyc2VJbnQob3JkZXIub3JkZXIuZGVwb3NpdCksIDIpO1xuICAgICAgJHNjb3BlLnBheUZ1bGxEaWFsb2cuc2hvd0RpYWxvZygkc2NvcGUpO1xuICAgIH07XG4gICAgJHNjb3BlLmNvbmZpcm1QYXlGdWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICBwcm9tb3Rpb25TZXJ2aWNlLnBheUZ1bGxQcm9tb3Rpb25PcmRlcih7XG4gICAgICAgIG9yZGVySWQ6ICRzY29wZS5jdXJyZW50T3JkZXJJZCxcbiAgICAgICAgY3JtTm90ZXM6ICRzY29wZS5wYXlGdWxsUGFyYW1zLm5vdGVcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5yZWZyZXNoTW9kZWwoJHNjb3BlLmN1cnJlbnRPcmRlcklkKTtcbiAgICAgICAgc2V0T3JkZXJUYWJsZSgpO1xuICAgICAgICAkc2NvcGUucGF5RnVsbERpYWxvZy5jbG9zZURpYWxvZygpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+WPkei0p1xuICAgICRzY29wZS5zZW5kT3JkZXIgPSBmdW5jdGlvbihvcmRlcikge1xuICAgICAgJHNjb3BlLnNlbmREaWFsb2cuc2hvd0RpYWxvZygkc2NvcGUpO1xuICAgIH07XG4gICAgJHNjb3BlLmNvbmZpcm1TZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICBwcm9tb3Rpb25TZXJ2aWNlLmRlbGl2ZXJ5UHJvbW90aW9uT3JkZXIoe1xuICAgICAgICBvcmRlcklkOiAkc2NvcGUuY3VycmVudE9yZGVySWQsXG4gICAgICAgIGV4cHJlc3NJZDogJHNjb3BlLnNlbmRQYXJhbXMuZXhwcmVzc051bWJlcixcbiAgICAgICAgZXhwcmVzc1R5cGU6ICRzY29wZS5zZW5kUGFyYW1zLmV4cHJlc3NOYW1lXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUucmVmcmVzaE1vZGVsKCRzY29wZS5jdXJyZW50T3JkZXJJZCk7XG4gICAgICAgIHNldE9yZGVyVGFibGUoKTtcbiAgICAgICAgJHNjb3BlLnNlbmREaWFsb2cuY2xvc2VEaWFsb2coKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/pgIDmrL5cbiAgICAkc2NvcGUucmVmdW5kT3JkZXIgPSBmdW5jdGlvbihvcmRlcikge1xuICAgICAgJHNjb3BlLnJlZnVuZERpYWxvZy5zaG93RGlhbG9nKCRzY29wZSk7XG4gICAgfTtcbiAgICAkc2NvcGUuY29uZmlybVJlZnVuZCA9IGZ1bmN0aW9uKG9yZGVyKSB7XG4gICAgICBwcm9tb3Rpb25TZXJ2aWNlLnJlZnVuZFByb21vdGlvbk9yZGVyKHtcbiAgICAgICAgb3JkZXJJZDogJHNjb3BlLmN1cnJlbnRPcmRlcklkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUucmVmcmVzaE1vZGVsKCRzY29wZS5jdXJyZW50T3JkZXJJZCk7XG4gICAgICAgIHNldE9yZGVyVGFibGUoKTtcbiAgICAgICAgJHNjb3BlLnJlZnVuZERpYWxvZy5jbG9zZURpYWxvZygpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8v56Gu6K6k6K6i5Y2VXG4gICAgJHNjb3BlLmNvbmZpcm1BbmRFZGl0T3JkZXIgPSBmdW5jdGlvbihvcmRlciwgc2NvcGUpIHtcbiAgICAgIG9wZW5FZGl0TW9kYWwob3JkZXIsIHNjb3BlKTtcbiAgICB9O1xuXG4gICAgLy/mlLbotKdcbiAgICAkc2NvcGUucmVjZWl2ZU9yZGVyID0gZnVuY3Rpb24ob3JkZXIpIHtcbiAgICAgIHByb21vdGlvblNlcnZpY2UucmVjZWl2ZVByb21vdGlvbk9yZGVyKHtcbiAgICAgICAgb3JkZXJJZDogJHNjb3BlLmN1cnJlbnRPcmRlcklkXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUucmVmcmVzaE1vZGVsKCRzY29wZS5jdXJyZW50T3JkZXJJZCk7XG4gICAgICAgIHNldE9yZGVyVGFibGUoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLmdldFByb21vdGlvblByb2R1Y3QgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwcm9tb3Rpb25TZXJ2aWNlLnF1ZXJ5UHJvbW90aW9uUHJvZHVjdExpc3Qoe1xuICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgIGxpbWl0OiAxMDAwMCxcbiAgICAgICAgdGl0bGU6ICRzY29wZS5lZGl0RGF0YS5zZWFyY2gsXG4gICAgICAgIHN0YXR1czogMSxcbiAgICAgICAgcGF5VHlwZToxXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUucHJvZHVjdHMgPSByZXMuY29udGVudDtcbiAgICAgICAgcmV0dXJuICRzY29wZS5wcm9kdWN0cztcblxuICAgICAgfSlcblxuICAgIH07XG4gICAgJHNjb3BlLmdldFNlbGVjdGVkUHJvZHVjdCA9IGZ1bmN0aW9uKGlkcykge1xuICAgICAgcmV0dXJuIHByb21vdGlvblNlcnZpY2UucXVlcnlQcm9tb3Rpb25Qcm9kdWN0TGlzdCh7XG4gICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgbGltaXQ6IDEwMDAwLFxuICAgICAgICBpZHM6IGlkc1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCA9IHJlcy5jb250ZW50O1xuICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHZhciBhcnJheSA9IF8ud2hlcmUoJHNjb3BlLmVkaXREYXRhLm9yZGVySXRlbXMsIHsgcHJvZHVjdElkOiBpdGVtXG4gICAgICAgICAgICAgIC5pZCB9KTtcbiAgICAgICAgICBpdGVtLml0ZW1OdW0gPSBwYXJzZUludChhcnJheVswXS5pdGVtTnVtKTtcblxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gJHNjb3BlLnNlbGVjdGVkUHJvZHVjdDtcblxuICAgICAgfSlcblxuICAgIH07XG4gICAgdmFyIG9wZW5FZGl0TW9kYWwgPSBmdW5jdGlvbihvcmRlciwgc2NvcGUpIHtcbiAgICAgICRzY29wZS5lZGl0RGF0YSA9IG9yZGVyO1xuXG4gICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0ID0gW107XG4gICAgICBpZHMgPSBfLnBsdWNrKCRzY29wZS5lZGl0RGF0YS5vcmRlckl0ZW1zLCAncHJvZHVjdElkJyk7O1xuICAgICAgJHNjb3BlLmdldFByb21vdGlvblByb2R1Y3QoKVxuICAgICAgJHNjb3BlLmdldFNlbGVjdGVkUHJvZHVjdChpZHMpO1xuXG4gICAgICAkc2NvcGUucmVjb3JkTW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICdwcm9tb3Rpb24nKSksXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWwtcHJvbW90aW9uRWRpdCcsXG4gICAgICAgIHNpemU6ICdwbGcnXG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5wcm9tb3Rpb25TZWxlY3QgPSBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICBfLmVhY2goJHNjb3BlLnByb2R1Y3RzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGl0ZW0uaXNTZWxlY3QgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgXy5lYWNoKCRzY29wZS5zZWxlY3RlZFByb2R1Y3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgICBwcm9kdWN0LmlzU2VsZWN0ID0gdHJ1ZTtcbiAgICAgICRzY29wZS5zZWxlY3RJdGVtID0gcHJvZHVjdDtcbiAgICB9O1xuICAgICRzY29wZS5wcm9tb3Rpb25kZWxlY3QgPSBmdW5jdGlvbihwcm9kdWN0KSB7XG4gICAgICBfLmVhY2goJHNjb3BlLnByb2R1Y3RzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGl0ZW0uaXNTZWxlY3QgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgXy5lYWNoKCRzY29wZS5zZWxlY3RlZFByb2R1Y3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIHByb2R1Y3QuaXNTZWxlY3QgPSB0cnVlO1xuICAgICAgJHNjb3BlLmRlbGVjdEl0ZW0gPSBwcm9kdWN0O1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2hhbmdlVG90YWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5lZGl0RGF0YS5vcmRlci5wcmljZSA9IDA7XG4gICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpZiAoaXRlbS5pdGVtTnVtID09PSAwIHx8IGl0ZW0uaXRlbU51bSA8IDApIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSBfLmZpbmRJbmRleCgkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0LCB7IGlkOiBpdGVtXG4gICAgICAgICAgICAgIC5pZCB9KTtcbiAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGl0ZW0uaXRlbU51bSA+IDk5OSkge1xuICAgICAgICAgICAgaXRlbS5pdGVtTnVtID0gOTk5O1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuZWRpdERhdGEub3JkZXIucHJpY2UgKz0gaXRlbS5pdGVtTnVtICogaXRlbS5wcmljZTtcbiAgICAgICAgfVxuXG4gICAgICB9KVxuICAgIH07XG4gICAgJHNjb3BlLmNvbmZpcm1FZGl0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXBhcnNlRmxvYXQoJHNjb3BlLmVkaXREYXRhLm9yZGVyLmFjdHVhbFByaWNlKSkge1xuICAgICAgICBhbGVydChcIuivt+ato+ehrui+k+WFpeWunuaUtumHkemine+8gVwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCgkc2NvcGUuZWRpdERhdGEub3JkZXIuYWN0dWFsUHJpY2UgKiAxMDApID4gcGFyc2VJbnQoJHNjb3BlLmVkaXREYXRhXG4gICAgICAgICAgLm9yZGVyLnByaWNlKSkge1xuICAgICAgICBhbGVydChcIuWunuaUtumHkemineS4jeWPr+i2hei/h+iuouWNlemHkemine+8gVwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCEkc2NvcGUuZWRpdERhdGEub3JkZXIuZGVsaXZlcnlUaW1lKSB7XG4gICAgICAgIGFsZXJ0KFwi6K+35q2j56Gu6L6T5YWl6YCB6LSn5pe26Ze077yBXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBvcmRlciA9IGFuZ3VsYXIuY29weSgkc2NvcGUuZWRpdERhdGEub3JkZXIpO1xuICAgICAgb3JkZXIuZGVsaXZlcnlUaW1lID0gb3JkZXIuZGVsaXZlcnlUaW1lLmdldFRpbWUoKTtcbiAgICAgIG9yZGVyLmFjdHVhbFByaWNlID0gcGFyc2VJbnQocGFyc2VGbG9hdChvcmRlci5hY3R1YWxQcmljZSwgMikgKlxuICAgICAgICAxMDApO1xuICAgICAgcHJvbW90aW9uU2VydmljZS5jb25maXJtT3JkZXIoe1xuICAgICAgICBvcmRlcklkOiAkc2NvcGUuZWRpdERhdGEub3JkZXIuaWQsXG4gICAgICAgIG9yZGVyOiBvcmRlcixcbiAgICAgICAgb3JkZXJJdGVtczogJHNjb3BlLnNlbGVjdGVkUHJvZHVjdFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnJlY29yZE1vZGFsLmNsb3NlKCk7XG4gICAgICAgICRzY29wZS5yZWZyZXNoTW9kZWwoJHNjb3BlLmVkaXREYXRhLm9yZGVyLmlkKTtcbiAgICAgICAgc2V0T3JkZXJUYWJsZSgpO1xuICAgICAgfSk7XG5cbiAgICB9O1xuICAgICRzY29wZS5jb3B5ID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgdmFyIGFycmF5ID0ge307XG4gICAgICBhbmd1bGFyLmZvckVhY2goaXRlbSwgZnVuY3Rpb24odiwga2V5KSB7XG4gICAgICAgIGlmICh2ICE9PSBudWxsKSB7XG4gICAgICAgICAgYXJyYXlba2V5XSA9IGFuZ3VsYXIuY29weSh2KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYXJyYXlcbiAgICB9O1xuICAgICRzY29wZS5pdGVtQWRkID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoJHNjb3BlLnNlbGVjdEl0ZW0pIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBfLndoZXJlKCRzY29wZS5zZWxlY3RlZFByb2R1Y3QsIHsgaWQ6ICRzY29wZS5zZWxlY3RJdGVtXG4gICAgICAgICAgICAuaWQgfSk7XG4gICAgICAgIGlmIChpdGVtLmxlbmd0aCkge1xuICAgICAgICAgIGl0ZW1bMF0uaXRlbU51bSArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgJHNjb3BlLnNlbGVjdEl0ZW0uaXRlbU51bSA9IDFcbiAgICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbS5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3QucHVzaChhbmd1bGFyLmNvcHkoJHNjb3BlLnNlbGVjdEl0ZW0pKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXRlbSA9IF8ud2hlcmUoJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCwgeyBpZDogJHNjb3BlLnNlbGVjdEl0ZW1cbiAgICAgICAgICAgIC5pZCB9KTtcbiAgICAgICAgaWYgKGl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgICAgaXRlbVswXS5pdGVtTnVtICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbS5pdGVtTnVtID0gMVxuICAgICAgICAgICRzY29wZS5zZWxlY3RJdGVtLmlzU2VsZWN0ID0gZmFsc2U7XG4gICAgICAgICAgJHNjb3BlLnNlbGVjdGVkUHJvZHVjdC5wdXNoKGFuZ3VsYXIuY29weSgkc2NvcGUuc2VsZWN0SXRlbSkpO1xuICAgICAgICB9XG4gICAgICB9XG5cblxuICAgIH07XG4gICAgJHNjb3BlLmRibEFkZCA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgIHZhciBpdGVtID0gXy53aGVyZSgkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0LCB7IGlkOiBwcm9kdWN0LmlkIH0pO1xuICAgICAgaWYgKGl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgIGl0ZW1bMF0uaXRlbU51bSArPSAxO1xuICAgICAgfSBlbHNlIHtcblxuICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbS5pdGVtTnVtID0gMVxuICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbS5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0LnB1c2goYW5ndWxhci5jb3B5KCRzY29wZS5zZWxlY3RJdGVtKSk7XG4gICAgICB9XG5cbiAgICB9O1xuICAgICRzY29wZS5pdGVtRGVsZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoJHNjb3BlLmRlbGVjdEl0ZW0pIHtcbiAgICAgICAgdmFyIGluZGV4ID0gXy5maW5kSW5kZXgoJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCwge1xuICAgICAgICAgIGlkOiAkc2NvcGUuZGVsZWN0SXRlbVxuICAgICAgICAgICAgLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRQcm9kdWN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgfTtcbiAgICAkc2NvcGUuZGJsRGVsZWN0ID0gZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgdmFyIGluZGV4ID0gXy5maW5kSW5kZXgoJHNjb3BlLnNlbGVjdGVkUHJvZHVjdCwgeyBpZDogcHJvZHVjdC5pZCB9KTtcbiAgICAgICRzY29wZS5zZWxlY3RlZFByb2R1Y3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9O1xuICB9KTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ3Byb21vdGlvblByb2R1Y3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2csXG4gICAgcHJvbW90aW9uU2VydmljZSwgdXRpbFNlcnZpY2UsIG1vZGFsU2VydmljZSwgTmdUYWJsZVBhcmFtcywgQ09OU1RBTlRTXG4gICkge1xuICAgICRzY29wZS5QUk9NT1RJT05fUEFZX1RZUEUgPSBDT05TVEFOVFMuUFJPTU9USU9OX1BBWV9UWVBFO1xuICAgICRzY29wZS51dGlsU2VydmljZSA9IHV0aWxTZXJ2aWNlO1xuICAgICRzY29wZS5waWNVcmwgPSB3aW5kb3cuY2ZnLnBpY1VybDtcbiAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICBzdGF0dXM6IDFcbiAgICB9O1xuICAgICRzY29wZS5xdWVyeURlc2MgPSBcIlwiO1xuICAgICRzY29wZS5pbWdTaXplTGltaXQgPSB7XG4gICAgICBzaXplOiA1MDAgKiAxMDI0LFxuICAgICAgd2lkdGg6IDEwODAsXG4gICAgICBoZWlnaHQ6IDEwODBcbiAgICB9XG4gICAgJHNjb3BlLnByb2R1Y3QgPSB7XG4gICAgICBpbWdEZXRhaWxzOiBbXSxcbiAgICAgIGRlc0ltZ0RldGFpbHM6IFtdXG4gICAgfTtcbiAgICAkc2NvcGUucGF5VHlwZVNlbGVjdERpc2FibGVkID0gZmFsc2U7IC8v5qCH6K6w5pSv5LuY5pa55byP5piv5ZCm5Y+v6YCJXG4gICAgLyoqXG4gICAgICog5YiX6KGoXG4gICAgICovXG4gICAgLy/ooajmoLzorr7nva5cbiAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAkc2NvcGUubGltaXQgPSAyMDtcbiAgICB2YXIgbG9hZFRhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgIH0sIHtcbiAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMjAsXG4gICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgIHZhciBzZWFyY2hQYXJhbXMgPSBnZXRRdWVyeVBhcmFtcygpO1xuICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpO1xuICAgICAgICAgIHNlYXJjaFBhcmFtcy5vZmZzZXQgPSAkc2NvcGUub2Zmc2V0O1xuICAgICAgICAgIHNlYXJjaFBhcmFtcy5saW1pdCA9ICRzY29wZS5saW1pdDtcbiAgICAgICAgICByZXR1cm4gcHJvbW90aW9uU2VydmljZS5xdWVyeVByb21vdGlvblByb2R1Y3RMaXN0KFxuICAgICAgICAgICAgc2VhcmNoUGFyYW1zKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgIHJldHVybiB1dGlsU2VydmljZS5pbmRleEFycmF5KHByb21vdGlvblNlcnZpY2UuX3BhcnNlUHJvbW90aW9uUHJvZHVjdExpc3QoXG4gICAgICAgICAgICAgICAgcmVzLmNvbnRlbnQpLFxuICAgICAgICAgICAgICBzZWFyY2hQYXJhbXMub2Zmc2V0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBsb2FkVGFibGUoKTtcbiAgICAvL+S/ruaUueafpeivouaetuS4iuWVhuWTgei/mOaYr+W3suS4i+aetuWVhuWTgVxuICAgICRzY29wZS5jaGFuZ2VBY3RpdmVRdWVyeVBhcmFtcyA9IGZ1bmN0aW9uKGFjdGl2ZSkge1xuICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhdHVzID0gYWN0aXZlO1xuICAgICAgJHNjb3BlLnF1ZXJ5UHJvZHVjdENvbmZpZy5zZWxlY3RJdGVtKCRzY29wZS5xdWVyeVByb2R1Y3RDb25maWcubmFtZVR5cGVEYXRhW1xuICAgICAgICAwXSk7XG4gICAgICBsb2FkVGFibGUoKTtcbiAgICB9O1xuICAgIC8v6YCJ5oup5pCc57Si5p2h5Lu2XG4gICAgJHNjb3BlLnF1ZXJ5UHJvZHVjdENvbmZpZyA9IHtcbiAgICAgIG5hbWVUeXBlRGF0YTogW3tcbiAgICAgICAgbWFya0lkOiAndGl0bGUnLFxuICAgICAgICBkZXNjOiAn5ZWG5ZOB5ZCN56ewJ1xuICAgICAgfSwge1xuICAgICAgICBtYXJrSWQ6ICdza3UnLFxuICAgICAgICBkZXNjOiAn5ZWG5ZOB57yW56CBJ1xuICAgICAgfV0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciBuYW1lVHlwZURhdGEgPSAkc2NvcGUucXVlcnlQcm9kdWN0Q29uZmlnLm5hbWVUeXBlRGF0YTtcbiAgICAgICAgXy5lYWNoKG5hbWVUeXBlRGF0YSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgIGlmICh0Lm1hcmtJZCAhPSBpdGVtLm1hcmtJZCkge1xuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5xdWVyeVBhcmFtc1t0Lm1hcmtJZF07IC8v5Y676Zmk6Z2e6YCJ5Lit55qE5p+l6K+i5a2X5q61XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zW1wibWFya0lkXCJdID0gaXRlbS5tYXJrSWQ7XG4gICAgICAgICRzY29wZS5xdWVyeURlc2MgPSBpdGVtLmRlc2M7XG4gICAgICAgICRzY29wZS5xdWVyeUNvbmZpZ0RlZmF1bHRJdGVtID0gaXRlbTtcbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZS5xdWVyeUNvbmZpZ0RlZmF1bHRJdGVtID0gJHNjb3BlLnF1ZXJ5UHJvZHVjdENvbmZpZy5uYW1lVHlwZURhdGFbXG4gICAgICAwXTtcbiAgICAvL+Wbnui9pumUruafpeivolxuICAgICRzY29wZS5wcm9kdWN0S2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICBpZiAoa2V5Y29kZSA9PSAxMykge1xuICAgICAgICAkc2NvcGUucHJvZHVjdFNlYXJjaCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/llYblk4HmkJzntKJcbiAgICAkc2NvcGUucHJvZHVjdFNlYXJjaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgbG9hZFRhYmxlKCk7XG4gICAgfTtcbiAgICAvL+aMieWVhuWTgee8lueggeaOkuW6j1xuICAgICRzY29wZS5zb3J0QnlTa3UgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZmllbGQgPSAnc2t1JztcbiAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5hc2MgPSBpdGVtLnNvcnRDb2RlO1xuICAgICAgbG9hZFRhYmxlKCk7XG4gICAgfTtcbiAgICB2YXIgZ2V0UXVlcnlQYXJhbXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB0ZW1wID0gJHNjb3BlLnF1ZXJ5UGFyYW1zO1xuICAgICAgdGVtcFt0ZW1wLm1hcmtJZF0gPSB0ZW1wLnF1ZXJ5TmFtZTtcbiAgICAgIHJldHVybiBfLm9taXQodGVtcCwgJ21hcmtJZCcsICdxdWVyeU5hbWUnKTtcbiAgICB9O1xuICAgIC8vIOiOt+WPlkg16ZO+5o6lXG4gICAgJHNjb3BlLmdldExpbmsgPSBmdW5jdGlvbihpZCkge1xuICAgICAgcHJvbW90aW9uU2VydmljZS5nZXRQcm9tb3Rpb25Qcm9kdWN0TGluayh7XG4gICAgICAgIGlkOiBpZFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLndlY2hhdExpbmsgPSByZXM7XG4gICAgICAgIC8v5ZCO57ut55So5q2j5YiZ5Yy56YWNXG4gICAgICAgICRzY29wZS5pbnRlcm5hbExpbmsgPSAnIycgKyByZXMuc3BsaXQoJz9yb3V0ZT0nKVsxXTtcbiAgICAgICAgb3Blbk1hZGFsKCdsaW5rU2hvdycsICdsZycpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvLyDorr7nva7llYblk4HkuIrkuIvmnrZcbiAgICAkc2NvcGUubW9kaWZ5UHJvZHVjdEFjdGl2ZSA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgIGlmIChwcm9kdWN0LmFjdGl2ZSkgeyAvL+mcgOiuvue9ruS4uuS4i+aetlxuICAgICAgICBwcm9tb3Rpb25TZXJ2aWNlLm9mZmxpbmVQcm9tb3Rpb25Qcm9kdWN0KHtcbiAgICAgICAgICBpZDogcHJvZHVjdC5pZFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIHByb2R1Y3QuYWN0aXZlID0gIXByb2R1Y3QuYWN0aXZlO1xuICAgICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0U3VjY2Vzcygn5LiL5p625oiQ5YqfJyk7XG4gICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7IC8v6ZyA6K6+572u5Li65LiK5p62XG4gICAgICAgIHByb21vdGlvblNlcnZpY2Uub25saW5lUHJvbW90aW9uUHJvZHVjdCh7XG4gICAgICAgICAgaWQ6IHByb2R1Y3QuaWRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBwcm9kdWN0LmFjdGl2ZSA9ICFwcm9kdWN0LmFjdGl2ZTtcbiAgICAgICAgICB1dGlsU2VydmljZS5hbGVydFN1Y2Nlc3MoJ+S4iuaetuaIkOWKnycpO1xuICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvKlxuICAgICAq5ZWG5ZOB55qE5paw5aKe77yM5L+u5pS5XG4gICAgICovXG4gICAgLy/miZPlvIDnvJbovpHmoYZcbiAgICAkc2NvcGUucHJvZHVjdEVkaXRXaW4gPSBmdW5jdGlvbihpZCkge1xuICAgICAgb3Blbk1hZGFsKCdwcm9kdWN0RWRpdCcsICdsZycpO1xuICAgICAgJHNjb3BlLnByb2R1Y3QgPSB7XG4gICAgICAgIGltZ0RldGFpbHM6IFtdLFxuICAgICAgICBkZXNJbWdEZXRhaWxzOiBbXVxuICAgICAgfTtcbiAgICAgIGlmICh0eXBlb2YgaWQgIT0gJ3VuZGVmaW5lZCcpIHsgLy/kv67mlLnmqKHlvI9cbiAgICAgICAgJHNjb3BlLnBheVR5cGVTZWxlY3REaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIHByb21vdGlvblNlcnZpY2UucXVlcnlQcm9tb3Rpb25Qcm9kdWN0RGV0YWlsKHtcbiAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBwcm9tb3Rpb25TZXJ2aWNlLmdldFByb21vdGlvblByb2R1Y3RMaW5rKHtcbiAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obGluaykge1xuICAgICAgICAgICAgdmFyIHByb2R1Y3QgPSBwcm9tb3Rpb25TZXJ2aWNlLl9wYXJzZVByb21vdGlvblByb2R1Y3REZXRhaWwoXG4gICAgICAgICAgICAgIHJlcyk7XG4gICAgICAgICAgICBwcm9kdWN0LmxpbmsgPSBsaW5rO1xuICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QgPSBwcm9kdWN0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5wYXlUeXBlU2VsZWN0RGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5pSv5LuY57G75Z6L6K6+572uXG4gICAgJHNjb3BlLnBheVR5cGVDb25maWcgPSB7XG4gICAgICBnZXREZWZhdWx0SXRlbTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmdldExpc3QoKTtcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKG9wdGlvbnMsIHtcbiAgICAgICAgICBwYXlUeXBlOiB2YWx1ZVxuICAgICAgICB9KSB8fCBvcHRpb25zWzBdO1xuICAgICAgfSxcbiAgICAgIGdldExpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgICAgIGNsc09yTmFtZTogJ1BST01PVElPTl9QQVlfVFlQRScsXG4gICAgICAgICAgaGFzRGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgY29kZUtleTogJ3BheVR5cGUnLFxuICAgICAgICAgIHZhbHVlS2V5OiAnbmFtZSdcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVjb3JkLnBheVR5cGUgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAkc2NvcGUucHJvZHVjdC5wYXlUeXBlID0gcmVjb3JkLnBheVR5cGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRJbWdzID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgdmFyIGltZ3MgPSB0eXBlID09IDEgPyAkc2NvcGUucHJvZHVjdC5pbWdEZXRhaWxzIDogJHNjb3BlLnByb2R1Y3RcbiAgICAgICAgLmRlc0ltZ0RldGFpbHM7XG4gICAgICByZXR1cm4gaW1ncztcbiAgICB9O1xuICAgIC8v5LiK5Lyg5a6M5Zu+54mHXG4gICAgJHNjb3BlLmRpZFVwbG9hZEltZyA9IGZ1bmN0aW9uKGZpbGUsIHR5cGUpIHtcbiAgICAgIHZhciBpbWdzID0gZ2V0SW1ncyh0eXBlKTtcbiAgICAgIGZpbGUuaW5kZXggPSBpbWdzLmxlbmd0aCA/IF8ubWF4KGltZ3MsIGZ1bmN0aW9uKGltZykge1xuICAgICAgICByZXR1cm4gaW1nLmluZGV4O1xuICAgICAgfSkuaW5kZXggKyAxIDogMTtcbiAgICAgIGltZ3MucHVzaChmaWxlKTtcbiAgICB9O1xuICAgIC8v6L2u5pKt5Zu+5o6S5bqPXG4gICAgJHNjb3BlLnNvcnRJbWdzID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgdmFyIGltZ3MgPSBnZXRJbWdzKHR5cGUpO1xuICAgICAgaW1ncyA9IF8uc29ydEJ5KGltZ3MsIGZ1bmN0aW9uKGltZykge1xuICAgICAgICByZXR1cm4gaW1nLmluZGV4O1xuICAgICAgfSk7XG4gICAgICBpZiAodHlwZSA9PSAxKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0LmltZ0RldGFpbHMgPSBpbWdzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3QuZGVzSW1nRGV0YWlscyA9IGltZ3M7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+mihOiniOWbvueJh1xuICAgICRzY29wZS5pbWdQcmV2aWV3ID0gZnVuY3Rpb24oaW1nKSB7XG4gICAgICAkc2NvcGUucHJldmlld0ltZyA9IGltZztcbiAgICAgIG9wZW5NYWRhbCgnaW1nUHJldmlld2VyJywgJ2xnJyk7XG4gICAgfTtcbiAgICAvL+WIoOmZpOWbvueJh1xuICAgICRzY29wZS5kZWxldGVJbWcgPSBmdW5jdGlvbihpLCB0eXBlKSB7XG4gICAgICB2YXIgaW1ncyA9IGdldEltZ3ModHlwZSk7XG4gICAgICBpbWdzLnNwbGljZShpLCAxKTtcbiAgICB9O1xuICAgIC8v5L+d5a2Y5ZWG5ZOBXG4gICAgJHNjb3BlLnByb2R1Y3RTYXZlID0gZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgaWYgKCFjaGVja1NhdmVQcm9kdWN0VmFsaWQocHJvZHVjdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgIHZhciBzYXZlUGFyYW1zID0gYW5ndWxhci5jb3B5KHByb2R1Y3QpO1xuICAgICAgc2F2ZVBhcmFtcy5pbWFnZXMgPSBfLnBsdWNrKHByb2R1Y3QuaW1nRGV0YWlscywgJ3BhdGgnKTtcbiAgICAgIHNhdmVQYXJhbXMuZGVzSW1hZ2VzID0gXy5wbHVjayhwcm9kdWN0LmRlc0ltZ0RldGFpbHMsICdwYXRoJyk7XG4gICAgICBzYXZlUGFyYW1zLmNvdmVyID0gc2F2ZVBhcmFtcy5pbWFnZXNbMF07XG4gICAgICBzYXZlUGFyYW1zLnByaWNlID0gdXRpbFNlcnZpY2UuZ2V0UG9pbnRJbnQoc2F2ZVBhcmFtcy5wcmljZSk7XG4gICAgICBpZiAoc2F2ZVBhcmFtcy5vcmlnaW5hbFByaWNlKSB7XG4gICAgICAgIHNhdmVQYXJhbXMub3JpZ2luYWxQcmljZSA9IHV0aWxTZXJ2aWNlLmdldFBvaW50SW50KHNhdmVQYXJhbXMub3JpZ2luYWxQcmljZSk7XG4gICAgICB9XG4gICAgICBkZWxldGUgc2F2ZVBhcmFtcy5hY3RpdmU7XG4gICAgICBpZiAodHlwZW9mIHByb2R1Y3QuaWQgPT0gJ3VuZGVmaW5lZCcpIHsgLy/mlrDlop7mqKHlvI9cbiAgICAgICAgcHJvbW90aW9uU2VydmljZS5jcmVhdGVQcm9tb3Rpb25Qcm9kdWN0KHNhdmVQYXJhbXMpLnRoZW4oXG4gICAgICAgICAgZnVuY3Rpb24oXG4gICAgICAgICAgICByZXMpIHtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHsgLy/nvJbovpHmqKHlvI9cbiAgICAgICAgcHJvbW90aW9uU2VydmljZS5tb2RpZnlQcm9tb3Rpb25Qcm9kdWN0KHNhdmVQYXJhbXMpLnRoZW4oXG4gICAgICAgICAgZnVuY3Rpb24oXG4gICAgICAgICAgICByZXMpIHtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/pqozor4Hkv53lrZjllYblk4HmnInmlYjmgKdcbiAgICB2YXIgY2hlY2tTYXZlUHJvZHVjdFZhbGlkID0gZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgdmFyIG1heFRpdGxlTGVuZ3RoID0gMTQsXG4gICAgICAgIG1heEltZ0NvdW50ID0gNSxcbiAgICAgICAgbWF4U3ViVGl0bGVMZW5ndGggPSAzNTtcbiAgICAgIHZhciBlcnJvck1zZyA9ICcnO1xuICAgICAgaWYgKCFwcm9kdWN0LnBheVR5cGUpIHsgLy/mnKrpgInmi6nmlK/ku5jnsbvlnotcbiAgICAgICAgZXJyb3JNc2cgPSAn6K+36YCJ5oup5pSv5LuY57G75Z6LJztcbiAgICAgIH0gZWxzZSBpZiAoIXByb2R1Y3QuaW1nRGV0YWlscy5sZW5ndGgpIHsgLy/mnKrkuIrkvKDllYblk4Hova7mkq3lm75cbiAgICAgICAgZXJyb3JNc2cgPSAn6K+35LiK5Lyg5ZWG5ZOB6L2u5pKt5Zu+JztcbiAgICAgIH0gZWxzZSBpZiAocHJvZHVjdC50aXRsZS5sZW5ndGggPiBtYXhUaXRsZUxlbmd0aCkge1xuICAgICAgICBlcnJvck1zZyA9ICfmoIfpopjkuI3lvpflpKfkuo4nICsgbWF4VGl0bGVMZW5ndGggKyAn5Liq5a2XJztcbiAgICAgIH0gZWxzZSBpZiAocHJvZHVjdC5pbWdEZXRhaWxzLmxlbmd0aCA+IG1heEltZ0NvdW50KSB7XG4gICAgICAgIGVycm9yTXNnID0gJ+WVhuWTgei9ruaSreWbvuS4jeW+l+Wkp+S6jicgKyBtYXhJbWdDb3VudCArICflvKAnO1xuICAgICAgfSBlbHNlIGlmIChwcm9kdWN0LnN1YnRpdGxlKSB7XG4gICAgICAgIGlmIChwcm9kdWN0LnN1YnRpdGxlLmxlbmd0aCA+IG1heFN1YlRpdGxlTGVuZ3RoKSB7XG4gICAgICAgICAgZXJyb3JNc2cgPSAn5Ymv5qCH6aKY5LiN5b6X5aSn5LqOJyArIG1heFN1YlRpdGxlTGVuZ3RoICsgJ+S4quWtlyc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChlcnJvck1zZy5sZW5ndGgpIHtcbiAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcihlcnJvck1zZyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgLy/miZPlvIBNb2RhbFxuICAgIHZhciBvcGVuTWFkYWwgPSBmdW5jdGlvbih0ZW1wbGF0ZVVybCwgc2l6ZSkge1xuICAgICAgbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAncHJvbW90aW9uLXByb2R1Y3QnKSksXG4gICAgICAgIHRlbXBsYXRlVXJsOiB0ZW1wbGF0ZVVybCxcbiAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgc2l6ZTogc2l6ZVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdwcm9tb3Rpb25TdWl0ZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRtZERpYWxvZyxcbiAgICBOZ1RhYmxlUGFyYW1zLCBDT05TVEFOVFMsIG1vZGFsU2VydmljZSwgcHJvbW90aW9uU2VydmljZSwgdXRpbFNlcnZpY2VcbiAgKSB7XG4gICAgdmFyIFBST01PVElPTl9QQVlfVFlQRSA9IENPTlNUQU5UUy5QUk9NT1RJT05fUEFZX1RZUEU7XG4gICAgJHNjb3BlLlBST01PVElPTl9QQVlfVFlQRSA9IFBST01PVElPTl9QQVlfVFlQRTtcbiAgICAkc2NvcGUucGljVXJsID0gd2luZG93LmNmZy5waWNVcmw7XG4gICAgJHNjb3BlLmltZ1NpemVMaW1pdCA9IHtcbiAgICAgIHNpemU6IDE2ICogMTAyNCxcbiAgICAgIHdpZHRoOiAyNTYsXG4gICAgICBoZWlnaHQ6IDI1NlxuICAgIH07XG4gICAgJHNjb3BlLnByb2R1Y3RzID0gW107XG4gICAgJHNjb3BlLnN1aXRlID0ge1xuICAgICAgc2VsZWN0ZWRQcm9kdWN0czogW11cbiAgICB9O1xuICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHt9OyAvL+afpeivouWPguaVsFxuICAgIC8qKlxuICAgICAqIOWIl+ihqFxuICAgICAqL1xuICAgIC8v6KGo5qC86K6+572uXG4gICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgdmFyIHF1ZXJ5UGFyYW1zID0ge1xuICAgICAgb2Zmc2V0OiAkc2NvcGUub2Zmc2V0LFxuICAgICAgbGltaXQ6ICRzY29wZS5saW1pdCxcbiAgICB9XG4gICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgY291bnQ6ICRzY29wZS5saW1pdFxuICAgIH0sIHtcbiAgICAgIGNvdW50czogW10sXG4gICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAyMCxcbiAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICBnZXREYXRhOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgJHNjb3BlLm9mZnNldCA9ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSk7XG4gICAgICAgIHJldHVybiBwcm9tb3Rpb25TZXJ2aWNlLnF1ZXJ5UHJvbW90aW9uU3VpdGVMaXN0KHF1ZXJ5UGFyYW1zKVxuICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHF1ZXJ5UGFyYW1zKVxuICAgICAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgICAgICB2YXIgc3VpdGVMaXN0ID0gcHJvbW90aW9uU2VydmljZS5fcGFyc2VQcm9tb3Rpb25TdWl0ZUxpc3QoXG4gICAgICAgICAgICAgICAgcmVzLmNvbnRlbnQpO1xuICAgICAgICAgICAgICBzdWl0ZUxpc3QgPSB1dGlsU2VydmljZS5pbmRleEFycmF5KHN1aXRlTGlzdCxcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5vZmZzZXQpO1xuICAgICAgICAgICAgICByZXR1cm4gc3VpdGVMaXN0O1xuICAgICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy/mkJzntKLmn6Xor6JcbiAgICAkc2NvcGUuc3VpdGVTZWFyY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIHF1ZXJ5UGFyYW1zLm5hbWUgPSAkc2NvcGUucXVlcnlQYXJhbXMuZGVzO1xuICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgZGF0YXNldDogW11cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mjInlm57ovaYg5pCc57Si5p+l6K+iXG4gICAgJHNjb3BlLnN1aXRlU2VhcmNoS2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICBpZiAoa2V5Y29kZSA9PSAxMykge1xuICAgICAgICAkc2NvcGUucHJvZHVjdFNlYXJjaCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/mlK/ku5jmlrnlvI8g562b6YCJXG4gICAgJHNjb3BlLnBheVR5cGVGaWx0ZXIgPSB7XG4gICAgICBnZXRMaXN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENPTlNUQU5UUy5nZXRMaXN0KHtcbiAgICAgICAgICBjbHNPck5hbWU6ICdQUk9NT1RJT05fUEFZX1RZUEUnLFxuICAgICAgICAgIGNvZGVLZXk6ICdwYXlUeXBlJyxcbiAgICAgICAgICB2YWx1ZUtleTogJ25hbWUnLFxuICAgICAgICAgIGRlZmF1bHRPYmo6IHtcbiAgICAgICAgICAgICcnOiAn5YWo6YOo5pSv5LuY5pa55byPJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBjb25zb2xlLmxvZyhpdGVtKVxuICAgICAgICBpZiAoaXRlbS5wYXlUeXBlKSB7XG4gICAgICAgICAgcXVlcnlQYXJhbXMucGF5VHlwZSA9IGl0ZW0ucGF5VHlwZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZWxldGUgcXVlcnlQYXJhbXMucGF5VHlwZVxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5Yig6Zmk57uE5ZCIXG4gICAgJHNjb3BlLmRlbGV0ZVN1aXRlID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgIGlmIChjb25maXJtKCfmmK/lkKbnoa7orqTliKDpmaTor6Xnu4TlkIg/JykpIHtcbiAgICAgICAgcHJvbW90aW9uU2VydmljZS5kZWxldGVQcm9tb3Rpb25TdWl0ZSh7XG4gICAgICAgICAgaWQ6IGlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v6I635Y+WSFRNTDXpk77mjqVcbiAgICAkc2NvcGUuZ2V0TGluayA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICBwcm9tb3Rpb25TZXJ2aWNlLmdldFByb21vdGlvblN1aXRlTGluayh7XG4gICAgICAgIGlkOiBpZFxuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLndlY2hhdExpbmsgPSByZXM7XG4gICAgICAgIC8v5ZCO57ut55So5q2j5YiZ5Yy56YWNXG4gICAgICAgICRzY29wZS5pbnRlcm5hbExpbmsgPSAnIycgKyByZXMuc3BsaXQoJz9yb3V0ZT0nKVsxXTtcbiAgICAgICAgb3Blbk1hZGFsKCdsaW5rU2hvdycsICdsZycpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiDmlrDlu7rokKXplIDnu4TlkIhcbiAgICAgKi9cbiAgICAvL+aJk+W8gCDokKXplIDnu4TlkIjmlrDlop5cbiAgICAkc2NvcGUuc3VpdGVFZGl0V2luID0gZnVuY3Rpb24oc3VpdGVJZCkge1xuICAgICAgb3Blbk1hZGFsKCdzdWl0ZUVkaXQnLCAnbGcnKTtcbiAgICAgIHByb21vdGlvblNlcnZpY2UucXVlcnlQcm9tb3Rpb25Qcm9kdWN0TGlzdCh7XG4gICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgbGltaXQ6IDEwMDAwLFxuICAgICAgICBzdGF0dXM6IDFcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocHJvZHVjdHNSZXMpIHtcbiAgICAgICAgaWYgKHN1aXRlSWQpIHsgLy/nvJbovpHmqKHlvI9cbiAgICAgICAgICBwcm9tb3Rpb25TZXJ2aWNlLnF1ZXJ5UHJvbW90aW9uU3VpdGVEZXRhaWwoe1xuICAgICAgICAgICAgaWQ6IHN1aXRlSWRcbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlID0gcmVzLnN1aXRlO1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlLnNlbGVjdGVkUHJvZHVjdHMgPSByZXMucHJvZHVjdHM7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRQcm9kdWN0SWRzID0gXy5wbHVjaygkc2NvcGUuc3VpdGUuc2VsZWN0ZWRQcm9kdWN0cyxcbiAgICAgICAgICAgICAgJ2lkJyk7XG4gICAgICAgICAgICAvL+iiq+mAieWVhuWTgVxuICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gXy5yZWplY3QocHJvZHVjdHNSZXMuY29udGVudCxcbiAgICAgICAgICAgICAgZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmNvbnRhaW5zKHNlbGVjdGVkUHJvZHVjdElkcywgcHJvZHVjdFxuICAgICAgICAgICAgICAgICAgLmlkKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7IC8v5paw5aKe5qih5byPXG4gICAgICAgICAgJHNjb3BlLnByb2R1Y3RzID0gcHJvZHVjdHNSZXMuY29udGVudDtcbiAgICAgICAgICAkc2NvcGUuc3VpdGUgPSB7XG4gICAgICAgICAgICBzZWxlY3RlZFByb2R1Y3RzOiBbXVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mlK/ku5jmlrnlvI/liY3nvIBcbiAgICAkc2NvcGUuZ2V0UGF5VHlwZVByZWZpeCA9IGZ1bmN0aW9uKHByb2R1Y3QpIHtcbiAgICAgIHZhciBwcmVUeHQgPSBwcm9kdWN0LnBheVR5cGUgPyAnKCcgKyBQUk9NT1RJT05fUEFZX1RZUEUuREVTQ1tcbiAgICAgICAgcHJvZHVjdC5wYXlUeXBlXS5zdWJzdHIoMCwgMSkgKyAnKScgOiAnJztcbiAgICAgIHJldHVybiBwcmVUeHQ7XG4gICAgfTtcbiAgICAvL+mAieS4reWVhuWTgVxuICAgICRzY29wZS5zZWxlY3RQcm9kdWN0ID0gZnVuY3Rpb24ocHJvZHVjdCwgdHlwZSkge1xuICAgICAgXy5lYWNoKCRzY29wZS5wcm9kdWN0cywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpdGVtLmlzU2VsZWN0ID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIF8uZWFjaCgkc2NvcGUuc3VpdGUuc2VsZWN0ZWRQcm9kdWN0cywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpdGVtLmlzU2VsZWN0ID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIHByb2R1Y3QuaXNTZWxlY3QgPSB0cnVlO1xuICAgIH07XG4gICAgLy/mt7vliqDmiJbnp7vpmaTllYblk4FcbiAgICAkc2NvcGUubW9kaWZ5U2VsZWN0ZWRQcm9kdWN0ID0gZnVuY3Rpb24obW9kZSkge1xuICAgICAgdmFyIG9wZXJhdGVQcm9kdWN0cyA9IFtdO1xuICAgICAgaWYgKG1vZGUgPT0gJ2FkZCcpIHtcbiAgICAgICAgb3BlcmF0ZVByb2R1Y3RzID0gJHNjb3BlLnByb2R1Y3RzO1xuICAgICAgfSBlbHNlIGlmIChtb2RlID09ICdyZW1vdmUnKSB7XG4gICAgICAgIG9wZXJhdGVQcm9kdWN0cyA9ICRzY29wZS5zdWl0ZS5zZWxlY3RlZFByb2R1Y3RzO1xuICAgICAgfVxuICAgICAgdmFyIG9wZXJhdGVQcm9kdWN0ID0gXy5maW5kKG9wZXJhdGVQcm9kdWN0cywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5pc1NlbGVjdCA9PSB0cnVlO1xuICAgICAgfSk7XG4gICAgICBpZiAoIW9wZXJhdGVQcm9kdWN0KSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+ivt+WFiOmAieaLqeWVhuWTgSEnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgb3BlcmF0ZVByb2R1Y3QuaXNTZWxlY3QgPSBmYWxzZTtcbiAgICAgIGlmIChtb2RlID09ICdhZGQnKSB7XG4gICAgICAgICRzY29wZS5wcm9kdWN0cyA9IF8ud2l0aG91dChvcGVyYXRlUHJvZHVjdHMsIG9wZXJhdGVQcm9kdWN0KTtcbiAgICAgICAgJHNjb3BlLnN1aXRlLnNlbGVjdGVkUHJvZHVjdHMucHVzaChvcGVyYXRlUHJvZHVjdCk7XG4gICAgICB9IGVsc2UgaWYgKG1vZGUgPT0gJ3JlbW92ZScpIHtcbiAgICAgICAgJHNjb3BlLnN1aXRlLnNlbGVjdGVkUHJvZHVjdHMgPSBfLndpdGhvdXQob3BlcmF0ZVByb2R1Y3RzLFxuICAgICAgICAgIG9wZXJhdGVQcm9kdWN0KTtcbiAgICAgICAgJHNjb3BlLnByb2R1Y3RzLnNwbGljZSgwLCAwLCBvcGVyYXRlUHJvZHVjdCk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvL+S/neWtmOe7hOWQiFxuICAgICRzY29wZS5zdWl0ZVNhdmUgPSBmdW5jdGlvbihzdWl0ZSkge1xuICAgICAgaWYgKCFjaGVja1NhdmVTdWl0ZVZhbGlkKHN1aXRlKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgc3VpdGUucHJvZHVjdElkcyA9IF8ucGx1Y2soc3VpdGUuc2VsZWN0ZWRQcm9kdWN0cywgJ2lkJyk7XG4gICAgICBzdWl0ZS5wcm9kdWN0TmFtZXMgPSBfLnBsdWNrKHN1aXRlLnNlbGVjdGVkUHJvZHVjdHMsXG4gICAgICAgICd0aXRsZScpO1xuICAgICAgZGVsZXRlIHN1aXRlLnNlbGVjdGVkUHJvZHVjdHM7XG4gICAgICBpZiAoc3VpdGUuaWQpIHsgLy/nvJbovpHmqKHlvI9cbiAgICAgICAgcHJvbW90aW9uU2VydmljZS5tb2RpZnlQcm9tb3Rpb25TdWl0ZShzdWl0ZSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHsgLy/mlrDlop7mqKHlvI9cbiAgICAgICAgcHJvbW90aW9uU2VydmljZS5jcmVhdGVQcm9tb3Rpb25TdWl0ZShzdWl0ZSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLy/pqozor4Hkv53lrZjlpZfppJDmnInmlYjmgKdcbiAgICB2YXIgY2hlY2tTYXZlU3VpdGVWYWxpZCA9IGZ1bmN0aW9uKHN1aXRlKSB7XG4gICAgICBpZiAoIXN1aXRlLmJhbm5lcikge1xuICAgICAgICB1dGlsU2VydmljZS5hbGVydEVycm9yKCfor7fkuIrkvKDlvq7kv6Hovazlj5FJQ09OIScpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoIXN1aXRlLnNlbGVjdGVkUHJvZHVjdHMubGVuZ3RoKSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+ivt+a3u+WKoOWVhuWTgSEnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIHBheVR5cGVzID0gXy51bmlvbihfLnBsdWNrKHN1aXRlLnNlbGVjdGVkUHJvZHVjdHMsICdwYXlUeXBlJykpO1xuICAgICAgaWYgKHBheVR5cGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcign5a2Y5Zyo5pSv5LuY5pa55byP5LiN5LiA6Ie055qE5ZWG5ZOB77yM6K+35LuU57uG5qOA5p+lIScpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8v5omT5byATW9kYWxcbiAgICB2YXIgb3Blbk1hZGFsID0gZnVuY3Rpb24odGVtcGxhdGVVcmwsIHNpemUpIHtcbiAgICAgIG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgJ3Byb21vdGlvbi1zdWl0ZScpKSxcbiAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlVXJsLFxuICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICBzaXplOiBzaXplXG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcbn07IiwiLypcbiAqIOinkuiJsueuoeeQhiBDb250cm9sbGVyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5jb250cm9sbGVyKCdSb2xlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHVpYk1vZGFsLCByb2xlU2VydmljZSkge1xuICAgIHZhciBsb2FkUm9sZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJvbGVTZXJ2aWNlLmdldFJvbGVzKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnJvbGUgPSByZXM7XG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5yb2xlU2VydmljZSA9IHJvbGVTZXJ2aWNlO1xuICAgICRzY29wZS5yb2xlID0gbnVsbDtcbiAgICAkc2NvcGUuZWRpdGFibGUgPSBmdW5jdGlvbihyb2xlKSB7XG4gICAgICAvLyDlj6rmnInpnZ7moLnoioLngrnoioLngrnmiY3lj6/ku6XnvJbovpFcbiAgICAgIHJldHVybiAkc2NvcGUucm9sZSAhPT0gcm9sZTtcbiAgICB9O1xuICAgICRzY29wZS5hZGRSb2xlID0gZnVuY3Rpb24oc2NvcGUsIHBhcmVudCkge1xuICAgICAgJHVpYk1vZGFsLm9wZW4oYWRkT3JFZGl0TW9kYWxPcHRpb25GYWN0b3J5KCRzY29wZS5wZXJtaXNzaW9ucykpXG4gICAgICAgIC5yZXN1bHQudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICByZXMucGFyZW50SWQgPSBwYXJlbnQuaWQ7XG4gICAgICAgICAgcm9sZVNlcnZpY2UuYWRkUm9sZShyZXMpLnRoZW4obG9hZFJvbGVzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuZWRpdFJvbGUgPSBmdW5jdGlvbihzY29wZSwgcm9sZSkge1xuICAgICAgJHVpYk1vZGFsLm9wZW4oYWRkT3JFZGl0TW9kYWxPcHRpb25GYWN0b3J5KCRzY29wZS5wZXJtaXNzaW9ucywgcm9sZSkpXG4gICAgICAgIC5yZXN1bHQudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICByb2xlU2VydmljZS5lZGl0Um9sZShyb2xlLmlkLCByZXMpLnRoZW4obG9hZFJvbGVzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUucmVtb3ZlUm9sZSA9IGZ1bmN0aW9uKHNjb3BlLCByb2xlKSB7XG4gICAgICAkdWliTW9kYWwub3BlbihyZW1vdmVNb2RhbE9wdGlvbkZhY3Rvcnkocm9sZSkpXG4gICAgICAgIC5yZXN1bHQudGhlbihmdW5jdGlvbihyb2xlVG9SZW1vdmUpIHtcbiAgICAgICAgICByb2xlU2VydmljZS5yZW1vdmVSb2xlKHJvbGVUb1JlbW92ZS5pZCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNjb3BlLnJlbW92ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGxvYWRSb2xlcygpO1xuICAgIHJvbGVTZXJ2aWNlLmdldE5vcm1hbFBlcm1pc3Npb25zKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICRzY29wZS5wZXJtaXNzaW9ucyA9IHJlcztcbiAgICB9KTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gYWRkT3JFZGl0TW9kYWxPcHRpb25GYWN0b3J5KHBlcm1pc3Npb25zLCByb2xlVG9FZGl0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvYWNjb3VudC9hZGRPckVkaXRSb2xlTW9kYWwuaHRtbCcsXG4gICAgICByZXNvbHZlOiB7XG4gICAgICAgIHJvbGVUb0VkaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiByb2xlVG9FZGl0O1xuICAgICAgICB9LFxuICAgICAgICBhbGxQZXJtaXNzaW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHBlcm1pc3Npb25zXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBBZGRPckVkaXRNb2RhbENvbnRyb2xsZXJcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiDmlrDlop4v5re75Yqg6KeS6Imy5a+56K+d5qGGIENvbnRyb2xsZXJcbiAgICovXG4gIGZ1bmN0aW9uIEFkZE9yRWRpdE1vZGFsQ29udHJvbGxlcigkc2NvcGUsICR1aWJNb2RhbEluc3RhbmNlLCByb2xlVG9FZGl0LCBhbGxQZXJtaXNzaW9ucykge1xuICAgICRzY29wZS5hbGxQZXJtaXNzaW9ucyA9IGFsbFBlcm1pc3Npb25zO1xuICAgICRzY29wZS5hZGRSb2xlTW9kZSA9ICFyb2xlVG9FZGl0O1xuICAgICRzY29wZS5yZXN1bHQgPSB7XG4gICAgICBuYW1lOiByb2xlVG9FZGl0ID8gcm9sZVRvRWRpdC5uYW1lIDogXCJcIixcbiAgICAgIHBlcm1pc3Npb25JZHM6IHJvbGVUb0VkaXQgPyByb2xlVG9FZGl0LnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbihwZXJtaXNzaW9uKSB7XG4gICAgICAgIHJldHVybiBwZXJtaXNzaW9uLmlkXG4gICAgICB9KSA6IFtdXG4gICAgfTtcbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5yZXN1bHQpO1xuICAgIH07XG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuZGlzbWlzcygpO1xuICAgIH07XG4gIH07XG59O1xuXG5mdW5jdGlvbiByZW1vdmVNb2RhbE9wdGlvbkZhY3Rvcnkocm9sZVRvUmVtb3ZlKSB7XG4gIHJldHVybiB7XG4gICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L3JlbW92ZVJvbGVNb2RhbC5odG1sJyxcbiAgICBzaXplOiAnc20nLFxuICAgIHJlc29sdmU6IHtcbiAgICAgIHJvbGVUb1JlbW92ZTogcm9sZVRvUmVtb3ZlXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICR1aWJNb2RhbEluc3RhbmNlLCByb2xlVG9SZW1vdmUpIHtcbiAgICAgICRzY29wZS5yb2xlVG9SZW1vdmUgPSByb2xlVG9SZW1vdmU7XG4gICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2Uocm9sZVRvUmVtb3ZlKTtcbiAgICAgIH07XG4gICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmRpc21pc3MoKTtcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcbiIsIi8q6ZSA5ZSu5pWw5o2u57uf6K6hKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFwcCkge1xuICBhcHAuY29udHJvbGxlcignc2FsZXNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgcHJvZHVjdFNlcnZpY2UsIHV0aWxTZXJ2aWNlLCBzYWxlc1NlcnZpY2UsIE5nVGFibGVQYXJhbXMsICRlbGVtZW50LCAkY29tcGlsZSwgJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAkc2NvcGUuaW50ZXJ2YWxIaWRlID0gZmFsc2U7XG4gICAgJHNjb3BlLnV0aWxTZXJ2aWNlID0gdXRpbFNlcnZpY2U7XG4gICAgJHNjb3BlLnllYXJIaWRlID0gdHJ1ZTtcbiAgICAkc2NvcGUubW9udGhIaWRlID0gdHJ1ZTtcbiAgICAkc2NvcGUud2Vla0hpZGUgPSB0cnVlO1xuICAgICRzY29wZS5sZXZlbE9uZUNhdGVnb3J5TGlzdCA9IFtdO1xuXG4gICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgJHNjb3BlLm1vbnRocyA9IFtdO1xuICAgICRzY29wZS53ZWVrTGlzdCA9IFtdOy8ve3N0YXJ0RGF0ZSxlbmREYXRlLHdlZWtOdW19XG4gICAgJHNjb3BlLmludGVydmFsTGlzdCA9IFt7IHZhbHVlOiAxLCBpbnRlcnZhbDogXCLmmKjml6VcIiB9LCB7XG4gICAgICB2YWx1ZTogMixcbiAgICAgIGludGVydmFsOiBcIuacgOi/kTflpKlcIlxuICAgIH0sIHsgdmFsdWU6IDMsIGludGVydmFsOiBcIuacgOi/kTMw5aSpXCIgfSwgeyB2YWx1ZTogNCwgaW50ZXJ2YWw6IFwi5pyA6L+ROTDlpKlcIiB9XTtcblxuICAgICRzY29wZS5zZWxlY3RZZWFyID0gJyc7XG4gICAgJHNjb3BlLnNlbGVjdFdlZWsgPSAnJztcbiAgICAkc2NvcGUuc2VsZWN0TW9udGggPSAxO1xuICAgICRzY29wZS5zZWxlY3RJbnRlcnZhbCA9ICRzY29wZS5pbnRlcnZhbExpc3RbMF07XG5cbiAgICAkc2NvcGUucHJvZHVjdE5hbWUgPSBcIlwiO1xuICAgICRzY29wZS5zZWFyY2hUeXBlID0gMTtcbiAgICAkc2NvcGUuc2FsZXNMaXN0ID0gW107XG4gICAgdmFyIGNhdGVnb3J5SWQgPSAwO1xuICAgIHZhciBzb3J0VHlwZSA9IDA7XG5cbiAgICAvLyDkuIvpnaLku6PnoIHkuLrlr7zlh7pFeGNlbOWBmuWHhuWkh1xuICAgIHZhciBleGNlbFRlbXBsYXRlID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KFxuICAgICAgJ2RhdGFTdGF0aXN0aWNzL3NhbGVzU3RhdGlzdGljc1RhYmxlVGVtcGxhdGUuaHRtbCcpKSgkc2NvcGUpO1xuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgICdleHBvcnRFeGNlbFdyYXAnKSkuYXBwZW5kKGV4Y2VsVGVtcGxhdGUpO1xuXG4gICAgJHNjb3BlLnNldEludGVydmFsID0gZnVuY3Rpb24gKCkgey8v5Yy66Ze057uf6K6hXG4gICAgICAkc2NvcGUuaW50ZXJ2YWxIaWRlID0gZmFsc2U7XG4gICAgICAkc2NvcGUueWVhckhpZGUgPSB0cnVlO1xuICAgICAgJHNjb3BlLm1vbnRoSGlkZSA9IHRydWU7XG4gICAgICAkc2NvcGUud2Vla0hpZGUgPSB0cnVlO1xuICAgICAgJHNjb3BlLnNlYXJjaFR5cGUgPSAxO1xuICAgIH07XG4gICAgJHNjb3BlLnNldE1vbnRocyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICRzY29wZS55ZWFySGlkZSA9IGZhbHNlO1xuICAgICAgJHNjb3BlLm1vbnRoSGlkZSA9IGZhbHNlO1xuICAgICAgJHNjb3BlLmludGVydmFsSGlkZSA9IHRydWU7XG4gICAgICAkc2NvcGUud2Vla0hpZGUgPSB0cnVlO1xuICAgICAgJHNjb3BlLnNlYXJjaFR5cGUgPSAyO1xuXG4gICAgfTtcbiAgICAkc2NvcGUuc2V0V2Vla3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAkc2NvcGUueWVhckhpZGUgPSBmYWxzZTtcbiAgICAgICRzY29wZS53ZWVrSGlkZSA9IGZhbHNlO1xuICAgICAgJHNjb3BlLm1vbnRoSGlkZSA9IHRydWU7XG4gICAgICAkc2NvcGUuaW50ZXJ2YWxIaWRlID0gdHJ1ZTtcbiAgICAgICRzY29wZS5zZWFyY2hUeXBlID0gMztcblxuICAgIH07XG4gICAgJHNjb3BlLm9uWWVhckNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICRzY29wZS5tb250aHMgPSAkc2NvcGUuc2VsZWN0WWVhci5tb250aDtcbiAgICAgICRzY29wZS5zZWxlY3RNb250aCA9ICRzY29wZS5tb250aHNbMF07XG4gICAgICAkc2NvcGUud2Vla0xpc3QgPSAkc2NvcGUuc2VsZWN0WWVhci53ZWVrO1xuICAgICAgJHNjb3BlLnNlbGVjdFdlZWsgPSAkc2NvcGUud2Vla0xpc3RbMF07XG4gICAgfTtcbiAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAkc2NvcGUubGltaXQgPSAyMDtcbiAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgfSwge1xuICAgICAgY291bnRzOiBbXSxcbiAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDIwLFxuICAgICAgcGFnaW5hdGlvbk1pbkJsb2NrczogMixcbiAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIHNlYXJjaFBhcmFtcyA9IGdldFF1ZXJ5UGFyYW1zKCk7XG4gICAgICAgICRzY29wZS5vZmZzZXQgPSAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpO1xuICAgICAgICBzZWFyY2hQYXJhbXMub2Zmc2V0ID0gJHNjb3BlLm9mZnNldDtcbiAgICAgICAgc2VhcmNoUGFyYW1zLmxpbWl0ID0gJHNjb3BlLmxpbWl0O1xuICAgICAgICByZXR1cm4gc2FsZXNTZXJ2aWNlLmdldFF1ZXJ5U2FsZXNMaXN0KHNlYXJjaFBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcblxuICAgICAgICAgIHJldHVybiByZXMuY29udGVudDtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICB9KTtcblxuICAgICRzY29wZS5vblNlYXJjaCA9IGZ1bmN0aW9uICgpIHsvL+afpeivouaMiemSrlxuICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgZGF0YXNldDogW11cbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLm9uUHJvZHVjdE5hbWVTZWFyY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuICAgICAgICBkYXRhc2V0OiBbXVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuZXhwb3J0RXhjZWwgPSBmdW5jdGlvbiAoKSB7Ly/lr7zlh7pleGNlbFxuXG4gICAgICBpZiAoISRzY29wZS5zYWxlc0xpc3QubGVuZ3RoKSB7XG4gICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoJ+ivt+WFiOmAieaLqemcgOWvvOWHuueahOaVsOaNricpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICBkb21bMF0uaHJlZiA9ICQoJyNleHBvcnQtc2FsZXMtdGFibGUnKS5leGNlbGV4cG9ydGpzKHtcbiAgICAgICAgY29udGFpbmVyaWQ6ICdleHBvcnQtc2FsZXMtdGFibGUnLFxuICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgIH0pO1xuICAgICAgZG9tWzBdLmRvd25sb2FkID0gJ+WVhuWTgemUgOWUruaVsOaNri54bHMnO1xuICAgICAgZG9tWzBdLmNsaWNrKCk7XG5cbiAgICB9O1xuICAgIC8v5Zue6L2m6ZSu5p+l6K+iXG4gICAgJHNjb3BlLnByb2R1Y3RLZXl1cCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIga2V5Y29kZSA9IHdpbmRvdy5ldmVudCA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICBpZiAoa2V5Y29kZSA9PSAxMykge1xuICAgICAgICAkc2NvcGUub25TZWFyY2goKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5Yu+6YCJXG4gICAgJHNjb3BlLnVwZGF0ZVNlbGVjdGlvbiA9IGZ1bmN0aW9uIChlLCBpdGVtKSB7XG4gICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgaXNDaGVja2VkID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgfVxuICAgICAgaXRlbS5jaGVja2VkID0gaXNDaGVja2VkO1xuICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAkc2NvcGUuc2FsZXNMaXN0LnB1c2goaXRlbSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc2NvcGUuc2FsZXNMaXN0ID0gXy53aXRob3V0KCRzY29wZS5zYWxlc0xpc3QsXG4gICAgICAgICAgaXRlbSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAkc2NvcGUudW5zYWxhYmxlQ2xpY2sgPSBmdW5jdGlvbiAoaXRlbSkgey8v5Yqg5YWl5rue6ZSA5ZWG5ZOB5bqTXG4gICAgICBpZiAoaXRlbS5pc1Vuc2FsYWJsZSA9PSAxKSB7XG4gICAgICAgIHNhbGVzU2VydmljZS5kZWxVbnNhbGFibGUoe1xuICAgICAgICAgIGlkOiBpdGVtLmlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSB7IHByb2R1Y3RJZHM6IFtpdGVtLmlkXSB9O1xuICAgICAgICBzYWxlc1NlcnZpY2UuYWRkVW5zYWxhYmxlKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgIH07XG4gICAgLy/mlrDlk4HmjqjojZBcbiAgICAkc2NvcGUucmVjb21tZW5kQ2xpY2sgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgdmFyIHBhcmFtcyA9IHsgcHJvZHVjdElkczogW2l0ZW0uaWRdIH07XG4gICAgICBpZiAoaXRlbS5pc05ldyA9PSAxKSB7XG4gICAgICAgIHNhbGVzU2VydmljZS5kZWxSZWNvbW1lbmQoe1xuICAgICAgICAgIGlkOiBpdGVtLmlkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2FsZXNTZXJ2aWNlLmFkZENvbW1lbmQocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcblxuICAgIH1cbiAgICAvL+e7hOijheWPguaVsFxuICAgIHZhciBnZXRRdWVyeVBhcmFtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgc3dpdGNoICgkc2NvcGUuc2VhcmNoVHlwZSkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgcXVlcnlQYXJhbXMucmFuZ2UgPSAkc2NvcGUuc2VsZWN0SW50ZXJ2YWwudmFsdWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBxdWVyeVBhcmFtcy55ZWFyID0gJHNjb3BlLnNlbGVjdFllYXIueWVhcjtcbiAgICAgICAgICBxdWVyeVBhcmFtcy5tb250aCA9ICRzY29wZS5zZWxlY3RNb250aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHF1ZXJ5UGFyYW1zLnN0YXJ0VGltZSA9IHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZygkc2NvcGUuc2VsZWN0V2Vlay5zdGFydERhdGUsIFwieXl5eS1NTS1kZFwiKTtcbiAgICAgICAgICBxdWVyeVBhcmFtcy5lbmRUaW1lID0gdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5zZWxlY3RXZWVrLmVuZERhdGUsIFwieXl5eS1NTS1kZFwiKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIDtcbiAgICAgIHF1ZXJ5UGFyYW1zLnByb2R1Y3ROYW1lID0gJHNjb3BlLnByb2R1Y3ROYW1lO1xuICAgICAgcXVlcnlQYXJhbXMudHlwZSA9ICRzY29wZS5zZWFyY2hUeXBlO1xuICAgICAgcXVlcnlQYXJhbXMuc29ydFR5cGUgPSBzb3J0VHlwZTtcbiAgICAgIGlmIChjYXRlZ29yeUlkID4gMCkge1xuICAgICAgICBxdWVyeVBhcmFtcy5jYXRlZ29yeUlkID0gY2F0ZWdvcnlJZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBxdWVyeVBhcmFtcztcbiAgICB9O1xuXG4gICAgLy/liJ3lp4vljJblk4HnsbtcbiAgICB2YXIgY2F0ZWdvcnlJbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgbG9hZENhdGVnb3J5TGlzdCgwKTtcbiAgICB9O1xuICAgIC8v5Yqg6L295ZOB57G7XG4gICAgdmFyIGxvYWRDYXRlZ29yeUxpc3QgPSBmdW5jdGlvbiAocGFyZW50Q2F0ZWdvcnlJZCkge1xuICAgICAgcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0Q2F0ZWdvcnlMaXN0KHtcbiAgICAgICAgcGFyZW50Q2F0ZWdvcnlJZDogcGFyZW50Q2F0ZWdvcnlJZFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIGlmICghcGFyZW50Q2F0ZWdvcnlJZCkgeyAvL+S4gOe6p+WTgeexu1xuICAgICAgICAgICRzY29wZS5sZXZlbE9uZUNhdGVnb3J5TGlzdCA9IGFuZ3VsYXIuY29weShyZXMpO1xuICAgICAgICAgICRzY29wZS5sZXZlbE9uZUNhdGVnb3J5RmlsdGVyLnNldExpc3QocmVzKTtcbiAgICAgICAgICBpZiAoJHNjb3BlLmxldmVsT25lQ2F0ZWdvcnlMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZExldmVsT25lQ2F0ZWdvcnkgPSAkc2NvcGUubGV2ZWxPbmVDYXRlZ29yeUxpc3RbMF07XG4gICAgICAgICAgICBsb2FkQ2F0ZWdvcnlMaXN0KCRzY29wZS5zZWxlY3RlZExldmVsT25lQ2F0ZWdvcnkuaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUubGV2ZWxPbmVDYXRlZ29yeU1hbmFnZUxpc3QgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uaWQgIT0gJzAnO1xuICAgIH07XG4gICAgY2F0ZWdvcnlJbml0KCk7XG4gICAgLy/kuIDnuqflk4Hnsbsg562b6YCJXG4gICAgJHNjb3BlLmxldmVsT25lQ2F0ZWdvcnlGaWx0ZXIgPSB7XG4gICAgICBsaXN0OiBbXSxcbiAgICAgIGRlZmF1bHRJdGVtOiB7XG4gICAgICAgIGNhdGVnb3J5TmFtZTogJ+WFqOmDqOWTgeexuydcbiAgICAgIH0sXG4gICAgICBzZXRMaXN0OiBmdW5jdGlvbiAobGlzdCkge1xuICAgICAgICBwcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RDYXRlZ29yeUxpc3Qoe1xuICAgICAgICAgIHBhcmVudENhdGVnb3J5SWQ6IDBcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5saXN0ID0gYW5ndWxhci5jb3B5KGxpc3QpO1xuICAgICAgICB0aGlzLmxpc3QudW5zaGlmdCh0aGlzLmRlZmF1bHRJdGVtKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbiAoaXRlbSkgey8v5LiA57qn5ZOB57G76YCJ5Lit5ZCOXG4gICAgICAgIGlmIChpdGVtLmlkKSB7XG4gICAgICAgICAgY2F0ZWdvcnlJZCA9IGl0ZW0uaWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2F0ZWdvcnlJZCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmNhdGVnb3J5TmFtZSA9IGl0ZW0uY2F0ZWdvcnlOYW1lO1xuICAgICAgICAkc2NvcGUub25TZWFyY2goKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOS4gOaYn+acn+avq+enkuaVsFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgdmFyIGdldFdlZWtUaW1lID0gZnVuY3Rpb24gd2Vla1RpbWUoKSB7XG4gICAgICByZXR1cm4gNyAqIDI0ICogMzYwMDAwMDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOiOt+WPluaYn+acn+aVsOe7hFxuICAgICAqIEBwYXJhbSB5ZWFyXG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIHZhciBnZXRXZWVrTGlzdCA9IGZ1bmN0aW9uIChzdGFydERheSwgZW5kRGF5KSB7XG4gICAgICB2YXIgZGF0ZSA9IHN0YXJ0RGF5O1xuICAgICAgdmFyIGVuZERhdGUgPSBlbmREYXk7XG4gICAgICAvLyDlj5blvpfov5nkuKrml6XmnJ/lr7nosaEgZGF0ZSDnmoTplb/mlbTlvaLml7bpl7QgdGltZVxuICAgICAgdmFyIHRpbWUgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgIHZhciB3ZWVrZGF5ID0gZGF0ZS5nZXREYXkoKTsvL+aWsOW5tOeahOesrCDkuIDlpKnmmK/mmJ/mnJ/lh6BcbiAgICAgIGlmICh3ZWVrZGF5ID09IDApIHtcbiAgICAgICAgd2Vla2RheSA9IDc7XG4gICAgICB9XG4gICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgd2hpbGUgKHRpbWUgPCBlbmREYXRlLmdldFRpbWUoKSkge1xuICAgICAgICB2YXIgd2Vla0l0ZW0gPSB7fTtcbiAgICAgICAgd2Vla0l0ZW0ud2Vla051bSA9IChpICsgMSk7XG4gICAgICAgIGlmIChpID09IDApIHtcbiAgICAgICAgICB3ZWVrSXRlbS5zdGFydERhdGUgPSB0aW1lO1xuICAgICAgICAgIHRpbWUgPSB0aW1lICsgKDcgLSB3ZWVrZGF5KSAqIDI0ICogMzYwMDAwMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3ZWVrSXRlbS5zdGFydERhdGUgPSB0aW1lICsgKDI0ICogMzYwMDAwMCk7XG4gICAgICAgICAgdGltZSA9IHRpbWUgKyBnZXRXZWVrVGltZSgpO1xuICAgICAgICB9XG4gICAgICAgIHdlZWtJdGVtLmVuZERhdGUgPSB0aW1lO1xuICAgICAgICBpZiAodGltZSA+PSBlbmREYXRlLmdldFRpbWUoKSkge1xuICAgICAgICAgIHdlZWtJdGVtLmVuZERhdGUgPSBlbmREYXRlLmdldFRpbWUoKTtcbiAgICAgICAgfVxuICAgICAgICB3ZWVrSXRlbS5zZWxlY3RPcHRpb24gPSBcIuesrFwiICsgd2Vla0l0ZW0ud2Vla051bSArIFwi5ZGoKFwiICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKHdlZWtJdGVtLnN0YXJ0RGF0ZSwgXCJNTeaciGRk5pelXCIpICsgXCItXCIgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcod2Vla0l0ZW0uZW5kRGF0ZSwgXCJNTeaciGRk5pelXCIpICsgXCIpXCI7XG4gICAgICAgIGxpc3QucHVzaCh3ZWVrSXRlbSk7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICog5byA5aeL5pe26Ze0XG4gICAgICogQHJldHVybnMge0RhdGV9XG4gICAgICovXG4gICAgdmFyIGdldFN0YXJ0RGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHNhbGVzU2VydmljZS5nZXRTdGFydFRpbWUoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgdmFyIHZhbCA9IERhdGUucGFyc2UocmVzLnN0YXJ0VGltZVN0cik7XG4gICAgICAgIHZhciBuZXdEYXRlID0gbmV3IERhdGUodmFsKTtcbiAgICAgICAgdmFyIGxpc3QgPSBnZXRTZWxlY3RUaW1lTGlzdChuZXdEYXRlKTtcbiAgICAgICAgJHNjb3BlLnllYXJzID0gbGlzdDtcbiAgICAgICAgJHNjb3BlLnNlbGVjdFllYXIgPSAkc2NvcGUueWVhcnNbMF07XG4gICAgICAgICRzY29wZS5tb250aHMgPSAkc2NvcGUuc2VsZWN0WWVhci5tb250aDtcbiAgICAgICAgJHNjb3BlLndlZWtMaXN0ID0gJHNjb3BlLnNlbGVjdFllYXIud2VlaztcbiAgICAgICAgJHNjb3BlLnNlbGVjdFdlZWsgPSAkc2NvcGUud2Vla0xpc3RbMF07XG4gICAgICAgICRzY29wZS5zZWxlY3RNb250aCA9ICRzY29wZS5tb250aHNbMF07XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOiOt+WPlumAieaLqeafkOW5tOeahOaciOS7vVxuICAgICAqIEBwYXJhbSBzdGFydE1vbnRoXG4gICAgICogQHBhcmFtIGVuZE1vbnRoXG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIHZhciBnZXRNb250aExpc3QgPSBmdW5jdGlvbiAoc3RhcnRNb250aCwgZW5kTW9udGgpIHtcbiAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICBmb3IgKHZhciBpID0gc3RhcnRNb250aDsgaSA8PSBlbmRNb250aDsgaSsrKSB7XG4gICAgICAgIGxpc3QucHVzaChpICsgMSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbGlzdDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOiOt+WPluaXtumXtOaVsOe7hFxuICAgICAqIEBwYXJhbSBzdGFydERhdGVcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICovXG4gICAgdmFyIGdldFNlbGVjdFRpbWVMaXN0ID0gZnVuY3Rpb24gKHN0YXJ0RGF0ZSkge1xuICAgICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgIHZhciBzdGFydFllYXIgPSBzdGFydERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgIHZhciBlbmRZZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTtcbiAgICAgIHZhciB5ZWFyTGlzdCA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0WWVhcjsgaSA8PSBlbmRZZWFyOyBpKyspIHtcbiAgICAgICAgdmFyIHllYXJJdGVtID0geyB5ZWFyOiAnJywgd2VlazogW10sIG1vbnRoOiBbXSB9O1xuICAgICAgICB2YXIgc3RhcnREYXk7XG4gICAgICAgIHZhciBlbmREYXk7XG4gICAgICAgIGlmIChpID09IHN0YXJ0WWVhcikge1xuICAgICAgICAgIHN0YXJ0RGF5ID0gc3RhcnREYXRlO1xuICAgICAgICAgIGVuZERheSA9IG5ldyBEYXRlKHN0YXJ0WWVhciwgXCIxMVwiLCBcIjMxXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGkgPT0gZW5kWWVhcikge1xuICAgICAgICAgIHN0YXJ0RGF5ID0gbmV3IERhdGUoZW5kWWVhciwgXCIwXCIsIFwiMVwiKTtcbiAgICAgICAgICBlbmREYXkgPSB0b2RheTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGFydERheSA9IG5ldyBEYXRlKGksIFwiMFwiLCBcIjFcIik7XG4gICAgICAgICAgZW5kRGF5ID0gbmV3IERhdGUoaSwgXCIxMVwiLCBcIjMxXCIpO1xuICAgICAgICB9XG4gICAgICAgIHllYXJJdGVtLndlZWsgPSBnZXRXZWVrTGlzdChzdGFydERheSwgZW5kRGF5KTtcbiAgICAgICAgeWVhckl0ZW0ubW9udGggPSBnZXRNb250aExpc3Qoc3RhcnREYXkuZ2V0TW9udGgoKSwgZW5kRGF5LmdldE1vbnRoKCkpO1xuICAgICAgICB5ZWFySXRlbS55ZWFyID0gaTtcbiAgICAgICAgeWVhckxpc3QucHVzaCh5ZWFySXRlbSk7XG4gICAgICB9XG4gICAgICByZXR1cm4geWVhckxpc3Q7XG4gICAgfTtcbiAgICAkc2NvcGUuc29ydEJ5UG9zaXRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgc29ydFR5cGUgPSBpdGVtLnNvcnRDb2RlO1xuICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgZGF0YXNldDogW11cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBnZXRTdGFydERhdGUoKTtcbiAgfSk7XG59IiwiLypcbiAq6LSn5p625beh5p+lXG4gKnNoZWxmQ29udHJvbGxlclxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5jb250cm9sbGVyKCdzaGVsZicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kU2lkZW5hdiwgJHNjZSwgc2hlbGZTZXJ2aWNlLCBjb21wYW55U2VydmljZSwgYXV0aFNlcnZpY2UsIHV0aWxTZXJ2aWNlLCBOZ1RhYmxlUGFyYW1zKSB7XG4gICAgICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHtcbiAgICAgICAgICAgIHNoZWxmX3N0b2NrX3BlcmNlbnQ6ICcnLFxuICAgICAgICAgICAgc2hlbGZfd2Fybl9jb3VudDogJycsXG4gICAgICAgICAgICBzaGVsZl90eXBlOiAnJyxcbiAgICAgICAgICAgIGxhc3RfdXBkYXRlX2ludGVydmFsOiAnJ1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY29tcGFueXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmhhbmRsZUNsaWNrU2VhcmNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZkxpc3QoXy5vbWl0KCRzY29wZS5xdWVyeVBhcmFtcywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPT09ICcnO1xuICAgICAgICAgICAgfSkpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueXMgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvbXBhbnlzLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdGVtcC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlOYW1lOiBpdGVtLmNvbXBhbnlfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlJZDogaXRlbS5jb21wYW55X2lkXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLmNvbXBhbnlMaXN0ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0OiBzaGVsZlNlcnZpY2UuX3BhcnNlU2hlbGZEYXRhKCRzY29wZS5jb21wYW55cylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUZpbHRlclBhbmVsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmhhbmRsZUNsaWNrU2VhcmNoQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZkxpc3Qoe30pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueXMgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvbXBhbnlzLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdGVtcC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlOYW1lOiBpdGVtLmNvbXBhbnlfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlJZDogaXRlbS5jb21wYW55X2lkXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLmNvbXBhbnlMaXN0ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMuc2V0dGluZ3Moe1xuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0OiBzaGVsZlNlcnZpY2UuX3BhcnNlU2hlbGZEYXRhKCRzY29wZS5jb21wYW55cylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2hvd0ZpbHRlclBhbmVsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWRTaWRlbmF2KCdyaWdodCcpLnRvZ2dsZSgpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuaGlkZUZpbHRlclBhbmVsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWRTaWRlbmF2KCdyaWdodCcpLnRvZ2dsZSgpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuaGVhZHMgPSBbe1xuICAgICAgICAgICAgdGl0bGU6ICfluo/lj7cnLFxuICAgICAgICAgICAgZmllbGQ6ICdpbmRleCcsXG4gICAgICAgICAgICBzaG93OiB0cnVlLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIsIGlkeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4gc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDo0MHB4O3RleHQtYWxpZ246Y2VudGVyXCI+JyArICh2ICsgMSkgKyAnPC9zcGFuPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5YWs5Y+45ZCN56ewJyxcbiAgICAgICAgICAgIGZpZWxkOiAnY29tcGFueV9uYW1lJyxcbiAgICAgICAgICAgIGZpbHRlcjogeyBjb21wYW55X25hbWU6ICd0ZXh0JyB9LFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYsIHIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxhIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MTUwcHhcIiBocmVmPVwiI3NoZWxmLycgKyByLmNvbXBhbnlfaWQgKyAnXCI+JyArIHYgKyAnPC9hPic7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+WFrOWPuOexu+WeiycsXG4gICAgICAgICAgICBmaWVsZDogJ2NvbXBhbnlfdHlwZScsXG4gICAgICAgICAgICBmaWx0ZXI6IHsgY29tcGFueV90eXBlOiAndGV4dCcgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflhazlj7jlnLDlnYAnLFxuICAgICAgICAgICAgZmllbGQ6ICdjb21wYW55X2FkZHJlc3MnLFxuICAgICAgICAgICAgZmlsdGVyOiB7IGNvbXBhbnlfYWRkcmVzczogJ3RleHQnIH0sXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odikge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4gc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoxNTBweFwiPicgKyB2ICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfotKfmnrbmlbAv6LSn5p625oC75pWwJyxcbiAgICAgICAgICAgIGZpZWxkOiAndmFsaWRfc2hlbGRfY291bnRWU3NoZWxmX2NvdW50JyxcbiAgICAgICAgICAgIGZpbHRlcjogeyB2YWxpZF9zaGVsZF9jb3VudFZTc2hlbGZfY291bnQ6ICd0ZXh0JyB9LFxuICAgICAgICAgICAgc2hvdzogdHJ1ZVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+i3neemu+S4iuasoeihpei0pycsXG4gICAgICAgICAgICBmaWVsZDogJ2xhc3RfdXBkYXRlX2ludGVydmFsJyxcbiAgICAgICAgICAgIHNvcnRhYmxlOiAnbGFzdF91cGRhdGVfaW50ZXJ2YWwnLFxuICAgICAgICAgICAgZmlsdGVyOiB7IGxhc3RfdXBkYXRlX2ludGVydmFsOiAndGV4dCcgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfotKfmnrbkuIrotKfnianmgLvkvZPljaDmr5QnLFxuICAgICAgICAgICAgZmllbGQ6ICdhbGxfcHJvZHVjdF9wZXInLFxuICAgICAgICAgICAgc29ydGFibGU6ICdhbGxfcHJvZHVjdF9wZXInLFxuICAgICAgICAgICAgZmlsdGVyOiB7IGFsbF9wcm9kdWN0X3BlcjogJ3RleHQnIH0sXG4gICAgICAgICAgICBzaG93OiB0cnVlLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MTUwcHhcIj4nICsgdiArICc8L3NwYW4+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV07XG4gICAgICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgIGNvdW50OiAyNVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgcGFnaW5hdGlvbk1heEJsb2NrczogMTMsXG4gICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgZGF0YXNldDogW11cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS5zaGVsZlN0YXR1c09wdGlvbnMgPSB7XG4gICAgICAgICAgICBjaG9pY2VzOiAkKFt7IHZhbHVlOiAnJywgZGVzYzogJ+WFqOmDqCcgfV0pLmNvbmNhdCh1dGlsU2VydmljZS5nZXRDb25zdGFudEpzb25WYWx1ZSgnU0hFTEZfU1RBVEUnKSksXG4gICAgICAgICAgICBnZXREZWZhdWx0SXRlbTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5jaG9pY2VzO1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7IHZhbHVlOiB2IH0pIHx8IG9wdGlvbnNbMF07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0SXRlbTogZnVuY3Rpb24ocmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWZhdWx0SXRlbSA9IHJlY29yZDtcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc2hlbGZfdHlwZSA9IHJlY29yZC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLyogICAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmTGlzdCgpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW55cyA9IHJlcy5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvbXBhbnlzLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnlzLmluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlOYW1lOiBpdGVtLmNvbXBhbnlfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYW55SWQ6IGl0ZW0uY29tcGFueV9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb21wYW55U2VydmljZS5jb21wYW55TGlzdCA9IHRlbXA7XG4gICAgICAgICAgICAgICAgICAgIC8vID0gXy5wbHVjaygkc2NvcGUuY29tcGFueXMsICdjb21wYW55X2lkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnNldHRpbmdzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzZXQ6IHNoZWxmU2VydmljZS5fcGFyc2VTaGVsZkRhdGEoJHNjb3BlLmNvbXBhbnlzKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTsqL1xuICAgIH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoJ3NoZWxmRGV0YWlsJywgZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJHJvdXRlUGFyYW1zLCBwcm9kdWN0U2VydmljZSwgY29tcGFueVNlcnZpY2UsIE5nVGFibGVQYXJhbXMsIHV0aWxTZXJ2aWNlLCBzaGVsZlNlcnZpY2UsIG1vZGFsU2VydmljZSkge1xuICAgICAgICB2YXIgc3VtbWFyeUNyZWF0ZU1vZGFsO1xuICAgICAgICB2YXIgY29tcGFueUxpc3QgPSBjb21wYW55U2VydmljZS5jb21wYW55TGlzdDtcbiAgICAgICAgJHNjb3BlLm9mZnNldCA9IDA7XG4gICAgICAgICRzY29wZS5saW1pdCA9IDI1O1xuICAgICAgICAkc2NvcGUuc3RyYXRlZ3kgPSAnJztcbiAgICAgICAgJHNjb3BlLnByZWZlciA9IHsgbmFtZTogJycsIGlkOiAnJyB9O1xuICAgICAgICAkc2NvcGUucmVmdXNlID0geyBuYW1lOiAnJywgaWQ6ICcnIH07XG4gICAgICAgICRzY29wZS5wcmVmZXJzID0gW107XG4gICAgICAgICRzY29wZS5yZWZ1c2VzID0gW107XG4gICAgICAgICRzY29wZS5zaG93UHJlZmVyU2VhcmNoID0gZmFsc2U7XG4gICAgICAgICRzY29wZS50b3RhbEl0ZW1zID0gY29tcGFueUxpc3QubGVuZ3RoO1xuICAgICAgICAkc2NvcGUuY3VycmVudENvbXBhbnkgPSBfLmZpbmRXaGVyZShjb21wYW55TGlzdCwgeyBjb21wYW55SWQ6ICRyb3V0ZVBhcmFtcy5jb21wYW55SWQgfSk7XG4gICAgICAgICRzY29wZS5jdXJyZW50UGFnZSA9IF8uaW5kZXhPZihjb21wYW55TGlzdCwgJHNjb3BlLmN1cnJlbnRDb21wYW55KSArIDE7XG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2N1cnJlbnRQYWdlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuaW5pdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy/phY3nva5cbiAgICAgICAgJHNjb3BlLnN1bW1hcnlIZWFkID0gW3tcbiAgICAgICAgICAgIHRpdGxlOiAn5bqP5Y+3JyxcbiAgICAgICAgICAgIGZpZWxkOiAnaW5kZXgnLFxuICAgICAgICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmVjb3JkLCBpbmRleCwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyBpbmRleCArICc8L3NwYW4+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflgY/niLHllYblk4EnLFxuICAgICAgICAgICAgZmllbGQ6ICdwcmVmZXJzJyxcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmVjb3JkLCBpbmRleCwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyBfLnBsdWNrKHZhbHVlIHx8IFtdLCAnbmFtZScpLmpvaW4oJyB8ICcpICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfmi5Lnu53llYblk4EnLFxuICAgICAgICAgICAgZmllbGQ6ICdyZWZ1c2VzJyxcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgcmVjb3JkLCBpbmRleCwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyBfLnBsdWNrKHZhbHVlIHx8IFtdLCAnbmFtZScpLmpvaW4oJyB8ICcpICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfpgInotK3nrZbnlaUnLFxuICAgICAgICAgICAgZmllbGQ6ICdzdHJhdGVneScsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzwvc3Bhbj4nICsgKHZhbHVlIHx8ICcnKSArICc8L3NwYW4+JztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzaG93OiB0cnVlXG4gICAgICAgIH1dO1xuICAgICAgICAkc2NvcGUucHJlZmVyU3VtbWFyeVRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoKTtcbiAgICAgICAgLy/mlrnms5VcbiAgICAgICAgLy/liJ3lp4vljJZcbiAgICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50Q29tcGFueSA9IGNvbXBhbnlMaXN0WyRzY29wZS5jdXJyZW50UGFnZSAtIDFdO1xuICAgICAgICAgICAgc2hlbGZTZXJ2aWNlLnF1ZXJ5U2hlbGZEZXRhaWxCeUNvbXBhbnlJZCh7XG4gICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY3VycmVudENvbXBhbnkuY29tcGFueUlkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS50YWJsZXMgPSBzaGVsZlNlcnZpY2UuX3BhcnNlU2hlbGZEZXRhaWxEYXRhKHJlc1swXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbXBhbnlTZXJ2aWNlLnF1ZXJ5Q29tcGFueVByZWZlclN1bW1hcnkoe1xuICAgICAgICAgICAgICAgIGNvbXBhbnlJZDogJHNjb3BlLmN1cnJlbnRDb21wYW55LmNvbXBhbnlJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueVN1bW1hcnkgPSByZXM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm9wZW5DcmVhdGVQcmVmZXJTdW1tYXJ5V2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzdW1tYXJ5Q3JlYXRlTW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N1bW1hcnljb250ZW50JyxcbiAgICAgICAgICAgICAgICBhcHBlbmRUbzogJGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICBvazogJHNjb3BlLmNyZWF0ZUNvbXBhbnlQcmVmZXJTdW1tYXJ5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmdldFRkQ2xzID0gZnVuY3Rpb24odGQpIHtcbiAgICAgICAgICAgIHZhciBwcm9kdWN0ID0gdGQgJiYgdGQucHJvZHVjdEhlYWRlciB8fCB7XG4gICAgICAgICAgICAgICAgc3RvY2s6IDAsXG4gICAgICAgICAgICAgICAgbWF4U3RvY2s6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSAwO1xuICAgICAgICAgICAgdmFyIHN0b2NrO1xuICAgICAgICAgICAgdmFyIG1heFN0b2NrO1xuICAgICAgICAgICAgdmFyIGNscyA9ICcnO1xuICAgICAgICAgICAgaWYgKCF0ZCB8fCAhcHJvZHVjdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0b2NrID0gcGFyc2VJbnQocHJvZHVjdC5zdG9jayk7XG4gICAgICAgICAgICBtYXhTdG9jayA9IHBhcnNlSW50KHByb2R1Y3QubWF4U3RvY2spO1xuICAgICAgICAgICAgcmF0aW8gPSBwYXJzZUZsb2F0KChzdG9jayAvIG1heFN0b2NrKS50b0ZpeGVkKDEpKTtcbiAgICAgICAgICAgIGlmIChyYXRpbyA8PSAwLjIpIHtcbiAgICAgICAgICAgICAgICBjbHMgPSAncmVkJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmF0aW8gPiAwLjIgJiYgcmF0aW8gPD0gMC41KSB7XG4gICAgICAgICAgICAgICAgY2xzID0gJ3llbGxvdyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNscyA9ICdncmVlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWF4U3RvY2sgPT09IDApIHtcbiAgICAgICAgICAgICAgICBjbHMgPSAnYmx1ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2xzO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuYWRkID0gZnVuY3Rpb24oJHNjb3BlLCB0eXBlKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlW3R5cGVdLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlW3R5cGVdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZVt0eXBlICsgJ3MnXS5wdXNoKGFuZ3VsYXIuY29weSgkc2NvcGVbdHlwZV0pKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlW3R5cGVdLmlkID0gJyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlW3R5cGUgKyAncyddLnB1c2goYW5ndWxhci5jb3B5KCRzY29wZVt0eXBlXSkpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGVbdHlwZV0ubmFtZSA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uKCRzY29wZSwgaW5kZXgsIHR5cGUpIHtcbiAgICAgICAgICAgICRzY29wZVt0eXBlICsgJ3MnXS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY3JlYXRlQ29tcGFueVByZWZlclN1bW1hcnkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBjb21wYW55U2VydmljZS5jcmVhdGVDb21wYW55UHJlZmVyU3VtbWFyeSh7XG4gICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY3VycmVudENvbXBhbnkuY29tcGFueUlkLFxuICAgICAgICAgICAgICAgIGluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZmVyczogJHNjb3BlLnByZWZlcnMsXG4gICAgICAgICAgICAgICAgICAgIHJlZnVzZXM6ICRzY29wZS5yZWZ1c2VzLFxuICAgICAgICAgICAgICAgICAgICBzdHJhdGVneTogJHNjb3BlLnN0cmF0ZWd5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS50eXBlSGVhZE9wdGlvbnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnR5cGVIZWFkQ29uZmlncyA9IHtcbiAgICAgICAgICAgIGRlYm91bmNlOiB7XG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiA1MDAsXG4gICAgICAgICAgICAgICAgJ2JsdXInOiAyNTBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXR0ZXJTZXR0ZXI6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmdldFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKHZhbHVlKSB7IC8v5pCc57Si5Yqg6L29XG4gICAgICAgICAgICByZXR1cm4gcHJvZHVjdFNlcnZpY2UucXVlcnlQcm9kdWN0QnlLZXkoe1xuICAgICAgICAgICAgICAgIG9mZnNldDogJHNjb3BlLm9mZnNldCxcbiAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiB2YWx1ZVxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmNvbnRlbnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKGl0ZW0sIG1vZGVsLCBsYWJlbCwgZXZlbnQsIHR5cGUpIHsgLy/mkJzntKLpgInmi6lcbiAgICAgICAgICAgICRzY29wZVt0eXBlXSA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLmhlYWRlci5wcm9kdWN0TmFtZSxcbiAgICAgICAgICAgICAgICBpZDogaXRlbS5oZWFkZXIuaWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICB9KTtcbn07XG4iLCIvKui0p+aetueuoeeQhiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuY29udHJvbGxlcignc2hlbGZNYW5hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkY29tcGlsZSwgJHRlbXBsYXRlQ2FjaGUsXG4gICAgc2hlbGZTZXJ2aWNlLCBOZ1RhYmxlUGFyYW1zLCBtb2RhbFNlcnZpY2UsIGNvbXBhbnlTZXJ2aWNlLFxuICAgIHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAkc2NvcGUuUFJPRklUX0xFVkVMID0gQ09OU1RBTlRTLlBST0ZJVF9MRVZFTDtcbiAgICAkc2NvcGUucGF0aHMgPSBbe1xuICAgICAgbmFtZTogJ+mmlumhtScsXG4gICAgICByb290OiAnI2hvbWUnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ+S8geS4mui0p+aetueuoeeQhicsXG4gICAgICBhY3RpdmU6IHRydWVcbiAgICB9XTtcbiAgICAkc2NvcGUucGljVXJsID0gd2luZG93LmNmZy5waWNVcmw7XG4gICAgdmFyIGRlZmF1bHRTaGVsZiA9IHsgZGVzYzogJ+aaguaXoOi0p+aeticgfTtcbiAgICAkc2NvcGUuY3VyU2hlbGYgPSBkZWZhdWx0U2hlbGY7XG4gICAgJHNjb3BlLmNvbXBhbnk7XG4gICAgJHNjb3BlLnNoZWxmTGlzdCA9IFtdO1xuICAgICRzY29wZS5zaGVsZlR5cGVMaXN0ID0gQ09OU1RBTlRTLmdldExpc3QoJ1NIRUxGX1RZUEUnLCBmYWxzZSwgJycsICcnLFxuICAgICAgbnVsbCwgdHJ1ZSk7XG4gICAgdmFyIHNhbGVzQ2hhcnREYXlzID0gMTQ7XG5cbiAgICB2YXIgaW5pdFZpZXcgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBleGNlbFRlbXBsYXRlID0gJGNvbXBpbGUoJHRlbXBsYXRlQ2FjaGUuZ2V0KFxuICAgICAgICAnc2hlbGZtYW5hZ2Uvc2hlbGZQcm9kdWN0c1RlbXBsYXRlLmh0bWwnKSkoJHNjb3BlKTtcbiAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0RXhjZWxXcmFwJykpLmFwcGVuZChcbiAgICAgICAgZXhjZWxUZW1wbGF0ZSk7XG4gICAgfTtcbiAgICBpbml0VmlldygpO1xuICAgICRzY29wZS5zZWxlY3RDb21wYW55Q2FsbGJhY2sgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAkc2NvcGUuY29tcGFueSA9IGNvbXBhbnk7XG4gICAgICAkc2NvcGUucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnkoY29tcGFueSk7XG4gICAgfTtcbiAgICAkc2NvcGUucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnkgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAkc2NvcGUuc2hlbGZMaXN0ID0gW107XG4gICAgICB2YXIgcXVlcnlQYXJhbXMgPSB7IGNvbXBhbnlJZDogY29tcGFueS5jb21wYW55SWQgfTtcbiAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmTGlzdEJ5Q29tcGFueUlkKHF1ZXJ5UGFyYW1zKS50aGVuKGZ1bmN0aW9uKFxuICAgICAgICByZXMpIHtcbiAgICAgICAgaWYgKHJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHJlcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgICAgdmFyIHQgPSBpdGVtO1xuICAgICAgICAgICAgdC5kZXNjID0gaXRlbS5zaGVsZk5hbWU7XG4gICAgICAgICAgICAkc2NvcGUuc2hlbGZMaXN0LnB1c2godCk7XG4gICAgICAgICAgICBpZiAoaSA9PSAwKSB7XG4gICAgICAgICAgICAgICRzY29wZS5jdXJTaGVsZiA9IHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc2NvcGUuY3VyU2hlbGYgPSBkZWZhdWx0U2hlbGY7XG4gICAgICAgICAgJHNjb3BlLnNoZWxmUHJvZHVjdHMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuc2VsZWN0U2hlbGZDYWxsYmFjayA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICRzY29wZS5jdXJTaGVsZiA9IGl0ZW07XG4gICAgICBpZiAodHlwZW9mIGl0ZW0uaWQgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIHF1ZXJ5UGFyYW1zID0geyBzaGVsZklkOiBpdGVtLmlkIH07XG4gICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZlByb2R1Y3N0c0J5U2hlbGZJZChxdWVyeVBhcmFtcykudGhlbihcbiAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgdmFyIHNoZWxmUHJvZHVjdHMgPSBzaGVsZlNlcnZpY2UuX3BhcnNlU2hlbGZQcm9kdWN0c0RhdGEoXG4gICAgICAgICAgICByZXMpO1xuICAgICAgICAgICRzY29wZS5zaGVsZlByb2R1Y3RzID0gc2hlbGZQcm9kdWN0cztcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8v6I635Y+W5L2N572u5L+h5oGvXG4gICAgJHNjb3BlLmdldFBvc2l0aW9uTmFtZSA9IGZ1bmN0aW9uKHNoZWxmUHJvZHVjdCkge1xuICAgICAgdmFyIGN1clNoZWxmVHlwZSA9ICRzY29wZS5jdXJTaGVsZi5zaGVsZlR5cGU7XG4gICAgICB2YXIgbWFya3MgPSBbJ0EnLCAnQicsICdDJywgJ0QnLCAnRSddO1xuICAgICAgdmFyIHBvc2l0aW9uTmFtZSA9IHNoZWxmUHJvZHVjdC5oZWFkZXIucm93ID09IDUgJiYgY3VyU2hlbGZUeXBlID09XG4gICAgICAgIENPTlNUQU5UUy5TSEVMRl9UWVBFLlNOQUNLUyA/XG4gICAgICAgICfppa7mlpnmoI8vJyArIHNoZWxmUHJvZHVjdC5oZWFkZXIuY29sIDpcbiAgICAgICAgJ+esrCcgKyBzaGVsZlByb2R1Y3QuaGVhZGVyLnJvdyArICflsYIvJyArIG1hcmtzW3NoZWxmUHJvZHVjdC5oZWFkZXJcbiAgICAgICAgICAucm93IC0gMV0gKyBzaGVsZlByb2R1Y3QuaGVhZGVyLmNvbDtcbiAgICAgIHJldHVybiBwb3NpdGlvbk5hbWU7XG4gICAgfTtcblxuICAgIC8q566h55CG6LSn5p62IG1vZGFs55u45YWzKi9cbiAgICAvL+euoeeQhui0p+aetlxuICAgICRzY29wZS5tYW5hZ2VTaGVsZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLmNyZWF0ZVNoZWxmT2JqID0ge307XG4gICAgICAkc2NvcGUucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnkoJHNjb3BlLmNvbXBhbnkpO1xuICAgICAgJHNjb3BlLm1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAnc2hlbGYtbWFuYWdlJykpLFxuICAgICAgICBzY29wZTogJHNjb3BlXG4gICAgICB9KTtcbiAgICB9O1xuICAgICRzY29wZS5nZXREZWZhdWx0U2hlbGZUeXBlID0gZnVuY3Rpb24oc2hlbGYpIHtcbiAgICAgIGlmICh0eXBlb2Ygc2hlbGYgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIF8uZmluZFdoZXJlKCRzY29wZS5zaGVsZlR5cGVMaXN0LCB7IGNvZGU6IHNoZWxmLnNoZWxmVHlwZSB9KSB8fFxuICAgICAgICAgICRzY29wZS5zaGVsZlR5cGVMaXN0WzBdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICRzY29wZS5zaGVsZlR5cGVMaXN0WzBdO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLnNlbGVjdFNoZWxmVHlwZUNhbGxiYWNrID0gZnVuY3Rpb24oaXRlbSwgc2hlbGYpIHtcbiAgICAgIGlmICh0eXBlb2Ygc2hlbGYgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgc2hlbGYuc2hlbGZUeXBlID0gaXRlbS5jb2RlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmNyZWF0ZVNoZWxmT2JqLnNoZWxmVHlwZSA9IGl0ZW0uY29kZTtcbiAgICAgIH1cblxuICAgIH07XG4gICAgLy/mlrDlu7rotKfmnrZcbiAgICAkc2NvcGUuY3JlYXRlU2hlbGYgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgc2hlbGYgPSAkc2NvcGUuY3JlYXRlU2hlbGZPYmo7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBzaGVsZk5hbWU6IHNoZWxmLnNoZWxmTmFtZSxcbiAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuY29tcGFueS5jb21wYW55SWQsXG4gICAgICAgIHNoZWxmVHlwZTogc2hlbGYuc2hlbGZUeXBlXG4gICAgICB9O1xuICAgICAgc2hlbGZTZXJ2aWNlLmNyZWF0ZVNoZWxmKHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5U2hlbGZMaXN0QnlDb21wYW55KCRzY29wZS5jb21wYW55KTtcbiAgICAgICAgZS50YXJnZXQucmVzZXQoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLy/mm7TmlrDotKfmnrZcbiAgICAkc2NvcGUubW9kaWZ5U2hlbGYgPSBmdW5jdGlvbihzaGVsZikge1xuICAgICAgaWYgKHNoZWxmLm51bWJlciA9PSAwKSB7XG4gICAgICAgIGFsZXJ0KCfotKfmnrbnvJblj7fpnIDkuLrlpKfkuo4w55qE5pW05pWwJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIHNoZWxmTmFtZTogc2hlbGYuc2hlbGZOYW1lLFxuICAgICAgICBzaGVsZklkOiBzaGVsZi5pZCxcbiAgICAgICAgc2hlbGZUeXBlOiBzaGVsZi5zaGVsZlR5cGUsXG4gICAgICAgIG51bWJlcjogc2hlbGYubnVtYmVyXG4gICAgICB9O1xuICAgICAgc2hlbGZTZXJ2aWNlLm1vZGlmeVNoZWxmKHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5U2hlbGZMaXN0QnlDb21wYW55KCRzY29wZS5jb21wYW55KTtcbiAgICAgICAgc2hlbGYuaW5FZGl0ID0gIXNoZWxmLmluRWRpdDtcbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8q6ZSA6YeP6LWw5Yq/5Zu+IG1vZGFs55u45YWzKi9cbiAgICAkc2NvcGUuY2hlY2tTYWxlc0NoYXJ0ID0gZnVuY3Rpb24oc2hlbGZQcm9kdWN0SWQpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7IHNoZWxmUHJvZHVjdElkOiBzaGVsZlByb2R1Y3RJZCwgZGF5czogc2FsZXNDaGFydERheXMgfTtcbiAgICAgIHNoZWxmU2VydmljZS5xdWVyeVNoZWxmUHJvZHVjdFRyZW5kKHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgdmFyIHhBeGlzRGF0YVRtcCA9IFtdO1xuICAgICAgICB2YXIgc2VyaWVzRGF0YVRtcCA9IFtdO1xuICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzLmNvbnRlbnQsIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgICB4QXhpc0RhdGFUbXAucHVzaChpdGVtLmRhdGUuc3Vic3RyaW5nKDUsIGl0ZW0uZGF0ZS5sZW5ndGgpKTtcbiAgICAgICAgICBzZXJpZXNEYXRhVG1wLnB1c2goaXRlbS5zYWxlcyk7XG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUueEF4aXNEYXRhID0geEF4aXNEYXRhVG1wO1xuICAgICAgICAkc2NvcGUuc2VyaWVzRGF0YSA9IHNlcmllc0RhdGFUbXA7XG4gICAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAgICdzaGVsZi1tYW5hZ2UnKSksXG4gICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZGFsU2FsZXNMaW5lJyxcbiAgICAgICAgICBzaXplOiAnbGcnXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICB9O1xuXG4gICAgLyrllYblk4Hor6bmg4UgbW9kYWznm7jlhbMqL1xuICAgICRzY29wZS5jaGVja1Byb2R1Y3REZXRhaWwgPSBmdW5jdGlvbihzaGVsZlByb2R1Y3QpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7IHNoZWxmUHJvZHVjdElkOiBzaGVsZlByb2R1Y3QuaGVhZGVyLmlkIH07XG4gICAgICBzaGVsZlNlcnZpY2UucXVlcnlTaGVsZlByb2R1Y3REZXRhaWwocGFyYW1zKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUuY3VyUHJvZHVjdCA9IHJlcztcbiAgICAgICAgJHNjb3BlLm1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgJ3NoZWxmLW1hbmFnZScpKSxcbiAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWxQcm9kdWN0RGV0YWlsJyxcbiAgICAgICAgICBzaXplOiAnbGcnXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvL+i0p+aetuS/oeaBr+WvvOWHukV4Y2VsXG4gICAgJHNjb3BlLmV4cG9ydFNoZWxmUHJvZHVjdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRvbSA9IGFuZ3VsYXIuZWxlbWVudCgnPGE+PC9hPicpO1xuICAgICAgICBkb21bMF0uaHJlZiA9ICQoJyNzaGVsZi1wcm9kdWN0cy10YWJsZScpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICAgIGNvbnRhaW5lcmlkOiBcInNoZWxmLXByb2R1Y3RzLXRhYmxlXCIsXG4gICAgICAgICAgZGF0YXR5cGU6ICd0YWJsZScsXG4gICAgICAgICAgcmV0dXJuVXJpOiAndHJ1ZSdcbiAgICAgICAgfSk7XG4gICAgICAgIGRvbVswXS5kb3dubG9hZCA9ICRzY29wZS5jb21wYW55LmNvbXBhbnlOYW1lICsgJy0nICsgJHNjb3BlXG4gICAgICAgICAgLmN1clNoZWxmLnNoZWxmTmFtZSArICctJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZShcbiAgICAgICAgICAgIG5ldyBEYXRlKCksICd5eXl5TU1kZGhobW1zcycpICsgJy54bHMnO1xuICAgICAgICBkb21bMF0uY2xpY2soKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgfSk7XG59OyIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzExLzI0LlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcignc3VpdGVDZmdNYW5hZ2UnLCBmdW5jdGlvbiAoJHNjb3BlLCBOZ1RhYmxlUGFyYW1zLCAkdWliTW9kYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsU2VydmljZSwgc3VpdGVTZXJ2aWNlLCB1dGlsU2VydmljZSwgQ09OU1RBTlRTLCBwcm9kdWN0U2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJTZXJ2aWNlKSB7XG5cbiAgICAgICAgJHNjb3BlLk9SREVSX1NUQVRVUyA9IENPTlNUQU5UUy5PUkRFUl9TVEFUVVM7IC8v6K6i5Y2V54q25oCBXG4gICAgICAgICRzY29wZS5TVUlURV9UWVBFID0gQ09OU1RBTlRTLlNVSVRFX1RZUEU7IC8vIOWll+mkkOexu+Wei1xuICAgICAgICAkc2NvcGUuSVNTVUVfU1RBVFVTID0gQ09OU1RBTlRTLklTU1VFX1NUQVRVUzsgLy/mnJ/lj7fnirbmgIFcbiAgICAgICAgJHNjb3BlLlNVSVRFX1NUQVRVUyA9IENPTlNUQU5UUy5TVUlURV9TVEFUVVM7IC8v5aWX6aSQ54q25oCBXG4gICAgICAgICRzY29wZS5pbWdQcmVmaXggPSB3aW5kb3cuY2ZnLnBpY1VybDtcbiAgICAgICAgJHNjb3BlLnBpY1VybCA9IHdpbmRvdy5jZmcucGljVXJsO1xuICAgICAgICAkc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgJHNjb3BlLmltZ1NpemVMaW1pdCA9IHtcbiAgICAgICAgICAgIC8vIHNpemU6IDUwMCAqIDEwMjQsXG4gICAgICAgICAgICB3aWR0aDogNzUwLFxuICAgICAgICAgICAgLy8gaGVpZ2h0OiA0MjBcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmlzcyA9IHt9O1xuICAgICAgICAkc2NvcGUuX3N1aXRlID0ge307XG4gICAgICAgICRzY29wZS5jU3VpdGUgPSB7fTtcblxuICAgICAgICAvL+a4heepuuaXtumXtFxuICAgICAgICAkc2NvcGUuY2xlYXJEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5SXNzdWVQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgZnJvbTogJycsXG4gICAgICAgICAgICAgICAgdG86ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIOWumuS5ieacn+WPt+Wvueixoe+8jOe7hOWQiOWIm+W7uuacn+WPt+aVsOaNrlxuICAgICAgICAkc2NvcGUucSA9IHtcbiAgICAgICAgICAgIHN1aXRlczogW10sXG4gICAgICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VpdGVzID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5mcm9tID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHRoaXMudG8gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS50ID0ge307XG4gICAgICAgICRzY29wZS5xdWVyeUlzc3VlUGFyYW1zID0ge1xuICAgICAgICAgICAgZnJvbTogJycsXG4gICAgICAgICAgICB0bzogJycsXG4gICAgICAgICAgICBzb3J0VHlwZTogJydcbiAgICAgICAgfTtcbiAgICAgICAgLy/liJvlu7rmnJ/lj7cgLS0+5a2Y5YKo5aWX6aSQ55qEdGFibGVcbiAgICAgICAgJHNjb3BlLmlzc3VlVGFibGVEYXRhID0gW107XG4gICAgICAgICRzY29wZS5zdWl0ZU9mSXNzdWVUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgIGNvdW50OiAxMDAwMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgZGF0YXNldDogJHNjb3BlLmlzc3VlVGFibGVEYXRhXG4gICAgICAgIH0pO1xuICAgICAgICAvL+WIm+W7uuWll+mkkCAtLT7lrZjlgqjllYblk4HnmoR0YWJsZVxuICAgICAgICAkc2NvcGUucHJvZHVjdFRhYmxlRGF0YSA9IFtdO1xuICAgICAgICAkc2NvcGUucHJvZHVjdFRhYmxlID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgY291bnQ6IDEwMDAwXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvdW50czogW10sXG4gICAgICAgICAgICBkYXRhc2V0OiAkc2NvcGUucHJvZHVjdFRhYmxlRGF0YVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuX3N1aXRlVHlwZSA9IHt9O1xuICAgICAgICAkc2NvcGUuX3N1aXRlU3RhdHVzID0ge307XG5cbiAgICAgICAgLy/lr7zlh7pleGNlbOmAieaLqeeahOaVsOaNrlxuICAgICAgICAkc2NvcGUuc3VpdGVTZWxlY3RlZEFycmF5ID0gW107XG4gICAgICAgICRzY29wZS5zdWl0ZUNoZWNrQWxsQ2ZnID0ge1xuICAgICAgICAgICAgZmxhZzogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnN1aXRlRXhwb3J0VGFibGVQYXJhbXMgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgICAgICBjb3VudDogMjVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgIGRhdGFzZXQ6ICRzY29wZS5zdWl0ZVNlbGVjdGVkQXJyYXlcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyDojrflj5bmnJ/lj7fliJfooag6IFtHRVRdIGJhY2tlbmQvaXNzdWU/b2Zmc2V0PTAmbGltaXQ9MjAmc3RhdHVzPTAmZnJvbT0xNDgwNTIxNjAwMDAwJnRvPTE0ODEzMjgwMDAwMDBcbiAgICAgICAgJHNjb3BlLmlzc3VlQ2ZnTWFuYWdlTGlzdCA9IGZ1bmN0aW9uIChxdWVyeVBhcmFtcykge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXMgPSBxdWVyeVBhcmFtcyB8fCAkc2NvcGUucXVlcnlJc3N1ZVBhcmFtcztcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgICAgICAgICAkc2NvcGUuaXNzdWVUYWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAyMCxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHAgPSBhbmd1bGFyLmV4dGVuZChwLCBxdWVyeVBhcmFtcyB8fCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcC5mcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gXy5vbWl0KHAsICdmcm9tJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwLnRvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gXy5vbWl0KHAsICd0bycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWl0ZVNlcnZpY2UuZ2V0QWxsSXNzdWVMaXN0KGFuZ3VsYXIuY29weShwKSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMudG90YWwocmVzLnRvdGFsRWxlbWVudHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoZWNrSW5mbyh1dGlsU2VydmljZS5pbmRleEFycmF5KHJlcy5jb250ZW50LCAkc2NvcGUubGltaXQgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYXJhbXMucGFnZSgpIC0gMSkgKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLy8g5pyf5Y+36K6i5Y2V54q25oCBXG4gICAgICAgICRzY29wZS5pc3N1ZVN0YXR1c0xpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgICBjbHNPck5hbWU6ICdJU1NVRV9TVEFUVVMnLFxuICAgICAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICAgICAgICcnOiAn5YWo6YOoJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLmV4cG9ydEV4Y2VsID0gZnVuY3Rpb24gKGNvbnRhaW5lcklkLCB0aXRsZSwgYXJyYXlTdHIpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGVbYXJyYXlTdHJdLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG9yZGVyU2VydmljZS5mb3JtRXhjZWwoY29udGFpbmVySWQsIHRpdGxlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KCfor7fpgInmi6nlr7zlh7rpobknKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY3JlYXRlSXNzdWVNb2RhbDtcbiAgICAgICAgJHNjb3BlLnJlc2V0SXNzdWVGb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmlzcyA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlT2ZJc3N1ZVRhYmxlLnNldHRpbmdzKCkuZGF0YXNldCA9IFtdO1xuICAgICAgICB9O1xuICAgICAgICAvLyDliJvlu7rmnJ/lj7dcbiAgICAgICAgJHNjb3BlLmNyZWF0ZUlzc3VlID0gZnVuY3Rpb24gKGlzcykge1xuICAgICAgICAgICAgJHNjb3BlLnJlc2V0SXNzdWVGb3JtKCk7XG4gICAgICAgICAgICAkc2NvcGUuY3JlYXRlSXNzdWVNb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1aXRlQ2ZnTWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9jcmVhdGVJc3N1ZVRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuICAgICAgICAvLyDmiZPljbDljZXmja7liJfooahcbiAgICAgICAgJHNjb3BlLmlzc3VlU2VsZWN0ZWRBcnJheSA9IFtdO1xuICAgICAgICAkc2NvcGUuaXNzdWVFeHBvcnRUYWJsZVBhcmFtcyA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgIGNvdW50OiAyNVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgZGF0YXNldDogJHNjb3BlLmlzc3VlU2VsZWN0ZWRBcnJheVxuICAgICAgICB9KTtcblxuICAgICAgICAvL+WIm+W7uuacn+WPtyAtLT4g5re75Yqg5aWX6aSQXG4gICAgICAgICRzY29wZS5hZGRTdWl0ZU9mSXNzdWUgPSBmdW5jdGlvbiAoYWRkSXNzdWUpIHtcbiAgICAgICAgICAgIGlmIChhZGRJc3N1ZSAhPSBudWxsICYmIGFkZElzc3VlICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGFkZElzc3VlICE9ICcnKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0ge2lkOiBhZGRJc3N1ZS5zdWl0ZUlkfTtcbiAgICAgICAgICAgICAgICBzdWl0ZVNlcnZpY2UuZ2V0U3VpdGUocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gODAyMDA3NDE3ODU5NjA0NDgwXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgPT0gXCJcIiB8fCByZXMgPT0gdW5kZWZpbmVkIHx8IHJlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn5aWX6aSQ5LiN5a2Y5Zyo5oiW6ICF5aWX6aSQSUTmnInor6/vvIzor7fmm7TmjaLlpZfppJBJROOAgicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5zdWl0ZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXMuc3VpdGUuc3VpdGVJZCA9IHJlcy5zdWl0ZS5pZDtcbiAgICAgICAgICAgICAgICAgICAgLy/mlbDmja7mupAgJGRhdGEgIGRhdGFzZXRcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1aXRlT2ZJc3N1ZVRhYmxlLnNldHRpbmdzKCkuZGF0YXNldC5zcGxpY2UoMCwgMCwgcmVzKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gJHNjb3BlLnN1aXRlT2ZJc3N1ZVRhYmxlLnNldHRpbmdzKCkuZGF0YXNldC5wdXNoKHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWl0ZU9mSXNzdWVUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXNzdWUuc3VpdGVJZCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAvLyDmlbDmja7mupAgcS5zdWl0ZXNcbiAgICAgICAgICAgICAgICAgICAgLypzdWl0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAqYWN0aXZlOiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbGVydCgn6K+36L6T5YWl5aWX6aSQSUQhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8g5Yib5bu65pyf5Y+3IC0tPiDlj5jmm7Tlt7Lmt7vliqDnmoTlpZfppJDnirbmgIFcblxuICAgICAgICAkc2NvcGUuY2hhbmdlU3VpdGVPZklzc3VlU3RhdHVzID0gZnVuY3Rpb24gKGlzcykge1xuICAgICAgICAgICAgaXNzLmFjdGl2ZSA9ICFpc3MuYWN0aXZlO1xuICAgICAgICAgICAgaWYgKCRzY29wZS5pc3MuaXNzdWUpIHtcbiAgICAgICAgICAgICAgICBzdWl0ZVNlcnZpY2UudXBkYXRlSXNzdWUoJHNjb3BlLmlzcy5pc3N1ZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8g5Yib5bu65pyf5Y+3IC0tPiDliKDpmaTlt7Lmt7vliqDnmoTlpZfppJAgaXNzXG4gICAgICAgICRzY29wZS5kZWxldGVTdWl0ZU9mSXNzdWUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHRoaXMuc3VpdGVPZklzc3VlVGFibGUuc2V0dGluZ3MoKS5kYXRhc2V0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLnN1aXRlT2ZJc3N1ZVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIOacn+WPt+mFjee9ri0tPiDnvJbovpEgLS0+IOWIoOmZpOW3sua3u+WKoOeahOWll+mkkCBpc3NcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUVkaXRvclN1aXRlT2ZJc3N1ZSA9IGZ1bmN0aW9uIChpc3MsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZGVsU3VpdGVJZCA9IGlzcy5zdWl0ZUlkO1xuICAgICAgICAgICAgJHNjb3BlLmlzcy5pc3N1ZS5zdWl0ZXMgPSBfLnJlamVjdCgkc2NvcGUuaXNzLmlzc3VlLnN1aXRlcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5zdWl0ZUlkID09IGRlbFN1aXRlSWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN1aXRlU2VydmljZS51cGRhdGVJc3N1ZSgkc2NvcGUuaXNzLmlzc3VlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNzdWVDZmdNYW5hZ2VMaXN0KCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1aXRlT2ZJc3N1ZVRhYmxlLnNldHRpbmdzKCkuZGF0YXNldCA9ICRzY29wZS5pc3Muc3VpdGUuc3VpdGVzO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnN1aXRlT2ZJc3N1ZVRhYmxlLnNldHRpbmdzKCkuZGF0YXNldC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy5zdWl0ZU9mSXNzdWVUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmlzc3VlU3RhdHVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5pc3N1ZUNmZ01hbmFnZUxpc3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5jb2RlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNoZWNrSW5mbyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdCA9IF8uZmluZFdoZXJlKCRzY29wZS5pc3N1ZVNlbGVjdGVkQXJyYXksIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaXNzdWUuaWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5pc3N1ZUNoZWNrQWxsQ2ZnID0ge1xuICAgICAgICAgICAgZmxhZzogZmFsc2VcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudXBkYXRlSXNzdWVFeHBvcnRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5pc3N1ZUV4cG9ydFRhYmxlUGFyYW1zLnNldHRpbmdzKCkuZGF0YXNldCA9ICRzY29wZS5pc3N1ZVNlbGVjdGVkQXJyYXk7XG4gICAgICAgICAgICAkc2NvcGUuaXNzdWVFeHBvcnRUYWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8g5Yu+6YCJXG4gICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24gPSBmdW5jdGlvbiAoZSwgaXRlbSwgc2VsZWN0ZWRBcnJheVN0ciwgY2hlY2tBbGxDZmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoXy5pc09iamVjdChlKSkge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gaXNDaGVja2VkO1xuICAgICAgICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAgICAgICAgICRzY29wZVtzZWxlY3RlZEFycmF5U3RyXS5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlW3NlbGVjdGVkQXJyYXlTdHJdID0gXy53aXRob3V0KCRzY29wZVtzZWxlY3RlZEFycmF5U3RyXSwgaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjay5jYWxsKCk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RBbGxPcmRlciA9IGZ1bmN0aW9uIChlLCBkYXRhLCBzZWxlY3RlZEFycmF5U3RyLCBmbGFnLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIHN0ID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkICE9PSBzdCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uKGUuY3VycmVudFRhcmdldC5jaGVja2VkLCBpdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRBcnJheVN0cixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/nvJbovpHmnJ/lj7dcbiAgICAgICAgJHNjb3BlLmVkaXRJc3N1ZSA9IGZ1bmN0aW9uIChpc3MpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXNldElzc3VlRm9ybSgpO1xuICAgICAgICAgICAgJHNjb3BlLmlzcyA9IGlzcztcbiAgICAgICAgICAgIHN1aXRlU2VydmljZS5nZXRJc3N1ZSh7XG4gICAgICAgICAgICAgICAgaWQ6IGlzcy5pc3N1ZS5pZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzcy5pc3N1ZSA9IHJlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VpdGVDZmdNYW5hZ2UnKSksXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3VpdGUvY3JlYXRlSXNzdWVUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8g5Yib5bu65pyf5Y+3IC0tPiDkv53lrZhcbiAgICAgICAgJHNjb3BlLnNhdmVJc3N1ZSA9IGZ1bmN0aW9uIChpc3MsIGFjdGl2ZSkge1xuICAgICAgICAgICAgdmFyIHN1aXRlcyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5zdWl0ZU9mSXNzdWVUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQsIGZ1bmN0aW9uIChzdWl0ZSkge1xuICAgICAgICAgICAgICAgIHN1aXRlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgc3VpdGVJZDogc3VpdGUuc3VpdGUuaWQsXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZTogc3VpdGUuc3VpdGUuYWN0aXZlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN1aXRlU2VydmljZS5jcmVhdGVJc3N1ZSh7XG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiAkc2NvcGUucS5zdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgZW5kVGltZTogJHNjb3BlLnEuZW5kVGltZSArIDg2Mzk5MDAwLFxuICAgICAgICAgICAgICAgIHN1aXRlczogc3VpdGVzLFxuICAgICAgICAgICAgICAgIHB1Ymxpc2hJbW1lZGlhdGVseTogYWN0aXZlXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLnN1aXRlcy5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfkuI3lj6/ku6XliJvlu7rnqbrnmoTmnJ/lj7fvvIzor7fmt7vliqDlpZfppJDjgIInKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVJc3N1ZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzc3VlQ2ZnTWFuYWdlTGlzdCgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5xLnJlc2V0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaXNzdWVDZmdNYW5hZ2VMaXN0KCk7XG5cbiAgICAgICAgLy/mnJ/lj7fphY3nva4gLS0+IOaOkuW6j1xuICAgICAgICAkc2NvcGUuc29ydEJ5SXNzdWUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5SXNzdWVQYXJhbXMuc29ydFR5cGUgPSBpdGVtLnNvcnRDb2RlO1xuICAgICAgICAgICAgJHNjb3BlLmlzc3VlQ2ZnTWFuYWdlTGlzdCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq5aWX6aSQKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgJHNjb3BlLnN1aXRlUXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBzb3J0VHlwZTogJycsXG4gICAgICAgICAgICB0eXBlOiAnJyxcbiAgICAgICAgICAgIHN0YXR1czogJycsXG4gICAgICAgICAgICAvLyBpZDogJydcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmRpc2FibGVFZGl0ID0gZmFsc2U7IC8v6buY6K6k5LiN5YWB6K645pON5L2cXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDojrflj5blpZfppJDliJfooagoU3VpdGVXaXRoU3RhdGlzdGljc1tdKTogW0dFVF0gL2JhY2tlbmQvc3VpdGU/b2Zmc2V0PTAmbGltaXQ9MjAmdHlwZT0wJnN0YXR1cz0wJmlkPXtpZH1cbiAgICAgICAgICogW0ZpbHRlciBQYXJhbXM6IHR5cGUoTk9ORSwwLDEpLCBzdGF0dXMoTk9ORSwwLDEpLCBpZChOT05FLHtpZH0pXVxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnN1aXRlQ2ZnTWFuYWdlTGlzdCA9IGZ1bmN0aW9uIChzdWl0ZVF1ZXJ5UGFyYW1zKSB7XG4gICAgICAgICAgICAkc2NvcGUub2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICRzY29wZS5saW1pdCA9IDIwO1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlT2ZJc3N1ZVRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc29ydFR5cGU6ICRzY29wZS5zdWl0ZVF1ZXJ5UGFyYW1zLnNvcnRUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJHNjb3BlLl9zdWl0ZVR5cGUuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogJHNjb3BlLl9zdWl0ZVN0YXR1cy5jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICRzY29wZS5zdWl0ZVF1ZXJ5UGFyYW1zLnN1aXRlSWRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1aXRlU2VydmljZS5nZXRBbGxTdWl0ZUxpc3QoYW5ndWxhci5jb3B5KHApKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tTdWl0ZUluZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5saW1pdCAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhcmFtcy5wYWdlKCkgLSAxKSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnN1aXRlQ2ZnTWFuYWdlTGlzdCgpO1xuXG4gICAgICAgICRzY29wZS51cGRhdGVTdWl0ZUV4cG9ydFRhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlRXhwb3J0VGFibGVQYXJhbXMuc2V0dGluZ3MoKS5kYXRhc2V0ID0gJHNjb3BlLnN1aXRlU2VsZWN0ZWRBcnJheTtcbiAgICAgICAgICAgICRzY29wZS5zdWl0ZUV4cG9ydFRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY2hlY2tTdWl0ZUluZm8gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBfLmZpbmRXaGVyZSgkc2NvcGUuc3VpdGVTZWxlY3RlZEFycmF5LCB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLnN1aXRlSWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgIC8vIOWIm+W7uuWll+mkkFxuICAgICAgICAkc2NvcGUuX2NyZWF0ZVN1aXRlID0gZnVuY3Rpb24gKF9zdWl0ZSkge1xuICAgICAgICAgICAgJHNjb3BlLmltYWdlcy5pbWdEZXRhaWxzPVtdO1xuICAgICAgICAgICAgJHNjb3BlLmRpc2FibGVFZGl0ID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUucHJvZHVjdFRhYmxlLnNldHRpbmdzKCkuZGF0YXNldCA9IFtdO1xuICAgICAgICAgICAgaWYgKF9zdWl0ZSkgeyAvL+WkjeWItlxuICAgICAgICAgICAgICAgIC8v5ou/5Yiw6L2s5o2i5ZCO55qEIGltYWdlcy5pbWdEZXRhaWxzXG4gICAgICAgICAgICAgICAgJHNjb3BlLmltYWdlcy5pbWdEZXRhaWxzID0gc3VpdGVTZXJ2aWNlLl9nZXRJbWFnZURldGFpbHMoX3N1aXRlLnN1aXRlLmltYWdlcyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNTdWl0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgYmFubmVyOiBfc3VpdGUuc3VpdGUuYmFubmVyLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBfc3VpdGUuc3VpdGUudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IF9zdWl0ZS5zdWl0ZS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZGVzOiBfc3VpdGUuc3VpdGUuZGVzLFxuICAgICAgICAgICAgICAgICAgICBzaG93UHJvZHVjdHM6ICFfc3VpdGUuc3VpdGUuc2hvd1Byb2R1Y3RzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoX3N1aXRlLnN1aXRlLnR5cGUgPT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNTdWl0ZS5mZWF0dXJlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChfc3VpdGUuc3VpdGUudHlwZSA9PSBcIjFcIikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY1N1aXRlLnN0YW5kYXJkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKF9zdWl0ZS5zdWl0ZS5wcm9kdWN0SWRzLCBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEJ5UHJvZHVjdElkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgeyAvL+aWsOWinlxuICAgICAgICAgICAgICAgICRzY29wZS5jU3VpdGUgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1aXRlQ2ZnTWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9jcmVhdGVTdWl0ZVRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/mt7vliqDlm77niYdcbiAgICAgICAgJHNjb3BlLmltYWdlcyA9IHtcbiAgICAgICAgICAgIGltZ0RldGFpbHM6IFtdLFxuICAgICAgICAgICAgZGVzSW1nRGV0YWlsczogW11cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGdldEltZ3MgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgdmFyIGltZ3MgPSB0eXBlID09IDEgPyAkc2NvcGUuaW1hZ2VzLmltZ0RldGFpbHMgOiAkc2NvcGUuaW1hZ2VzXG4gICAgICAgICAgICAgICAgLmRlc0ltZ0RldGFpbHM7XG4gICAgICAgICAgICByZXR1cm4gaW1ncztcbiAgICAgICAgfTtcbiAgICAgICAgLy/kuIrkvKDlrozlm77niYdcbiAgICAgICAgJHNjb3BlLmRpZFVwbG9hZEltZyA9IGZ1bmN0aW9uIChmaWxlLCB0eXBlKSB7XG4gICAgICAgICAgICB2YXIgaW1ncyA9IGdldEltZ3ModHlwZSk7XG4gICAgICAgICAgICBmaWxlLmluZGV4ID0gaW1ncy5sZW5ndGggPyBfLm1heChpbWdzLCBmdW5jdGlvbiAoaW1nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGltZy5pbmRleDtcbiAgICAgICAgICAgIH0pLmluZGV4ICsgMSA6IDE7XG4gICAgICAgICAgICBpbWdzLnB1c2goZmlsZSk7XG4gICAgICAgIH07XG4gICAgICAgIC8v6L2u5pKt5Zu+5o6S5bqPXG4gICAgICAgICRzY29wZS5zb3J0SW1ncyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICB2YXIgaW1ncyA9IGdldEltZ3ModHlwZSk7XG4gICAgICAgICAgICBpbWdzID0gXy5zb3J0QnkoaW1ncywgZnVuY3Rpb24gKGltZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbWcuaW5kZXg7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0eXBlID09IDEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW1hZ2VzLmltZ0RldGFpbHMgPSBpbWdzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW1hZ2VzLmRlc0ltZ0RldGFpbHMgPSBpbWdzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvL+mihOiniOWbvueJh1xuICAgICAgICAkc2NvcGUuaW1nUHJldmlldyA9IGZ1bmN0aW9uKGltZykge1xuICAgICAgICAgICAgJHNjb3BlLnByZXZpZXdJbWcgPSBpbWc7XG4gICAgICAgICAgICBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAgICAgICAgICdzdWl0ZUNmZ01hbmFnZScpKSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2ltZ1ByZXZpZXdlcicsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICBzaXplOiAnbGcnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/liKDpmaTlm77niYdcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUltZyA9IGZ1bmN0aW9uKGksIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBpbWdzID0gZ2V0SW1ncyh0eXBlKTtcbiAgICAgICAgICAgIGltZ3Muc3BsaWNlKGksIDEpO1xuICAgICAgICB9O1xuICAgICAgICAvL+mqjOivgeS/neWtmOWVhuWTgeacieaViOaAp1xuICAgICAgICB2YXIgY2hlY2tTYXZlUHJvZHVjdEltZyA9IGZ1bmN0aW9uIChpbWFnZXMpIHtcbiAgICAgICAgICAgIHZhciBlcnJvck1zZyA9ICcnO1xuICAgICAgICAgICAgaWYgKGltYWdlcy5sZW5ndGggPT0gMCkgeyAvL+acquS4iuS8oOWVhuWTgei9ruaSreWbvlxuICAgICAgICAgICAgICAgIC8vIGVycm9yTXNnID0gJ+ivt+S4iuS8oOWVhuWTgei9ruaSreWbvic7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+ivt+a3u+WKoOWbvueJhycpO1xuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVycm9yTXNnLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHV0aWxTZXJ2aWNlLmFsZXJ0RXJyb3IoZXJyb3JNc2cpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAvL+WIm+W7uuWll+mkkCAtLT4g5re75YqgIFNrdUNvZGVcbiAgICAgICAgJHNjb3BlLmFkZEJ5U2t1Q29kZSA9IGZ1bmN0aW9uIChhZGRQcm9kdWN0KSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLnByb2R1Y3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQubGVuZ3RoID49IDE1KSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+WVhuWTgeaVsOmHj+i/h+Wkmizor7fphYzmg4Xmt7vliqDjgIIo5Y+v5re75Yqg5ZWG5ZOB5pWw6YeP5pyA5aSa5LiN6IO95aSn5LqOMTXkuKopJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/mn6Xmib7mlbDnu4TkuIvpnaLmn5DkuKrlsZ7mgKfnmoTlgLxcbiAgICAgICAgICAgIC8vIHZhciB0ID0gXy5maW5kKHByb2R1Y3REYXRhLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiBpdGVtLmhlYWRlci5pZCA9PSBhZGRQcm9kdWN0LnByb2R1Y3RJZDtcbiAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgLyppZiAodCkge1xuICAgICAgICAgICAgIGFsZXJ0KCfor6VTS1UgSUTlt7LlrZjlnKghJyk7XG4gICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgaWYgKGFkZFByb2R1Y3QgPT0gbnVsbCB8fCBhZGRQcm9kdWN0ID09IHVuZGVmaW5lZCAmJiBhZGRQcm9kdWN0ID09ICcnKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+WVhuWTgee8lueggSDkuI3og73kuLrnqbrvvIHvvIHvvIEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge3NrdUNvZGU6IGFkZFByb2R1Y3Quc2t1Q29kZX07XG4gICAgICAgICAgICBwcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RCeUtleShwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIC8vIOaVsOaNrua6kCAkZGF0YSAgZGF0YXNldFxuICAgICAgICAgICAgICAgIGlmIChyZXMudG90YWxFbGVtZW50cyAhPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfor7fovpPlhaXmraPnoa7nmoTllYblk4HnvJbnoIEnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdFRhYmxlLnNldHRpbmdzKCkuZGF0YXNldC5zcGxpY2UoMCwgMCwgcmVzLmNvbnRlbnRbMF0pO1xuICAgICAgICAgICAgICAgIC8vICRzY29wZS5wcm9kdWN0VGFibGUuc2V0dGluZ3MoKS5kYXRhc2V0LnB1c2gocmVzLmNvbnRlbnRbMF0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0VGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8v5re75Yqg5oiQ5Yqf5ZCO5riF56m6aW5wdXRcbiAgICAgICAgICAgIGFkZFByb2R1Y3Quc2t1Q29kZSA9IFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5hZGRCeVByb2R1Y3RJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtpZDogaWQucHJvZHVjdElkfTtcbiAgICAgICAgICAgIHByb2R1Y3RTZXJ2aWNlLmdldFByb2R1Y3RCeUlkKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgLy8g5pWw5o2u5rqQICRkYXRhICBkYXRhc2V0XG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQucHVzaChyZXMpO1xuICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0VGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/liJvlu7rlpZfppJAgLS0+IOWIoOmZpOWVhuWTgVxuICAgICAgICAkc2NvcGUuX2RlbGV0ZVByb2R1Y3QgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIC8v5qC55o2u5YWD57Sg5L2N572uIOWIoOmZpOW9k+WJjeihjFxuICAgICAgICAgICAgdGhpcy5wcm9kdWN0VGFibGUuc2V0dGluZ3MoKS5kYXRhc2V0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAvL+agueaNrklEIOWIoOmZpOWVhuWTgVxuICAgICAgICAgICAgLyp0aGlzLnByb2R1Y3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQgPSBfLnJlamVjdChwcm9kdWN0RGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICByZXR1cm4gaXRlbS5oZWFkZXIuaWQgPT0gaWQ7XG4gICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgICAgIHRoaXMucHJvZHVjdFRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuICAgICAgICAvL+WPkeW4g+Wll+mkkFxuICAgICAgICAkc2NvcGUuX3B1Ymxpc2hTdWl0ZSA9IGZ1bmN0aW9uIChfc3VpdGUpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7aWQ6IF9zdWl0ZS5zdWl0ZS5pZH07XG4gICAgICAgICAgICBzdWl0ZVNlcnZpY2UucHVibGlzaFN1aXRlKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1aXRlQ2ZnTWFuYWdlTGlzdCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgLy8g5aWX6aSQ57G75Z6LXG4gICAgICAgICRzY29wZS5zdWl0ZVR5cGVMaXN0ID0gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgICAgICAgY2xzT3JOYW1lOiAnU1VJVEVfVFlQRScsXG4gICAgICAgICAgICBkZWZhdWx0T2JqOiB7XG4gICAgICAgICAgICAgICAgJyc6ICflhajpg6jnsbvlnosnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUuc3VpdGVUeXBlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5fc3VpdGVUeXBlID0gaXRlbTtcbiAgICAgICAgICAgICRzY29wZS5zdWl0ZUNmZ01hbmFnZUxpc3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8g5aWX6aSQ54q25oCBXG4gICAgICAgICRzY29wZS5zdWl0ZVN0YXR1c0xpc3QgPSBDT05TVEFOVFMuZ2V0TGlzdCh7XG4gICAgICAgICAgICBjbHNPck5hbWU6ICdTVUlURV9TVEFUVVMnLFxuICAgICAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICAgICAgICcnOiAn5YWo6YOo54q25oCBJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnN1aXRlU3RhdHVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5fc3VpdGVTdGF0dXMgPSBpdGVtO1xuICAgICAgICAgICAgJHNjb3BlLnN1aXRlQ2ZnTWFuYWdlTGlzdCgpO1xuICAgICAgICB9O1xuICAgICAgICAvL+WIm+W7uuWll+mkkCAtLT4g5L+d5a2YXG4gICAgICAgICRzY29wZS5zYXZlU3VpdGUgPSBmdW5jdGlvbiAoY1N1aXRlKSB7XG4gICAgICAgICAgICAvKmlmICghY2hlY2tTYXZlUHJvZHVjdEltZygkc2NvcGUuaW1hZ2VzLmltZ0RldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSovXG4gICAgICAgICAgICB2YXIgaW1hZ2VzID0gIF8ucGx1Y2soJHNjb3BlLmltYWdlcy5pbWdEZXRhaWxzLCAncGF0aCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coaW1hZ2VzKTtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgcHJvZHVjdElkcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHByb2R1Y3REYXRhID0gJHNjb3BlLnByb2R1Y3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQ7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJvZHVjdERhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdElkcy5wdXNoKGl0ZW0uaGVhZGVyLmlkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBiYW5uZXI6IGNTdWl0ZS5iYW5uZXIsXG4gICAgICAgICAgICAgICAgLy8gdHlwZTpjU3VpdGUudHlwZSxcbiAgICAgICAgICAgICAgICB0aXRsZTogY1N1aXRlLnRpdGxlLFxuICAgICAgICAgICAgICAgIGRlczogY1N1aXRlLmRlcyxcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWRzOiBwcm9kdWN0SWRzLFxuICAgICAgICAgICAgICAgIGltYWdlczppbWFnZXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGNTdWl0ZS5zaG93UHJvZHVjdHMgPT0gdW5kZWZpbmVkIHx8IGNTdWl0ZS5zaG93UHJvZHVjdHMgPT0gbnVsbCB8fCBjU3VpdGUuc2hvd1Byb2R1Y3RzID09ICcnKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnNob3dQcm9kdWN0cyA9IHRydWVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnNob3dQcm9kdWN0cyA9ICFjU3VpdGUuc2hvd1Byb2R1Y3RzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY1N1aXRlLmZlYXR1cmVzKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnR5cGUgPSAnMCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY1N1aXRlLnN0YW5kYXJkKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnR5cGUgPSAnMSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY1N1aXRlLmZlYXR1cmVzICYmIGNTdWl0ZS5zdGFuZGFyZCkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KCflpZfppJDnsbvlnovpgInmi6nmnInor68o5Y2V6YCJKeOAgicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNTdWl0ZS50aXRsZS5sZW5ndGggPiAxMCkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KCfkuLvmoIfpopjlrZfnrKbmlbDkuI3og73lpKfkuo4xMOS4quWtl+espuOAgicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc2NvcGUucHJvZHVjdFRhYmxlLnNldHRpbmdzKCkuZGF0YXNldC5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ+ivt+a3u+WKoOWVhuWTge+8ge+8ge+8gScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdWl0ZVNlcnZpY2UuY3JlYXRlU3VpdGUocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1aXRlQ2ZnTWFuYWdlTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICBhbGVydCgn5re75Yqg5oiQ5Yqf77yB77yB77yBJyk7XG4gICAgICAgICAgICAgICAgICAgIG1lLiRjbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvL+WIoOmZpOWll+mkkFxuICAgICAgICAkc2NvcGUuX2RlbGV0ZVN1aXRlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAkc2NvcGUuaWQgPSBpZDtcbiAgICAgICAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAgICAgICAgICAgJ3N1aXRlQ2ZnTWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdkZWxldGVTdWl0ZU1vZGVsJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5fZGVsZXRlU3VpdGVPayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgICAgICBzdWl0ZVNlcnZpY2UuZGVsZXRlU3VpdGUoe2lkOiAkc2NvcGUuaWR9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VpdGVDZmdNYW5hZ2VMaXN0KCk7XG4gICAgICAgICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/mn6XnnIvor6bmg4VcbiAgICAgICAgJHNjb3BlLnN1aXRlRGV0YWlscyA9IGZ1bmN0aW9uIChfc3VpdGUpIHtcbiAgICAgICAgICAgIC8vICRzY29wZS5pbWFnZXMuaW1nRGV0YWlscz1bXTtcbiAgICAgICAgICAgIC8v5ou/5Yiw6L2s5o2i5ZCO55qEIGltYWdlcy5pbWdEZXRhaWxzXG4gICAgICAgICAgICAkc2NvcGUuaW1hZ2VzLmltZ0RldGFpbHMgPSBzdWl0ZVNlcnZpY2UuX2dldEltYWdlRGV0YWlscyhfc3VpdGUuc3VpdGUuaW1hZ2VzKTtcblxuICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RUYWJsZS5zZXR0aW5ncygpLmRhdGFzZXQgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdCA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuY1N1aXRlID0ge1xuICAgICAgICAgICAgICAgIGJhbm5lcjogX3N1aXRlLnN1aXRlLmJhbm5lcixcbiAgICAgICAgICAgICAgICB0eXBlOiBfc3VpdGUuc3VpdGUudHlwZSxcbiAgICAgICAgICAgICAgICB0aXRsZTogX3N1aXRlLnN1aXRlLnRpdGxlLFxuICAgICAgICAgICAgICAgIGRlczogX3N1aXRlLnN1aXRlLmRlcyxcbiAgICAgICAgICAgICAgICAvLyBpbWFnZXM6IF9zdWl0ZS5zdWl0ZS5pbWFnZXMsXG4gICAgICAgICAgICAgICAgc2hvd1Byb2R1Y3RzOiAhX3N1aXRlLnN1aXRlLnNob3dQcm9kdWN0cyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoX3N1aXRlLnN1aXRlLnR5cGUgPT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY1N1aXRlLmZlYXR1cmVzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfc3VpdGUuc3VpdGUudHlwZSA9PSBcIjFcIikge1xuICAgICAgICAgICAgICAgICRzY29wZS5jU3VpdGUuc3RhbmRhcmQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKF9zdWl0ZS5zdWl0ZS5wcm9kdWN0SWRzLCBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQnlQcm9kdWN0SWQoe1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5tb2RhbCA9IG1vZGFsU2VydmljZS5pbml0TW9kYWwoe1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1aXRlQ2ZnTWFuYWdlJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9jcmVhdGVTdWl0ZVRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuICAgICAgICAvL+aOkuW6j1xuICAgICAgICAkc2NvcGUuX3NvcnRTdWl0ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3VpdGVRdWVyeVBhcmFtcy5zb3J0VHlwZSA9IGl0ZW0uc29ydENvZGU7XG4gICAgICAgICAgICAkc2NvcGUuc3VpdGVDZmdNYW5hZ2VMaXN0KCk7XG4gICAgICAgICAgICAvKiRzY29wZS5zdWl0ZUNmZ01hbmFnZUxpc3QoXG4gICAgICAgICAgICAgJHNjb3BlLnNvcnRUeXBlID0gaXRlbS5zb3J0Q29kZSAvL+mAmui/h+WPguaVsOS8oOe7meacjeWKoeerr1xuICAgICAgICAgICAgICk7Ki9cbiAgICAgICAgfTtcbiAgICB9KVxufTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzExLzI0LlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcignc3VpdGVEaXN0cmlidXRpb25EeW5hbWljJywgZnVuY3Rpb24gKCRzY29wZSwgTmdUYWJsZVBhcmFtcywgJHVpYk1vZGFsLCBtb2RhbFNlcnZpY2UsIHV0aWxTZXJ2aWNlLCBwcmludFNlcnZpY2UsIENPTlNUQU5UUywgJG1kRGlhbG9nLCBzdWl0ZVNlcnZpY2UsIG9yZGVyU2VydmljZSkge1xuXG4gICAgICAgICRzY29wZS5PUkRFUl9TVEFUVVMgPSBDT05TVEFOVFMuT1JERVJfU1RBVFVTOy8v6K6i5Y2V54q25oCBXG4gICAgICAgICRzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7IC8v6K6i5Y2V57G75Z6LXG4gICAgICAgICRzY29wZS5ERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTsgLy/pgIHotKfljZXnirbmgIFcblxuICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBzdWl0ZU5hbWU6ICcnLC8v5aWX6aSQ5ZCN56ewXG4gICAgICAgICAgICBzdGFydFRpbWU6ICcnLC8v5byA5aeL5pe26Ze0XG4gICAgICAgICAgICBlbmRUaW1lOiAnJywvL+e7k+adn+aXtumXtFxuICAgICAgICAgICAgY29tcGFueUlkOiAnJywgLy/lhazlj7hJRFxuICAgICAgICB9O1xuICAgICAgICAvL+agueaNruS8geS4muaQnOe0olxuICAgICAgICAkc2NvcGUuc2VhcmNoQnlDb21wYW55ID0gZnVuY3Rpb24gKGNvbXBhbnkpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWQgPSBjb21wYW55LmNvbXBhbnlJZDtcbiAgICAgICAgICAgICRzY29wZS5zdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWNMaXN0KCk7XG4gICAgICAgIH07XG4gICAgICAgIC8v5riF56m65LyB5Lia5pCc57SiXG4gICAgICAgICRzY29wZS5lbXB0eUNvbXBhbnlTZWFyY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlJZDtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDlpZfppJDphY3pgIHliqjmgIHliJfooahcbiAgICAgICAgICog6I635Y+W6YWN6YCB5Y2V5YiX6KGo5o6l5Y+j77yaXG4gICAgICAgICAqIGxvZ2lzdGljcy9vcmRlci9kZWxpdmVyeS9maW5kTGlzdFxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnN1aXRlRGlzdHJpYnV0aW9uRHluYW1pY0xpc3QgPSBmdW5jdGlvbiAocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgICAgICAgICAkc2NvcGUuaXNTdWl0ZU9yZGVyTGlzdCA9ICcxJzsvL+agh+iusFxuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IE5nVGFibGVQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubGltaXRcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NYXhCbG9ja3M6IDIwLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25NaW5CbG9ja3M6IDIsXG4gICAgICAgICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlU29ydDogJHNjb3BlLnR5cGVTb3J0LCAgLy8gJHNjb3BlLnR5cGVTb3J0ICDlj5Yg6LWL5YC8XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1N1aXRlT3JkZXJMaXN0OiAkc2NvcGUuaXNTdWl0ZU9yZGVyTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyU3RhdGVzOiAkc2NvcGUub3JkZXJTdGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLmNvbXBhbnlJZCA9ICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55SWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5zdWl0ZU5hbWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnN1aXRlTmFtZSA9ICRzY29wZS5xdWVyeVBhcmFtcy5zdWl0ZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTigkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5zdGFydFRpbWUgPSAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZFRpbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLmVuZFRpbWUgPSAkc2NvcGUucXVlcnlQYXJhbXMuZW5kVGltZSArIDg2Mzk5MDAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWl0ZVNlcnZpY2UuZ2V0U3VpdGVEaXN0cmlidXRpb25EeW5hbWljTGlzdChhbmd1bGFyLmNvcHkocCkpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0luZm8odXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnN1aXRlRGlzdHJpYnV0aW9uRHluYW1pY0xpc3QoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog6I635Y+W5pyf5Y+35YiX6KGoXG5cbiAgICAgICAgICRzY29wZS5nZXRTdWl0ZUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc3VpdGVTZXJ2aWNlLmdldEFsbElzc3VlTGlzdCh7fSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc3N1ZS5pc3N1ZUNob2ljZXMgPSByZXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgJHNjb3BlLmdldFN1aXRlTGlzdCgpO1xuXG4gICAgICAgICAvISoqXG4gICAgICAgICAqIOacn+WPt+etm+mAiVxuICAgICAgICAgKiEvXG4gICAgICAgICAkc2NvcGUuaXNzdWUgPSB7XG4gICAgICAgICAgICAgICAgaXNzdWU6IFtdLFxuICAgICAgICAgICAgICAgIGdldERlZmF1bHRJdGVtOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAkc2NvcGUuaXNzdWVMaXN0Lmxpc3Q7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVOYW1lOiAn5YWo6YOoJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNlbGVjdEl0ZW06IGZ1bmN0aW9uIChyZWNvcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlY29yZC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzc3VlLmlzc3VlSWQgPSByZWNvcmQuaXNzdWVJZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07Ki9cbiAgICAgICAgLyrmiZPljbAqL1xuICAgICAgICAvL+aJk+WNsOWNleaNruWIl+ihqFxuICAgICAgICB2YXIgcHJpbnRPcmRlckFycmF5ID0gW107XG4gICAgICAgIHZhciBjaGVja0luZm8gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBfLmZpbmRXaGVyZShwcmludE9yZGVyQXJyYXksIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJJZDogaXRlbS5vcmRlcklkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2hlY2tBbGxDZmcgPSB7XG4gICAgICAgICAgICBmbGFnOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5Yu+6YCJXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24gKGUsIG9yZGVyKSB7XG4gICAgICAgICAgICB2YXIgaXNDaGVja2VkO1xuICAgICAgICAgICAgaWYgKF8uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNDaGVja2VkID0gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9yZGVyLmNoZWNrZWQgPSBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgcHJpbnRPcmRlckFycmF5LnB1c2gob3JkZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hlY2tBbGxDZmcuZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHByaW50T3JkZXJBcnJheSA9IF8ud2l0aG91dChwcmludE9yZGVyQXJyYXksIG9yZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEFsbE9yZGVyID0gZnVuY3Rpb24gKGUsIGRhdGEsIGNoZWNrYWxsKSB7XG4gICAgICAgICAgICB2YXIgc3QgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQgIT09IHN0KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24oZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKipcbiAgICAgICAgICog5om56YeP5omT5Y2wXG4gICAgICAgICAqL1xuXG4gICAgICAgIC8v5omT5Y2wXG4gICAgICAgICRzY29wZS5wcmludE9yZGVyID0gZnVuY3Rpb24gKG9yZGVycykge1xuICAgICAgICAgICAgdmFyIHRlbXBzID0gW107XG4gICAgICAgICAgICB2YXIgYVRlbXBzID0gW107XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9yZGVycykgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgICAgICAgIGFUZW1wcyA9IG9yZGVycztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYVRlbXBzID0gW29yZGVyc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYVRlbXBzLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHRlbXBzLnB1c2goaXRlbS5vcmRlcklkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGRlbGl2ZXJ5T3JkZXJJZHMgPSB7XG4gICAgICAgICAgICAgICAgZGVsaXZlcnlPcmRlcklkczp0ZW1wc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5xdWVyeU9yZGVyRGV0YWlscyhcbiAgICAgICAgICAgICAgICAvLyBpZHM6Xy5wbHVjayhvcmRlcnMsJ2lkJylcbiAgICAgICAgICAgICAgICAvLyBkZWxpdmVyeU9yZGVySWRzOiB0ZW1wc1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShkZWxpdmVyeU9yZGVySWRzKVxuICAgICAgICAgICAgKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJEZXRhaWxzID0gcmVzLmRlbGl2ZXJ5T3JkZXJEZXRhaWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5pc1ByaW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0ZW1wcyA9IG9yZGVyU2VydmljZS5wcmludE9yZGVyRG9tcyhvcmRlckRldGFpbHMsICRzY29wZS5PUkRFUl9UWVBFLlNVSVRFRFlOQU1JQywgJHNjb3BlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0ZW1wcyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRlbXBzKTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlbXBzLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbVswXS5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHMucHVzaChpdGVtWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBwcmludFNlcnZpY2UucHJpbnRCeURlZmF1bHRQcmludGVyKGh0bWxzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbHMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5iYXRoTXVsdGlQcmludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChwcmludE9yZGVyQXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnByaW50T3JkZXIocHJpbnRPcmRlckFycmF5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudDogJ+ivt+mAieaLqemcgOimgeaJk+WNsOeahOelqOaNricsXG4gICAgICAgICAgICAgICAgICAgIG9rOiAn56Gu6K6kJ1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog6K6i5Y2V5piO57uG5omT5Y2wXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUub3JkZXJEZXRhaWxQcmludCA9IGZ1bmN0aW9uIChvcmRlclR5cGUpIHtcbiAgICAgICAgICAgIHZhciBodG1sID0gb3JkZXJTZXJ2aWNlLmdldFByaW50SHRtbEluT3JkZXJNb2R1bGUob3JkZXJUeXBlKTtcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgICAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcihodG1sKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICrmnKzmnJ/phY3pgIHmrKHmlbBcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5zb3J0QnlDdXJyZW50RGlzdHJpYnV0aW9uTnVtYmVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS50eXBlU29ydCA9IGl0ZW0uc29ydENvZGU7ICAgIC8vIOi1i+WAvCDkvKDnu5nmnI3liqHnq69cbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAq6K6i5Y2V5Y+C5LiO5Lq65pWwXG4gICAgICAgICAqL1xuICAgICAgICAkc2NvcGUuc29ydEJ5T3JkZXJQYXJ0aWNpcGF0aW9uID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS50eXBlU29ydCA9IGl0ZW0uc29ydENvZGU7ICAgIC8vIOi1i+WAvCDkvKDnu5nmnI3liqHnq69cbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOacn+WPt+iuouWNleaYjue7hlxuICAgICAgICAgKiDojrflj5bphY3pgIHljZXor6bmg4XmjqXlj6PvvJpcbiAgICAgICAgICogbG9naXN0aWNzL29yZGVyL2RlbGl2ZXJ5L3tvcmRlcklkfVxuICAgICAgICAgKi9cbiAgICAgICAgJHNjb3BlLnN1aXRlT3JkZXJEZXRhaWwgPSBmdW5jdGlvbiAoc09yZGVyKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICAvL2FwcGVuZFRvOuWwhm1vZGFsIOWKoOi9veWIsOaMh+Wummlk55qERE9N6aG16Z2iXG4gICAgICAgICAgICAgICAgYXBwZW5kVG86IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VpdGVEaXN0cmlidXRpb25EeW5hbWljJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgLy90ZW1wbGF0ZVVybOWxnuaAp+WAvOaYr+S4gOS4qnVybOi3r+W+hCzot6/lvoTmjIflkJHkuIDkuKpodG1s5qih5p2/XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9zdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWNUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge29yZGVySWQ6IHNPcmRlci5vcmRlcklkfTtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5xdWVyeURlbGl2ZXJ5RGV0YWlsKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgc3VpdGVTZXJ2aWNlLnBhcnNlU3VpdGVEYXRhKHJlcyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNPcmRlciA9IHJlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5L+u5pS56K6i5Y2V54q25oCB5o6l5Y+j77yaXG4gICAgICAgICAqIGxvZ2lzdGljcy9vcmRlci9kZWxpdmVyeS97b3JkZXJJZH0vc3RhdGVcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5vcmRlckZpbmlzaGVkID0gZnVuY3Rpb24gKHNPcmRlcikge1xuICAgICAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7b3JkZXJJZDogc09yZGVyLm9yZGVySWQsIG9yZGVyU3RhdGU6IHNPcmRlci5vcmRlclN0YXRlfTtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5tb2RpZnlEZWxpdmVyeVN0YXRlKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgbWUuJGNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIOWll+mkkOeKtuaAgVxuICAgICAgICAkc2NvcGUuc2hpcG1lbnRTdGF0dXNMaXN0ID0gQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgICAgICAgY2xzT3JOYW1lOiAnREVMSVZFUllfU1RBVEUnLFxuICAgICAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICAgICAgICcnOiAn5YWo6YOo54q25oCBJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnNoaXBtZW50U3RhdHVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5vcmRlclN0YXRlcyA9IGl0ZW0uY29kZTtcbiAgICAgICAgICAgICRzY29wZS5zdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWNMaXN0KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWll+mkkOWunuaXtuWKqOaAgS0tPuaYjue7hlxuICAgICAgICAgKiDphY3otKfljZXllYblk4HlkI3np7Dov4fmu6Tmjonlu7rorq7kuIvmnrbnmoRcbiAgICAgICAgICovXG4gICAgICAgICRzY29wZS5maWx0ZXJUeXBlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLml0ZW1UeXBlICE9IDNcbiAgICAgICAgfTtcbiAgICB9KVxufTtcblxuXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5jb250cm9sbGVyKCd0ZWFDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkY29tcGlsZSxvcmRlclNlcnZpY2UsICR0ZW1wbGF0ZUNhY2hlLCAkbWREaWFsb2csIG1vZGFsU2VydmljZSwgcHJpbnRTZXJ2aWNlLCBvcmRlclNlcnZpY2UsIE5nVGFibGVQYXJhbXMsIHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMsY29tcGFueVNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLnV0aWxTZXJ2aWNlID0gdXRpbFNlcnZpY2U7XG4gICAgICAgICRzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgICRzY29wZS5ERUxJVkVSWV9VUkdFTkNZID0gQ09OU1RBTlRTLkRFTElWRVJZX1VSR0VOQ1k7XG4gICAgICAgICRzY29wZS5DT01QQU5ZX1RZUEUgPSBDT05TVEFOVFMuQ09NUEFOWV9UWVBFO1xuICAgICAgICAkc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICAgJHNjb3BlLlRlYV9QZXJpb2RfVHlwZT1DT05TVEFOVFMuVGVhX1BlcmlvZF9UeXBlO1xuXG5cbiAgICAgICAgdmFyIERFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgdmFyIENPTVBBTllfVFlQRSA9IENPTlNUQU5UUy5DT01QQU5ZX1RZUEU7XG4gICAgICAgIHZhciBPUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHZhciBERUxJVkVSWV9TVEFURSA9IENPTlNUQU5UUy5ERUxJVkVSWV9TVEFURTtcbiAgICAgICAgdmFyIFJFRlVORF9TVEFURSA9IENPTlNUQU5UUy5SRUZVTkRfU1RBVEU7XG4gICAgICAgIHZhciBJTlZFTlRPUllfU1RBVEUgPSBDT05TVEFOVFMuSU5WRU5UT1JZX1NUQVRFO1xuICAgICAgICB2YXIgU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICB2YXIgVGVhX1BlcmlvZF9UeXBlPUNPTlNUQU5UUy5UZWFfUGVyaW9kX1R5cGU7XG4gICAgICAgICRzY29wZS5vZmZzZXQ7XG4gICAgICAgICRzY29wZS5saW1pdDtcbiAgICAgICAgJHNjb3BlLmN1ck9yZGVyVHlwZSA9IHsgZGVzYzogJ+WFqOmDqOWNleaNruexu+WeiycgfTtcbiAgICAgICAgJHNjb3BlLmlzVXBkYXRlVGltZUNob2ljZXM9W3sgZGVzYzogJ+S4i+WNleaXtumXtCcsIGNvZGU6ICcwJyB9LCB7IGRlc2M6ICfpooTnuqbpgIHotKfml7bpl7QnLCBjb2RlOiAnMScgfV07XG4gICAgICAgICRzY29wZS5vcmRlclR5cGVMaXN0ID0gW3sgZGVzYzogJ+WFqOmDqOiuouWNlScsIGNvZGU6ICcwJyB9LCB7IGRlc2M6ICflt7LmjqXljZUnLCBjb2RlOiAnMScgfSwgeyBkZXNjOiAn5b6F5o6l5Y2VJywgY29kZTogJzInIH0sIHsgZGVzYzogJ+W3suWPlua2iCcsIGNvZGU6ICczJyB9XTtcbiAgICAgICAgJHNjb3BlLmlzUGFpZExpc3QgPSBbeyBkZXNjOiAn5YWo6YOo5LuY5qy+54q25oCBJywgY29kZTogJycgfSwgeyBkZXNjOiAn5pyq5LuY5qy+JywgY29kZTogJzAnIH0sIHsgZGVzYzogJ+W3suS7mOasvicsIGNvZGU6ICcxJyB9XTtcbiAgICAgICAgJHNjb3BlLmludm9pY2VOZWVkU3RhdGVMaXN0ID0gQ09OU1RBTlRTLmdldExpc3QoJ0lOVk9JQ0VfTkVFRF9TVEFURScsIHRydWUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB7ICcnOiAn5YWo6YOo5byA56Wo6ZyA5rGCJyB9KTtcbiAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIgPSB7fTtcbiAgICAgICAgJHNjb3BlLnJlZnVuZE9yZGVyID0ge307XG4gICAgICAgICRzY29wZS5pbnZlbnRvcnlPcmRlciA9IHt9O1xuICAgICAgICAkc2NvcGUuc2V0dGxlbWVudE9yZGVyID0ge307XG5cbiAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zID0ge1xuICAgICAgICAgICAgY3JlYXRlU3RhcnREYXk6ICcnLFxuICAgICAgICAgICAgY3JlYXRlRW5kRGF5OiAnJyxcbiAgICAgICAgICAgIHVwZGF0ZVN0YXJ0RGF5OiAnJyxcbiAgICAgICAgICAgIHVwZGF0ZUVuZERheTogJycsXG4gICAgICAgICAgICBpc0ludm9pY2U6ICcnLCAvLzAg5LiN6ZyA6KaB5byA56WoICAx6ZyA6KaB5byA56WoXG4gICAgICAgICAgICBpc1BhaWQ6ICcnLCAvLyAwIOayoeaciSAgMSDlt7LmlK/ku5hcbiAgICAgICAgICAgIGlzVXBhdGVUaW1lOiAwLFxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0SXNVcGFkYXRlID0gZnVuY3Rpb24oY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUgPSBwYXJzZUludChjaG9pY2UuY29kZSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zZWxlY3RJc1BhaWQgPSBmdW5jdGlvbihjaG9pY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5pc1BhaWQgPSBjaG9pY2UuY29kZTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlclRhYmxlLnJlbG9hZCgpO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyVGFibGUucGFnZSgxKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEludm9pY2VuTmVlZFN0YXRlID0gZnVuY3Rpb24oY2hvaWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNJbnZvaWNlID0gY2hvaWNlLmNvZGU7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlclRhYmxlLnBhZ2UoMSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzZXRPcmRlclRhYmxlID0gZnVuY3Rpb24ocXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSA9ICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydERheSB8fCB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJyk7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ID0gJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheSB8fCB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKTtcbiAgICAgICAgICAgICRzY29wZS5vZmZzZXQgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmxpbWl0ID0gMjA7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWF4QmxvY2tzOiAxMyxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uTWluQmxvY2tzOiAyLFxuICAgICAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogKHBhcmFtcy5wYWdlKCkgLSAxKSAqICRzY29wZS5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAkc2NvcGUubGltaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wYW55SWQ6ICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55TmFtZT8kc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueU5hbWU6JydcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICBzd2l0Y2ggKHBhcnNlSW50KCRzY29wZS5jdXJPcmRlclR5cGUuY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmV4cHJlc3NTdGF0dXM9MjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmV4cHJlc3NTdGF0dXM9MTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnN0YXR1cz0yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuc3RhdHVzPTQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5pc0ludm9pY2UgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLmlzSW52b2ljZSA9ICRzY29wZS5xdWVyeVBhcmFtcy5pc0ludm9pY2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5pc1BhaWQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLmlzUGFpZCA9ICRzY29wZS5xdWVyeVBhcmFtcy5pc1BhaWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5xdWVyeVBhcmFtcy5pc1VwYXRlVGltZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwLnN0YXJ0VGltZSA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0RGF5LnJlcGxhY2UoLy0vZywnLycpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuZW5kVGltZSA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheS5yZXBsYWNlKC8tL2csJy8nKSsnIDIzOjU5OjU5Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnRpbWVUeXBlPTI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnN0YXJ0VGltZSA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0RGF5LnJlcGxhY2UoLy0vZywnLycpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuZW5kVGltZSA9IERhdGUucGFyc2UoJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZERheS5yZXBsYWNlKC8tL2csJy8nKSsnIDIzOjU5OjU5Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwLnRpbWVUeXBlPTE7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJTZXJ2aWNlLnF1ZXJ5VGVhTGlzdChwKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhPSAkc2NvcGUuYWRkVGVhVHlwZShyZXMuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hlY2tJbmZvKHV0aWxTZXJ2aWNlLmluZGV4QXJyYXkoZGF0YSwgJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8vc2V0T3JkZXJUYWJsZSgpO1xuICAgICAgICAvLyDkuIvljYjojLbnsbvlnovovazmjaJcbiAgICAgICAgICAkc2NvcGUuYWRkVGVhVHlwZT1mdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0YSkgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgICAgICAgIHRlYUFycmF5ID0gZGF0YTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGVhQXJyYXkgPSBbZGF0YV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRlYUFycmF5LCBmdW5jdGlvbihpdGVtLCBpKSB7XG4gICAgICAgICAgICAgIGlmKGl0ZW0uZXhwcmVzc1N0YXR1cz09Mil7XG4gICAgICAgICAgICAgICAgaXRlbS50eXBlPTFcbiAgICAgICAgICAgICAgfWVsc2UgaWYoaXRlbS5leHByZXNzU3RhdHVzPT0xJiZpdGVtLnN0YXR1cz09Mil7XG4gICAgICAgICAgICAgICBpdGVtLnR5cGU9MlxuICAgICAgICAgICAgICB9ZWxzZSBpZihpdGVtLnN0YXR1cz09NCl7XG4gICAgICAgICAgICAgICBpdGVtLnR5cGU9M1xuXG4gICAgICAgICAgICAgIH1lbHNle31cblxuICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgcmV0dXJuIHRlYUFycmF5O1xuICAgICAgICAgIH1cbiAgICAgICAgLy/mkJzntKLljZXmja5cbiAgICAgICAgJHNjb3BlLnNlYXJjaFRlYSA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1zKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zIHx8IHt9O1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lID0gcXVlcnlQYXJhbXMuY29tcGFueU5hbWU7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnREYXkgPSBxdWVyeVBhcmFtcy5zdGFydFRpbWUgPyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUocXVlcnlQYXJhbXMuc3RhcnRUaW1lLCAneXl5eS1NTS1kZCcpIDpcbiAgICAgICAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJyk7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kRGF5ID0gcXVlcnlQYXJhbXMuZW5kVGltZSA/IHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZShxdWVyeVBhcmFtcy5lbmRUaW1lLCAneXl5eS1NTS1kZCcpIDpcbiAgICAgICAgICAgICAgICB1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKTtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5pc1VwYXRlVGltZSA9IHF1ZXJ5UGFyYW1zLmlzVXBhdGVUaW1lO1xuICAgICAgICAgICAgc2V0T3JkZXJUYWJsZSgpO1xuICAgICAgICB9O1xuICAgICAgICAvL+iOt+WPluWNleaNrueKtuaAgeaPj+i/sFxuICAgICAgICAkc2NvcGUuZ2V0T3JkZXJTdGF0ZURlc2MgPSBmdW5jdGlvbihvcmRlclR5cGUsIG9yZGVyU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBvcmRlclN0YXRlRGVzYyA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChvcmRlclR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyU3RhdGVEZXNjID0gREVMSVZFUllfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlJFRlVORDpcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJTdGF0ZURlc2MgPSBSRUZVTkRfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLklOVkVOVE9SWTpcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJTdGF0ZURlc2MgPSBJTlZFTlRPUllfU1RBVEUuREVTQ1tvcmRlclN0YXRlXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlNFVFRMRU1FTlQ6XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyU3RhdGVEZXNjID0gU0VUVExFTUVOVF9TVEFURS5ERVNDW29yZGVyU3RhdGVdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvcmRlclN0YXRlRGVzYztcbiAgICAgICAgfTtcbiAgICAgICAgLy/pgInmi6nljZXmja7nsbvlnotcbiAgICAgICAgJHNjb3BlLnNlbGVjdE9yZGVyVHlwZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcblxuICAgICAgICAgICAgJHNjb3BlLmN1ck9yZGVyVHlwZSA9IGl0ZW07XG4gICAgICAgICAgICBzZXRPcmRlclRhYmxlKCk7XG4gICAgICAgIH07XG4gICAgICAgIC8v5piO57uGXG4gICAgICAgICRzY29wZS5jaGVja09yZGVyRGV0YWlsID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBvcmRlcklkLGNvbXBhbnlOYW1lKSB7XG4gICAgICAgICAgICAvLyRzY29wZS5jb21wYW55TmFtZT1jb21wYW55TmFtZTtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5jaGVja09yZGVyRGV0YWlsKG9yZGVyVHlwZSwgb3JkZXJJZCwgJHNjb3BlLGZhbHNlLGNvbXBhbnlOYW1lKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy/ojrflj5bpgIHotKfljZXor6bmg4VcbiAgICAgICAgdmFyIGdldERlbGl2ZXJ5RGV0YWlsID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5RGVsaXZlcnlEZXRhaWwoeyAnb3JkZXJJZCc6IG9wdHMub3JkZXJJZCB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyID0gcmVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLm5hbWUgPSAn6YCB6LSn5Y2VJyArICctJyArICRzY29wZS5kZWxpdmVyeU9yZGVyLmNvbXBhbnlOYW1lICsgJy0nICsgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIuc2hlbGZOYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5kZWxpdmVyeU9yZGVyLmNyZWF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1dFNhbGVQcm9kdWN0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnN1cHBsZW1lbnRQcm9kdWN0TGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QgPSBbXTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZGVsaXZlcnlPcmRlci5pdGVtcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBhcnNlSW50KGl0ZW0uaXRlbVR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIucHV0U2FsZVByb2R1Y3RMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIuc3VwcGxlbWVudFByb2R1Y3RMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJ5T3JkZXIucHVsbFNhbGVQcm9kdWN0TGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgb3B0cy5kaWRMb2FkRGF0YSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy/ojrflj5bpgIDotKfljZXor6bmg4VcbiAgICAgICAgdmFyIGdldFJlZnVuZERldGFpbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgICAgIG9yZGVyU2VydmljZS5xdWVyeVJlZnVuZERldGFpbCh7ICdvcmRlcklkJzogb3B0cy5vcmRlcklkIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZnVuZE9yZGVyID0gcmVzO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWZ1bmRPcmRlci5uYW1lID0gJ+mAgOi0p+WNlScgKyAnLScgKyAkc2NvcGUucmVmdW5kT3JkZXIuY29tcGFueU5hbWUgKyAnLScgKyAkc2NvcGUucmVmdW5kT3JkZXIuc2hlbGZOYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKCRzY29wZS5yZWZ1bmRPcmRlci5jcmVhdGVUaW1lLCAneXl5eU1NZGRoaG1tc3MnKSArICcpJztcbiAgICAgICAgICAgICAgICBvcHRzLmRpZExvYWREYXRhKCk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH07XG4gICAgICAgIC8v6I635Y+W55uY54K55Y2V6K+m5oOFXG4gICAgICAgIHZhciBnZXRJbnZlbnRvcnlEZXRhaWwgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UucXVlcnlJbnZlbnRvcnlEZXRhaWwoeyAnb3JkZXJJZCc6IG9wdHMub3JkZXJJZCB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnZlbnRvcnlPcmRlciA9IHJlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW52ZW50b3J5T3JkZXIubmFtZSA9ICfnm5jngrnljZUnICsgJy0nICsgJHNjb3BlLmludmVudG9yeU9yZGVyLmNvbXBhbnlOYW1lICsgJy0nICsgJHNjb3BlLmludmVudG9yeU9yZGVyLnNoZWxmTmFtZSArXG4gICAgICAgICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZygkc2NvcGUuaW52ZW50b3J5T3JkZXIuY3JlYXRlVGltZSwgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICAgICAgb3B0cy5kaWRMb2FkRGF0YSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8v6I635Y+W57uT566X5Y2V6K+m5oOFXG4gICAgICAgIHZhciBnZXRTZXR0bGVtZW50RGV0YWlsID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgICAgb3JkZXJTZXJ2aWNlLnF1ZXJ5U2V0dGxlbWVudERldGFpbCh7ICdvcmRlcklkJzogb3B0cy5vcmRlcklkIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldHRsZW1lbnRPcmRlciA9IG9yZGVyU2VydmljZS5fcGFyc2VTZXR0bGVtZW50RGV0YWlsRGF0YShyZXMpO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXR0bGVtZW50T3JkZXIubmFtZSA9ICfnu5PnrpfljZUnICsgJy0nICsgJHNjb3BlLnNldHRsZW1lbnRPcmRlci5jb21wYW55TmFtZSArXG4gICAgICAgICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZygkc2NvcGUuc2V0dGxlbWVudE9yZGVyLmNyZWF0ZVRpbWUsICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgICAgIG9wdHMuZGlkTG9hZERhdGEoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+ivpue7hk1vZGFs5Lit5a+85Ye6RXhjZWzvvIjnp7voh7NzZXJ2aWNl77yJXG4gICAgICAgIC8v5YiX6KGo5Lit5a+85Ye6RXhjZWxcbiAgICAgICAgJHNjb3BlLmV4cG9ydEV4Y2VsT25MaXN0ID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBvcmRlcklkKSB7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UuZXhwb3J0RXhjZWwob3JkZXJUeXBlLCBvcmRlcklkLCAkc2NvcGUpO1xuICAgICAgICB9O1xuICAgICAgICAvKuaJk+WNsCovXG4gICAgICAgIC8v5omT5Y2w5Y2V5o2u5YiX6KGoXG4gICAgICAgIHZhciBwcmludE9yZGVyQXJyYXkgPSBbXTtcbiAgICAgICAgdmFyIGNoZWNrSW5mbyA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBfLmZpbmRXaGVyZShwcmludE9yZGVyQXJyYXksIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJJZDogaXRlbS5vcmRlcklkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2hlY2tBbGxDZmcgPSB7XG4gICAgICAgICAgICBmbGFnOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICAvL+WLvumAiVxuICAgICAgICAkc2NvcGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24oZSwgb3JkZXIpIHtcbiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQ7XG4gICAgICAgICAgICBpZiAoXy5pc09iamVjdChlKSkge1xuICAgICAgICAgICAgICAgIGlzQ2hlY2tlZCA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0NoZWNrZWQgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3JkZXIuY2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgICAgICAgICAgIGlmIChpc0NoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBwcmludE9yZGVyQXJyYXkucHVzaChvcmRlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGVja0FsbENmZy5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcHJpbnRPcmRlckFycmF5ID0gXy53aXRob3V0KHByaW50T3JkZXJBcnJheSwgb3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0QWxsT3JkZXIgPSBmdW5jdGlvbihlLCBkYXRhLCBjaGVja2FsbCkge1xuICAgICAgICAgICAgdmFyIHN0ID0gZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQ7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQgIT09IHN0KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTZWxlY3Rpb24oZS5jdXJyZW50VGFyZ2V0LmNoZWNrZWQsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+aJuemHj+aJk+WNsFxuICAgICAgICAkc2NvcGUucHJpbnRPcmRlciA9IGZ1bmN0aW9uKG9yZGVycykge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciB0ZWFPcmRlcklkcyA9IFtdO1xuICAgICAgICAgICAgdmFyIG9yZGVyQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob3JkZXJzKSA9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICAgICAgb3JkZXJBcnJheSA9IG9yZGVycztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3JkZXJBcnJheSA9IFtvcmRlcnNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG9yZGVyQXJyYXksIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB0ZWFPcmRlcklkcy5wdXNoKGl0ZW0uaWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UudGVhT3JkZXJEZXRhaWxzKHtcbiAgICAgICAgICAgICAgICBvcmRlcklkczogdGVhT3JkZXJJZHNcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlYU9yZGVyRGV0YWlscyA9IHJlc3x8IFtdO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wcyA9IFtdO1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0ZWFPcmRlckRldGFpbHMsIGZ1bmN0aW9uKGRldGFpbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3JkZXJUeXBlPU9SREVSX1RZUEUuU0VUVExFTUVOVDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gb3JkZXJTZXJ2aWNlLnRlYU9yZGVyU2NvcGUoT1JERVJfVFlQRS5URUFPUkRFUiwgZGV0YWlsLCAkc2NvcGUuJG5ldyh0cnVlKSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmlzUHJpbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wcy5wdXNoKGFuZ3VsYXIuZWxlbWVudCgnPGRpdj48L2Rpdj4nKS5hcHBlbmQob3JkZXJTZXJ2aWNlLmdldFRlbXBsYXRlRG9tQnlUeXBlKE9SREVSX1RZUEUuVEVBT1JERVIsIHNjb3BlKSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0ZW1wcywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbVswXS5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHMucHVzaChpdGVtWzBdLmlubmVySFRNTCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBwcmludFNlcnZpY2UucHJpbnRCeURlZmF1bHRQcmludGVyKGh0bWxzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvLyDor6bmg4XpobXmiZPljbBcbiAgICAgICAgJHNjb3BlLnByaW50VGVhSHRtbD0gZnVuY3Rpb24ob3JkZXJUeXBlKSB7XG4gICAgICAgICAgICB2YXIgaHRtbCA9IG9yZGVyU2VydmljZS5nZXRQcmludEh0bWxJbk9yZGVyTW9kdWxlKG9yZGVyVHlwZSk7XG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgICAgICAgICAgcHJpbnRTZXJ2aWNlLnByaW50QnlEZWZhdWx0UHJpbnRlcihodG1sKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuYmF0aE11bHRpUHJpbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChwcmludE9yZGVyQXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnByaW50T3JkZXIocHJpbnRPcmRlckFycmF5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudDogJ+ivt+mAieaLqemcgOimgeaJk+WNsOeahOelqOaNricsXG4gICAgICAgICAgICAgICAgICAgIG9rOiAn56Gu6K6kJ1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAkc2NvcGUua2V5cmVtYXJrPWZ1bmN0aW9uKGUscmVtYXJrLGlkKXtcbiAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7IC8v5Zue6L2m6ZSuXG4gICAgICAgICAgICAgICAgICBvcmRlclNlcnZpY2UubW9kaWZ5UmVtYXJrKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVySWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtYXJrOnJlbWFya1xuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pOyAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICBcbiAgICAgIFxuICAgICAgICAgfTtcbiAgICAgICAgICRzY29wZS5jYW5jZWxPcmRlcj1mdW5jdGlvbihpZCl7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UuY2FuY2VsVGVhKHtcbiAgICAgICAgICAgICAgICBvcmRlcklkOmlkXG5cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRlYURldGFpbC5vcmRlci50eXBlPTEwMFxuICAgICAgICAgICAgICAgICAgICB9KTsgICAgXG4gICAgICAgICB9IDtcbiAgICAgICAgICRzY29wZS5hY2NlcHRPcmRlcj1mdW5jdGlvbihpZCl7XG4gICAgICAgICAgICBvcmRlclNlcnZpY2UuYWNjZXB0VGVhKHtcbiAgICAgICAgICAgICAgICBvcmRlcklkOmlkXG5cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgJHNjb3BlLnRlYURldGFpbC5vcmRlci50eXBlPTEwMCAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pOyAgICBcbiAgICAgICAgIH0gO1xuXG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ3RlbXBsYXRlJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2csICRmaWx0ZXIsXG4gICAgTmdUYWJsZVBhcmFtcywgdGVtcGxhdGVTZXJ2aWNlLCBDT05TVEFOVFMsIGNhY2hlU2VydmljZSwgdXRpbFNlcnZpY2UpIHtcbiAgICAkc2NvcGUudGVtcGxhdGUgPSB7XG4gICAgICBuYW1lOiAnJ1xuICAgIH07XG4gICAgJHNjb3BlLnF1ZXJ5VGVtcGxhdGVQYXJhbXMgPSB7XG4gICAgICB0eXBlOiAnJyxcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgc3RhdHVzOiAnJ1xuICAgIH07XG4gICAgJHNjb3BlLnF1ZXJ5VGVtcGxhdGVDb25maWcgPSB7XG4gICAgICBzZWxlY3RDb21wYW55VHlwZTogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAkc2NvcGUucXVlcnlUZW1wbGF0ZVBhcmFtcy50eXBlID0gaXRlbS5jb2RlO1xuICAgICAgICAkc2NvcGUucXVlcnlUZW1wbGF0ZUxpc3QoKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RUZW1wbGF0ZVN0YXR1czogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAkc2NvcGUucXVlcnlUZW1wbGF0ZVBhcmFtcy5zdGF0dXMgPSBpdGVtLmNvZGU7XG4gICAgICAgICRzY29wZS5xdWVyeVRlbXBsYXRlTGlzdCgpO1xuICAgICAgfSxcbiAgICAgIGNvbXBhbnlUeXBlczogQ09OU1RBTlRTLmdldExpc3Qoe1xuICAgICAgICBjbHNPck5hbWU6ICdURU1QTEFURV9UWVBFJyxcbiAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICcnOiAn5YWo6YOo57G75Z6LJ1xuICAgICAgICB9XG4gICAgICB9KSxcbiAgICAgIHRlbXBsYXRlU3RhdHVzZXM6IENPTlNUQU5UUy5nZXRMaXN0KHtcbiAgICAgICAgY2xzT3JOYW1lOiAnVEVNUExBVEVfU1RBVFVTJyxcbiAgICAgICAgZGVmYXVsdE9iajoge1xuICAgICAgICAgICcnOiAn5YWo6YOo54q25oCBJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH07XG5cbiAgICAkc2NvcGUubGltaXQgPSAyNTtcbiAgICAkc2NvcGUudGVtcGxhdGVMaXN0ID0gW107XG4gICAgJHNjb3BlLnRlbXBsYXRlVGFibGVIZWFkID0gW107XG4gICAgJHNjb3BlLnRlbXBsYXRlVGFibGUgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICBjb3VudDogJHNjb3BlLmxpbWl0XG4gICAgfSwge1xuICAgICAgY291bnRzOiBbXSxcbiAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgcCA9IHt9O1xuICAgICAgICAkc2NvcGUub2Zmc2V0ID0gJHNjb3BlLmxpbWl0ICogKHBhcmFtcy5wYWdlKCkgLSAxKTtcbiAgICAgICAgcCA9IHtcbiAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5vZmZzZXQsXG4gICAgICAgICAgbGltaXQ6ICRzY29wZS5saW1pdFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGVtcGxhdGVTZXJ2aWNlLnF1ZXJ5VGVtcGxhdGVMaXN0KGFuZ3VsYXIuZXh0ZW5kKHAsICRzY29wZS5xdWVyeVRlbXBsYXRlUGFyYW1zKSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICRzY29wZS50ZW1wbGF0ZUxpc3QgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChyZXMudG90YWxFbGVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gdXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgJHNjb3BlLm9mZnNldCArXG4gICAgICAgICAgICAgIDEpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgICRzY29wZS5xdWVyeVRlbXBsYXRlTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLnRlbXBsYXRlVGFibGUucmVsb2FkKCk7XG4gICAgICAkc2NvcGUudGVtcGxhdGVUYWJsZS5wYWdlKDEpO1xuICAgIH07XG4gICAgJHNjb3BlLmNyZWF0ZVRlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcjL3RlbXBsYXRlRWRpdCc7XG4gICAgfTtcbiAgICAkc2NvcGUuZWRpdFRlbXBsYXRlID0gZnVuY3Rpb24odCkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnIy90ZW1wbGF0ZUVkaXQvJyArIHQuaWQ7XG4gICAgfTtcbiAgICAkc2NvcGUucHVibGlzaFRlbXBsYXRlID0gZnVuY3Rpb24odCkge1xuICAgICAgdGVtcGxhdGVTZXJ2aWNlLnB1Ymxpc2hUZW1wbGF0ZSh7XG4gICAgICAgIGlkOiB0LmlkLFxuICAgICAgICB0eXBlOiB0LnR5cGUsXG4gICAgICAgIHN0YXR1czogQ09OU1RBTlRTLlRFTVBMQVRFX1NUQVRVUy5QVUJMSUMsXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkc2NvcGUucXVlcnlUZW1wbGF0ZUxpc3QoKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLmRlbGV0ZVRlbXBsYXRlID0gZnVuY3Rpb24odCkge1xuICAgICAgdGVtcGxhdGVTZXJ2aWNlLmRlbGV0ZVRlbXBsYXRlKHtcbiAgICAgICAgaWQ6IHQuaWRcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS50ZW1wbGF0ZVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICAkc2NvcGUudGVtcGxhdGVUYWJsZS5wYWdlKDEpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmNvbnRyb2xsZXIoJ3RlbXBsYXRlRWRpdCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvdXRlUGFyYW1zLFxuICAgICRtZFNpZGVuYXYsIHVwbG9hZFNlcnZpY2UsIHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMsXG4gICAgTmdUYWJsZVBhcmFtcywgdGVtcGxhdGVTZXJ2aWNlLCAkZmlsdGVyLCAkbWREaWFsb2cpIHtcbiAgICB2YXIgdGVtcGxhdGVJZCA9ICRyb3V0ZVBhcmFtcy50ZW1wbGF0ZUlkIHx8ICcnO1xuICAgICRzY29wZS5DT05TVEFOVFMgPSBDT05TVEFOVFM7XG4gICAgJHNjb3BlLnBpY1VybCA9IHdpbmRvdy5jZmcucGljVXJsO1xuICAgICRzY29wZS50ZW1wbGF0ZURlZmF1bHQgPSB7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIGNyZWF0VGltZTogJycsXG4gICAgICB1cGRhdGVUaW1lOiAnJyxcbiAgICAgIHR5cGU6ICcnLFxuICAgICAgc3RhdHVzOiAnJyxcbiAgICAgIG1vZHVsZTogW11cbiAgICB9O1xuICAgICRzY29wZS50ZW1wbGF0ZSA9IHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgY3JlYXRUaW1lOiAnJyxcbiAgICAgIHVwZGF0ZVRpbWU6ICcnLFxuICAgICAgdHlwZTogJycsXG4gICAgICBzdGF0dXM6ICcnLFxuICAgICAgbW9kdWxlOiBbXVxuICAgIH07XG4gICAgJHNjb3BlLm1vZHVsZXMgPSAkc2NvcGUudGVtcGxhdGUubW9kdWxlIHx8IFtdO1xuICAgICRzY29wZS5mdWxsV2lkdGggPSA0O1xuICAgICRzY29wZS5kZWZhdWx0TW9kdWxlID0ge1xuICAgICAgd2lkdGg6ICcnLFxuICAgICAgaGVpZ2h0OiAnJyxcbiAgICAgIG1lcmdlTmV4dDogZmFsc2UsXG4gICAgICBpc0hpZGU6IGZhbHNlLFxuICAgICAgY29udGVudHM6IFt7XG4gICAgICAgIHg6ICcnLFxuICAgICAgICB5OiAnJyxcbiAgICAgICAgd2lkdGg6ICcnLFxuICAgICAgICBoZWlnaHQ6ICcnLFxuICAgICAgICBjb250ZW50VHlwZTogJycsXG4gICAgICAgIGNvbnRlbnRMaW5rOiBbXSxcbiAgICAgICAgY29udGVudEltYWdlOiBbXVxuICAgICAgfV1cbiAgICB9O1xuICAgIC8v5L6n6L655qCP6YCJ5Lit55qE5YaF5a655YWD57SgXG4gICAgJHNjb3BlLm5ld0NvbnRlbnQgPSB7XG4gICAgICBjb250ZW50VHlwZTogJycsXG4gICAgICBkaXNhYmxlQWxlcnQ6ICcnLFxuICAgICAgaXNEaXNhYmxlOiBmYWxzZSxcbiAgICAgIGlzUG9wOiBmYWxzZSxcbiAgICAgIG5vQm9yZGVyOiBmYWxzZSxcbiAgICAgIGNvbnRlbnRMaW5rOiBbXSxcbiAgICAgIGNvbnRlbnRJbWFnZTogW11cbiAgICB9O1xuICAgIC8v5omA5pyJ5qih5Z2X57G75Z6L5Y+K5YW25biD5bGAXG4gICAgJHNjb3BlLmFsbE1vZHVsZXMgPSBbXG4gICAgICAvLzHooYxcbiAgICAgIHtcbiAgICAgICAgd2lkdGg6ICRzY29wZS5mdWxsV2lkdGgsXG4gICAgICAgIGhlaWdodDogMSxcbiAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAkc2NvcGUuZnVsbFdpZHRoLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIC8vMeihjDLliJdcbiAgICAgIHtcbiAgICAgICAgd2lkdGg6ICRzY29wZS5mdWxsV2lkdGgsXG4gICAgICAgIGhlaWdodDogMSxcbiAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgeDogMixcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIC8vMeihjDTliJdcbiAgICAgIHtcbiAgICAgICAgd2lkdGg6ICRzY29wZS5mdWxsV2lkdGgsXG4gICAgICAgIGhlaWdodDogMSxcbiAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAxLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgeDogMSxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAxLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgeDogMixcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAxLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgeDogMyxcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHdpZHRoOiAxLFxuICAgICAgICAgIGhlaWdodDogMVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIC8vMuihjFxuICAgICAge1xuICAgICAgICB3aWR0aDogJHNjb3BlLmZ1bGxXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiAyLFxuICAgICAgICBjb250ZW50czogW3tcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgd2lkdGg6ICRzY29wZS5mdWxsV2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiAyXG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAgLy8y6KGMMuWIl1xuICAgICAge1xuICAgICAgICB3aWR0aDogJHNjb3BlLmZ1bGxXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiAyLFxuICAgICAgICBjb250ZW50czogW3tcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgd2lkdGg6IDIsXG4gICAgICAgICAgaGVpZ2h0OiAyXG4gICAgICAgIH0sIHtcbiAgICAgICAgICB4OiAyLFxuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgd2lkdGg6IDIsXG4gICAgICAgICAgaGVpZ2h0OiAyXG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAgLy8y6KGM77yM5Y+j55SwXG4gICAgICB7XG4gICAgICAgIHdpZHRoOiAkc2NvcGUuZnVsbFdpZHRoLFxuICAgICAgICBoZWlnaHQ6IDIsXG4gICAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMCxcbiAgICAgICAgICB3aWR0aDogMixcbiAgICAgICAgICBoZWlnaHQ6IDJcbiAgICAgICAgfSwge1xuICAgICAgICAgIHg6IDIsXG4gICAgICAgICAgeTogMCxcbiAgICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgICBoZWlnaHQ6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgIHg6IDIsXG4gICAgICAgICAgeTogMSxcbiAgICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgICBoZWlnaHQ6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgIHg6IDMsXG4gICAgICAgICAgeTogMCxcbiAgICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgICBoZWlnaHQ6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgIHg6IDMsXG4gICAgICAgICAgeTogMSxcbiAgICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgICBoZWlnaHQ6IDFcbiAgICAgICAgfV1cbiAgICAgIH1cbiAgICBdO1xuICAgICRzY29wZS5hbGxDb250ZW50VHlwZXMgPSBDT05TVEFOVFMuZ2V0TGlzdCgnQ09OVEVOVF9UWVBFJywgZmFsc2UpO1xuICAgICRzY29wZS5hbGxUZW1wbGF0ZVR5cGVzID0gQ09OU1RBTlRTLmdldExpc3QoJ1RFTVBMQVRFX1RZUEUnLCBmYWxzZSk7XG4gICAgJHNjb3BlLmFsbFRlbXBsYXRlU3RhdHVzZXMgPSBDT05TVEFOVFMuZ2V0TGlzdCgnVEVNUExBVEVfU1RBVFVTJyxcbiAgICAgIGZhbHNlKTtcbiAgICAkc2NvcGUuZGlzYWJsZUNob2ljZXMgPSBbe1xuICAgICAgbmFtZTogJ+WFgeiuuCcsXG4gICAgICB2YWx1ZTogZmFsc2VcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn56aB5q2iJyxcbiAgICAgIHZhbHVlOiB0cnVlXG4gICAgfV07XG4gICAgJHNjb3BlLnBvcENob2ljZXMgPSBbe1xuICAgICAgbmFtZTogJ+aXoCcsXG4gICAgICB2YWx1ZTogZmFsc2VcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5pyJJyxcbiAgICAgIHZhbHVlOiB0cnVlXG4gICAgfV07XG4gICAgJHNjb3BlLmJvcmRlckNob2ljZXMgPSBbe1xuICAgICAgbmFtZTogJ+WQpicsXG4gICAgICB2YWx1ZTogZmFsc2VcbiAgICB9LCB7XG4gICAgICBuYW1lOiAn5pivJyxcbiAgICAgIHZhbHVlOiB0cnVlXG4gICAgfV07XG4gICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudCA9ICRzY29wZS5uZXdDb250ZW50O1xuXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8v6I635Y+W5qih5p2/6K+m5oOFXG4gICAgICBpZiAodGVtcGxhdGVJZCkge1xuICAgICAgICB0ZW1wbGF0ZVNlcnZpY2UucXVlcnlUZW1wbGF0ZURldGFpbCh7XG4gICAgICAgICAgaWQ6IHRlbXBsYXRlSWRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAkc2NvcGUudGVtcGxhdGUgPSByZXM7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLnNhdmVUZW1wbGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBhcmFtcyA9IGFuZ3VsYXIuY29weSgkc2NvcGUudGVtcGxhdGUpO1xuICAgICAgdmFyIGZuID0gJyc7XG4gICAgICBpZiAocGFyYW1zLmlkKSB7XG4gICAgICAgIGZuID0gJ2VkaXRUZW1wbGF0ZSc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmbiA9ICdjcmVhdGVUZW1wbGF0ZSc7XG4gICAgICB9XG4gICAgICBpZiAoIXBhcmFtcy5uYW1lIHx8ICFwYXJhbXMudHlwZSB8fCAhcGFyYW1zLnN0YXR1cykge1xuICAgICAgICAkbWREaWFsb2cuc2hvdygkbWREaWFsb2cuYWxlcnQoe1xuICAgICAgICAgIHRpdGxlOiAn5o+Q56S6JyxcbiAgICAgICAgICB0ZXh0Q29udGVudDogJ+ivt+WujOaVtOWhq+WGmeaooeeJiOS/oeaBrycsXG4gICAgICAgICAgb2s6ICfnoa7orqQnLFxuICAgICAgICAgIGNhbmNlbDogJ+WPlua2iCdcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0ZW1wbGF0ZVNlcnZpY2VbZm5dKHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnI3RlbXBsYXRlJztcbiAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLnJlc2V0RWRpdFRlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGVtcGxhdGVJZCkge1xuICAgICAgICBpbml0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc2NvcGUudGVtcGxhdGUgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLnRlbXBsYXRlRGVmYXVsdCk7XG4gICAgICAgICRzY29wZS5tb2R1bGVzID0gJHNjb3BlLnRlbXBsYXRlLm1vZHVsZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8v5qih5Z2XXG4gICAgLy9kZWxldGUgbW9kdWxlXG4gICAgJHNjb3BlLmRlbGV0ZU1vZHVsZSA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAkc2NvcGUubW9kdWxlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH07XG4gICAgJHNjb3BlLm1vdmVNb2R1bGUgPSBmdW5jdGlvbihpbmRleCwgaXNVcCkge1xuICAgICAgdmFyIGJlZm9yZUluZGV4ID0gaXNVcCA/IGluZGV4IC0gMSA6IGluZGV4O1xuICAgICAgaWYgKChpc1VwICYmICFpbmRleCkgfHwgKCFpc1VwICYmIGluZGV4ID09ICRzY29wZS5tb2R1bGVzLmxlbmd0aCAtXG4gICAgICAgICAgMSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgJHNjb3BlLm1vZHVsZXNbYmVmb3JlSW5kZXhdID0gJHNjb3BlLm1vZHVsZXMuc3BsaWNlKGJlZm9yZUluZGV4ICtcbiAgICAgICAgMSwgMSxcbiAgICAgICAgJHNjb3BlLm1vZHVsZXNbYmVmb3JlSW5kZXhdKVswXTtcbiAgICB9O1xuICAgICRzY29wZS50b2dnbGVNb2R1bGVDb25maWdXaW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICRtZFNpZGVuYXYoJ3JpZ2h0JykudG9nZ2xlKCk7XG4gICAgfTtcbiAgICAkc2NvcGUuc2VsZWN0TW9kdWxlID0gZnVuY3Rpb24obSkge1xuICAgICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIuZXh0ZW5kKGFuZ3VsYXIuY29weSgkc2NvcGUuZGVmYXVsdE1vZHVsZSksXG4gICAgICAgIGFuZ3VsYXIuY29weShcbiAgICAgICAgICBtKSk7XG4gICAgICAkc2NvcGUubW9kdWxlcy5wdXNoKG1vZHVsZSk7XG4gICAgICAkc2NvcGUudG9nZ2xlTW9kdWxlQ29uZmlnV2luKCk7XG4gICAgfTtcbiAgICAvL+WGheWuuVxuICAgICRzY29wZS5lZGl0Q29udGVudCA9IGZ1bmN0aW9uKG1vZHVsZUluZGV4LCB4LCB5KSB7XG4gICAgICAkc2NvcGUuY3VycmVudEVkaXRNb2R1bGUgPSAkc2NvcGUubW9kdWxlc1ttb2R1bGVJbmRleF07XG4gICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmN1cnJlbnRFZGl0TW9kdWxlLmNvbnRlbnRzLCBmdW5jdGlvbihcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgaW5kZXgpIHtcbiAgICAgICAgaWYgKGNvbnRlbnQueCA9PSB4ICYmIGNvbnRlbnQueSA9PSB5KSB7XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudCA9IGFuZ3VsYXIuZXh0ZW5kKGFuZ3VsYXIuY29weShcbiAgICAgICAgICAgICAgJHNjb3BlLm5ld0NvbnRlbnQpLFxuICAgICAgICAgICAgYW5ndWxhci5jb3B5KGNvbnRlbnQpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUuY3VycmVudEVkaXRDb250ZW50KTtcbiAgICAgICRzY29wZS50b2dnbGVFZGl0Q29udGVudFdpbigpO1xuICAgIH07XG4gICAgJHNjb3BlLnRvZ2dsZUVkaXRDb250ZW50V2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gICAgfTtcbiAgICAkc2NvcGUuYmFubmVyQ29udGVudEVsZW1lbnRQYW5lbDtcbiAgICAkc2NvcGUuYmFubmVyQ29udGVudCA9IHtcbiAgICAgIGxpbms6ICcnLFxuICAgICAgaW1hZ2U6ICcnLFxuICAgICAgaXNFZGl0OiBmYWxzZSxcbiAgICAgIGluZGV4OiAnJyxcbiAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5saW5rID0gJyc7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSAnJztcbiAgICAgICAgdGhpcy5pc0VkaXQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pbmRleCA9ICcnO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLmFkZEJhbm5lckVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5iYW5uZXJDb250ZW50LnJlc2V0KCk7XG4gICAgICAkc2NvcGUuYmFubmVyQ29udGVudEVsZW1lbnRQYW5lbC5zaG93RGlhbG9nKCRzY29wZSk7XG4gICAgfTtcbiAgICAkc2NvcGUuZWRpdEJhbm5lckVsZW1lbnQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgJHNjb3BlLmJhbm5lckNvbnRlbnQuaXNFZGl0ID0gdHJ1ZTtcbiAgICAgICRzY29wZS5iYW5uZXJDb250ZW50LmluZGV4ID0gaW5kZXg7XG4gICAgICAkc2NvcGUuYmFubmVyQ29udGVudC5pbWFnZSA9ICRzY29wZS5jdXJyZW50RWRpdENvbnRlbnQuY29udGVudEltYWdlW1xuICAgICAgICBpbmRleF07XG4gICAgICAkc2NvcGUuYmFubmVyQ29udGVudC5saW5rID0gJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudC5jb250ZW50TGlua1tcbiAgICAgICAgaW5kZXhdO1xuICAgICAgJHNjb3BlLmJhbm5lckNvbnRlbnRFbGVtZW50UGFuZWwuc2hvd0RpYWxvZygkc2NvcGUpO1xuICAgIH07XG4gICAgJHNjb3BlLmNvbmZpcm1CYW5uZXJDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUuYmFubmVyQ29udGVudEVsZW1lbnRQYW5lbC5jbG9zZURpYWxvZygkc2NvcGUpO1xuICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLmJhbm5lckNvbnRlbnQuaW5kZXg7XG4gICAgICBpZiAoJHNjb3BlLmJhbm5lckNvbnRlbnQuaXNFZGl0KSB7XG4gICAgICAgICRzY29wZS5jdXJyZW50RWRpdENvbnRlbnQuY29udGVudExpbmtbaW5kZXhdID1cbiAgICAgICAgICAkc2NvcGUuYmFubmVyQ29udGVudC5saW5rO1xuICAgICAgICAkc2NvcGUuY3VycmVudEVkaXRDb250ZW50LmNvbnRlbnRJbWFnZVtpbmRleF0gPVxuICAgICAgICAgICRzY29wZS5iYW5uZXJDb250ZW50LmltYWdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudC5jb250ZW50TGluay5wdXNoKCRzY29wZS5iYW5uZXJDb250ZW50XG4gICAgICAgICAgLmxpbmspO1xuICAgICAgICAkc2NvcGUuY3VycmVudEVkaXRDb250ZW50LmNvbnRlbnRJbWFnZS5wdXNoKCRzY29wZS5iYW5uZXJDb250ZW50XG4gICAgICAgICAgLmltYWdlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZS5jb25maXJtRWRpdENvbnRlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5jdXJyZW50RWRpdE1vZHVsZS5jb250ZW50c1skc2NvcGUuY3VycmVudEVkaXRDb250ZW50SW5kZXhdID1cbiAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudDtcbiAgICAgICRzY29wZS50b2dnbGVFZGl0Q29udGVudFdpbigpO1xuICAgIH07XG4gICAgJHNjb3BlLmNhbmNlbEVkaXRDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUudG9nZ2xlRWRpdENvbnRlbnRXaW4oKTtcbiAgICB9O1xuICAgICRzY29wZS5kZWxldGVDdXJyZW50RWRpdENvbnRlbnQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmNvbmZpcm0oe1xuICAgICAgICB0aXRsZTogJ+aPkOekuicsXG4gICAgICAgIHRleHRDb250ZW50OiAn5Yig6Zmk5ZCO5peg5rOV5oGi5aSN77yM56Gu6K6k5Yig6Zmk77yfJyxcbiAgICAgICAgb2s6ICfnoa7orqQnLFxuICAgICAgICBjYW5jZWw6ICflj5bmtognXG4gICAgICB9KSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudC5jb250ZW50SW1hZ2Uuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRFZGl0Q29udGVudC5jb250ZW50TGluay5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuY2hhbmdlTWVyZ2VOZXh0ID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gICAgICBpZiAobW9kdWxlLm1lcmdlTmV4dCA9PSAndHJ1ZScgfHwgbW9kdWxlLm1lcmdlTmV4dCA9PSB0cnVlKSB7XG4gICAgICAgIG1vZHVsZS5tZXJnZU5leHQgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZHVsZS5tZXJnZU5leHQgPSB0cnVlO1xuICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLiR3YXRjaCgndGVtcGxhdGUnLCBmdW5jdGlvbih2KSB7XG4gICAgICAkc2NvcGUubW9kdWxlcyA9IHYubW9kdWxlIHx8IFtdO1xuICAgIH0pXG4gICAgaW5pdCgpO1xuICB9KTtcbn07IiwiLyrpm7bpkrHlj5HmlL4qL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuY29udHJvbGxlcignd2VsZmFyZScsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nLCAkZWxlbWVudCwgJG1kU2lkZW5hdiwgJGZpbHRlciwgdXBsb2FkU2VydmljZSwgTmdUYWJsZVBhcmFtcywgd2VsZmFyZVNlcnZpY2UsIHN0YWZmU2VydmljZSwgbW9kYWxTZXJ2aWNlLCBjb21wYW55U2VydmljZSwgdXRpbFNlcnZpY2UsIG1vZGFsU2VydmljZSwgQ09OU1RBTlRTKSB7XG4gICAgICAgIHZhciBvZmZzZXQgPSAwO1xuICAgICAgICB2YXIgbGltaXQgPSAyNTtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5V2VsZmFyZUNvbmZpZyA9IHtcbiAgICAgICAgICAgIHF1ZXJ5V2VsZmFyZUtleTogJydcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5U3RhZmZDb25maWcgPSB7XG4gICAgICAgICAgICBxdWVyeVN0YWZmS2V5OiAnJ1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUucXVlcnlXZWxmYXJlQ29uZmlnID0ge1xuICAgICAgICAgICAgY2hvaWNlczogW3tcbiAgICAgICAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICAgICAgICBkZXNjOiAn5YWo6YOoJ1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiAxLFxuICAgICAgICAgICAgICAgIGRlc2M6ICflvoXlrqHmoLgnXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IDIsXG4gICAgICAgICAgICAgICAgZGVzYzogJ+WuoeaguOmAmui/hydcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogMyxcbiAgICAgICAgICAgICAgICBkZXNjOiAn5a6h5qC45pyq6YCa6L+HJ1xuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZWZhdWx0SXRlbToge1xuICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgIGRlc2M6ICflhajpg6gnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcXVlcnlXZWxmYXJlVHlwZTogMCxcbiAgICAgICAgICAgIHF1ZXJ5V2VsZmFyZUtleTogJycsXG4gICAgICAgICAgICBnZXRPcHRpb25CeVZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5jaG9pY2VzO1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmZpbmRXaGVyZShvcHRpb25zLCB7IHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbihyZWNvcmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRJdGVtID0gcmVjb3JkO1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVdlbGZhcmVDb25maWcucXVlcnlXZWxmYXJlVHlwZSA9IHJlY29yZC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLndlbGZhcmVPZkNvbXBhbnkgPSB7XG4gICAgICAgICAgICBjb21wYW55SWQ6ICcnLFxuICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICBsaW1pdDogbGltaXQsXG4gICAgICAgICAgICB3ZWxmYXJlczogW10sXG4gICAgICAgICAgICBnZXRRdWVyeVBhcmFtczogZnVuY3Rpb24oY29tcGFueUlkKSB7XG4gICAgICAgICAgICAgICAgLy/lhazlj7jkuI3lkIxcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb21wYW55SWQgIT09IGNvbXBhbnlJZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGFueUlkID0gY29tcGFueUlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBsaW1pdDogdGhpcy5saW1pdCxcbiAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiB0aGlzLmNvbXBhbnlJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRXZWxmYXJlT2ZDb21wYW55OiBmdW5jdGlvbih3ZWxmYXJlcykge1xuICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0ICs9IHdlbGZhcmVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB0aGlzLndlbGZhcmVzID0gJCh0aGlzLndlbGZhcmVzKS5jb25jYXQod2VsZmFyZXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBhbnlJZCA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMud2VsZmFyZXMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJHNjb3BlLndlbGZhcmVIZWFkcyA9IFt7XG4gICAgICAgICAgICB0aXRsZTogJ+W6j+WPtycsXG4gICAgICAgICAgICBmaWVsZDogJ2luZGV4J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+WPkeaUvuaXtumXtCcsXG4gICAgICAgICAgICBmaWVsZDogJ2NyZWF0ZVRpbWUnLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICc8c3Bhbj4nICsgJGZpbHRlcignZGF0ZScpKHZhbHVlLCAneXl5eS5NTS5kZCBISDptbTpzcycpICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflj5HmlL7kvIHkuJonLFxuICAgICAgICAgICAgZmllbGQ6ICdjb21wYW55TmFtZScsXG4gICAgICAgICAgICBzaG93OiB0cnVlLFxuICAgICAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuICBzdHlsZT1cIndpZHRoOjE4MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO1wiPicgKyB2ICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+WPkeaUvuaAu+mHkeminScsXG4gICAgICAgICAgICBmaWVsZDogJ29yZGVyRmVlJyxcbiAgICAgICAgICAgIHNob3c6IHRydWUsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuICBzdHlsZT1cIndpZHRoOjE4MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO1wiPicgKyAkZmlsdGVyKCdybWInKSh2YWx1ZSkgKyAnPC9zcGFuPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5pON5L2c6LSm5Y+3JyxcbiAgICAgICAgICAgIGZpZWxkOiAnY29tcGFueU1hbmFnZXJOYW1lJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+aJi+acuuWPtycsXG4gICAgICAgICAgICBmaWVsZDogJ21vYmlsZSdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfluqfmnLonLFxuICAgICAgICAgICAgZmllbGQ6ICd0ZWwnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn54q25oCBJyxcbiAgICAgICAgICAgIGZpZWxkOiAnb3JkZXJTdGF0ZScsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPVwidGV4dCB0ZXh0LScgKyAkZmlsdGVyKCdzdHlsZScpKHZhbHVlLCAnV0VMRkFSRV9TVEFURScpICsgJyBzdGF0ZVwiPicgKyAkZmlsdGVyKCdkZXNjJykodmFsdWUsICdXRUxGQVJFX1NUQVRFJykgKyAnPC9zcGFuPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5pON5L2cJyxcbiAgICAgICAgICAgIGZpZWxkOiAnY29tbWFuZCcsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgcmVjb3JkLCBpbmRleCwgc2NvcGUsIGNvbHVtbikge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc21cIiAgbmctY2xpY2s9XCJzaG93V2VsZmFyZUxpc3RPZkNvbXBhbnkoJyArIFwiJ1wiICsgcmVjb3JkLmNvbXBhbnlJZCArIFwiJ1wiICsgJywkZXZlbnQpXCIgPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1saXN0XCI+PC9zcGFuPjwvYnV0dG9uPicgK1xuICAgICAgICAgICAgICAgICAgICAnJm5ic3AmbmJzcCZuYnNwJyArXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbVwiIGhyZWY9XCJqYXZhc2NyaXB0OjtcIiBuZy1kaXNhYmxlZD1cIignICsgcmVjb3JkLm9yZGVyU3RhdGUgKyAnIT1DT05TVEFOVFMuV0VMRkFSRV9TVEFURS5XQUlUX0FVRElUKVwiIG5nLWNsaWNrPVwiYXVkaXRXZWxmYXJlKCcgKyBcIidcIiArIHJlY29yZC5vcmRlcklkICsgXCInXCIgKyBcIiwncGFzcydcIiArICcsJGV2ZW50KVwiPumAmui/hzwvYnV0dG9uPicgK1xuICAgICAgICAgICAgICAgICAgICAnJm5ic3AmbmJzcCZuYnNwJyArXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kYW5nZXIgYnRuLXNtXCIgaHJlZj1cImphdmFzY3JpcHQ6O1wiIG5nLWRpc2FibGVkPVwiKCcgKyByZWNvcmQub3JkZXJTdGF0ZSArICchPUNPTlNUQU5UUy5XRUxGQVJFX1NUQVRFLldBSVRfQVVESVQpXCIgbmctY2xpY2s9XCJhdWRpdFdlbGZhcmUoJyArIFwiJ1wiICsgcmVjb3JkLm9yZGVySWQgKyBcIidcIiArIFwiLCdyZWZ1c2UnXCIgKyAnLCRldmVudClcIj7mi5Lnu508L2J1dHRvbj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XTtcblxuICAgICAgICAkc2NvcGUud2VsZmFyZURldGFpbFRhYmxlSGVhZHMgPSBbe1xuICAgICAgICAgICAgdGl0bGU6ICfluo/lj7cnLFxuICAgICAgICAgICAgZmllbGQ6ICdpbmRleCdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICfmiYvmnLrlj7cnLFxuICAgICAgICAgICAgZmllbGQ6ICdtb2JpbGUnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5aSH5rOo5ZCNJyxcbiAgICAgICAgICAgIGZpZWxkOiAncmVtYXJrJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+aYteensCcsXG4gICAgICAgICAgICBmaWVsZDogJ2FsaWFzJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+mHkeminScsXG4gICAgICAgICAgICBmaWVsZDogJ2ZlZScsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuICBzdHlsZT1cIndpZHRoOjE4MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO1wiPicgKyAkZmlsdGVyKCdybWInKSh2YWx1ZSkgKyAnPC9zcGFuPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dO1xuICAgICAgICAkc2NvcGUuc3RhZmZIZWFkcyA9IFt7XG4gICAgICAgICAgICB0aXRsZTogJ+W6j+WPtycsXG4gICAgICAgICAgICBmaWVsZDogJ2luZGV4J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICB0aXRsZTogJ+aJi+acuuWPtycsXG4gICAgICAgICAgICBmaWVsZDogJ21vYmlsZSdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGl0bGU6ICflpIfms6jlkI0nLFxuICAgICAgICAgICAgZmllbGQ6ICdyZW1hcmsnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5pi156ewJyxcbiAgICAgICAgICAgIGZpZWxkOiAnYWxpYXMnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5aS05YOPJyxcbiAgICAgICAgICAgIGZpZWxkOiAnYXZhdGFyJyxcbiAgICAgICAgICAgIGdldFZhbHVlOmZ1bmN0aW9uICh2LHJlY29yZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGltZyBjbGFzcz1cImhlYWQtcG9ydHJhaXRcIiBzcmM9JytyZWNvcmQuYXZhdGFyKycvPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5pON5L2cJyxcbiAgICAgICAgICAgIGZpZWxkOiAnY29tbWFuZCcsXG4gICAgICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24odiwgcmVjb3JkLCBpbmRleCwgc2NvcGUsIGNvbHVtbikge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc21cIiAgbmctY2xpY2s9XCJvcGVuRWRpdFN0YWZmV2luKFxcJycgKyByZWNvcmQuaWQgKyAnXFwnKVwiID48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGVuY2lsXCI+PC9zcGFuPjwvYnV0dG9uPicgK1xuICAgICAgICAgICAgICAgICAgICAnJm5ic3AmbmJzcCZuYnNwJyArXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kYW5nZXIgYnRuLXNtXCIgaHJlZj1cImphdmFzY3JpcHQ6O1wiIG5nLWNsaWNrPVwiZGVsZXRlU3RhZmYoXFwnJyArIHJlY29yZC5pZCArICdcXCcpXCI+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRyYXNoXCI+PC9zcGFuPjwvYnV0dG9uPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dO1xuICAgICAgICAvL+mbtumSseihqOagvFxuICAgICAgICB2YXIgd2VsZmFyZURldGFpbE1vZGFsO1xuICAgICAgICAkc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICAkc2NvcGUud2VsZmFyZUxpc3QgPSBbXTtcbiAgICAgICAgJHNjb3BlLndlbGZhcmVEZXRhaWxzID0gW107XG4gICAgICAgICRzY29wZS53ZWxmYXJlRGV0YWlsQ29tcGFueSA9IHt9O1xuICAgICAgICAkc2NvcGUub2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICAkc2NvcGUubGltaXQgPSBsaW1pdDtcbiAgICAgICAgJHNjb3BlLndlbGZhcmVUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgIGNvdW50OiAyNVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHM6IFtdLFxuICAgICAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhZ2VQYXJhbXMgPSB1dGlsU2VydmljZS5yZXNldFBhZ2luYXRpb24oJHNjb3BlLCAkc2NvcGUubGltaXQgKiAocGFyYW1zLnBhZ2UoKSAtIDEpLCBsaW1pdCk7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSAkLmV4dGVuZChwYWdlUGFyYW1zLCB7IGNvbXBhbnlJZDogJHNjb3BlLndlbGZhcmVEZXRhaWxDb21wYW55LmNvbXBhbnlJZCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gd2VsZmFyZVNlcnZpY2UucXVlcnlXZWxmYXJlTGlzdChwKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2VsZmFyZXMgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxTZXJ2aWNlLmluZGV4QXJyYXkocmVzLmNvbnRlbnQsICRzY29wZS5vZmZzZXQgKyAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS53ZWxmYXJlRGV0YWlsTm90ZSA9ICcnO1xuICAgICAgICAkc2NvcGUud2VsZmFyZURldGFpbCA9IHtcbiAgICAgICAgICAgIHJlbWFyazogJycsXG4gICAgICAgICAgICBjcmVhdGVUaW1lOiAwXG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLndlbGZhcmVEZXRhaWxUYWJsZSA9IG5ldyBOZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgICAgIGNvdW50OiAxMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHM6IFtdXG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUud2VsZmFyZURldGFpbEN0cmw7XG4gICAgICAgICRzY29wZS5zZWxlY3RXZWxmYXJlQ29tcGFueSA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcbiAgICAgICAgICAgICRzY29wZS53ZWxmYXJlRGV0YWlsQ29tcGFueSA9IGNvbXBhbnk7XG4gICAgICAgICAgICAkc2NvcGUud2VsZmFyZVRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VhcmNoV2VsZmFyZUJ5S2V5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyRzY29wZS53ZWxmYXJlVGFibGUucmVsb2FkKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmF1ZGl0V2VsZmFyZSA9IGZ1bmN0aW9uKG9yZGVySWQsIHR5cGUsIGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB2YXIgb3JkZXJTdGF0ZSA9IHR5cGUgPT0gJ3JlZnVzZScgPyBDT05TVEFOVFMuV0VMRkFSRV9TVEFURS5SRUZVU0VEIDogQ09OU1RBTlRTLldFTEZBUkVfU1RBVEUuUEFTU0VEO1xuICAgICAgICAgICAgd2VsZmFyZVNlcnZpY2UuYXVkaXRXZWxmYXJlKHtcbiAgICAgICAgICAgICAgICBvcmRlcklkOiBvcmRlcklkLFxuICAgICAgICAgICAgICAgIG9yZGVyU3RhdGU6IG9yZGVyU3RhdGVcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLndlbGZhcmVUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAkbWRTaWRlbmF2KCdsZWZ0JykuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvL+WFrOWPuOmbtumSseWIl+ihqFxuICAgICAgICAkc2NvcGUuc2hvd1dlbGZhcmVMaXN0T2ZDb21wYW55ID0gZnVuY3Rpb24oY29tcGFueUlkLCBlKSB7XG4gICAgICAgICAgICAvL+eCueWHu+mHjee9rumhteeggVxuICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUud2VsZmFyZU9mQ29tcGFueS5yZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9ICRzY29wZS53ZWxmYXJlT2ZDb21wYW55LmdldFF1ZXJ5UGFyYW1zKGNvbXBhbnlJZCk7XG4gICAgICAgICAgICB3ZWxmYXJlU2VydmljZS5xdWVyeVdlbGZhcmVMaXN0KHBhcmFtcykudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUud2VsZmFyZU9mQ29tcGFueS5zZXRXZWxmYXJlT2ZDb21wYW55KHJlcy5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRlbGVtZW50LmZpbmQoJ21kLWxpc3QnKS5vbignc2Nyb2xsJywgXy5kZWJvdW5jZShmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gJCh0aGlzKS5oZWlnaHQoKTtcbiAgICAgICAgICAgIHZhciBib3R0b20gPSB0aGlzLnNjcm9sbEhlaWdodCAtIHRoaXMuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgaWYgKGhlaWdodCArIDUwID49IGJvdHRvbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93V2VsZmFyZUxpc3RPZkNvbXBhbnkoJHNjb3BlLndlbGZhcmVPZkNvbXBhbnkuY29tcGFueUlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMzAwKSk7XG4gICAgICAgIC8v6Zu26ZKx6K+m5oOFXG5cbiAgICAgICAgJHNjb3BlLnNob3dXZWxmYXJlRGV0YWlsID0gZnVuY3Rpb24ob3JkZXJJZCwgaXRlbSkge1xuICAgICAgICAgICAgJHNjb3BlLndlbGZhcmVEZXRhaWwucmVtYXJrID0gaXRlbS5yZW1hcms7XG4gICAgICAgICAgICAkc2NvcGUud2VsZmFyZURldGFpbC5jcmVhdGVUaW1lID0gaXRlbS5jcmVhdGVUaW1lO1xuICAgICAgICAgICAgd2VsZmFyZVNlcnZpY2UucXVlcnlXZWxmYXJlT2JqZWN0TGlzdCh7XG4gICAgICAgICAgICAgICAgb3JkZXJJZDogb3JkZXJJZCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICBsaW1pdDogMTAwMDAwXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS53ZWxmYXJlRGV0YWlscyA9IHJlcy5jb250ZW50O1xuICAgICAgICAgICAgICAgICRzY29wZS53ZWxmYXJlRGV0YWlsVGFibGUuc2V0dGluZ3Moe1xuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0OiB1dGlsU2VydmljZS5pbmRleEFycmF5KHJlcy5jb250ZW50LCAxKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlbGZhcmVEZXRhaWxDdHJsLnNob3dEaWFsb2coJHNjb3BlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAvKuWRmOW3peeuoeeQhiovXG4gICAgICAgIHZhciBzdGFmZkVkaXRNb2RhbDtcbiAgICAgICAgJHNjb3BlLnN0YWZmRGV0YWlsQ3RybDtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRTdGFmZiA9IHtcbiAgICAgICAgICAgIG1vYmlsZTogJycsXG4gICAgICAgICAgICBhbGlhczogJycsXG4gICAgICAgICAgICBhdmF0YXI6ICcnLFxuICAgICAgICAgICAgcmVtYXJrOiAnJ1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc3RhZmYgPSB7XG4gICAgICAgICAgICBjb21wYW55SWQ6ICcnLFxuICAgICAgICAgICAga2V5d29yZDogJycsXG4gICAgICAgICAgICBpdGVtczogW11cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnN0YWZmVGFibGUgPSBuZXcgTmdUYWJsZVBhcmFtcyh7XG4gICAgICAgICAgICBjb3VudDogMjVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgY291bnRzOiBbXSxcbiAgICAgICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLnN0YWZmLmNvbXBhbnlJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwYWdlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW1pdDogJHNjb3BlLmxpbWl0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6ICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwID0gJC5leHRlbmQocGFnZVBhcmFtcywge1xuICAgICAgICAgICAgICAgICAgICBjb21wYW55SWQ6ICRzY29wZS5zdGFmZi5jb21wYW55SWQsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW06ICRzY29wZS5zdGFmZi5rZXl3b3JkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YWZmU2VydmljZS5xdWVyeVN0YWZmTGlzdChwKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhZmYuaXRlbXMgPSByZXMuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnRvdGFsKHJlcy50b3RhbEVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbFNlcnZpY2UuaW5kZXhBcnJheShyZXMuY29udGVudCwgICRzY29wZS5saW1pdCAqIChwYXJhbXMucGFnZSgpIC0gMSkgKyAxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS5zZWFyY2hTdGFmZkJ5S2V5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGFmZi5rZXl3b3JkID0gdmFsdWU7XG4gICAgICAgICAgICAkc2NvcGUuc3RhZmZUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdFN0YWZmQ29tcGFueSA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGFmZi5jb21wYW55SWQgPSBjb21wYW55LmNvbXBhbnlJZDtcbiAgICAgICAgICAgICRzY29wZS5zdGFmZlRhYmxlLnJlbG9hZCgpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2hvd1dlbGZhcmVTZW5kV2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWRTaWRlbmF2KCdyaWdodCcpLnRvZ2dsZSgpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZ2V0U3RhZmZMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzdGFmZlNlcnZpY2UucXVlcnlTdGFmZkxpc3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm9wZW5FZGl0U3RhZmZXaW4gPSBmdW5jdGlvbihzdGFmZklkKSB7XG4gICAgICAgICAgICBzdGFmZlNlcnZpY2UucXVlcnlTdGFmZkRldGFpbCh7XG4gICAgICAgICAgICAgICAgc3RhZmZJZDogc3RhZmZJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFN0YWZmID0gcmVzO1xuICAgICAgICAgICAgICAgIHN0YWZmRWRpdE1vZGFsID0gbW9kYWxTZXJ2aWNlLmluaXRNb2RhbCh7XG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZFRvOiAkZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgb2s6ICRzY29wZS5lZGl0U3RhZmZDb25maXJtXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmVkaXRTdGFmZkNvbmZpcm0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5jdXJyZW50U3RhZmYpO1xuICAgICAgICAgICAgcmV0dXJuIHN0YWZmU2VydmljZS5lZGl0U3RhZmYoJHNjb3BlLmN1cnJlbnRTdGFmZikudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhZmZUYWJsZS5yZWxvYWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuaW1wb3J0U3RhZmZFeGNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdXBsb2FkU2VydmljZS51cGxvYWRGaWxlKCkudGhlbihmdW5jdGlvbihmaWxlKSB7XG4gICAgICAgICAgICAgICAgc3RhZmZTZXJ2aWNlLmV4YW1pbkV4Y2VsKHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuc3RhZmYuY29tcGFueUlkLFxuICAgICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGl0bGUoJ+aIkOWKnycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnZXhjZWzmoKHpqozmiJDlip/vvIzmmK/lkKblvIDlp4vlr7zlhaU/JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9rKCfnoa7lrponKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2FuY2VsKCflj5bmtognKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhZmZTZXJ2aWNlLmltcG9ydFN0YWZmRXhjZWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiAkc2NvcGUuc3RhZmYuY29tcGFueUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YWZmVGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdygkbWREaWFsb2cuYWxlcnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRpdGxlKCfmiJDlip8nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgn5a+85YWl5oiQ5Yqf77yBJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub2soJ+ehruWumicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5hbGVydCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNsaWNrT3V0c2lkZVRvQ2xvc2UodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGl0bGUoJ+Wksei0pScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KHJlcy5jb25zb2xlTG9nLmpvaW4oJzsnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub2soJ+ehruWumicpXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmV4cG9ydFN0YWZmRXhjZWw9ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCdodHRwOi8vcmVzLmtpbmd4aXF1ZS5jb20vaG9sbHBpbi9jcm0vdGVtcGxhdGUvJUU1JTkxJTk4JUU1JUI3JUE1JUU1JUFGJUJDJUU1JTg1JUE1JUU2JUE4JUExJUU2JTlEJUJGLnhscycsJ19ibGFuaycpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZGVsZXRlU3RhZmYgPSBmdW5jdGlvbihzdGFmZklkKSB7XG4gICAgICAgICAgICBzdGFmZlNlcnZpY2UuZGVsZXRlU3RhZmYoe1xuICAgICAgICAgICAgICAgIHN0YWZmSWQ6IHN0YWZmSWRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YWZmVGFibGUucmVsb2FkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cz1bcmVxdWlyZShcIi4vY29udHJvbGxlci9hY2NvdW50LmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvYXBwLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvY29tbWVudHNNYW5hZ2UuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9jb21wYW55LmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvY29uZmlndXJhdGlvbkluZm9ybWF0aW9uLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvZGVhZFN0b2NrLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvZGVsaXZlcnlFZGl0LmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvZmluYW5jZS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL2dvb2RzQ2hvb3NlSGlzdG9yeS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL2dvb2RzQ2hvb3NlT3JkZXIuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9ob2xpZGF5V2VsZmFyZS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL2hvbWUuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9pblN0b3JhZ2UuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9pbmZvcm1hdGlvbi5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL2lzc3VlRHluYW1pYy5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL2xhYmVsc01hbmFnZW1lbnQuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9uZXdQcm9kdWN0UmVjb21tZW5kLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvb3JkZXIuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9waWNrT3JkZXIuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9wb3NpdGlvbk1hbmFnZS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3Byb2R1Y3QuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9wcm9tb3Rpb25PcmRlci5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3Byb21vdGlvblByb2R1Y3QuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9wcm9tb3Rpb25TdWl0ZS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3JvbGUuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9zYWxlc1N0YXRpc3RpY3MuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9zaGVsZi5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3NoZWxmRGV0YWlsLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvc2hlbGZNYW5hZ2UuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci9zdWl0ZUNmZ01hbmFnZS5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3N1aXRlRGlzdHJpYnV0aW9uRHluYW1pYy5qc1wiKSxyZXF1aXJlKFwiLi9jb250cm9sbGVyL3RlYUluZm9ybWF0aW9uLmpzXCIpLHJlcXVpcmUoXCIuL2NvbnRyb2xsZXIvdGVtcGxhdGUuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci90ZW1wbGF0ZUVkaXQuanNcIikscmVxdWlyZShcIi4vY29udHJvbGxlci93ZWxmYXJlLmpzXCIpXSIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5kaXJlY3RpdmUoJ2Jsb2NrQWRkJywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgdGVtcGxhdGVVcmw6ICdkaXJlY3RpdmUvYmxvY2tBZGQuaHRtbCcsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgc2NvcGU6IHsgICdhZGRCbG9jayc6ICcmJyB9LFxuICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjb21wYW55U2VydmljZSkge1xuICAgICAgICRzY29wZS5ibG9ja1NlbGVjdENob2ljZXM9W3sgZGVzYzogJ+WVhuWTgeWQjeensCcsIGNvZGU6ICcwJyB9LCB7ZGVzYzogJ+WVhuWTgWlkJyxjb2RlOiAnMSd9XTtcbiAgICAgICAkc2NvcGUudHlwZT0wO1xuICAgICAgICRzY29wZS5wcm9kdWN0TmFtZT1cIlwiO1xuICAgICAgICRzY29wZS5hZGQ9ZnVuY3Rpb24oKXtcbiAgICAgICAgICAkc2NvcGUuYWRkQmxvY2soe1xuICAgICAgICAgIHByb2R1Y3RJZDokc2NvcGUucHJvZHVjdElkLFxuICAgICAgICAgIHJlYXNvbjokc2NvcGUucmVhc29uLFxuICAgICAgICAgIGNhbGxiYWNrOiRzY29wZS5pbml0XG4gICAgICAgIH0pXG4gICAgICAgfTtcbiAgICAgICAkc2NvcGUuaW5pdD1mdW5jdGlvbigpe1xuICAgICAgICAgICAkc2NvcGUucHJvZHVjdE5hbWU9XCJcIjtcbiAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RJZD1cIlwiO1xuICAgICAgICAgICAkc2NvcGUucmVhc29uPVwiXCI7XG4gICAgICAgfTtcbiAgICAgICAkc2NvcGUuJHdhdGNoKCdwcm9kdWN0SWQnLGZ1bmN0aW9uKHYpe1xuICAgICAgIH0pXG4gICAgICAkc2NvcGUudHlwZVNlbGVjdD1mdW5jdGlvbihpdGVtKXtcbiAgICAgICAgJHNjb3BlLnR5cGU9aXRlbS5jb2RlO1xuICAgICAgICBjb25zb2xlLmxvZyggJHNjb3BlLnR5cGUpXG4gICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5kaXJlY3RpdmUoJ2NvbXBhbnlTZWFyY2hlcicsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgdGVtcGxhdGVVcmw6ICdkaXJlY3RpdmUvY29tcGFueVNlYXJjaGVyLmh0bWwnLFxuICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7ICdzZWxlY3RDb21wYW55JzogJyYnLCAnc3ViY2xhc3MnOiAnQCcsICdlbXB0eUNhbGxiYWNrJzogJyYnIH0sXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGNvbXBhbnlTZXJ2aWNlKSB7XG5cbiAgICAgICAgJHNjb3BlLnN1YmNsYXNzID8gJHNjb3BlLnJvb3RDbGFzcyA9ICRzY29wZS5zdWJjbGFzcyA6ICRzY29wZS5yb290Q2xhc3MgPVxuICAgICAgICAgICdjb2wtbWQtMic7XG4gICAgICAgICRzY29wZS50eXBlSGVhZENvbmZpZ3MgPSB7XG4gICAgICAgICAgZGVib3VuY2U6IHtcbiAgICAgICAgICAgICdkZWZhdWx0JzogNTAwLFxuICAgICAgICAgICAgJ2JsdXInOiAyNTBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdldHRlclNldHRlcjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2hhbmdlVmFsdWUgPSBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICBpZiAoIXN0cikge1xuICAgICAgICAgICAgJHNjb3BlLmVtcHR5Q2FsbGJhY2soKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5nZXRUeXBlSGVhZE9wdGlvbnMgPSBmdW5jdGlvbih2YWx1ZSkgeyAvL+aQnOe0ouWKoOi9vVxuICAgICAgICAgIHJldHVybiBjb21wYW55U2VydmljZS5xdWVyeUNvbXBhbnlMaXN0KHtcbiAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgIGxpbWl0OiA1LFxuICAgICAgICAgICAgZGVsU3RhdGU6IDAsXG4gICAgICAgICAgICBjb21wYW55TmFtZTogdmFsdWVcbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5jb250ZW50O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2VsZWN0VHlwZUhlYWRPcHRpb25zID0gZnVuY3Rpb24oaXRlbSkgeyAvL+aQnOe0oumAieaLqVxuICAgICAgICAgICRzY29wZS5zZWxlY3RDb21wYW55KHsgJ2NvbXBhbnknOiBpdGVtIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTsiLCIvKlxuICrnvJbor5FodG1sXG4gKiBjb21waWxlLWh0bWxcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdjb21waWxlSHRtbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBzY29wZTogZmFsc2UsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjb21waWxlKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgkYXR0cnMuY29tcGlsZUh0bWwsIGZ1bmN0aW9uKGh0bWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGh0bWwpID09ICdbb2JqZWN0IE9iamVjdF0nKSB7IC8v5pWw57uEXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgPSBodG1sLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8v5a2X56ym5LiyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgPSBodG1sICYmIGh0bWwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGNvbXBpbGUoJzxzcGFuPicgKyBzdHIgKyAnPC9zcGFuPicpKCRzY29wZSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmRpcmVjdGl2ZSgnY291bnQnLCBmdW5jdGlvbigkbWRQYW5lbCwgJHRlbXBsYXRlQ2FjaGUsICRjb21waWxlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbnVtOiAnPScsXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U6ICc9JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9jb3VudC5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGx1c0NvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5udW0gPSAkc2NvcGUubnVtICsgMTtcbiAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1pbkNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5udW0gPSAkc2NvcGUubnVtIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRibGNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdudW0nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9uQ2hhbmdlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdkYXRlRm9ybWF0ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCkge1xuXG4gICAgICAgICAgICAgICAgY3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vY29udmVydCBkYXRhIGZyb20gdmlldyBmb3JtYXQgdG8gbW9kZWwgZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vY29udmVydCBkYXRhIGZyb20gbW9kZWwgZm9ybWF0IHRvIHZpZXcgZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhOyAvL2NvbnZlcnRlZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmRpcmVjdGl2ZSgnZGF0ZVBpY2tlcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL2RhdGVQaWNrZXIuaHRtbCcsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICB0aW1lU3RhbXA6ICc9JyxcbiAgICAgICAgICAgICAgICBuZ01vZGVsOic9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kdCA9IG5ldyBEYXRlKHBhcnNlSW50KCRzY29wZS50aW1lU3RhbXApKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3BlbmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLyogICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZURpc2FibGVkOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBkYXRhLmRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGUgPSBkYXRhLm1vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZGUgPT09ICdkYXknICYmIChkYXRlLmdldERheSgpID09PSAwIHx8IGRhdGUuZ2V0RGF5KCkgPT09IDYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdFllYXI6ICd5eXl5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heERhdGU6IG5ldyBEYXRlKDIwMjAsIDUsIDIyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkRhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydGluZ0RheTogMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OyovXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFsdElucHV0Rm9ybWF0cyA9IFsnTSEvZCEveXl5eSddO1xuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuMSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ3RpbWVTdGFtcCcsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmR0ID0gbmV3IERhdGUocGFyc2VJbnQoJHNjb3BlLnRpbWVTdGFtcCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2R0JywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUhPT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRpbWVTdGFtcCA9IHZhbHVlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVN0YW1wPScnO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvKiRzY29wZS5mb3JtYXRzID0gWydkZC1NTU1NLXl5eXknLCAneXl5eS9NTS9kZCcsICdkZC5NTS55eXl5JywgJ3Nob3J0RGF0ZSddOyovXG4gICAgICAgICAgICAgICAgLyokc2NvcGUuY2xlYXJEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kdCA9ICcnO1xuICAgICAgICAgICAgICAgIH07Ki9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ2RpYWxvZycsIGZ1bmN0aW9uKCRtZFBhbmVsLCAkdGVtcGxhdGVDYWNoZSwgJGNvbXBpbGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdAJyxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogJz1pbnN0YW5jZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhbmVsO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb250cm9sbGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKG1kUGFuZWxSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwgJiYgcGFuZWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RpYWxvZyA9IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbCA9ICRlbGVtZW50LmNoaWxkcmVuKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0bXAgPSAkdGVtcGxhdGVDYWNoZS5nZXQoJ2RpcmVjdGl2ZS9kaWFsb2cuaHRtbCcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSAkbWRQYW5lbC5uZXdQYW5lbFBvc2l0aW9uKCkuYWJzb2x1dGUoKS5jZW50ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFjaFRvOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbENsYXNzOiAnZGlhbG9nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0bXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25PcGVuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAxMDAwMDAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46ICRlbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgb25Eb21BZGRlZDogZnVuY3Rpb24oZG9tcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWFsb2cgPSBkb21zWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5fcGFuZWxFbC5maW5kKCdtZC1jb250ZW50JykuYXBwZW5kKGRpYWxvZy5fY29uZmlnLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRG9tUmVtb3ZlZDogZnVuY3Rpb24oZG9tcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWFsb2cgPSBkb21zWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5fY29uZmlnLm9yaWdpbi5hcHBlbmQoZGlhbG9nLl9jb25maWcuY29udGVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgJG1kUGFuZWwub3Blbihjb25maWcpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZSA9IHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmRpcmVjdGl2ZSgnZHJvcERvd24nLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL2Ryb3BEb3duLmh0bWwnLFxuICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgICdzZWxlY3QnOiAnJicsXG4gICAgICAgICdsaXN0JzogJ0AnLCAvL+S8oOWFpeeahOmAieaLqemhueWIl+ihqFxuICAgICAgICAnZGVzY0ZpZWxkJzogJ0AnLCAvL+aMh+WumuaYvuekuuWtl+autVxuICAgICAgICAnZGVmYXVsdERlc2MnOiAnQCcsIC8v6buY6K6k5o+P6L+wXG4gICAgICAgICdkZWZhdWx0SXRlbSc6ICdAJywgLy/pu5jorqTpgInpobkg5qC85byP5Li6eydjb2RlJzonMCcsJ2Rlc2MnOiflkKYnfShkZXNj5b+F6aG75pyJLGNvZGXoh6rkvr8pXG4gICAgICAgICdidG5TdHlsZSc6ICdAJywgLy9idG4tbGluazrml6DmoYbok53oibIgYnRuLWRlZmF1bHQ65pyJ5qGG5oyJ6ZKuXG4gICAgICAgICdkaXNhYmxlZCc6ICdAJywgLy/mmK/lkKblj6/nlKjvvIx0cnVl5Li65LiN5Y+v55So77yMZmFsc2XkuLrlj6/nlKhcbiAgICAgICAgJ3ByZXZlbnRBdXRvU2VsZWN0ZWQnOiAnPSdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsIHNoZWxmU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuZGVzY0ZpZWxkID0gJHNjb3BlLmRlc2NGaWVsZCB8fCAnZGVzYyc7XG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2RlZmF1bHREZXNjJywgZnVuY3Rpb24obmV3VmFsdWUsIG9sZFZhbHVlLCBzY29wZSkge1xuICAgICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgJHNjb3BlLmRlZmF1bHREZXNjID0gbmV3VmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdEl0ZW0gPSBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgICAkc2NvcGUuZGVmYXVsdEl0ZW0gPSBvcHRpb24uaXRlbTtcblxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2xpc3QnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUsIHNjb3BlKSB7XG4gICAgICAgICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkobmV3VmFsdWUpICYmIG5ld1ZhbHVlICE9ICcnKSB7XG4gICAgICAgICAgICAkc2NvcGUubGlzdCA9IEpTT04ucGFyc2UobmV3VmFsdWUpO1xuXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHByZXZlbnRBdXRvU2VsZWN0ZWQgPSAkc2NvcGUucHJldmVudEF1dG9TZWxlY3RlZDtcbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnZGVmYXVsdEl0ZW0nLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUsIHNjb3BlKSB7XG4gICAgICAgICAgdmFyIGRlZmF1bHRJdGVtO1xuICAgICAgICAgIGlmICgkc2NvcGUuZGVmYXVsdEl0ZW0gJiYgXy5pc1N0cmluZygkc2NvcGUuZGVmYXVsdEl0ZW0pKSB7XG4gICAgICAgICAgICBkZWZhdWx0SXRlbSA9IEpTT04ucGFyc2UoJHNjb3BlLmRlZmF1bHRJdGVtKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVmYXVsdEl0ZW0gPSBzY29wZS5kZWZhdWx0SXRlbSB8fCB7fTtcbiAgICAgICAgICB9XG4gICAgICAgICAgJHNjb3BlLmRlZmF1bHREZXNjID0gZGVmYXVsdEl0ZW1bJHNjb3BlLmRlc2NGaWVsZF0gfHxcbiAgICAgICAgICAgICRzY29wZS5kZWZhdWx0RGVzYztcbiAgICAgICAgICBpZiAoIXByZXZlbnRBdXRvU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3QgJiYgJHNjb3BlLnNlbGVjdC5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgICAgaXRlbTogZGVmYXVsdEl0ZW1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwcmV2ZW50QXV0b1NlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ2VjaGFydHNMaW5lJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgdGVtbGF0ZTogJzxkaXYgc3R5bGU9XCJoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO1wiPjwvZGl2PicsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGlkOiAnQCcsXG4gICAgICAgICAgICAgICAgeGF4aXNkYXRhOiAnPScsXG4gICAgICAgICAgICAgICAgc2VyaWVzZGF0YTogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgIC8vIOaMh+WumuWbvuihqOeahOmFjee9rumhueWSjOaVsOaNrlxuICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn6ZSA6YeP6LWw5Yq/5Zu+J1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnYXhpcydcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbGVnZW5kOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBbJ+mUgOmHjyddXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHhBeGlzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiAkc2NvcGUueGF4aXNkYXRhXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHlBeGlzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgc2VyaWVzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ+mUgOmHjycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbGluZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiAkc2NvcGUuc2VyaWVzZGF0YVxuICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIG15Q2hhcnQgPSBlY2hhcnRzLmluaXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJHNjb3BlLmlkKSk7XG4gICAgICAgICAgICAgICAgbXlDaGFydC5zZXRPcHRpb24ob3B0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzExLzIyLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICAvKmFwcC5kaXJlY3RpdmUoJ2ZpeGVkVGFibGVIZWFkZXJzJywgWyckdGltZW91dCcsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gZWxlbWVudC5wYXJlbnRzVW50aWwoYXR0cnMuZml4ZWRUYWJsZUhlYWRlcnMpO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0aWNreVRhYmxlSGVhZGVycyh7c2Nyb2xsYWJsZUFyZWE6IGNvbnRhaW5lciwgXCJmaXhlZE9mZnNldFwiOiAyfSk7XG5cbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTsqL1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmRpcmVjdGl2ZSgnZm9ybVJlcXVpcmVkJywgZnVuY3Rpb24oJGNvbXBpbGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBjb21waWxlOiBmdW5jdGlvbigkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gJGF0dHJzLmZvcm1SZXF1aXJlZDtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuYXR0cignbmctY2xhc3MnLCAkYXR0cnMuY2xhc3MgKyAnIHt7JyArIG5hbWUgKyAnLiRpbnZhbGlkJiYhJyArIG5hbWUgKyAnLiRwcmlzdGluZT8nICsgXCInXCIgKyAnaGFzLWVycm9yJyArIFwiJ1wiICsgJzonICsgXCInJ1wiICsgJ319Jyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3N0OiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29tcGlsZShlbGVtKShzY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGxpbms6ZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKXtcblxuICAgICAgICAgICAgLy8gICAgIHZhciBzdHI9ICRzY29wZS4kZXZhbCgkYXR0cnMuZm9ybVJlcXVpcmVkKTtcbiAgICAgICAgICAgIC8vICAgICAkZWxlbWVudC5hZGRDbGFzcyhzdHIpO1xuICAgICAgICAgICAgLy8gICAgICRjb21waWxlKCRlbGVtZW50KSgkc2NvcGUpO1xuXG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHRhb3hpYW9mZW5nIG9uIDE2LzgvNC5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdsYWJlbHNNYW5hZ2VtZW50cycsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xhYmVsc01hbmFnZW1lbnRzL2xhYmVsc01hbmFnZW1lbnRzLmh0bWwnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwiLypcbiAqQ29tcG9uZW50IGxvZ2luXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmRpcmVjdGl2ZSgnbG9naW4nLCBmdW5jdGlvbigkbG9jYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBtb2RhbFNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXJuYW1lID0gJyc7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBzdyA9ICcnO1xuICAgICAgICAgICAgICAgICRzY29wZS5pc0xvZ2luID0gYXV0aFNlcnZpY2UuaXNMb2dpbigpO1xuICAgICAgICAgICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8v55m76ZmGXG4gICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmxvZ2luKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBzY29wZS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBzdzogJC5oZXhfbWQ1KHNjb3BlLnBzdylcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v55m76ZmG5oiQ5Yqf6KeG5Zu+5Y+Y5YyWXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2dpbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcjaG9tZSc7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJGVsZW1lbnQucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5sb2dpbiBpbnB1dFt0eXBlPXBhc3N3b3JkXScpLnZhbCgnJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmRpcmVjdGl2ZSgnbWRJbWcnLCBmdW5jdGlvbigkZmlsdGVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9tZEltZy5odG1sJyxcbiAgICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGJnOiAnQCcsXG4gICAgICAgIHBhdGg6ICc9JyxcbiAgICAgICAgbWRTdHlsZTogJ0AnLFxuICAgICAgICBpbWdDbGFzczogJ0AnXG4gICAgICB9LFxuICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAgICRzY29wZS51cmwgPSAnJztcbiAgICAgICAgJHNjb3BlLnN0eWxlID0ge307XG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3BhdGgnLCBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgJHNjb3BlLnVybCA9ICRmaWx0ZXIoJ2ltZycpKHYpO1xuICAgICAgICAgIGlmICgkc2NvcGUuYmcpIHtcbiAgICAgICAgICAgICRzY29wZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKCcgKyAkc2NvcGUudXJsICsgJyknO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLmRpcmVjdGl2ZSgnbWRVcGxvYWRlcicsIGZ1bmN0aW9uKHVwbG9hZFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL21kVXBsb2FkZXIuaHRtbCcsXG4gICAgICB0cmFuc2NsdWRlOiBmYWxzZSxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZToge1xuICAgICAgICB2YWx1ZTogJz0nLFxuICAgICAgICBuZ01vZGVsOiAnPScsXG4gICAgICAgIGluZGV4OiAnPScsXG4gICAgICAgIGhpZGVJbnB1dDogJ0AnLCAvL+aYr+WQpumakOiXj+i+k+WFpeahhu+8jOm7mOiupOS4jemakOiXj1xuICAgICAgICBkaWRVcGxvYWQ6ICcmJywgLy/lrozmiJDkuIrkvKDlm57osIPkuovku7ZcbiAgICAgICAgc2l6ZUxpbWl0OiAnQCcsIC8v5bC65a+45aSn5bCP6ZmQ5Yi2XG4gICAgICAgIGlzVXBsb2FkVXB5dW46ICdAJyAvL+aYr+WQpumcgOimgeS4iuS8oOWPiOaLjeS6ke+8jOm7mOiupOS4iuS8oFxuICAgICAgfSxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgICAkc2NvcGUuZmlsZW5hbWVzID0gJyc7XG4gICAgICAgICRzY29wZS5maWxlcyA9IFtdO1xuICAgICAgICAkc2NvcGUucGF0aCA9ICRhdHRycy5wYXRoO1xuICAgICAgICAkc2NvcGUudXBsb2FkVGl0bGUgPSAkc2NvcGUudXBsb2FkVGl0bGUgfHwgJ+S4iuS8oCc7XG5cbiAgICAgICAgJHNjb3BlLmNoYW5nZUZpbGUgPSBmdW5jdGlvbihkb20pIHtcbiAgICAgICAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgICAgIGZpbGVfZG9tOiBkb20sXG4gICAgICAgICAgICBmb2xkZXI6IGFuZ3VsYXIuZWxlbWVudChkb20pLmF0dHIoJ3BhdGgnKSxcbiAgICAgICAgICAgIHNpemVfbGltaXQ6IEpTT04ucGFyc2UoJHNjb3BlLnNpemVMaW1pdCB8fCAne30nKSxcbiAgICAgICAgICAgIGlzX3VwbG9hZF91cHl1bjogJHNjb3BlLmlzVXBsb2FkVXB5dW4gfHwgJ3RydWUnXG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgc3RyX2RvbSA9IGFuZ3VsYXIuZWxlbWVudChkb20pLm5leHQoKS5maW5kKCdpbnB1dCcpO1xuICAgICAgICAgIHVwbG9hZFNlcnZpY2UudXBsb2FkKG9wdHMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUudmFsdWUgPSByZXMucGF0aDtcbiAgICAgICAgICAgICRzY29wZS5maWxlbmFtZXMgPSByZXMucGF0aDtcbiAgICAgICAgICAgIHZhciBkaWRVcGxvYWQgPSAkc2NvcGUuZGlkVXBsb2FkIHx8IGZ1bmN0aW9uKCkge307XG4gICAgICAgICAgICBkaWRVcGxvYWQoe1xuICAgICAgICAgICAgICBmaWxlOiByZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTtcbiIsIi8qXG4gKkNvbXBvbmVudCBsb2dpblxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ21vZHVsZScsIGZ1bmN0aW9uKCRmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9tb2R1bGUuaHRtbCcsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBtb2R1bGVMYXlvdXQ6ICc9JyxcbiAgICAgICAgICAgICAgICBtb2R1bGVJbmRleDogJ0AnLFxuICAgICAgICAgICAgICAgIGVkaXRDb250ZW50OiAnPScsXG4gICAgICAgICAgICAgICAgaXNJblRlbXBsYXRlOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIG1vZGFsU2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNBcnJheSA9IGZ1bmN0aW9uKGFycnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuaXNBcnJheShhcnJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbCA9IF8ucmFuZ2UoJHNjb3BlLm1vZHVsZUxheW91dC53aWR0aCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJvdyA9IF8ucmFuZ2UoJHNjb3BlLm1vZHVsZUxheW91dC5oZWlnaHQpO1xuICAgICAgICAgICAgICAgICRzY29wZS5jZWxscyA9ICRzY29wZS5tb2R1bGVMYXlvdXQuY29udGVudHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbmRlclN0eWxlID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRlbXBsYXRlID0gJHNjb3BlLmlzSW5UZW1wbGF0ZSAhPT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5oYXNDb250ZW50ID0gZnVuY3Rpb24oeCwgeSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IF8uZmluZCgkc2NvcGUuY2VsbHMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnggPT0geCAmJiBpdGVtLnkgPT0geTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVuZGVyU3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGNvbnRlbnQud2lkdGggKiAxMDAgKyAnJScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBjb250ZW50LmhlaWdodCAqIDEwMCArICclJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5ub0JvcmRlciA9PSAndHJ1ZScgPyAkc2NvcGUucmVuZGVyU3R5bGUuYm9yZGVyID0gMCA6ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5jb250ZW50SW1hZ2UgJiYgY29udGVudC5jb250ZW50SW1hZ2VbMF0gPyAkc2NvcGUucmVuZGVyU3R5bGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZEltYWdlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXJsKCcgKyAkZmlsdGVyKCdpbWcnKShjb250ZW50LmNvbnRlbnRJbWFnZVswXSkgKyAnKScgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFjb250ZW50O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdtc1N0ZXBwZXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICByZXF1aXJlOiBbJ2Zvcm0nLCAnbXNTdGVwcGVyJ10sXG4gICAgICAgICAgICBwcmlvcml0eTogMTAwMSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL21zU3RlcHBlci5odG1sJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbW9kZWw6IFwiPW5nTW9kZWxcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCR0aW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vIERhdGFcbiAgICAgICAgICAgICAgICBtZS5tYWluRm9ybSA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIG1lLnN0ZXBzID0gW107XG4gICAgICAgICAgICAgICAgbWUuY3VycmVudFN0ZXAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgbWUuY3VycmVudFN0ZXBOdW1iZXIgPSAxO1xuXG4gICAgICAgICAgICAgICAgLy8gTWV0aG9kc1xuICAgICAgICAgICAgICAgIG1lLnJlZ2lzdGVyTWFpbkZvcm0gPSByZWdpc3Rlck1haW5Gb3JtO1xuICAgICAgICAgICAgICAgIG1lLnJlZ2lzdGVyU3RlcCA9IHJlZ2lzdGVyU3RlcDtcbiAgICAgICAgICAgICAgICBtZS5zZXR1cFN0ZXBzID0gc2V0dXBTdGVwcztcbiAgICAgICAgICAgICAgICBtZS5yZXNldEZvcm0gPSByZXNldEZvcm07XG5cbiAgICAgICAgICAgICAgICBtZS5zZXRDdXJyZW50U3RlcCA9IHNldEN1cnJlbnRTdGVwO1xuXG4gICAgICAgICAgICAgICAgbWUuZ290b1N0ZXAgPSBnb3RvU3RlcDtcbiAgICAgICAgICAgICAgICBtZS5nb3RvUHJldmlvdXNTdGVwID0gZ290b1ByZXZpb3VzU3RlcDtcbiAgICAgICAgICAgICAgICBtZS5nb3RvTmV4dFN0ZXAgPSBnb3RvTmV4dFN0ZXA7XG4gICAgICAgICAgICAgICAgbWUuZ290b0ZpcnN0U3RlcCA9IGdvdG9GaXJzdFN0ZXA7XG4gICAgICAgICAgICAgICAgbWUuZ290b0xhc3RTdGVwID0gZ290b0xhc3RTdGVwO1xuXG4gICAgICAgICAgICAgICAgbWUuaXNGaXJzdFN0ZXAgPSBpc0ZpcnN0U3RlcDtcbiAgICAgICAgICAgICAgICBtZS5pc0xhc3RTdGVwID0gaXNMYXN0U3RlcDtcblxuICAgICAgICAgICAgICAgIG1lLmlzU3RlcEN1cnJlbnQgPSBpc1N0ZXBDdXJyZW50O1xuICAgICAgICAgICAgICAgIG1lLmlzU3RlcERpc2FibGVkID0gaXNTdGVwRGlzYWJsZWQ7XG4gICAgICAgICAgICAgICAgbWUuaXNTdGVwT3B0aW9uYWwgPSBpc1N0ZXBPcHRpb25hbDtcbiAgICAgICAgICAgICAgICBtZS5pc1N0ZXBWYWxpZCA9IGlzU3RlcFZhbGlkO1xuICAgICAgICAgICAgICAgIG1lLmlzU3RlcE51bWJlclZhbGlkID0gaXNTdGVwTnVtYmVyVmFsaWQ7XG5cbiAgICAgICAgICAgICAgICBtZS5pc0Zvcm1WYWxpZCA9IGlzRm9ybVZhbGlkO1xuXG4gICAgICAgICAgICAgICAgLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogUmVnaXN0ZXIgdGhlIG1haW4gZm9ybVxuICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIGZvcm1cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZWdpc3Rlck1haW5Gb3JtKGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgbWUubWFpbkZvcm0gPSBmb3JtO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFJlZ2lzdGVyIGEgc3RlcFxuICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc2NvcGVcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gZm9ybVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyU3RlcChlbGVtZW50LCBzY29wZSwgZm9ybSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZTogc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtOiBmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RlcE51bWJlcjogc2NvcGUuc3RlcCB8fCAobWUuc3RlcHMubGVuZ3RoICsgMSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwVGl0bGU6IHNjb3BlLnN0ZXBUaXRsZVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFB1c2ggdGhlIHN0ZXAgaW50byBzdGVwcyBhcnJheVxuICAgICAgICAgICAgICAgICAgICBtZS5zdGVwcy5wdXNoKHN0ZXApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNvcnQgc3RlcHMgYnkgc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAgICBtZS5zdGVwcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnN0ZXBOdW1iZXIgLSBiLnN0ZXBOdW1iZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFNldHVwIHN0ZXBzIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldHVwU3RlcHMoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLnNldEN1cnJlbnRTdGVwKG1lLmN1cnJlbnRTdGVwTnVtYmVyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBSZXNldCBzdGVwcyBhbmQgdGhlIG1haW4gZm9ybVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGltZW91dCBpcyByZXF1aXJlZCBoZXJlIGJlY2F1c2Ugd2UgbmVlZCB0b1xuICAgICAgICAgICAgICAgICAgICAvLyBsZXQgZm9ybSBtb2RlbCB0byByZXNldCBiZWZvcmUgc2V0dGluZyB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gc3RhdHVzZXNcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCBhbGwgdGhlIHN0ZXBzXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1lLnN0ZXBzLmxlbmd0aDsgeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc3RlcHNbeF0uZm9ybS4kc2V0UHJpc3RpbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5zdGVwc1t4XS5mb3JtLiRzZXRVbnRvdWNoZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIG1haW4gZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgbWUubWFpbkZvcm0uJHNldFByaXN0aW5lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZS5tYWluRm9ybS4kc2V0VW50b3VjaGVkKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdvIHRvIGZpcnN0IHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG9GaXJzdFN0ZXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBTZXQgY3VycmVudCBzdGVwXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldEN1cnJlbnRTdGVwKHN0ZXBOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHN0ZXBOdW1iZXIgaXMgbm90IGEgdmFsaWQgc3RlcCBudW1iZXIsIGJhaWwuLi5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1N0ZXBOdW1iZXJWYWxpZChzdGVwTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IHN0ZXAgbnVtYmVyXG4gICAgICAgICAgICAgICAgICAgIG1lLmN1cnJlbnRTdGVwTnVtYmVyID0gc3RlcE51bWJlcjtcblxuICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIGFsbCBzdGVwc1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lLnN0ZXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZS5zdGVwc1tpXS5lbGVtZW50LmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHRoZSBjdXJyZW50IHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgbWUuc3RlcHNbbWUuY3VycmVudFN0ZXBOdW1iZXIgLSAxXS5lbGVtZW50LnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR28gdG8gYSBzdGVwXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdvdG9TdGVwKHN0ZXBOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWUuc2V0Q3VycmVudFN0ZXAoc3RlcE51bWJlcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR28gdG8gdGhlIHByZXZpb3VzIHN0ZXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnb3RvUHJldmlvdXNTdGVwKCkge1xuICAgICAgICAgICAgICAgICAgICBtZS5zZXRDdXJyZW50U3RlcChtZS5jdXJyZW50U3RlcE51bWJlciAtIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEdvIHRvIHRoZSBuZXh0IHN0ZXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnb3RvTmV4dFN0ZXAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLnNldEN1cnJlbnRTdGVwKG1lLmN1cnJlbnRTdGVwTnVtYmVyICsgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogR28gdG8gdGhlIGZpcnN0IHN0ZXBcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnb3RvRmlyc3RTdGVwKCkge1xuICAgICAgICAgICAgICAgICAgICBtZS5zZXRDdXJyZW50U3RlcCgxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBHbyB0byB0aGUgbGFzdCBzdGVwXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ290b0xhc3RTdGVwKCkge1xuICAgICAgICAgICAgICAgICAgICBtZS5zZXRDdXJyZW50U3RlcChtZS5zdGVwcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIENoZWNrIGlmIHRoZSBjdXJyZW50IHN0ZXAgaXMgdGhlIGZpcnN0IHN0ZXBcbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzRmlyc3RTdGVwKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWUuY3VycmVudFN0ZXBOdW1iZXIgPT09IDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgc3RlcCBpcyB0aGUgbGFzdCBzdGVwXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpc0xhc3RTdGVwKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWUuY3VycmVudFN0ZXBOdW1iZXIgPT09IG1lLnN0ZXBzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gc3RlcCBpcyB0aGUgY3VycmVudCBvbmVcbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBzdGVwTnVtYmVyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge251bGx8Ym9vbGVhbn1cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpc1N0ZXBDdXJyZW50KHN0ZXBOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHN0ZXBOdW1iZXIgaXMgbm90IGEgdmFsaWQgc3RlcCBudW1iZXIsIGJhaWwuLi5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1N0ZXBOdW1iZXJWYWxpZChzdGVwTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWUuY3VycmVudFN0ZXBOdW1iZXIgPT09IHN0ZXBOdW1iZXI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHN0ZXAgc2hvdWxkIGJlIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtudWxsfGJvb2xlYW59XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNTdGVwRGlzYWJsZWQoc3RlcE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgc3RlcE51bWJlciBpcyBub3QgYSB2YWxpZCBzdGVwIG51bWJlciwgYmFpbC4uLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU3RlcE51bWJlclZhbGlkKHN0ZXBOdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXNhYmxlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc3RlcE51bWJlcjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU3RlcFZhbGlkKGkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpc2FibGVkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIENoZWNrIGlmIHRoZSBnaXZlbiBzdGVwIGlzIG9wdGlvbmFsXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtudWxsfGJvb2xlYW59XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNTdGVwT3B0aW9uYWwoc3RlcE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgc3RlcE51bWJlciBpcyBub3QgYSB2YWxpZCBzdGVwIG51bWJlciwgYmFpbC4uLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU3RlcE51bWJlclZhbGlkKHN0ZXBOdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZS5zdGVwc1tzdGVwTnVtYmVyIC0gMV0uc2NvcGUub3B0aW9uYWxTdGVwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIENoZWNrIGlmIHRoZSBnaXZlbiBzdGVwIGlzIHZhbGlkXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0gc3RlcE51bWJlclxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtudWxsfGJvb2xlYW59XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNTdGVwVmFsaWQoc3RlcE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgc3RlcE51bWJlciBpcyBub3QgYSB2YWxpZCBzdGVwIG51bWJlciwgYmFpbC4uLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU3RlcE51bWJlclZhbGlkKHN0ZXBOdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBzdGVwIGlzIG9wdGlvbmFsLCBhbHdheXMgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3RlcE9wdGlvbmFsKHN0ZXBOdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZS5zdGVwc1tzdGVwTnVtYmVyIC0gMV0uZm9ybS4kdmFsaWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHN0ZXAgbnVtYmVyIGlzIGEgdmFsaWQgc3RlcCBudW1iZXJcbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSBzdGVwTnVtYmVyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNTdGVwTnVtYmVyVmFsaWQoc3RlcE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShzdGVwTnVtYmVyIDwgMSB8fCBzdGVwTnVtYmVyID4gbWUuc3RlcHMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBDaGVjayBpZiB0aGUgZW50aXJlIGZvcm0gaXMgdmFsaWRcbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzRm9ybVZhbGlkKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWUubWFpbkZvcm0uJHZhbGlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21waWxlOiBmdW5jdGlvbih0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRFbGVtZW50LmFkZENsYXNzKCdtcy1zdGVwcGVyJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzLCBjdHJscylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBGb3JtQ3RybCA9IGN0cmxzWzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgTXNTdGVwcGVyQ3RybCA9IGN0cmxzWzFdO1xuICAgICAgICAgICAgICAgICAgICBNc1N0ZXBwZXJDdHJsLnJlZ2lzdGVyTWFpbkZvcm0oRm9ybUN0cmwpO1xuICAgICAgICAgICAgICAgICAgICBNc1N0ZXBwZXJDdHJsLnNldHVwU3RlcHMoKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdtc1N0ZXBwZXJTdGVwJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgcmVxdWlyZTogWydmb3JtJywgJ15tc1N0ZXBwZXInXSxcbiAgICAgICAgICAgIHByaW9yaXR5OiAxMDAwLFxuICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHN0ZXA6ICc9PycsXG4gICAgICAgICAgICAgICAgc3RlcFRpdGxlOiAnPT8nLFxuICAgICAgICAgICAgICAgIG9wdGlvbmFsU3RlcDogJz0/J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdEVsZW1lbnQuYWRkQ2xhc3MoJ21zLXN0ZXBwZXItc3RlcCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgaUVsZW1lbnQsIGlBdHRycywgY3RybHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIEZvcm1DdHJsID0gY3RybHNbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBNc1N0ZXBwZXJDdHJsID0gY3RybHNbMV07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSXMgaXQgYW4gb3B0aW9uYWwgc3RlcD9cbiAgICAgICAgICAgICAgICAgICAgc2NvcGUub3B0aW9uYWxTdGVwID0gYW5ndWxhci5pc0RlZmluZWQoaUF0dHJzLm9wdGlvbmFsU3RlcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgTXNTdGVwcGVyQ3RybC5yZWdpc3RlclN0ZXAoaUVsZW1lbnQsIHNjb3BlLCBGb3JtQ3RybCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSGlkZSB0aGUgc3RlcCBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIGlFbGVtZW50LmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ25hdmlnYXRvcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL25hdmlnYXRvci5odG1sJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICAgICAgIFx0XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHRhb3hpYW9mZW5nIG9uIDE2LzcvMjguXG4gKi9cbi8qXG4gKue8luivkWh0bWxcbiAqIGNvbXBpbGUtaHRtbFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdhY2NvdW50JywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICAvLyB0ZW1wbGF0ZVVybDonYWNjb3VudC9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjb21waWxlKSB7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ29uRmluaXNoUmVuZGVyRmlsdGVycycsIGZ1bmN0aW9uKCR0aW1lb3V0KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuJGxhc3QgPT09IHRydWUpIHsgLy/liKTmlq3mmK/lkKbmmK/mnIDlkI7kuIDmnaHmlbDmja4gIFxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCduZ1JlcGVhdEZpbmlzaGVkJyk7IC8v5ZCR54i257qnc2NvcGXkvKDpgIFuZ1JlcGVhdEZpbmlzaGVk5ZG95LukIFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdwYW5lbCcsIGZ1bmN0aW9uKCRtZFBhbmVsLCAkdGVtcGxhdGVDYWNoZSwgJGNvbXBpbGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdAJyxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogJz1pbnN0YW5jZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhbmVsO1xuICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSAkKCcjY29udGFpbmVyJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvbnRyb2xsZXInKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbihtZFBhbmVsUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsICYmIHBhbmVsLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dEaWFsb2cgPSBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSAkY29tcGlsZSgkZWxlbWVudC5odG1sKCkpKHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9ICR0ZW1wbGF0ZUNhY2hlLmdldCgnZGlyZWN0aXZlL2RpYWxvZy5odG1sJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9ICRtZFBhbmVsLm5ld1BhbmVsUG9zaXRpb24oKS5hYnNvbHV0ZSgpLmNlbnRlcigpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNoVG86IGNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsQ2xhc3M6ICdkaWFsb2cnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6IHRtcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JhY2tkcm9wOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlc2NhcGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbk9wZW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDIwNTUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogJGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRvbUFkZGVkOiBmdW5jdGlvbihkb21zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpYWxvZyA9IGRvbXNbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nLl9wYW5lbEVsLmZpbmQoJ21kLWNvbnRlbnQnKS5hcHBlbmQoZGlhbG9nLl9jb25maWcuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgb25Eb21SZW1vdmVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6ICdzY3JvbGwnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHlBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZFBhbmVsLm9wZW4oY29uZmlnKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlID0gdGhpcztcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2c9dGhpcy5jbG9zZURpYWxvZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuZGlyZWN0aXZlKCdwZXJtaXNzaW9ucycsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgdGVtcGxhdGVVcmw6ICdkaXJlY3RpdmUvcGVybWlzc2lvbnMuaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBhbGw6ICc9JyxcbiAgICAgICAgY2hlY2tlZDogJz0nXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgIGlmICh0eXBlb2YoJHNjb3BlLmNoZWNrZWQpID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgdGhyb3cgXCI8cGVybWlzc2lvbnM+IE1pc3NpbmcgYXR0cmlidXRlICdjaGVja2VkJy5cIjtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuY2hlY2tlZFBlcm1pc3Npb25zID0gbmV3IENoZWNrZWRQZXJtaXNzaW9ucygkc2NvcGUuYWxsLCAkc2NvcGUuY2hlY2tlZCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmZ1bmN0aW9uIENoZWNrZWRQZXJtaXNzaW9ucyhhbGxQZXJtaXNzaW9ucywgY2hlY2tlZElkcykge1xuICB2YXIgZGljdCA9IHt9O1xuICB2YXIgdG9JZCA9IGZ1bmN0aW9uKHBlcm1pc3Npb24pIHtcbiAgICByZXR1cm4gcGVybWlzc2lvbi5pZDtcbiAgfTtcbiAgLy8g5Yid5aeL5YyW5bey57uP6YCJ5oup55qE5p2D6ZmQXG4gIGFuZ3VsYXIuZm9yRWFjaChhbGxQZXJtaXNzaW9ucywgZnVuY3Rpb24oZ3JvdXApIHtcbiAgICBpZighZ3JvdXAucGVybWlzc2lvbnMpIHJldHVybjtcbiAgICBkaWN0W2dyb3VwLmlkXSA9IGdyb3VwLnBlcm1pc3Npb25zLm1hcCh0b0lkKS5maWx0ZXIoZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiBjaGVja2VkSWRzLmluZGV4T2YoaWQpID4gLTE7XG4gICAgfSk7XG4gIH0pO1xuICB2YXIgaXNDaGVja2VkID0gZnVuY3Rpb24oZ3JvdXAsIHBlcm1pc3Npb24pIHtcbiAgICB2YXIgZ3JvdXBJZCA9IGdyb3VwLmlkO1xuICAgIHJldHVybiBkaWN0Lmhhc093blByb3BlcnR5KGdyb3VwSWQpICYmIGRpY3RbZ3JvdXBJZF0uaW5kZXhPZihwZXJtaXNzaW9uLmlkKSA+IC0xO1xuICB9O1xuICB2YXIgdG9nZ2xlID0gZnVuY3Rpb24oZ3JvdXAsIHBlcm1pc3Npb24pIHtcbiAgICB2YXIgZ3JvdXBJZCA9IGdyb3VwLmlkO1xuICAgIHZhciBwZXJtaXNzaW9uSWQgPSBwZXJtaXNzaW9uLmlkO1xuICAgIC8vIOabtOaWsOWtl+WFuFxuICAgIGlmIChkaWN0Lmhhc093blByb3BlcnR5KGdyb3VwSWQpKSB7XG4gICAgICB2YXIgY2hlY2tlZEluR3JvdXAgPSBkaWN0W2dyb3VwSWRdO1xuICAgICAgdmFyIGluZGV4ID0gY2hlY2tlZEluR3JvdXAuaW5kZXhPZihwZXJtaXNzaW9uSWQpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgY2hlY2tlZEluR3JvdXAuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoZWNrZWRJbkdyb3VwLnB1c2gocGVybWlzc2lvbklkKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZGljdFtncm91cElkXSA9IFtwZXJtaXNzaW9uSWRdO1xuICAgIH1cbiAgICAvLyDmm7TmlrDmlbDnu4RcbiAgICB2YXIgaW5kZXggPSBjaGVja2VkSWRzLmluZGV4T2YocGVybWlzc2lvbklkKTtcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgY2hlY2tlZElkcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjaGVja2VkSWRzLnB1c2gocGVybWlzc2lvbklkKTtcbiAgICB9XG4gIH07XG4gIHZhciBzZWxlY3RBbGwgPSBmdW5jdGlvbihncm91cCkge1xuICAgIHZhciBpZHMgPSBncm91cC5wZXJtaXNzaW9ucy5tYXAodG9JZCk7XG4gICAgLy8g5pu05paw5a2X5YW4XG4gICAgZGljdFtncm91cC5pZF0gPSBpZHM7XG4gICAgLy8g5pu05paw5pWw57uEXG4gICAgYW5ndWxhci5mb3JFYWNoKGdyb3VwLnBlcm1pc3Npb25zLCBmdW5jdGlvbihwZXJtaXNzaW9uKSB7XG4gICAgICBpZiAoY2hlY2tlZElkcy5pbmRleE9mKHBlcm1pc3Npb24uaWQpIDwgMCkge1xuICAgICAgICBjaGVja2VkSWRzLnB1c2gocGVybWlzc2lvbi5pZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIHZhciBpbnZlcnNlU2VsZWN0aW9uID0gZnVuY3Rpb24oZ3JvdXApIHtcbiAgICB2YXIgcGVybWlzc2lvbnMgPSBncm91cC5wZXJtaXNzaW9uc1xuICAgICAgLmZpbHRlcihmdW5jdGlvbihwZXJtaXNzaW9uKSB7XG4gICAgICAgIHJldHVybiAhaXNDaGVja2VkKGdyb3VwLCBwZXJtaXNzaW9uKTtcbiAgICAgIH0pO1xuICAgIHZhciBpZHMgPSBwZXJtaXNzaW9ucy5tYXAodG9JZCk7XG4gICAgdmFyIG9sZElkcyA9IGRpY3RbZ3JvdXAuaWRdO1xuICAgIC8vIOabtOaWsOWtl+WFuFxuICAgIGRpY3RbZ3JvdXAuaWRdID0gaWRzO1xuICAgIC8vIOabtOaWsOaVsOe7hFxuICAgIGFuZ3VsYXIuZm9yRWFjaChvbGRJZHMsIGZ1bmN0aW9uKG9sZElkKSB7XG4gICAgICB2YXIgaW5kZXggPSBjaGVja2VkSWRzLmluZGV4T2Yob2xkSWQpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgY2hlY2tlZElkcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNoZWNrZWRJZHMgPSBjaGVja2VkSWRzLmNvbmNhdChpZHMpO1xuICB9O1xuICB0aGlzLmlzQ2hlY2tlZCA9IGlzQ2hlY2tlZDtcbiAgdGhpcy50b2dnbGUgPSB0b2dnbGU7XG4gIHRoaXMuc2VsZWN0QWxsID0gc2VsZWN0QWxsO1xuICB0aGlzLmludmVyc2VTZWxlY3Rpb24gPSBpbnZlcnNlU2VsZWN0aW9uO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5kaXJlY3RpdmUoJ3Byb2R1Y3RTZWFyY2hlcicsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL3Byb2R1Y3RTZWFyY2hlci5odG1sJyxcbiAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICByZXBsYWNlOnRydWUsXG4gICAgICBzY29wZToge3Byb2R1Y3RJZDpcIj1cIixwcm9kdWN0TmFtZTpcIj1cIn0sXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIHByb2R1Y3RTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS50eXBlSGVhZENvbmZpZ3MgPSB7XG4gICAgICAgICAgZGVib3VuY2U6IHtcbiAgICAgICAgICAgICdkZWZhdWx0JzogNTAwLFxuICAgICAgICAgICAgJ2JsdXInOiAyNTBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdldHRlclNldHRlcjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2hhbmdlVmFsdWUgPSBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5nZXRUeXBlSGVhZE9wdGlvbnMgPSBmdW5jdGlvbih2YWx1ZSkgeyAvL+aQnOe0ouWKoOi9vVxuICAgICAgICAgIHJldHVybiBwcm9kdWN0U2VydmljZS5xdWVyeVByb2R1Y3RCeUtleSh7XG4gICAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgICBsaW1pdDogNSxcbiAgICAgICAgICAgIGRlbFN0YXRlOiAwLFxuICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHZhbHVlXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuY29udGVudDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdFR5cGVIZWFkT3B0aW9ucyA9IGZ1bmN0aW9uKGl0ZW0pIHsgLy/mkJzntKLpgInmi6lcblxuICAgICAgICAkc2NvcGUucHJvZHVjdElkPWl0ZW0uaGVhZGVyLmlkO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5wcm9kdWN0SWQpXG4gICAgICAgICBcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdwcm9tb3Rpb25TZWFyY2hlcicsIGZ1bmN0aW9uKHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9wcm9tb3Rpb25TZWFyY2guaHRtbCcsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICAnc2VhcmNoJzogJyYnLFxuICAgICAgICAgICAgICAgICdzaG93VGltZVNlbGVjdCc6ICdAJyxcbiAgICAgICAgICAgICAgICAnaXNVcGRhdGVUaW1lQ2hvaWNlcyc6ICc9JyxcbiAgICAgICAgICAgICAgICAnc2VhcmNoQ2hvaWNlcyc6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgXHRjb25zb2xlLmxvZygkc2NvcGUuc2VhcmNoQ2hvaWNlcylcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RpbWVTZWxlY3QgPSAkc2NvcGUuc2hvd1RpbWVTZWxlY3QgfHwgJ3RydWUnO1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHtzZWFyY2hTZWxlY3Q6MX07XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zaG93VGltZVNlbGVjdCA9PSAndHJ1ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLnN0YXJ0VGltZSA9IG5ldyBEYXRlKHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZURpcyhuZXcgRGF0ZSgpLCAtNywgJ3l5eXktTU0tZGQnKSArICcgMDA6MDA6MDAnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmVuZFRpbWUgPSBuZXcgRGF0ZSh1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGUobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKSArIFwiIDIzOjU5OjU5XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8kc2NvcGUuaXNVcGRhdGVUaW1lQ2hvaWNlcz1beyBkZXNjOiAn5LiL5Y2V5pe26Ze0JywgY29kZTogJzAnIH0sIHsgZGVzYzogJ+mihOe6pumAgei0p+aXtumXtCcsIGNvZGU6ICcxJyB9XTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCRzY29wZS5pc1VwZGF0ZVRpbWVDaG9pY2VzKVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RJc1VwYWRhdGUgPSBmdW5jdGlvbihjaG9pY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmlzVXBhdGVUaW1lID0gcGFyc2VJbnQoY2hvaWNlLmNvZGUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaFNlbGVjdCA9IGZ1bmN0aW9uKGNob2ljZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc2VhcmNoU2VsZWN0ID0gcGFyc2VJbnQoY2hvaWNlLmNvZGUpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuY29tcGFueU5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucXVlcnlQYXJhbXMuc2VhcmNoU2VsZWN0KVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLmtleVByZXNzU2VhcmNoID0gZnVuY3Rpb24oZSwgcXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykgeyAvL+Wbnui9pumUrlxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHF1ZXJ5UGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFdlbGZhcmVDb21wYW55ID0gZnVuY3Rpb24oY29tcGFueSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5jb21wYW55TmFtZT0gY29tcGFueS5jb21wYW55SWQ7XG5cbiAgICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCdyZXF1aXJlZElucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIGVsZW1lbnQub24oXCJrZXl1cFwiLGZ1bmN0aW9uKGV2KXtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gZXYudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciBwRWxlID0gZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgICAgICAgICAgICBpZih2YWwubGVuZ3RoPT0wJiYhcEVsZS5oYXNDbGFzcygnaGFzLWVycm9yJykpe1xuICAgICAgICAgICAgICAgIFx0cEVsZS5hZGRDbGFzcygnaGFzLWVycm9yJyk7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgXHRwRWxlLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3InKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuXG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmRpcmVjdGl2ZSgnc2VhcmNoR3JvdXAnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9zZWFyY2hHcm91cC5odG1sJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBrZXk6ICc9JyxcbiAgICAgICAgICAgICAgICBzZWFyY2hGbjogJz0nLFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnQCcsXG4gICAgICAgICAgICAgICAgY2xhc3M6J0AnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2hGbiAmJiAkc2NvcGUuc2VhcmNoRm4uY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuZGlyZWN0aXZlKCdzaWRlYmFyJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL3NpZGViYXIuaHRtbCcsXG4gICAgICB0cmFuc2NsdWRlOiBmYWxzZSxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICAgdmFyIGN1cjtcbiAgICAgICAgdmFyIGN1ck5vZGV4O1xuICAgICAgICAkc2NvcGUuaXNMb2dpbiA9IGF1dGhTZXJ2aWNlLmlzTG9naW4oKTtcbiAgICAgICAgJHNjb3BlLnZlcnNpb24gPSB3aW5kb3cuY2ZnLnZlcnNpb247XG4gICAgICAgICRzY29wZS5pc0ZvbGRlZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5wb3J0cyA9IFt7XG4gICAgICAgICAgbmFtZTogJ+S8geS4muW6kycsXG4gICAgICAgICAgcGFyZW50OiB0cnVlLFxuICAgICAgICAgIGljb246ICdjb21wYW55JyxcbiAgICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICAgIG5hbWU6ICfkvIHkuJrln7rnoYDkv6Hmga8nLFxuICAgICAgICAgICAgcm91dGU6ICdjb21wYW55J1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfkv6Hmga/mlLbpm4YnLFxuICAgICAgICAgICAgcm91dGU6ICdpbmZvcm1hdGlvbidcbiAgICAgICAgICB9XVxuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ+WVhuWTgeeuoeeQhicsXG4gICAgICAgICAgcGFyZW50OiB0cnVlLFxuICAgICAgICAgIGljb246ICdwcm9kdWN0JyxcbiAgICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICAgIG5hbWU6ICfotKfmnrbllYblk4EnLFxuICAgICAgICAgICAgcm91dGU6ICdwcm9kdWN0J1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfllYblk4HmoIfnrb7nrqHnkIYnLFxuICAgICAgICAgICAgcm91dGU6ICdsYWJlbHNNYW5hZ2VtZW50J1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfku5PkvY3nrqHnkIYnLFxuICAgICAgICAgICAgcm91dGU6ICdwb3NpdGlvbk1hbmFnZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5paw5ZOB5o6o6I2QJyxcbiAgICAgICAgICAgIHJvdXRlOiAnbmV3UHJvZHVjdFJlY29tbWVuZCdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5rue6ZSA5ZWG5ZOB5bqTJyxcbiAgICAgICAgICAgIHJvdXRlOiAnZGVhZFN0b2NrJ1xuICAgICAgICAgIH1dXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAn6LSn5p62566h55CGJyxcbiAgICAgICAgICBwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgaWNvbjogJ3NoZWxmJyxcbiAgICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICAgIG5hbWU6ICfkvIHkuJrotKfmnrbnrqHnkIYnLFxuICAgICAgICAgICAgcm91dGU6ICdzaGVsZk1hbmFnZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn6LSn5p625beh5p+lJyxcbiAgICAgICAgICAgIHJvdXRlOiAnc2hlbGYnXG4gICAgICAgICAgfV1cbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICfkuJrliqHmtYHnqIvnrqHnkIYnLFxuICAgICAgICAgIHBhcmVudDogdHJ1ZSxcbiAgICAgICAgICBpY29uOiAnYnVzaW5lc3MtcHJvY2VzcycsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICBuYW1lOiAn5ouj6LSn5Y2VJyxcbiAgICAgICAgICAgIHJvdXRlOiAncGlja09yZGVyJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfljZXmja7kuK3lv4MnLFxuICAgICAgICAgICAgcm91dGU6ICdvcmRlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5Zue5LuT5Y2VJyxcbiAgICAgICAgICAgIHJvdXRlOiAnaW5TdG9yYWdlJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfotKLliqHnrqHnkIYnLFxuICAgICAgICAgICAgcm91dGU6ICdmaW5hbmNlJyxcbiAgICAgICAgICB9LCBdXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAn5LyB5Lia5pyN5YqhJyxcbiAgICAgICAgICBwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgaWNvbjogJ2VudGVycHJpc2Utc2VydmljZScsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICBuYW1lOiAn6Zu26Iqx6ZKxJyxcbiAgICAgICAgICAgIHJvdXRlOiAnd2VsZmFyZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5LyB5Lia6YCJ6LSt5Y2VJyxcbiAgICAgICAgICAgIHJvdXRlOiAnZ29vZHNDaG9vc2VPcmRlcidcbiAgICAgICAgICB9XVxuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ+WinuWAvOacjeWKoScsXG4gICAgICAgICAgcGFyZW50OiB0cnVlLFxuICAgICAgICAgIGljb246ICd2YWx1ZS1hZGRlZCcsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICBuYW1lOiAn5LiL5Y2I6Iy2JyxcbiAgICAgICAgICAgIHJvdXRlOiAndGVhSW5mb3JtYXRpb24nLFxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfoioLlgYfml6Xnpo/liKknLFxuICAgICAgICAgICAgcm91dGU6ICdob2xpZGF5V2VsZmFyZScsXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ+iQpemUgOWVhuWTgScsXG4gICAgICAgICAgICByb3V0ZTogJ3Byb21vdGlvblByb2R1Y3QnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ+iQpemUgOWVhuWTgee7hOWQiCcsXG4gICAgICAgICAgICByb3V0ZTogJ3Byb21vdGlvblN1aXRlJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfokKXplIDorqLljZUnLFxuICAgICAgICAgICAgcm91dGU6ICdwcm9tb3Rpb25PcmRlcidcbiAgICAgICAgICB9XVxuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ0Lnq6/lip/og73nrqHnkIYnLFxuICAgICAgICAgIHBhcmVudDogdHJ1ZSxcbiAgICAgICAgICBpY29uOiAnQi1jbGllbnQnLFxuICAgICAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICAgICAgbmFtZTogJ+mmlumhtemFjee9ricsXG4gICAgICAgICAgICByb3V0ZTogJ3RlbXBsYXRlJyxcbiAgICAgICAgICAgIGljb246ICd0ZW1wbGF0ZSdcbiAgICAgICAgICB9XVxuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ0Pnq6/lip/og73nrqHnkIYnLFxuICAgICAgICAgIHBhcmVudDogdHJ1ZSxcbiAgICAgICAgICBpY29uOiAnQy1jbGllbnQnLFxuICAgICAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICAgICAgbmFtZTogJ+acn+WPt+WunuaXtuWKqOaAgScsXG4gICAgICAgICAgICByb3V0ZTogJ2lzc3VlRHluYW1pYycsXG4gICAgICAgICAgICBpY29uOiAnaXNzdWVEeW5hbWljJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICflpZfppJDphY3pgIHliqjmgIEnLFxuICAgICAgICAgICAgcm91dGU6ICdzdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWMnLFxuICAgICAgICAgICAgaWNvbjogJ3N1aXRlRGlzdHJpYnV0aW9uRHluYW1pYydcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAn5aWX6aSQ6YWN572u566h55CGJyxcbiAgICAgICAgICAgIHJvdXRlOiAnc3VpdGVDZmdNYW5hZ2UnLFxuICAgICAgICAgICAgaWNvbjogJ3N1aXRlQ2ZnTWFuYWdlJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICfor4TorrrnrqHnkIYnLFxuICAgICAgICAgICAgcm91dGU6ICdjb21tZW50c01hbmFnZScsXG4gICAgICAgICAgICBpY29uOiAnY29tbWVudHNNYW5hZ2UnXG4gICAgICAgICAgfV1cbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICfmlbDmja7nu5/orqEnLFxuICAgICAgICAgIHBhcmVudDogdHJ1ZSxcbiAgICAgICAgICBpY29uOiAnZGF0YScsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICBuYW1lOiAn5ZWG5ZOB6JCl6ZSA5pWw5o2uJyxcbiAgICAgICAgICAgIHJvdXRlOiAnc2FsZXNTdGF0aXN0aWNzJ1xuICAgICAgICAgIH1dXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAn6LSm5Y+3566h55CGJyxcbiAgICAgICAgICByb3V0ZTogJ2FjY291bnQnLFxuICAgICAgICAgIGljb246ICdhY2NvdW50J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ+S/oeaBr+mFjee9ricsXG4gICAgICAgICAgcm91dGU6ICdjb25maWd1cmF0aW9uSW5mb3JtYXRpb24nLFxuICAgICAgICAgIGljb246ICdjb25maWd1cmF0aW9uSW5mb3JtYXRpb24nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAn5qih5p2/566h55CGJyxcbiAgICAgICAgICByb3V0ZTogJ3RlbXBsYXRlJyxcbiAgICAgICAgICBpY29uOiAndGVtcGxhdGUnXG4gICAgICAgIH1dO1xuICAgICAgICAkc2NvcGUuaGFuZGxlTG9naW5CdG5DbGljayA9IGZ1bmN0aW9uKGlzTG9naW4pIHtcbiAgICAgICAgICBpc0xvZ2luID8gYXV0aFNlcnZpY2UuZXhpdCgpIDogKHdpbmRvdy5sb2NhdGlvbi5oYXNoID1cbiAgICAgICAgICAgICcjL2xvZ2luJyk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5hY3RpdmUgPSBmdW5jdGlvbihvcHRpb25zLCBlKSB7XG4gICAgICAgICAgZSAmJiBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIHZhciBpbmRleHMgPSBvcHRpb25zLmluZGV4cztcbiAgICAgICAgICB2YXIgbGVuID0gaW5kZXhzLmxlbmd0aDtcbiAgICAgICAgICB2YXIgaGFzQ2hpbGRyZW4gPSBvcHRpb25zLmhhc0NoaWxkcmVuO1xuICAgICAgICAgIGlmIChjdXJOb2RleCkge1xuICAgICAgICAgICAgY3VyTm9kZXguYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChsZW4gPD0gMSkge1xuICAgICAgICAgICAgY3VyID0gaW5kZXhzO1xuICAgICAgICAgICAgaWYgKCRzY29wZS5wb3J0c1tpbmRleHNbMF1dKSB7XG4gICAgICAgICAgICAgICRzY29wZS5wb3J0c1tpbmRleHNbMF1dLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgIGN1ck5vZGV4ID0gJHNjb3BlLnBvcnRzW2luZGV4c1swXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1ciA9IGluZGV4cztcbiAgICAgICAgICAgICRzY29wZS5wb3J0c1tpbmRleHNbMF1dLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLnBvcnRzW2luZGV4c1swXV0uY2hpbGRyZW5baW5kZXhzWzFdXSkge1xuICAgICAgICAgICAgICAkc2NvcGUucG9ydHNbaW5kZXhzWzBdXS5jaGlsZHJlbltpbmRleHNbMV1dLmFjdGl2ZSA9XG4gICAgICAgICAgICAgICAgdHJ1ZTtcbiAgICAgICAgICAgICAgY3VyTm9kZXggPSAkc2NvcGUucG9ydHNbaW5kZXhzWzBdXS5jaGlsZHJlbltpbmRleHNbMV1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZVBhcmVudCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGUpIHtcbiAgICAgICAgICBlICYmIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdmFyIGluZGV4cyA9IG9wdGlvbnMuaW5kZXhzO1xuICAgICAgICAgICRzY29wZS5wb3J0c1tpbmRleHNbMF1dLmFjdGl2ZSA9ICEkc2NvcGUucG9ydHNbaW5kZXhzWzBdXS5hY3RpdmU7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5mb2xkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLnRvZ2dsZUNsYXNzKCdmb2xkZWQnKTtcbiAgICAgICAgICAkc2NvcGUuaXNGb2xkZWQgPSAhJHNjb3BlLmlzRm9sZGVkO1xuICAgICAgICB9O1xuICAgICAgICAvL+S6i+S7tlxuICAgICAgICAkc2NvcGUuJG9uKCdzaWRlYmFyLmFjdGl2ZScsIGZ1bmN0aW9uKGUsIHJvdXRlKSB7XG4gICAgICAgICAgdmFyIGluZGV4ID0gW107XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5wb3J0cywgZnVuY3Rpb24ocG9ydCwgaWR4KSB7XG4gICAgICAgICAgICB2YXIgaGFzQ2hpbGRyZW4gPSBwb3J0LnBhcmVudDtcbiAgICAgICAgICAgIHZhciBjaGlsZHJlblJvdXRlcnM7XG4gICAgICAgICAgICBpZiAoaGFzQ2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgY2hpbGRyZW5Sb3V0ZXJzID0gXy5wbHVjayhwb3J0LmNoaWxkcmVuLCAncm91dGUnKTtcbiAgICAgICAgICAgICAgaSA9IGNoaWxkcmVuUm91dGVycy5pbmRleE9mKHJvdXRlKTtcbiAgICAgICAgICAgICAgaWYgKGkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaW5kZXgucHVzaChpZHgpO1xuICAgICAgICAgICAgICAgIGluZGV4LnB1c2goaSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChyb3V0ZSA9PSBwb3J0LnJvdXRlKSB7XG4gICAgICAgICAgICAgICAgaW5kZXgucHVzaChpZHgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJHNjb3BlLmFjdGl2ZSh7IGluZGV4czogaW5kZXggfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuZGlyZWN0aXZlKCdzb3J0QnV0dG9uJywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS9zb3J0QnV0dG9uLmh0bWwnLFxuICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgICd0aXRsZSc6ICdAJywgLy/moIfpophcbiAgICAgICAgJ2FzY1NvcnRDb2RlJzogJ0AnLCAvL+WNh+W6j+S7o+eggVxuICAgICAgICAnZGVzY1NvcnRDb2RlJzogJ0AnLCAvL+mZjeW6j+S7o+eggVxuICAgICAgICAnc29ydENhbGxiYWNrJzogJyYnIC8v5o6S5bqP5Zue6LCDXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICRzY29wZS5kZXNjU29ydENvZGUgPSB0eXBlb2YgJHNjb3BlLmRlc2NTb3J0Q29kZSAhPVxuICAgICAgICAgICd1bmRlZmluZWQnID9cbiAgICAgICAgICAkc2NvcGUuZGVzY1NvcnRDb2RlIDogLSRzY29wZS5hc2NTb3J0Q29kZTtcbiAgICAgICAgJHNjb3BlLnNvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuc29ydENvZGUgPSAkc2NvcGUuc29ydENvZGUgPT0gJHNjb3BlLmFzY1NvcnRDb2RlID9cbiAgICAgICAgICAgICRzY29wZS5kZXNjU29ydENvZGUgOiAkc2NvcGUuYXNjU29ydENvZGU7XG4gICAgICAgICAgJHNjb3BlLnNvcnRDYWxsYmFjayh7XG4gICAgICAgICAgICBpdGVtOiB7XG4gICAgICAgICAgICAgIHNvcnRDb2RlOiAkc2NvcGUuc29ydENvZGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfSlcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZGlyZWN0aXZlKCd0ZWFTZWFyY2hlcicsIGZ1bmN0aW9uKHV0aWxTZXJ2aWNlLCBDT05TVEFOVFMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS90ZWFTZWFyY2hlci5odG1sJyxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgICdzZWFyY2gnOiAnJicsXG4gICAgICAgICAgICAgICAgJ3Nob3dUaW1lU2VsZWN0JzogJ0AnLFxuICAgICAgICAgICAgICAgICdpc1VwZGF0ZVRpbWVDaG9pY2VzJzogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dUaW1lU2VsZWN0ID0gJHNjb3BlLnNob3dUaW1lU2VsZWN0IHx8ICd0cnVlJztcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNob3dUaW1lU2VsZWN0ID09ICd0cnVlJykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuc3RhcnRUaW1lID0gbmV3IERhdGUodXRpbFNlcnZpY2UucGFyc2VUaW1lQnlEYXRlRGlzKG5ldyBEYXRlKCksIC03LCAneXl5eS1NTS1kZCcpICsgJyAwMDowMDowMCcpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuZW5kVGltZSA9IG5ldyBEYXRlKHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5RGF0ZShuZXcgRGF0ZSgpLCAneXl5eS1NTS1kZCcpICsgXCIgMjM6NTk6NTlcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyRzY29wZS5pc1VwZGF0ZVRpbWVDaG9pY2VzPVt7IGRlc2M6ICfkuIvljZXml7bpl7QnLCBjb2RlOiAnMCcgfSwgeyBkZXNjOiAn6aKE57qm6YCB6LSn5pe26Ze0JywgY29kZTogJzEnIH1dO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJHNjb3BlLmlzVXBkYXRlVGltZUNob2ljZXMpXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdElzVXBhZGF0ZSA9IGZ1bmN0aW9uKGNob2ljZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUgPSBwYXJzZUludChjaG9pY2UuY29kZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkc2NvcGUua2V5UHJlc3NTZWFyY2ggPSBmdW5jdGlvbihlLCBxdWVyeVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7IC8v5Zue6L2m6ZSuXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0V2VsZmFyZUNvbXBhbnkgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5UGFyYW1zLmNvbXBhbnlOYW1lPSBjb21wYW55LmNvbXBhbnlJZDtcblxuICAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5kaXJlY3RpdmUoJ3RvcFNlYXJjaGVyJywgZnVuY3Rpb24odXRpbFNlcnZpY2UsIENPTlNUQU5UUykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL3RvcFNlYXJjaGVyLmh0bWwnLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgJ3NlYXJjaCc6ICcmJyxcbiAgICAgICAgICAgICAgICAnc2hvd1RpbWVTZWxlY3QnOiAnQCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1RpbWVTZWxlY3QgPSAkc2NvcGUuc2hvd1RpbWVTZWxlY3QgfHwgJ3RydWUnO1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2hvd1RpbWVTZWxlY3QgPT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5zdGFydFRpbWUgPSBuZXcgRGF0ZSh1dGlsU2VydmljZS5wYXJzZVRpbWVCeURhdGVEaXMobmV3IERhdGUoKSwgLTcsICd5eXl5LU1NLWRkJykgKyAnIDAwOjAwOjAwJyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVyeVBhcmFtcy5lbmRUaW1lID0gbmV3IERhdGUodXRpbFNlcnZpY2UucGFyc2VUaW1lQnlEYXRlKG5ldyBEYXRlKCksICd5eXl5LU1NLWRkJykgKyBcIiAyMzo1OTo1OVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzVXBkYXRlVGltZUNob2ljZXMgPSBDT05TVEFOVFMuZ2V0TGlzdCgnSU5WT0lDRV9USU1FX1RZUEUnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmlzVXBkYXRlVGltZUNob2ljZXMpXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdElzVXBhZGF0ZSA9IGZ1bmN0aW9uKGNob2ljZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlcnlQYXJhbXMuaXNVcGF0ZVRpbWUgPSBwYXJzZUludChjaG9pY2UuY29kZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkc2NvcGUua2V5UHJlc3NTZWFyY2ggPSBmdW5jdGlvbihlLCBxdWVyeVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7IC8v5Zue6L2m6ZSuXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuZGlyZWN0aXZlKCd1cGxvYWRlcicsIGZ1bmN0aW9uKHVwbG9hZFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnZGlyZWN0aXZlL3VwbG9hZGVyLmh0bWwnLFxuICAgICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHZhbHVlOiAnPScsXG4gICAgICAgIG5nTW9kZWw6ICc9JyxcbiAgICAgICAgaW5kZXg6ICc9JyxcbiAgICAgICAgdXBsb2FkVGl0bGU6ICdAJywgLy/kuIrkvKDmjInpkq7nmoR0aXRsZSzpu5jorqTkuLon5LiK5LygJ1xuICAgICAgICBoaWRlSW5wdXQ6ICdAJywgLy/mmK/lkKbpmpDol4/ovpPlhaXmoYbvvIzpu5jorqTkuI3pmpDol49cbiAgICAgICAgZGlkVXBsb2FkOiAnJicsIC8v5a6M5oiQ5LiK5Lyg5Zue6LCD5LqL5Lu2XG4gICAgICAgIHNpemVMaW1pdDogJ0AnLCAvL+WwuuWvuOWkp+Wwj+mZkOWItlxuICAgICAgICBpc1VwbG9hZFVweXVuOiAnQCcgLy/mmK/lkKbpnIDopoHkuIrkvKDlj4jmi43kupHvvIzpu5jorqTkuIrkvKBcbiAgICAgIH0sXG4gICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICAgJHNjb3BlLmZpbGVuYW1lcyA9ICcnO1xuICAgICAgICAkc2NvcGUuZmlsZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnBhdGggPSAkYXR0cnMucGF0aDtcbiAgICAgICAgJHNjb3BlLnVwbG9hZFRpdGxlID0gJHNjb3BlLnVwbG9hZFRpdGxlIHx8ICfkuIrkvKAnO1xuXG4gICAgICAgICRzY29wZS5jaGFuZ2VGaWxlID0gZnVuY3Rpb24oZG9tKSB7XG4gICAgICAgICAgdmFyIG9wdHMgPSB7XG4gICAgICAgICAgICBmaWxlX2RvbTogZG9tLFxuICAgICAgICAgICAgZm9sZGVyOiBhbmd1bGFyLmVsZW1lbnQoZG9tKS5hdHRyKCdwYXRoJyksXG4gICAgICAgICAgICBzaXplX2xpbWl0OiBKU09OLnBhcnNlKCRzY29wZS5zaXplTGltaXQgfHwgJ3t9JyksXG4gICAgICAgICAgICBpc191cGxvYWRfdXB5dW46ICRzY29wZS5pc1VwbG9hZFVweXVuIHx8ICd0cnVlJ1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgc3RyX2RvbSA9IGFuZ3VsYXIuZWxlbWVudChkb20pLm5leHQoKS5maW5kKCdpbnB1dCcpO1xuICAgICAgICAgIHVwbG9hZFNlcnZpY2UudXBsb2FkKG9wdHMpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUudmFsdWUgPSByZXMucGF0aDtcbiAgICAgICAgICAgICRzY29wZS5maWxlbmFtZXMgPSByZXMucGF0aDtcbiAgICAgICAgICAgIHZhciBkaWRVcGxvYWQgPSAkc2NvcGUuZGlkVXBsb2FkIHx8IGZ1bmN0aW9uKCkge307XG4gICAgICAgICAgICBkaWRVcGxvYWQoe1xuICAgICAgICAgICAgICBmaWxlOiByZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuZGlyZWN0aXZlKCd2YWxpZEZpbGUnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICBlbC5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoZWwudmFsKCkpO1xuICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHM9W3JlcXVpcmUoXCIuL2RpcmVjdGl2ZS9ibG9ja0FkZC5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvY29tcGFueVNlYXJjaGVyLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9jb21waWxlSHRtbC5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvY291bnQuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL2RhdGVGb3JtYXRlLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9kYXRlUGlja2VyLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9kaWFsb2cuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL2Ryb3BEb3duLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9lY2hhcnRzTGluZS5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvZml4ZWRUYWJsZUhlYWRlcnMuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL2Zvcm1SZXF1aXJlZC5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvbGFiZWxzTWFuYWdlbWVudHMuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL2xvZ2luLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9tZEltZy5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvbWRVcGxvYWRlci5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvbW9kdWxlLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9tc1N0ZXBwZXIuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL21zU3RlcHBlclN0ZXAuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL25hdmlnYXRvci5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvbmV3VXNlcnMuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL29uRmluaXNoUmVuZGVyRmlsdGVycy5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvcGFuZWwuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3Blcm1pc3Npb25zLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS9wcm9kdWN0U2VhcmNoZXIuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3Byb21vdGlvbi5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvcmVxdWlyZWRJbnB1dC5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvc2VhcmNoR3JvdXAuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3NpZGViYXIuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3NvcnRCdXR0b24uanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3RlYVNlYXJjaGVyLmpzXCIpLHJlcXVpcmUoXCIuL2RpcmVjdGl2ZS90b3BTZWFyY2hlci5qc1wiKSxyZXF1aXJlKFwiLi9kaXJlY3RpdmUvdXBsb2FkZXIuanNcIikscmVxdWlyZShcIi4vZGlyZWN0aXZlL3ZhbGlkRmlsZUlucHV0LmpzXCIpXSIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmZpbHRlcignZGVzYycsIGZ1bmN0aW9uKENPTlNUQU5UUykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGZpZWxkKSB7XG4gICAgICAgICAgICB2YXIgZiA9IENPTlNUQU5UU1tmaWVsZF07XG4gICAgICAgICAgICB2YXIgZGVzY3MgPSBmICYmIGYuREVTQztcbiAgICAgICAgICAgIHJldHVybiBkZXNjcyAmJiBkZXNjc1t2YWx1ZV0gfHwgJyc7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmZpbHRlcignaW1nJywgZnVuY3Rpb24oQ09OU1RBTlRTKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihwYXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmNmZy5waWNVcmwrcGF0aDtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZmlsdGVyKCdpbnQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGRhdGEsIGZpZWxkcykge1xuICAgIFx0XHR2YXIgcj1kYXRhO1xuICAgIFx0XHRhbmd1bGFyLmZvckVhY2goZmllbGRzLGZ1bmN0aW9uKGZpZWxkKXtcbiAgICBcdFx0XHR2YXIgZnM9ZmllbGQuc3BsaXQoJy4nKTtcbiAgICBcdFx0XHR2YXIgbGVuPWZzLmxlbmd0aDtcbiAgICBcdFx0XHR2YXIgbHNmPWZzW2ZzLmxlbmd0aC0xXTtcbiAgICBcdFx0XHR2YXIgdD1kYXRhO1xuICAgIFx0XHRcdGZvcih2YXIgaT0wO2k8bGVuLTE7aSsrKXtcbiAgICBcdFx0XHRcdHQ9dFtmc1tpXV07XG4gICAgXHRcdFx0fVxuICAgIFx0XHRcdHRbbHNmXT1wYXJzZUludCh0W2xzZl0pO1xuICAgIFx0XHR9KTtcbiAgICBcdFx0cmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmZpbHRlcigncG9pbnRzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihhbXQpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCgoYW10KjEwMCkudG9GaXhlZCgwKSk7IFxuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuXHRhcHAuZmlsdGVyKCdybWInLCBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oYW10KSB7XG5cdFx0XHRpZiAoaXNOYU4ocGFyc2VJbnQoYW10KSkpIHtcblx0XHRcdFx0cmV0dXJuIGFtdFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGFtdCA/IChwYXJzZUludChhbXQgLyAxMDApICsgJy4nICsgcGFyc2VJbnQoKGFtdCAvIDEwKSAlIDEwKSArXG5cdFx0XHRcdFx0cGFyc2VJbnQoYW10ICUgMTApKSA6ICcwJztcblx0XHRcdH1cblxuXHRcdH1cblx0fSk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5maWx0ZXIoJ3NlbGVjdGlvbicsIGZ1bmN0aW9uKENPTlNUQU5UUykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZmllbGQsIGhhc0RlZmF1bHQsIGNvZGVLZXksIHZhbHVlS2V5LCBkZWZhdWx0T2JqLCBpc0NvZGVOdW0pIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZmllbGQpID09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGVLZXkgPSBmaWVsZC5jb2RlS2V5O1xuICAgICAgICAgICAgICAgIHZhciBoYXNEZWZhdWx0ID0gZmllbGQuaGFzRGVmYXVsdDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVLZXkgPSBmaWVsZC52YWx1ZUtleTtcbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdE9iaiA9IGZpZWxkLmRlZmF1bHRPYmo7XG4gICAgICAgICAgICAgICAgdmFyIGlzQ29kZU51bSA9IGZpZWxkLmlzQ29kZU51bWw7XG4gICAgICAgICAgICAgICAgdmFyIGNsc09yTmFtZSA9IGZpZWxkLmNsc09yTmFtZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsc09yTmFtZSA9IGZpZWxkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIENPTlNUQU5UUy5nZXRMaXN0KGNsc09yTmFtZSwgaGFzRGVmYXVsdCwgY29kZUtleSwgdmFsdWVLZXksIGRlZmF1bHRPYmosIGlzQ29kZU51bSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmZpbHRlcignc3R5bGUnLCBmdW5jdGlvbihDT05TVEFOVFMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBmaWVsZCkge1xuICAgICAgICAgICAgdmFyIGYgPSBDT05TVEFOVFNbZmllbGRdO1xuICAgICAgICAgICAgdmFyIGRlc2NzID0gZiAmJiBmLlNUWUxFO1xuICAgICAgICAgICAgcmV0dXJuIGRlc2NzICYmIGRlc2NzW3ZhbHVlXSB8fCAnJztcbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuZmlsdGVyKCd2YWx1ZScsIGZ1bmN0aW9uKENPTlNUQU5UUykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGZpZWxkLCBpc1ZhbHVlTnVtKSB7XG4gICAgICAgICAgICB2YXIgZiA9IENPTlNUQU5UU1tmaWVsZF07XG4gICAgICAgICAgICB2YXIgZGVzY3MgPSBmICYmIGYuREVTQztcbiAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGVzY3MsIGZ1bmN0aW9uKHZhLCBrZXkpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gdmEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ga2V5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLmZpbHRlcignd2VlaycsIGZ1bmN0aW9uKENPTlNUQU5UUykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGZpZWxkKSB7XG4gICAgICAgICAgICB2YXIgZiA9IENPTlNUQU5UU1tmaWVsZF07XG4gICAgICAgICAgICB2YXIgZGVzY3MgPSBmICYmIGYuU1RZTEU7XG4gICAgICAgICAgICByZXR1cm4gZGVzY3MgJiYgZGVzY3NbdmFsdWVdIHx8ICcnO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cz1bcmVxdWlyZShcIi4vZmlsdGVyL2Rlc2MuanNcIikscmVxdWlyZShcIi4vZmlsdGVyL2ltZy5qc1wiKSxyZXF1aXJlKFwiLi9maWx0ZXIvaW50LmpzXCIpLHJlcXVpcmUoXCIuL2ZpbHRlci9wb2ludHMuanNcIikscmVxdWlyZShcIi4vZmlsdGVyL3JtYi5qc1wiKSxyZXF1aXJlKFwiLi9maWx0ZXIvc2VsZWN0aW9uLmpzXCIpLHJlcXVpcmUoXCIuL2ZpbHRlci9zdHlsZS5qc1wiKSxyZXF1aXJlKFwiLi9maWx0ZXIvdmFsdWUuanNcIikscmVxdWlyZShcIi4vZmlsdGVyL3dlZWsuanNcIildIiwiO1xuKGZ1bmN0aW9uKCkge1xuICB2YXIgYW5ndWxhciA9IHdpbmRvdy5hbmd1bGFyO1xuICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsICduZ0Nvb2tpZXMnLCAnbmdUYWJsZScsXG4gICAgJ3RlbXBsYXRlQnVuZGxlJywgJ3VpLmJvb3RzdHJhcCcsICd1aS5yb3V0ZXInLCAndWkudHJlZScsXG4gICAgJ2lzdGV2ZW4tbXVsdGktc2VsZWN0JywgJ25nQW5pbWF0ZScsICduZ0FyaWEnLCAnbmdNYXRlcmlhbCcsXG4gICAgJ25nU2FuaXRpemUnLCAnbmdNZXNzYWdlcycsICdpbmZpbml0ZS1zY3JvbGwnXG4gIF0pLmNvbmZpZyhbXG4gICAgJyRjb21waWxlUHJvdmlkZXInLCAnJG1kVGhlbWluZ1Byb3ZpZGVyJyxcbiAgICBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyLCAkbWRUaGVtaW5nUHJvdmlkZXIpIHtcbiAgICAgICRjb21waWxlUHJvdmlkZXIuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoXG4gICAgICAgIC9eXFxzKihodHRwcz98ZnRwfG1haWx0b3xmaWxlfGRhdGEpOi8pO1xuICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKFwiZGVmYXVsdFwiKS5wcmltYXJ5UGFsZXR0ZShcImJsdWVcIikuYWNjZW50UGFsZXR0ZShcbiAgICAgICAgXCJsaWdodC1ibHVlXCIpLndhcm5QYWxldHRlKFwiZGVlcC1vcmFuZ2VcIikuYmFja2dyb3VuZFBhbGV0dGUoXG4gICAgICAgIFwiZ3JleVwiKTtcbiAgICB9XG4gIF0pO1xuICB2YXIgcm91dGVycyA9IHJlcXVpcmUoJy4vcm91dGVycy5qcycpO1xuICB2YXIgc2VydmljZXMgPSByZXF1aXJlKCcuL3NlcnZpY2VzLmpzJyk7XG4gIHZhciBkaXJlY3RpdmVzID0gcmVxdWlyZSgnLi9kaXJlY3RpdmVzLmpzJyk7XG4gIHZhciBjb25zdGFudHMgPSByZXF1aXJlKCcuL2NvbnN0YW50cy5qcycpO1xuICB2YXIgY29udHJvbGxlcnMgPSByZXF1aXJlKCcuL2NvbnRyb2xsZXJzLmpzJyk7XG4gIHZhciBmaWx0ZXJzID0gcmVxdWlyZSgnLi9maWx0ZXJzLmpzJyk7XG4gIC8v5rOo5YaMcm91dGVyXG4gIGFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgYW5ndWxhci5mb3JFYWNoKHJvdXRlcnMsIGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyArIHJvdXRlLnBhdGgsIHJvdXRlKTtcbiAgICB9KTtcbiAgICAkcm91dGVQcm92aWRlci5vdGhlcndpc2Uoe1xuICAgICAgcmVkaXJlY3RUbzogJy9ob21lJ1xuICAgIH0pO1xuICB9XSk7XG4gIC8vIGFwcC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gIC8vICAgICBhbmd1bGFyLmZvckVhY2gocm91dGVycywgZnVuY3Rpb24ocm91dGUpIHtcbiAgLy8gICAgICAgICB2YXIgY2ZnID0ge1xuICAvLyAgICAgICAgICAgICB1cmw6ICcvJyArIHJvdXRlLnBhdGgsXG4gIC8vICAgICAgICAgICAgIHZpZXdzOiB7fVxuICAvLyAgICAgICAgIH07XG4gIC8vICAgICAgICAgY2ZnLnZpZXdzW3JvdXRlLm5hbWVdID0ge1xuICAvLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogcm91dGUudGVtcGxhdGVVcmxcbiAgLy8gICAgICAgICB9O1xuICAvLyAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHJvdXRlLm5hbWUsIGNmZyk7XG4gIC8vICAgICB9KTtcbiAgLy8gICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XG4gIC8vIH1dKTtcbiAgLy/ms6jlhoxjb25zdGFudFxuICBhbmd1bGFyLmZvckVhY2goZmlsdGVycywgZnVuY3Rpb24oZm4pIHtcbiAgICBmbi5jYWxsKHRoaXMsIGFwcCk7XG4gIH0pO1xuICAvL+azqOWGjGNvbnN0YW50XG4gIGFuZ3VsYXIuZm9yRWFjaChjb25zdGFudHMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICBhcHAuY29uc3RhbnQoa2V5LCB2YWx1ZSk7XG4gIH0pO1xuICAvL+azqOWGjOeahHNlcnZpY2VcbiAgYW5ndWxhci5mb3JFYWNoKHNlcnZpY2VzLCBmdW5jdGlvbihmbikge1xuICAgIGZuLmNhbGwodGhpcywgYXBwKTtcbiAgfSk7XG4gIC8v5om56YeP5rOo5YaMZGlyZWNpdmVzXG4gIGFuZ3VsYXIuZm9yRWFjaChkaXJlY3RpdmVzLCBmdW5jdGlvbihmbikge1xuICAgIGZuLmNhbGwodGhpcywgYXBwKTtcbiAgfSk7XG4gIC8v5rOo5YaM55qEY29udHJvbGxlclxuICBhbmd1bGFyLmZvckVhY2goY29udHJvbGxlcnMsIGZ1bmN0aW9uKGZuKSB7XG4gICAgdHJ5IHtcbiAgICAgIGZuLmNhbGwodGhpcywgYXBwKTtcbiAgICB9IGNhdGNoIChlKSB7fVxuXG4gIH0pO1xufSgpKTtcbi8vIGFwcC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSkge1xuLy8gICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XG4vLyAgICAgfSk7XG4vLyB9KTsiLCJtb2R1bGUuZXhwb3J0cyA9IFt7XG4gIG5hbWU6ICdob21lJyxcbiAgcGF0aDogJ2hvbWUnLFxuICB0ZW1wbGF0ZVVybDogJ2hvbWUvaG9tZS5odG1sJ1xufSwge1xuICBuYW1lOiAnY29tcGFueScsXG4gIHBhdGg6ICdjb21wYW55JyxcbiAgdGVtcGxhdGVVcmw6ICdjb21wYW55L2NvbXBhbnkuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3NoZWxmJyxcbiAgcGF0aDogJ3NoZWxmJyxcbiAgdGVtcGxhdGVVcmw6ICdzaGVsZi9zaGVsZlBhdHJvbC5odG1sJ1xufSwge1xuICBuYW1lOiAnc2hlbGZNYW5hZ2UnLFxuICBwYXRoOiAnc2hlbGZNYW5hZ2UnLFxuICB0ZW1wbGF0ZVVybDogJ3NoZWxmbWFuYWdlL3NoZWxmTWFuYWdlLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdvcmRlcicsXG4gIHBhdGg6ICdvcmRlcicsXG4gIHRlbXBsYXRlVXJsOiAnb3JkZXIvb3JkZXIuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3BpY2tPcmRlcicsXG4gIHBhdGg6ICdwaWNrT3JkZXInLFxuICB0ZW1wbGF0ZVVybDogJ3BpY2tPcmRlci9waWNrT3JkZXIuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ2dvb2RzQ2hvb3NlT3JkZXInLFxuICBwYXRoOiAnZ29vZHNDaG9vc2VPcmRlcicsXG4gIHRlbXBsYXRlVXJsOiAnZ29vZHNDaG9vc2VPcmRlci9nb29kc0Nob29zZU9yZGVyLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdnb29kc0Nob29zZUhpc3RvcnknLFxuICBwYXRoOiAnZ29vZHNDaG9vc2VIaXN0b3J5JyxcbiAgdGVtcGxhdGVVcmw6ICdnb29kc0Nob29zZU9yZGVyL2dvb2RzQ2hvb3NlSGlzdG9yeS5odG1sJ1xufSwge1xuICBuYW1lOiAnZGVsaXZlcnlFZGl0JyxcbiAgcGF0aDogJ2RlbGl2ZXJ5RWRpdC86b3JkZXJJZCcsXG4gIHRlbXBsYXRlVXJsOiAncGlja09yZGVyL2RlbGl2ZXJ5RWRpdC5odG1sJ1xufSwge1xuICBuYW1lOiAnZGVsaXZlcnlFZGl0MicsXG4gIHBhdGg6ICdkZWxpdmVyeUVkaXQvOm9yZGVySWQvOmdvb2RzQ2hvb3NlT3JkZXJJZCcsXG4gIHRlbXBsYXRlVXJsOiAncGlja09yZGVyL2RlbGl2ZXJ5RWRpdC5odG1sJ1xufSwge1xuICBuYW1lOiAnYWNjb3VudCcsXG4gIHBhdGg6ICdhY2NvdW50JyxcbiAgdGVtcGxhdGVVcmw6ICdhY2NvdW50L2FjY291bnQuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3JvbGUnLFxuICBwYXRoOiAncm9sZScsXG4gIHRlbXBsYXRlVXJsOiAnYWNjb3VudC9yb2xlLmh0bWwnLFxuICBjb250cm9sbGVyOiAnUm9sZUN0cmwnXG59LCB7XG4gIG5hbWU6ICdpblN0b3JhZ2UnLFxuICBwYXRoOiAnaW5TdG9yYWdlJyxcbiAgdGVtcGxhdGVVcmw6ICdpblN0b3JhZ2UvaW5TdG9yYWdlLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdwcm9kdWN0JyxcbiAgcGF0aDogJ3Byb2R1Y3QnLFxuICB0ZW1wbGF0ZVVybDogJ3Byb2R1Y3QvcHJvZHVjdC5odG1sJ1xufSwge1xuICBuYW1lOiAnc2FsZXNTdGF0aXN0aWNzJyxcbiAgcGF0aDogJ3NhbGVzU3RhdGlzdGljcycsXG4gIHRlbXBsYXRlVXJsOiAnZGF0YVN0YXRpc3RpY3Mvc2FsZXNTdGF0aXN0aWNzLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdwcm9tb3Rpb25Qcm9kdWN0JyxcbiAgcGF0aDogJ3Byb21vdGlvblByb2R1Y3QnLFxuICB0ZW1wbGF0ZVVybDogJ3Byb21vdGlvbi9wcm9tb3Rpb25Qcm9kdWN0Lmh0bWwnXG59LCB7XG4gIG5hbWU6ICdwcm9tb3Rpb25TdWl0ZScsXG4gIHBhdGg6ICdwcm9tb3Rpb25TdWl0ZScsXG4gIHRlbXBsYXRlVXJsOiAncHJvbW90aW9uL3Byb21vdGlvblN1aXRlLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdzaGVsZmRldGFpbCcsXG4gIHBhdGg6ICdzaGVsZi86Y29tcGFueUlkJyxcbiAgdGVtcGxhdGVVcmw6ICdzaGVsZi9zaGVsZkRldGFpbC5odG1sJ1xufSwge1xuICBuYW1lOiAnaW5mb3JtYXRpb24nLFxuICBwYXRoOiAnaW5mb3JtYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJ2luZm9ybWF0aW9uL2luZm9ybWF0aW9uLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdsYWJlbHNNYW5hZ2VtZW50JyxcbiAgcGF0aDogJ2xhYmVsc01hbmFnZW1lbnQnLFxuICB0ZW1wbGF0ZVVybDogJ2xhYmVsc01hbmFnZW1lbnQvbGFiZWxzTWFuYWdlbWVudC5odG1sJ1xufSwge1xuICBuYW1lOiAnd2VsZmFyZScsXG4gIHBhdGg6ICd3ZWxmYXJlJyxcbiAgdGVtcGxhdGVVcmw6ICd3ZWxmYXJlL3dlbGZhcmUuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3Bvc2l0aW9uTWFuYWdlJyxcbiAgcGF0aDogJ3Bvc2l0aW9uTWFuYWdlJyxcbiAgdGVtcGxhdGVVcmw6ICdwb3NpdGlvbk1hbmFnZS9wb3NpdGlvbk1hbmFnZS5odG1sJ1xufSwge1xuICBuYW1lOiAnZmluYW5jZScsXG4gIHBhdGg6ICdmaW5hbmNlJyxcbiAgdGVtcGxhdGVVcmw6ICdmaW5hbmNlL2ZpbmFuY2UuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ2NvbmZpZ3VyYXRpb25JbmZvcm1hdGlvbicsXG4gIHBhdGg6ICdjb25maWd1cmF0aW9uSW5mb3JtYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJ2NvbmZpZ3VyYXRpb25JbmZvcm1hdGlvbi9jb25maWd1cmF0aW9uSW5mb3JtYXRpb24uaHRtbCdcbn0sIHtcbiAgbmFtZTogJ2hvbGlkYXlXZWxmYXJlJyxcbiAgcGF0aDogJ2hvbGlkYXlXZWxmYXJlJyxcbiAgdGVtcGxhdGVVcmw6ICdob2xpZGF5V2VsZmFyZS9ob2xpZGF5V2VsZmFyZS5odG1sJ1xufSwge1xuICBuYW1lOiAndGVhSW5mb3JtYXRpb24nLFxuICBwYXRoOiAndGVhSW5mb3JtYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJ3RlYUluZm9ybWF0aW9uL3RlYUluZm9ybWF0aW9uLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdwcm9tb3Rpb25PcmRlcicsXG4gIHBhdGg6ICdwcm9tb3Rpb25PcmRlcicsXG4gIHRlbXBsYXRlVXJsOiAncHJvbW90aW9uL3Byb21vdGlvbk9yZGVyLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdpc3N1ZUR5bmFtaWMnLFxuICBwYXRoOiAnaXNzdWVEeW5hbWljJyxcbiAgdGVtcGxhdGVVcmw6ICdzdWl0ZS9pc3N1ZUR5bmFtaWMuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3N1aXRlRGlzdHJpYnV0aW9uRHluYW1pYycsXG4gIHBhdGg6ICdzdWl0ZURpc3RyaWJ1dGlvbkR5bmFtaWMnLFxuICB0ZW1wbGF0ZVVybDogJ3N1aXRlL3N1aXRlRGlzdHJpYnV0aW9uRHluYW1pYy5odG1sJ1xufSwge1xuICBuYW1lOiAnc3VpdGVDZmdNYW5hZ2UnLFxuICBwYXRoOiAnc3VpdGVDZmdNYW5hZ2UnLFxuICB0ZW1wbGF0ZVVybDogJ3N1aXRlL3N1aXRlQ2ZnTWFuYWdlLmh0bWwnXG59LCB7XG4gIG5hbWU6ICdjb21tZW50c01hbmFnZScsXG4gIHBhdGg6ICdjb21tZW50c01hbmFnZScsXG4gIHRlbXBsYXRlVXJsOiAnc3VpdGUvY29tbWVudHNNYW5hZ2UuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ3RlbXBsYXRlJyxcbiAgcGF0aDogJ3RlbXBsYXRlJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZS90ZW1wbGF0ZS5odG1sJ1xufSwge1xuICBuYW1lOiAndGVtcGxhdGVFZGl0JyxcbiAgcGF0aDogJ3RlbXBsYXRlRWRpdCcsXG4gIHRlbXBsYXRlVXJsOiAndGVtcGxhdGUvdGVtcGxhdGVFZGl0Lmh0bWwnXG59LCB7XG4gIG5hbWU6ICd0ZW1wbGF0ZUVkaXQnLFxuICBwYXRoOiAndGVtcGxhdGVFZGl0Lzp0ZW1wbGF0ZUlkJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZS90ZW1wbGF0ZUVkaXQuaHRtbCdcbn0sIHtcbiAgbmFtZTogJ2RlYWRTdG9jaycsXG4gIHBhdGg6ICdkZWFkU3RvY2snLFxuICB0ZW1wbGF0ZVVybDogJ2RlYWRTdG9jay9kZWFkU3RvY2suaHRtbCdcbn0sIHtcbiAgbmFtZTogJ25ld1Byb2R1Y3RSZWNvbW1lbmQnLFxuICBwYXRoOiAnbmV3UHJvZHVjdFJlY29tbWVuZCcsXG4gIHRlbXBsYXRlVXJsOiAncHJvZHVjdC9uZXdQcm9kdWN0UmVjb21tZW5kLmh0bWwnXG59XTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdGFveGlhb2Zlbmcgb24gMTYvNi8yNy5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ2FjY291bnRTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgZnVuY3Rpb24oeGhyU2VydmljZSwgJHEpIHtcblxuICAgIHRoaXMuX3BhcnNlQWNjb3VudERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAvL+aLt+i0neS4gOS7ve+8jOS/neaMgeaVsOaNrua6kOS4jeWPmFxuICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICB2YXIgdCA9IGFuZ3VsYXIuY29weShpdGVtKTtcbiAgICAgICAgdC5pbmRleCA9IGluZGV4O1xuICAgICAgICB0ZW1wLnB1c2godCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0ZW1wO1xuICAgIH07XG5cbiAgICAvKui/m+WFpei0puaIt+euoeeQhumhteaXtizmmL7npLrmiYDmnInmlbDmja4qL1xuICAgIHRoaXMuZmluZEFsbE1hbmFnZXIgPSBmdW5jdGlvbihwYXJhbXMsIG9mZnNldCwgbGltaXQpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB2YXIgc3RyID0gJz9vZmZzZXQ9JyArIG9mZnNldCArICcmbGltaXQ9JyArIGxpbWl0O1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnbWFuYWdlcicgKyBzdHIsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICB0aGlzLmluZGV4QWNjb3VudCA9IGZ1bmN0aW9uKGRhdGEsIG9mZnNldCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGl0ZW0uaW5kZXggPSBpbmRleCArIG9mZnNldDtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcblxuICAgIC8q5paw5aKe55So5oi3Ki9cbiAgICB0aGlzLmNyZWF0ZU1hbmFnZXIgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnbWFuYWdlcicsXG4gICAgICAgIC8q5Y6f5o6l5Y+jOiBtYW5hZ2VyL21hbmFnZS9jcmVhdGVNYW5hZ2VyKi9cbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9hc3RFcnJvcjogdHJ1ZSAvLyDnlKh0b2FzdOabv+S7o+m7mOiupOeahGRpYWxvZ+adpeaYvuekuumUmeivr+a2iOaBr1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyog57yW6L6R55So5oi3Ki9cbiAgICB0aGlzLm1vZGlmeU1hbmFnZXIgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6IFwibWFuYWdlci9cIiArIHBhcmFtcy5pZCxcbiAgICAgICAgLyrljp/mjqXlj6M6bWFuYWdlci9tYW5hZ2UvbW9kaWZ5TWFuYWdlciovXG4gICAgICAgIHBhcmFtczogXy5vbWl0KHBhcmFtcywgJ2lkJyksIC8vIF8ub21pdCA65Y+q6L+H5ruk5Ye66Zmk5Y67a2V5cyjmnInmlYjnmoTplK7nu4TmiJDnmoTmlbDnu4Qp5Y+C5pWw5oyH5a6a55qE5bGe5oCn5YC8XG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9hc3RFcnJvcjogdHJ1ZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcblxuICAgIH07XG5cbiAgICAvKuWIoOmZpOeUqOaItyovXG4gICAgdGhpcy5kZWxldGVNYW5hZ2VyID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICBwYXRoOiAnbWFuYWdlci8nICsgcGFyYW1zLmlkLFxuICAgICAgICAvKuWOn+aOpeWPozptYW5hZ2VyL21hbmFnZS9yZW1vdmVNYW5hZ2VyKi9cbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgdGhpcy5sb2FkU3VwZXJ2aXNvcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAnbWFuYWdlci9zdXBlcnZpc29ycycsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmxvYWRTZWxmID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ21hbmFnZXIvc2VsZicsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmxvYWRBY2NvdW50ID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAnbWFuYWdlci8nICsgaWQsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLnNlYXJjaE5hbWUgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ21hbmFnZXIvc2VhcmNoP25hbWU9JyArIG5hbWUsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmRvd25sb2FkRXhjZWwgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXRoOiAncGVybWlzc2lvbi9leHBvcnQnLFxuICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2FycmF5YnVmZmVyJyxcbiAgICAgICAgICBkYXRhVHlwZTogJ2FycmF5YnVmZmVyJyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICB9O1xuXG4gICAgdGhpcy51cGxvYWRQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uKGNvbW1lbnQsIGZpbGUpIHtcbiAgICAgIHZhciBmaWxlRXggPSBmaWxlLm5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcbiAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgZm9ybURhdGEuYXBwZW5kKCdjb21tZW50JywgY29tbWVudCk7XG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBmaWxlKTtcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnd29ya2Jvb2tUeXBlJywgZmlsZUV4ID09ICd4bHMnID8gJ0hTU0YnIDogJ1hTU0YnKTtcbiAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHhoclNlcnZpY2UuVXBsb2FkKHtcbiAgICAgICAgICBwYXRoOiAncGVybWlzc2lvbicsXG4gICAgICAgICAgcGFyYW1zOiBmb3JtRGF0YSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMudXBsb2FkUGVybWlzc2lvbkdyb3VwcyA9IGZ1bmN0aW9uKGNvbW1lbnQsIGZpbGUpIHtcbiAgICAgIHZhciBmaWxlRXggPSBmaWxlLm5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcbiAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgZm9ybURhdGEuYXBwZW5kKCdjb21tZW50JywgY29tbWVudCk7XG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBmaWxlKTtcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnd29ya2Jvb2tUeXBlJywgZmlsZUV4ID09ICd4bHMnID8gJ0hTU0YnIDogJ1hTU0YnKTtcbiAgICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHhoclNlcnZpY2UuVXBsb2FkKHtcbiAgICAgICAgICBwYXRoOiAncGVybWlzc2lvbi9ncm91cCcsXG4gICAgICAgICAgcGFyYW1zOiBmb3JtRGF0YSxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfV0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgJ2NhY2hlU2VydmljZScsIGZ1bmN0aW9uKHhoclNlcnZpY2UsICRxLCBjYWNoZVNlcnZpY2UpIHtcbiAgICAgICAgLy/mjqXlj6NcbiAgICAgICAgLyrnmbvpmYZcbiAgICAgICAgICpAUGFyYW1zXG4gICAgICAgICAqdXNlcm5hbWVcbiAgICAgICAgICpwc3dcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9naW4gPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdhdXRoL2xvZ2luJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMsIHN0YXR1cywgaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aCA9IGhlYWRlcnMoJ0F1dGhvcml6YXRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVTZXJ2aWNlLnNldFNlc3Npb24oYXV0aCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmV4aXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhY2hlU2VydmljZS5zZXRTZXNzaW9uKCcnKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pc0xvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVTZXJ2aWNlLmdldFNlc3Npb24oKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICB9XSk7XG59O1xuIiwiLypcbiAqY2FjaGVTZXJ2aWNlXG4gKi9cbi8q6ZSuXG4gKnRrICB0b2tlblxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ2NhY2hlU2VydmljZScsIGZ1bmN0aW9uKCRjb29raWVzKSB7XG4gICAgICAgIHZhciBDT05TVEFOVCA9IHtcbiAgICAgICAgICAgIFNFU1NJT046ICdjcm1fcydcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXRJdGVtID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gJGNvb2tpZXMuZ2V0KGtleSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2V0SXRlbSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiAkY29va2llcy5wdXQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbSA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKGtleSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2V0U2Vzc2lvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SXRlbShDT05TVEFOVC5TRVNTSU9OKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXRTZXNzaW9uID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0SXRlbShDT05TVEFOVC5TRVNTSU9OLCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgfSk7XG59O1xuIiwiLypcbiAqY29tcGFueVNlcnZpY2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ2NvbXBhbnlTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgZnVuY3Rpb24oeGhyU2VydmljZSwgJHEpIHtcbiAgICB2YXIgbWUgPSB0aGlzO1xuICAgIHRoaXMuY29tcGFueUxpc3QgPSBbXTtcbiAgICB0aGlzLkNvbXBhbnlNb2RlbCA9IFt7XG4gICAgICBuYW1lOiAnY29tcGFueUlkJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdzdGFmZk51bSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnY29tcGFueU5hbWUnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ3NoZWxmVHlwZSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnZGVzJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdhZGRyZXNzJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdsaW1pdEZlZSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnY29udGFjdHMnLFxuICAgICAgbW9kZWw6ICdDb250YWN0TW9kZWwnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ2xuZydcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnbGF0J1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdzdGF0dXMnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ2ZvbGxvd1Blb3BsZSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnc2VuZFdlZWsnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ3N1cGVyQWRtaW4nXG4gICAgfSwge1xuICAgICAgbmFtZTogJ3BpY2tpbmdUeXBlJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdwaWNraW5nUmVtYXJrJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdjdXN0b21lclR5cGUnXG4gICAgfV07XG4gICAgdGhpcy5Db250YWN0TW9kZWwgPSBbe1xuICAgICAgbmFtZTogJ2lkJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdtb2JpbGUnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ2NvbXBhbnlJZCdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAndGVsJ1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdxcSdcbiAgICB9LCB7XG4gICAgICBuYW1lOiAnd2VjaGF0J1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdjb250YWN0TmFtZSdcbiAgICB9XTtcbiAgICB0aGlzLmZvcm1hdGUgPSBmdW5jdGlvbihtb2RlbG5hbWUsIGRhdGEpIHtcbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgbWUucmVjdXJzaW9uID0gYXJndW1lbnRzLmNhbGxlZTtcbiAgICAgIHZhciB1ID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgIHZhciB0ZW1wID0gXy5vbWl0KGl0ZW0sIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICB2YXIgbWRuYW1lO1xuICAgICAgICAgIHZhciByID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgaW5kZXggPSBfLnBsdWNrKG1lW21vZGVsbmFtZV0sICduYW1lJykuaW5kZXhPZihcbiAgICAgICAgICAgIGtleSk7XG4gICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgbWRuYW1lID0gbWVbbW9kZWxuYW1lXVtpbmRleF0ubW9kZWw7XG4gICAgICAgICAgICBtZG5hbWUgPyBvYmpba2V5XSA9IG1lLnJlY3Vyc2lvbihtZG5hbWUsIHZhbHVlKSA6XG4gICAgICAgICAgICAgIGZhbHNlO1xuICAgICAgICAgICAgciA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbmd1bGFyLmV4dGVuZCh0ZW1wLCBvYmopO1xuICAgICAgfTtcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0YSkgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICByZXN1bHQgPSBbXTtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICByZXN1bHQucHVzaCh1KGl0ZW0pKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSB1KGRhdGEpO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICB0aGlzLmluZGV4Q29tcGFueSA9IGZ1bmN0aW9uKGRhdGEsIG9mZnNldCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGl0ZW0uaW5kZXggPSBpbmRleCArIG9mZnNldDtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcbiAgICB0aGlzLnBhcnNlQ29tcGFueUxpc3QgPSBmdW5jdGlvbihkYXRhLCBvZmZzZXQpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpdGVtLmluZGV4ID0gaW5kZXggKyBvZmZzZXQ7XG4gICAgICAgIGl0ZW0ubGFzdENvbnRhY3QgPSBpdGVtLmNvbnRhY3RzW2l0ZW0uY29udGFjdHMubGVuZ3RoIC1cbiAgICAgICAgICAxXTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcbiAgICAvL+aOpeWPo1xuICAgIC8q6I635Y+W5YWs5Y+45YiX6KGoXG4gICAgb2Zmc2V0KOadoeebruWBj+enuylcbiAgICBsaW1pdCjlvZPliY3pobXmmL7npLrmlbDmja7kuKrmlbApXG4gICAgaXNEZWxldGVkKDA65pyq5Yig6ZmkIDE65bey5Yig6ZmkIOS4jeS8oOi/lOWbnuaJgOaciSlcbiAgICBjb21wYW55TmFtZSjml6DlgLzlj6/kuI3kvKApXG4gICAgYWRkcmVzcyjml6DlgLzlj6/kuI3kvKApXG4gICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICBwYXJhbXMuaXNEZWxldGVkID0gMDtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L19xdWVyeScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q6I635Y+W5YWs5Y+45L+h5oGvXG4gICAgICpAUGFyYW1zXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvJyArIHBhcmFtcy5jb21wYW55SWQsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrliJvlu7rlhazlj7hcbiAgICAgKkBQYXJhbXNcbiAgICAgKmNvbXBhbnlOYW1lIC8v5YWs5Y+45ZCN56ewXG4gICAgICpzdGFmZk51bSAvL+S8geS4muWRmOW3peaVsFxuICAgICAqc2hlbGZUeXBlIC8v5LyB5Lia57G75Z6LLDE65LyB5Lia5oC75YyF77ybMjrlkZjlt6Xoh6rotLlcbiAgICAgKmFkZHJlc3MgLy/kvIHkuJrlnLDlnYBcbiAgICAgKmRlcyAvL+S8geS4muaPj+i/sFxuICAgICAqbGltaXRGZWUvL+S8geS4muaKmOaJo+S4iumZkFxuICAgICAqY29udGFjdHMge2NvbXBhbnlJZCxjb250YWN0TmFtZSxtb2JpbGUscXEsd2VjaGF0LHRlbH0vL+S8geS4muiBlOezu+S6uuWIl+ihqFxuICAgICAqL1xuICAgIHRoaXMuY3JlYXRlQ29tcGFueSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55JyxcbiAgICAgICAgcGFyYW1zOiBtZS5mb3JtYXRlKCdDb21wYW55TW9kZWwnLCBwYXJhbXMpLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q5L+u5pS55YWs5Y+4XG4gICAgICpAUGFyYW1zXG4gICAgICpjb21wYW55SWRcbiAgICAgKmNvbXBhbnlOYW1lXG4gICAgICpzdGFmZk51bVxuICAgICAqc2hlbGZUeXBlXG4gICAgICphZGRyZXNzXG4gICAgICpkZXNcbiAgICAgKi9cbiAgICB0aGlzLmVkaXRDb21wYW55ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55JyxcbiAgICAgICAgcGFyYW1zOiBtZS5mb3JtYXRlKCdDb21wYW55TW9kZWwnLCBwYXJhbXMpLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q6I635Y+W5LyB5Lia5rqi5Lu354q25oCBXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueVByZW1pdW1TdGF0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ3ByZW1pdW0vY29tcGFueS8nICsgcGFyYW1zLmNvbXBhbnlJZCxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrorr7nva7kvIHkuJrmuqLku7dcbiAgICAgKmNvbXBhbnlJZFxuICAgICAqL1xuICAgIHRoaXMuc2V0Q29tcGFueVByZW1pdW0gPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdwcmVtaXVtJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKua3u+WKoOS8geS4muiBlOezu+S6ulxuICAgICAqQFBhcmFtc1xuICAgICAqY29tcGFueUlkXG4gICAgICpjb250YWN0TmFtZVxuICAgICAqbW9iaWxlXG4gICAgICpxcVxuICAgICAqd2VjaGF0XG4gICAgICp0ZWxcbiAgICAgKi9cbiAgICB0aGlzLmFkZENvbXBhbnlDb250YWN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvY29udGFjdCcsXG4gICAgICAgIHBhcmFtczogbWUuZm9ybWF0ZSgnQ29udGFjdE1vZGVsJywgcGFyYW1zKSxcbiAgICAgICAgZmxvYXRUb1N0cmluZzogdHJ1ZSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvKuS/ruaUueS8geS4muiBlOezu+S6ulxuICAgICAqQFBhcmFtc1xuICAgICAqaWRcbiAgICAgKmNvbXBhbnlJZFxuICAgICAqY29udGFjdE5hbWVcbiAgICAgKm1vYmlsZVxuICAgICAqcXFcbiAgICAgKndlY2hhdFxuICAgICAqdGVsXG4gICAgICovXG4gICAgdGhpcy5lZGl0Q29tcGFueUNvbnRhY3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L2NvbnRhY3QnLFxuICAgICAgICBwYXJhbXM6IG1lLmZvcm1hdGUoJ0NvbnRhY3RNb2RlbCcsIHBhcmFtcyksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrliKDpmaTkvIHkuJrogZTns7vkurpcbiAgICAgKkBQYXJhbXNcbiAgICAgKmNvbnRhY3RJZFxuICAgICAqL1xuICAgIHRoaXMuZGVsZXRlQ29tcGFueUNvbnRhY3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkRlbGV0ZSh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L2NvbnRhY3QnICsgJz9jb250YWN0SWQ9JyArIHBhcmFtcy5jb250YWN0SWQsXG4gICAgICAgIHBhcmFtczoge30sXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKuaWsOW7uuS8geS4muS/oeaBr1xuICAgICAqQFBhcmFtc1xuICAgICAqY29tcGFueUlkXG4gICAgICppbmZvXG4gICAgICovXG4gICAgdGhpcy5jcmVhdGVDb21wYW55SW5mb3JtYXRpb24gPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zdXJ2ZXknLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG5cbiAgICB9O1xuICAgIC8q6I635Y+W5LyB5Lia5L+h5oGv5YiX6KGoXG4gICAgICpAUGFyYW1zXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueUluZm9ybWF0aW9uID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zdXJ2ZXknLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvKumHjee9ruS8geS4muWvhueggVxuICAgICAqQFBhcmFtc1xuICAgICAqY29tcGFueUlkXG4gICAgICovXG4gICAgdGhpcy5yZXNldENvbXBhbnlQYXNzd29yZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvbWFuYWdlcicsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q5LyB5Lia54q25oCB5Y+Y5pu05pel5b+XXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueVN0YXRlQ2hhbmdlTG9nID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zdGF0dXMvbG9nL2ZpbmRfbGlzdCcsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q6I635Y+W5YWs5Y+45oOF5oql5qaC6KeIXG4gICAgICpAUGFyYW1zXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueVByZWZlclN1bW1hcnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L3N1cnZleS9zdW1tYXJ5JyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrliJvlu7rlhazlj7jmg4XmiqXmpoLop4hcbiAgICAgKkBQYXJhbXNcbiAgICAgKmNvbXBhbnlJZFxuICAgICAqaW5mb1xuICAgICAqL1xuICAgIHRoaXMuY3JlYXRlQ29tcGFueVByZWZlclN1bW1hcnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zdXJ2ZXkvc3VtbWFyeScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q5Yib5bu6L+S/ruaUueS8geS4muWdj+i0puaKteaJo1xuICAgICAqY29tcGFueUlkXG4gICAgICpjaGFuZ2VcbiAgICAgKi9cbiAgICB0aGlzLnNldENvbXBhbnlEZWR1Y3Rpb24gPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdkZWR1Y3Rpb24vY29tcGFueS8nICsgcGFyYW1zLmNvbXBhbnlJZCxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrmn6Xor6LkvIHkuJrlnY/otKbmirXmiaPkv6Hmga9cbiAgICAgKmNvbXBhbnlJZFxuICAgICAqL1xuICAgIHRoaXMucXVlcnlDb21wYW55RGVkdWN0aW9uID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnZGVkdWN0aW9uL2NvbXBhbnkvJyArIHBhcmFtcy5jb21wYW55SWQsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q5p+l6K+i5LyB5Lia5Z2P6LSm5L2Z6aKd5rWB5rC0XG4gICAgICpjb21wYW55SWRcbiAgICAgKm9mZnNldFxuICAgICAqbGltaXRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5Q29tcGFueURlZHVjdGlvbkZsb3cgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdkZWR1Y3Rpb24vY29tcGFueS8nICsgcGFyYW1zLmNvbXBhbnlJZCArICcvbG9ncycsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8vIOm7keWQjeWNleWIl+ihqFxuICAgIHRoaXMuZ2V0QmxvY2tDb21wYW55ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9ibGFja2xpc3QvJyArIHBhcmFtcy5jb21wYW55SWQsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgdGhpcy5nZXRaZXJvUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvemVyb3NlbGwvJyArIHBhcmFtcy5jb21wYW55SWQsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLy8g5re75Yqg6buR5ZCN5Y2VXG4gICAgdGhpcy5hZGRCbG9ja0NvbXBhbnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9ibGFja2xpc3QvJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLy8g5L+u5pS56buR5ZCN5Y2VXG4gICAgdGhpcy5tb2RpZnlCbG9ja0NvbXBhbnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L2JsYWNrbGlzdC8nLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvL+WIoOmZpOm7keWQjeWNlVxuICAgIHRoaXMuZGVsZXRlQmxvY2tDb21wYW55ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9ibGFja2xpc3QvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICB9XSk7XG59OyIsIi8qKlxuICogQ3JlYXRlZCBieSB0YW94aWFvZmVuZyBvbiAyMDE2LzEwLzE5LlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcHApIHtcbiAgICBhcHAuc2VydmljZSgnY29uZmlndXJhdGlvbkluZm9ybWF0aW9uU2VydmljZScsIFsneGhyU2VydmljZScsICckcScsIGZ1bmN0aW9uICh4aHJTZXJ2aWNlLCAkcSkge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDUk3kv6Hmga/phY3nva4gLSDpm7boirHpkrHln7rmlbAjXG4gICAgICAgICAqIOaOpeWPo+WQjSAvaW5mby9jb25maWcvcG9ja2V0X21vbmV5XG4gICAgICAgICAqIOivt+axguaWueazlSBQVVRcbiAgICAgICAgICog6K+35rGC5Y+C5pWwIDogdG90YWxGZWUgIOmbtuiKsemSseagoemqjOWAvCAgIGludOexu+Wei1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wb2NrZXRNb25leUF1ZGl0ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnaW5mby9jb25maWcvcG9ja2V0X21vbmV5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDUk3kv6Hmga/phY3nva4gLSDpm7boirHpkrHln7rmlbAgLS0g6I635Y+W6buY6K6k55qE6Zu26Iqx6ZKx5Z+65pWwXG4gICAgICAgICAqIOaOpeWPo+WQjSBpbmZvL2NvbmZpZy9tb25leV9iYXNlXG4gICAgICAgICAqIOivt+axguaWueazlSBHRVRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0UG9ja2V0TW9uZXlBdWRpdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2luZm8vY29uZmlnL21vbmV5X2Jhc2UnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENSTeS/oeaBr+mFjee9riAtIOaDs+imgeWVhuWTgeeIseW/g+i3s+WKqOaXtumXtOmFjee9rlxuICAgICAgICAgKiDmjqXlj6PlkI0gL2luZm8vY29uZmlnL2hlYXJ0X3Nob3dcbiAgICAgICAgICog6K+35rGC5pa55rOVIFBVVFxuICAgICAgICAgKiDor7fmsYLlj4LmlbA6IHNob3dUaW1lICBpbnTnsbvlnotcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud2lzaExpc3RDb25maWd1cmF0aW9uID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnaW5mby9jb25maWcvaGVhcnRfc2hvdycsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDUk3kv6Hmga/phY3nva4gLSDojrflj5YgIOaDs+imgeWVhuWTgeeIseW/g+i3s+WKqOaXtumXtOmFjee9rlxuICAgICAgICAgKiDmjqXlj6PlkI0gaW5mby9jb25maWcvaGVhcnRfYmFzZVxuICAgICAgICAgKiDor7fmsYLmlrnms5UgR0VUXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldFdpc2hMaXN0Q29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2luZm8vY29uZmlnL2hlYXJ0X2Jhc2UnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqICBDUk3kv6Hmga/phY3nva4gLSDokKXplIDllYblk4Ev57uE5ZCI5a6a6YeR6aKd5bqmXG4gICAgICAgICAqICDmjqXlj6PlkI0gY29tcGFueS9wcm9tb3Rpb24vY29uZmlnL2RlcG9zaXRcbiAgICAgICAgICogIOivt+axguaWueazlSBHZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0TWFya2V0aW5nQWN0aXZpdGllc0RlcG9zaXRJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvcHJvbW90aW9uL2NvbmZpZy9kZXBvc2l0JyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMubWFya2V0aW5nQWN0aXZpdGllc0RlcG9zaXRJbmZvID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvcHJvbW90aW9uL2NvbmZpZy9kZXBvc2l0LycgKyBwYXJhbXMsXG4gICAgICAgICAgICAgICAgLy8gcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ1JN5L+h5oGv6YWN572uIC0g6I635Y+W6YCJ6LSt5Y2V5LiK6ZmQI1xuICAgICAgICAgKiDmjqXlj6PlkI0gL2luZm8vY29uZmlnL21hbmFnZXJfb3JkZXJcbiAgICAgICAgICog6K+35rGC5pa55rOVIEdFVFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nZXRDaG9vc2VPcmRlckluZm9DZWlsaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnaW5mby9jb25maWcvbWFuYWdlcl9vcmRlcicsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ1JN5L+h5oGv6YWN572uIC0g5Yib5bu6L+S/ruaUuemAiei0reS4iumZkOWAvCNcbiAgICAgICAgICog5o6l5Y+j5ZCNIC9pbmZvL2NvbmZpZy9tYW5hZ2VyX29yZGVyXG4gICAgICAgICAqIOivt+axguaWueazlSBQT1NUXG4gICAgICAgICAqIOivt+axguWPguaVsDogaWQgICBsaW1pdE51bSAgIHNoZWxmTnVtVHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jcmVhdGVDaG9vc2VPcmRlckluZm8gPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdpbmZvL2NvbmZpZy9tYW5hZ2VyX29yZGVyJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9XG4gICAgfV0pO1xufTtcbiIsIi8vcHJvZHVjdFNlcnZpY2Vcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5zZXJ2aWNlKCdkZWFkU3RvY2tTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgJyRmaWx0ZXInLCAnQ09OU1RBTlRTJyxcbiAgICBmdW5jdGlvbih4aHJTZXJ2aWNlLCAkcSwgJGZpbHRlciwgQ09OU1RBTlRTKSB7XG4gICAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24odXJsLCB0eXBlLCBwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlW3R5cGVdKHtcbiAgICAgICAgICBwYXRoOiB1cmwsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAgICrmn6Xor6Lmu57plIDllYblk4FcbiAgICAgICAqe1xuICAgICAgICpwcm9kdWN0TmFtZVxuICAgICAgICp9XG4gICAgICAgKi9cbiAgICAgIHRoaXMuZ2V0RGVhZFN0b2NrUHJvZHVjdExpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnkoJ3Byb2R1Y3QvdW5zYWxhYmxlL19xdWVyeScsICdQb3N0JywgcGFyYW1zKTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAgICrliKDpmaTmu57plIDllYblk4FcbiAgICAgICAqe3Byb2R1Y3RJZFxuICAgICAgICp9XG4gICAgICAgKi9cbiAgICAgIHRoaXMucmVtb3ZlRGVhZFN0b2NrUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeSgncHJvZHVjdC91bnNhbGFibGUvZGVsLycrcGFyYW1zLnByb2R1Y3RJZCwgJ0RlbGV0ZScsIHBhcmFtcyk7XG4gICAgICB9O1xuXG5cbiAgICB9XG4gIF0pO1xufTtcbiIsIi8qXG4gKmRpYWxvZ1NlcnZpY2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ2RpYWxvZ1NlcnZpY2UnLCBbJyRtZERpYWxvZycsICckcScsIGZ1bmN0aW9uKCRtZERpYWxvZywgJHEpIHtcbiAgICB0aGlzLmFsZXJ0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICB0aGlzLmNvbmZpcm0gPSBmdW5jdGlvbigpIHt9O1xuICB9XSk7XG59OyIsIi8qXG4gKmNvbXBhbnlTZXJ2aWNlXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ2ZpbmFuY2VTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgJyRmaWx0ZXInLCBmdW5jdGlvbih4aHJTZXJ2aWNlLCAkcSwgJGZpbHRlcikge1xuICAgICAgICAvKui0ouWKoeWIl+ihqFxuICAgICAgICAgKmNvbXBhbnlJZFxuICAgICAgICAgKmZpbmFuY2VTdGFydFRpbWVcbiAgICAgICAgICpmaW5hbmNlRW5kVGltZVxuICAgICAgICAgKm9yZGVyU3RhdGVzXG4gICAgICAgICAqaXNJbnZvaWNlXG4gICAgICAgICAqaXNVcGRhdGVUaW1lXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1ZXJ5RmluYW5jZUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICBwYXJhbXMuZmluYW5jZVN0YXJ0VGltZSAmJiAocGFyYW1zLmZpbmFuY2VTdGFydFRpbWUgPSBwYXJhbXMuZmluYW5jZVN0YXJ0VGltZS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgcGFyYW1zLmZpbmFuY2VFbmRUaW1lICYmIChwYXJhbXMuZmluYW5jZUVuZFRpbWUgPSBwYXJhbXMuZmluYW5jZUVuZFRpbWUuZ2V0VGltZSgpKTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL3NldHRsZW1lbnQvZmluYW5jZS9maW5kTGlzdCcsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrotKLliqHnu5PnrpfljZXlvIDnpahcbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3JlYXRlSW52b2ljZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHBhcmFtcy5pbnZvaWNlRmVlID0gJGZpbHRlcigncG9pbnRzJykocGFyYW1zLmludm9pY2VGZWUpO1xuICAgICAgICAgICAgcGFyYW1zLmV4cHJlc3NDb21wYW55ID0gcGFyYW1zLmV4cHJlc3NDb21wYW55LmRlc2MgfHwgcGFyYW1zLmV4cHJlc3NDb21wYW55O1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvc2V0dGxlbWVudC9maW5hbmNlL2ludm9pY2UnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIC8q57uT566X5Y2V56Gu6K6k5pS25qy+XG4gICAgICAgICAqXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNvbmZpcm1QYXltZW50ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgcGFyYW1zLnJlY2VpdmVGZWUgPSAkZmlsdGVyKCdwb2ludHMnKShwYXJhbXMucmVjZWl2ZUZlZSk7XG4gICAgICAgICAgICBwYXJhbXMuZHVlRmVlID0gJGZpbHRlcigncG9pbnRzJykocGFyYW1zLmR1ZUZlZSk7XG4gICAgICAgICAgICBwYXJhbXMuYmFkRGVidEZlZSA9ICRmaWx0ZXIoJ3BvaW50cycpKHBhcmFtcy5iYWREZWJ0RmVlKTtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUocGFyYW1zLnJlY2VpdmVGZWVUaW1lKTtcbiAgICAgICAgICAgIHZhciBzID0gbmV3IERhdGUocGFyYW1zLnJlY2VpdmVGZWVUaW1lSG91cik7XG4gICAgICAgICAgICBkLnNldEhvdXJzKHMuZ2V0SG91cnMoKSk7XG4gICAgICAgICAgICBkLnNldE1pbnV0ZXMocy5nZXRNaW51dGVzKCkpO1xuICAgICAgICAgICAgZC5zZXRTZWNvbmRzKHMuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIHBhcmFtcy5yZWNlaXZlRmVlVGltZSA9IGQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvc2V0dGxlbWVudC9maW5hbmNlL2NvbmZpcm1QYXltZW50JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5zZXJ2aWNlKCdnb29kc0Nob29zZVNlcnZpY2UnLCBbJ3hoclNlcnZpY2UnLCAnJHEnLCBmdW5jdGlvbih4aHJTZXJ2aWNlLCAkcSkge1xuICAgICAgICAvKuWIhumhteafpeivoumAiei0reWNleWIl+ihqFxuICAgICAgICAqb2Zmc2V0IFJcbiAgICAgICAgbGltaXQgUlxuICAgICAgICBjb21wYW55SWRcbiAgICAgICAgc3RhcnRUaW1lXG4gICAgICAgIGVuZFRpbWVcbiAgICAgICAgb3JkZXJTdGF0ZXNcbiAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xdWVyeU1hbmFnZXJPcmRlckxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ21hbmFnZXJvcmRlci9vcmRlcnMnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrmn6Xor6LooYzmlL/pgInotK3ljZXmmI7nu4ZcbiAgICAgICAgICpvcmRlcklkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1ZXJ5TWFuYWdlck9yZGVyRGV0YWlsID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdtYW5hZ2Vyb3JkZXIvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrkv67mlLnooYzmlL/pgInotK3ljZXnirbmgIFcbiAgICAgICAgKm9yZGVySWRcbiAgICAgICAgKm9yZGVyU3RhdGVcbiAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tb2RpZnlPcmRlclN0YXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdtYW5hZ2Vyb3JkZXIvJytwYXJhbXMub3JkZXJJZCsnL3N0YXRlJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6e1xuICAgICAgICAgICAgICAgICAgICBvcmRlclN0YXRlOnBhcmFtcy5vcmRlclN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBvcHRSZWNvcmQ6cGFyYW1zLm9wdFJlY29yZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn1cbiIsIi8qKlxuICpcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ2hvbGlkYXlXZWxmYXJlU2VydmljZScsIFsneGhyU2VydmljZScsICckcScsICckZmlsdGVyJywgJ0NPTlNUQU5UUycsIGZ1bmN0aW9uICh4aHJTZXJ2aWNlLCAkcSwgJGZpbHRlciwgQ09OU1RBTlRTKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaYvuekuuW+heS7mOasvueKtuaAgeeahOiuouWNlSDkuI3mmL7npLrmlK/ku5jmlrnlvI9cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGFyc2VEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgICAgICB2YXIgdCA9IGFuZ3VsYXIuY29weShkYXRhKTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0LCBmdW5jdGlvbiAob3JkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAob3JkZXIub3JkZXIuc3RhdHVzID09IENPTlNUQU5UUy5PUkRFUl9TVEFUVVMuQ0FOQ0VMKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLm9yZGVyLnBheUNoYW5uZWwgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyppZiAob3JkZXIub3JkZXIucGF5Q2hhbm5lbCA9PSBDT05TVEFOVFMuUEFZTUVOVF9TVEFUVVMuV0VDSEFUX1BBWSB8fCBvcmRlci5vcmRlci5wYXlDaGFubmVsID09IENPTlNUQU5UUy5QQVlNRU5UX1NUQVRVUy5XRUNIQVRfQVBQKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLm9yZGVyLnN0YXR1cyA9IENPTlNUQU5UUy5PUkRFUl9TVEFUVVMuV0FJVElOR19ESVNUUklCVVRJT047XG4gICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiOt+WPluaJgOacieiKguWBh+aXpeemj+WIqeiuouWNlVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nZXRBbGxXZWxmYXJlT3JkZXJzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICBpZihwYXJhbXMudHlwZSl7Ly/ojrflj5bpu5jorqRcbiAgICAgICAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgICAgICAgIHBhcmFtcy5lbmRUaW1lID0gICRmaWx0ZXIoJ2RhdGUnKShwYXJhbXMuZW5kVGltZSwgJ3l5eXktTU0tZGQgSEg6bW06c3MnKTtcbiAgICAgICAgICAgICAgICBwYXJhbXMuc3RhcnRUaW1lID0gJGZpbHRlcignZGF0ZScpKHBhcmFtcy5zdGFydFRpbWUsICd5eXl5LU1NLWRkIEhIOm1tOnNzJyk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHBhcmFtcy50eXBlO1xuICAgICAgICAgICAgfSBlbHNle1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcGFyYW1zLmxpbWl0PTI1O1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2hvbGlkYXkvb3JkZXIvcGFnZScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgLy8gcmVtb3RlOidob2xpZGF5JyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5piO57uGIC0tPiDlpIfms6gg5o6l5Y+jXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNldE5vdGVzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9ob2xpZGF5L29yZGVyL25vdGVzJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiAg5Y+W5raI6K6i5Y2VXG4gICAgICAgICAqICBwYXJhbXMgOiBpZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jYW5jZWxPcmRlciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvaG9saWRheS9vcmRlci9jYW5jZWwnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaUtuWIsOasvumhuVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZWNlaXZlUGF5bWVudCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvaG9saWRheS9vcmRlci9jb25maXJtJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDlrozmiJDphY3pgIFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY29tcGxldGVEZWxpdmVyeSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvaG9saWRheS9vcmRlci9maW5pc2gnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiOt+WPlum7mOiupOeahCjpooTlrprml7bpl7TjgIHng63ljZbml7bpl7TjgIHnu5PmnZ/ml7bpl7QpXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldEhvbGlkYXlEZWZhdWx0VGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2hvbGlkYXkvcGVyaW9kL2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIC8vIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOabtOaWsCjpooTlrprml7bpl7TjgIHng63ljZbml7bpl7TjgIHnu5PmnZ/ml7bpl7QpXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVwZGF0ZUhvbGlkYXlUaW1lID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnaG9saWRheS9wZXJpb2QvdXBkYXRlJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn07IiwiLy9pblN0b3JhZ2VTZXJ2aWNlXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5zZXJ2aWNlKCdpblN0b3JhZ2VTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgZnVuY3Rpb24oeGhyU2VydmljZSwgJHEpIHtcbiAgICAgICAgLypcbiAgICAgICAgICrojrflj5blm57ku5PljZXliJfooahcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0SW5TdG9yYWdlTGlzdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICAvLyBwYXRoOiAnY29tcGFueS9zdG9jay9xdWVyeT9wYWdlTm89JyArIHBhcmFtcy5wYWdlTm8sXG4gICAgICAgICAgICAgICAgcGF0aDogJ2xvZ2lzdGljcy9vcmRlci9iYWNrc3RvY2svZmluZExpc3QnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiOt+WPluWbnuS7k+WNleivpuaDhVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nZXRJblN0b3JhZ2VEZXRhaWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgLy8gcGF0aDogJ2NvbXBhbnkvc3RvY2svZGV0YWlsJyxcbiAgICAgICAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2JhY2tzdG9jay8nICsgcGFyYW1zLm9yZGVySWQsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKlxuICAgICAgICAgKiDojrflj5bnrqHnkIblkZjliJfooahcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0QWxsTWFuYWdlciA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnbWFuYWdlcicsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5L+u5pS55Zue5LuT5Y2V5L+h5oGvXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVwZGF0ZUluU3RvcmFnZURldGFpbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2JhY2tzdG9jaycsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn07IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHRhb3hpYW9mZW5nIG9uIDE2LzgvNC5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuc2VydmljZSgnbGFiZWxzTWFuYWdlbWVudFNlcnZpY2UnLCBbJ3hoclNlcnZpY2UnLCAnJHEnLCBmdW5jdGlvbih4aHJTZXJ2aWNlLCAkcSkge1xuICAgICAgICAvKuiOt+WPluaJgOacieagh+etvlxuICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldEFsbExhYmVsTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9sYWJlbC9maW5kX2FsbF9saXN0JyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDllYblk4HmoIfnrb4gLSDliJfooajmn6Xor6JcbiAgICAgICAgICog5o6l5Y+j5ZCNIC9jb21wYW55L2xhYmVsXG4gICAgICAgICAqIOivt+axguaWueazlSBHRVRcbiAgICAgICAgICog6K+35rGC5Y+C5pWwOiBsYWJlbE5hbWUgICBvZmZzZXQgIGxpbWl0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldExhYmVsc0xpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvbGFiZWwvZmluZF9uYW1lX2xpc3QnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5Yib5bu65ZWG5ZOB5qCH562+5ZCN56ewXG4gICAgICAgICAqIOaOpeWPo+WQjSAvY29tcGFueS9sYWJlbC9jcmVhdGVfbmFtZVxuICAgICAgICAgKiDor7fmsYLmlrnms5UgUE9TVFxuICAgICAgICAgKiDor7fmsYLlj4LmlbA6IHR5cGUgIG5hbWUgICByZW1hcmtcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3JlYXRlTGFiZWxzTmFtZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvbGFiZWwvY3JlYXRlX25hbWUnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5p+l55yL5ZWG5ZOB5qCH562+5ZCN56ew5piO57uGXG4gICAgICAgICAqIOaOpeWPo+WQjSAvY29tcGFueS9sYWJlbC/ov5nph4zkvKBsYWJlbElkXG4gICAgICAgICAqIOivt+axguaWueazlSBHRVRcbiAgICAgICAgICog6K+35rGC5Y+C5pWwOiBsYWJlbElkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldExhYmVsc0RldGFpbHMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvbGFiZWwvJyArIHBhcmFtcy5sYWJlbElkLFxuICAgICAgICAgICAgICAgIC8qcGFyYW1zOiBwYXJhbXMsKi9cbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWVhuWTgeagh+etviAtIOS/ruaUueWVhuWTgeagh+etvuWQjeensFxuICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvbW9kaWZ5X25hbWVcbiAgICAgICAgICog6K+35rGC5pa55rOVIFBVVFxuICAgICAgICAgKiDor7fmsYLlj4LmlbA6IGlkICB0eXBlICAgbmFtZSAgIHJlbWFya1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tb2RpZnlsYWJlbHNOYW1lID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL21vZGlmeV9uYW1lJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWVhuWTgeagh+etviAtIOWIoOmZpOWVhuWTgeagh+etvuWQjeensFxuICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvZGVsZXRlX25hbWUv6L+Z6YeM5aGr5YaZbGFiZWxJZFxuICAgICAgICAgKiDor7fmsYLmlrnms5UgREVMRVRFXG4gICAgICAgICAqIOivt+axguWPguaVsDogaWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVsZXRlQ29tbW9kaXR5TGFiZWxOYW1lID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL2RlbGV0ZV9uYW1lLycgKyBwYXJhbXMuaWQsXG4gICAgICAgICAgICAgICAgLypwYXJhbXM6IHBhcmFtcywqL1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g6I635Y+W5qCH562+57G75Z6L5YiX6KGoXG4gICAgICAgICAqIOaOpeWPo+WQjSAvY29tcGFueS9sYWJlbC9maW5kX3R5cGVfbGlzdFxuICAgICAgICAgKiDor7fmsYLmlrnms5UgR0VUXG4gICAgICAgICAqIOivt+axguWPguaVsCA6IOaXoFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vYnRhaW5MYWJlbFR5cGVMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL2ZpbmRfdHlwZV9saXN0JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWVhuWTgeagh+etviAtIOWIm+W7uuagh+etvuexu+Wei1xuICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvY3JlYXRlX3R5cGVcbiAgICAgICAgICog6K+35rGC5pa55rOVIFBPU1RcbiAgICAgICAgICog6K+35rGC5Y+C5pWwOiB0eXBlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNyZWF0ZUxhYmVsc1R5cGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL2NyZWF0ZV90eXBlJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICog5ZWG5ZOB5qCH562+IC0g5pu05paw5qCH562+57G75Z6LXG4gICAgICAgICAqIOaOpeWPo+WQjSAvY29tcGFueS9sYWJlbC9tb2RpZnlfdHlwZVxuICAgICAgICAgKiDor7fmsYLmlrnms5UgUFVUXG4gICAgICAgICAqIOivt+axguWPguaVsDogaWQgIHR5cGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXBkYXRlTGFiZWxUeXBlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL21vZGlmeV90eXBlJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWVhuWTgeagh+etviAtIOWIoOmZpOagh+etvuexu+Wei1xuICAgICAgICAgKiDmjqXlj6PlkI0gL2NvbXBhbnkvbGFiZWwvZGVsZXRlX3R5cGUv6L+Z6YeM5aGr5YaZbGFiZWxJZFxuICAgICAgICAgKiDor7fmsYLmlrnms5UgREVMRVRFXG4gICAgICAgICAqIOivt+axguWPguaVsDogaWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVsZXRlTGFiZWxUeXBlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L2xhYmVsL2RlbGV0ZV90eXBlLycgKyBwYXJhbXMuaWQsXG4gICAgICAgICAgICAgICAgLypwYXJhbXM6IHBhcmFtcywqL1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICB9XSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ2xvYWRkaW5nU2VydmljZScsIFsgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlbCA9ICQoJyNsb2FkZGluZycpO1xuICAgICAgICBlbC5vbignY2xpY2snLGZ1bmN0aW9uKGUpe1xuICAgICAgICBcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBlbC5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZWwuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuc2VydmljZSgnbW9kYWxTZXJ2aWNlJywgWyckdWliTW9kYWwnLCBmdW5jdGlvbigkdWliTW9kYWwpIHtcbiAgICB0aGlzLmluaXRNb2RhbCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHZhciBjb25maWcgPSBhbmd1bGFyLmV4dGVuZCh7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBvcHRzLnRlbXBsYXRlVXJsIHx8ICdtb2RlbGNvbnRlbnQnLCAvL+aMh+WQkeS4iumdouWIm+W7uueahOinhuWbvlxuICAgICAgICBzaXplOiBvcHRzLnNpemUgfHwgJycsXG4gICAgICAgIGJhY2tkcm9wOiAnc3RhdGljJyxcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgLy/noa7lrpogIOWPlua2iFxuICAgICAgICAgICRzY29wZS5jb25maXJtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKG9wdHMub2spIHsgLy/lhbPpl61cbiAgICAgICAgICAgICAgb3B0cy5vay5jYWxsKHRoaXMsICRzY29wZSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBtZS4kY2xvc2UoKSB8fCBtZS5tb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLm9rKSB7XG4gICAgICAgICAgICAgICRzY29wZS5vay5hcHBseSh0aGlzLCBbJHNjb3BlXSk7XG4gICAgICAgICAgICB9IGVsc2UgeyAvL+S4jeWFs+mXrVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiRjbG9zZSgpIHx8IHRoaXMubW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9LCBvcHRzKTtcbiAgICAgIHJldHVybiAkdWliTW9kYWwub3Blbihjb25maWcpO1xuICAgIH07XG4gIH1dKTtcbn07IiwiLy9wcm9kdWN0U2VydmljZVxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ25ld1Byb2R1Y3RTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgZnVuY3Rpb24oXG4gICAgeGhyU2VydmljZSwgJHEpIHtcbiAgICB0aGlzLmluZGV4RGF0YSA9IGZ1bmN0aW9uKGRhdGEsIG9mZnNldCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGl0ZW0uaW5kZXggPSBpbmRleCArIG9mZnNldDtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9O1xuXG4gICAgLy8g5p+l5om+5paw5ZOB6KGoXG4gICAgdGhpcy5xdWVyeVByb2R1Y3RCeUtleSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdwcm9kdWN0L3JlY29tbWVuZC9fcXVlcnknLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvL+afpeeci+WVhuWTgeivpuaDhVxuICAgIHRoaXMuZ2V0UHJvZHVjdEJ5SWQgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdwcm9kdWN0LycgKyBwYXJhbXMuaWQsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygkZmlsdGVyKCdpbnQnKShyZXMsIFsnaGVhZGVyLnN0b2NrJ10pKVxuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJGZpbHRlcignaW50JykocmVzLCBbJ2hlYWRlci5zdG9jayddKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8vIOS/ruaUueaWsOWTgeaOqOiNkOeKtuaAge+8muaOqOiNkOeKtuaAgeWAvCAxOuaOqOiNkOS4rSAyOuW+heaOqOiNkFxuICAgIHRoaXMuY2hhbmdlTmV3UHJvZHVjdFN0YXR1cyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgIHBhdGg6ICdwcm9kdWN0L3JlY29tbWVuZC9jaGFuZ2VTdGF0ZScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8v5Yig6Zmk5paw5ZOB5o6o6I2QXG4gICAgdGhpcy5kZWxldGVOZXdQcm9kdWN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICBwYXRoOiAncHJvZHVjdC9yZWNvbW1lbmQvZGVsLycgKyBwYXJhbXMuaWQsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8vIOiOt+WPluaJgOacieWVhuWTgeeahOaVsOaNru+8jOeUqOS6jua3u+WKoOaWsOWTgeeahOWvueivneahhlxuICAgIHRoaXMucXVlcnlBbGxQcm9kdWN0ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdwcm9kdWN0L19xdWVyeScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8vIOehruiupOa3u+WKoOaWsOWTgVxuICAgIHRoaXMuYWRkTmV3UHJvZHVjdHMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgY29uc29sZS5sb2coJyEhISEhISBhZGROZXdQcm9kdWN0cycsIHBhcmFtcylcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdwcm9kdWN0L3JlY29tbWVuZC9hZGQnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKlxuICAgICAq6Zmk5b2T5YmN6LSn5p625LiK55qE5YW25LuW5ZWG5ZOBXG4gICAgICovXG4gICAgdGhpcy5fcGFyc2VPdGhlclNoZWxmUHJvZHVjdHMgPSBmdW5jdGlvbihkYXRhLCBzZWxlY3RlZElkTGlzdCkge1xuICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtLCBpKSB7XG4gICAgICAgIHZhciB0ID0gYW5ndWxhci5jb3B5KGl0ZW0uaGVhZGVyKTtcbiAgICAgICAgdC5wb3NpdGlvbnMgPSBpdGVtLnBvc2l0aW9ucztcbiAgICAgICAgaWYgKHNlbGVjdGVkSWRMaXN0LmluZGV4T2YoaXRlbS5oZWFkZXIuaWQpID4gLTEpIHtcbiAgICAgICAgICB0LnNlbGVjdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdC5jYXRlZ29yeU5hbWUgPSBpdGVtLmNhdGVnb3J5LmNhdGVnb3J5TmFtZTtcbiAgICAgICAgdGVtcC5wdXNoKHQpO1xuXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0ZW1wO1xuICAgIH07XG4gIH1dKTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuc2VydmljZSgnb3JkZXJTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJ0NPTlNUQU5UUycsICckcScsICd1dGlsU2VydmljZScsXG4gICAgJ21vZGFsU2VydmljZScsICckY29tcGlsZScsICckdGVtcGxhdGVDYWNoZScsICdwcmludFNlcnZpY2UnLFxuICAgICdzdWl0ZVNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uKHhoclNlcnZpY2UsIENPTlNUQU5UUywgJHEsIHV0aWxTZXJ2aWNlLCBtb2RhbFNlcnZpY2UsXG4gICAgICAkY29tcGlsZSwgJHRlbXBsYXRlQ2FjaGUsIHByaW50U2VydmljZSwgc3VpdGVTZXJ2aWNlKSB7XG4gICAgICB2YXIgT1JERVJfVFlQRSA9IENPTlNUQU5UUy5PUkRFUl9UWVBFO1xuICAgICAgdmFyIFBST0RVQ1RfRlJPTV9UWVBFID0gQ09OU1RBTlRTLlBJQ0tfUFJPRFVDVF9GUk9NX1RZUEU7XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgLy/mnI3liqFcbiAgICAgIC8q57uT566X5Y2V6K+m5oOF5pWw5o2u6L2s5o2iXG4gICAgICAgKi9cbiAgICAgIHRoaXMuX3BhcnNlU2V0dGxlbWVudERldGFpbERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciB0ID0gYW5ndWxhci5jb3B5KGRhdGEpO1xuICAgICAgICB2YXIgb3BJdGVtcyA9IFtdO1xuICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YS5pbnZlbnRvcnlPcmRlcnMsIGZ1bmN0aW9uKGludmVudG9yeU9yZGVyLFxuICAgICAgICAgIGopIHtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW52ZW50b3J5T3JkZXIuZGVsaXZlcnlPcmRlcnMsIGZ1bmN0aW9uKFxuICAgICAgICAgICAgZGVsaXZlcnlPcmRlciwgYSkge1xuICAgICAgICAgICAgdmFyIG9wSXRlbSA9IHtcbiAgICAgICAgICAgICAgb3BUaW1lOiBkZWxpdmVyeU9yZGVyLnVwZGF0ZVRpbWUsXG4gICAgICAgICAgICAgIHNoZWxmTmFtZTogZGVsaXZlcnlPcmRlci5zaGVsZk5hbWUsXG4gICAgICAgICAgICAgIGRlbGl2ZXJ5T3JkZXJGZWU6IGRlbGl2ZXJ5T3JkZXIub3JkZXJGZWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBvcEl0ZW1zLnB1c2gob3BJdGVtKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW52ZW50b3J5T3JkZXIucmV0dXJuT3JkZXJzLCBmdW5jdGlvbihcbiAgICAgICAgICAgIHJldHVybk9yZGVyLCBiKSB7XG4gICAgICAgICAgICB2YXIgb3BJdGVtID0ge1xuICAgICAgICAgICAgICBvcFRpbWU6IHJldHVybk9yZGVyLnVwZGF0ZVRpbWUsXG4gICAgICAgICAgICAgIHNoZWxmTmFtZTogcmV0dXJuT3JkZXIuc2hlbGZOYW1lLFxuICAgICAgICAgICAgICByZXR1cm5PcmRlckZlZTogcmV0dXJuT3JkZXIub3JkZXJGZWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBvcEl0ZW1zLnB1c2gob3BJdGVtKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoaW52ZW50b3J5T3JkZXIub3JkZXJGZWUgfHwgaW52ZW50b3J5T3JkZXIucGFpZEZlZSB8fFxuICAgICAgICAgICAgaW52ZW50b3J5T3JkZXIuZGlzY291bnRGZWUgfHwgaW52ZW50b3J5T3JkZXIucHJlbWl1bUZlZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdmFyIGludmVudG9yeU9wSXRlbSA9IHtcbiAgICAgICAgICAgICAgb3BUaW1lOiBpbnZlbnRvcnlPcmRlci5lbmRUaW1lLFxuICAgICAgICAgICAgICBzaGVsZk5hbWU6IGludmVudG9yeU9yZGVyLnNoZWxmTmFtZSxcbiAgICAgICAgICAgICAgaW52ZW50b3J5T3JkZXJGZWU6IGludmVudG9yeU9yZGVyLm9yZGVyRmVlLFxuICAgICAgICAgICAgICBpbnZlbnRvcnlQYWlkRmVlOiBpbnZlbnRvcnlPcmRlci5wYWlkRmVlLFxuICAgICAgICAgICAgICBpbnZlbnRvcnlEaXNjb3VudEZlZTogaW52ZW50b3J5T3JkZXIuZGlzY291bnRGZWUsXG4gICAgICAgICAgICAgIHByZW1pdW1GZWU6IGludmVudG9yeU9yZGVyLnByZW1pdW1GZWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBvcEl0ZW1zLnB1c2goaW52ZW50b3J5T3BJdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0Lm9wSXRlbXMgPSBvcEl0ZW1zO1xuICAgICAgICB2YXIgbWF4Q29sTnVtID0gODtcbiAgICAgICAgdC50YkNvbE51bSA9IHQucHJlbWl1bUZlZSA/IG1heENvbE51bSA6IG1heENvbE51bSAtIDE7XG4gICAgICAgIHZhciBzaG91bGRQYXlEZXNjID0gKHQub3JkZXJGZWUgLSB0Lm9yZGVyRGlzY291bnQpIC8gMTAwLjAgK1xuICAgICAgICAgICflhYMnO1xuICAgICAgICBpZiAodC5vcmRlckRpc2NvdW50IHx8IHQucG9ja2V0TW9uZXlGZWUpIHtcbiAgICAgICAgICBzaG91bGRQYXlEZXNjICs9ICcoJztcbiAgICAgICAgICBzaG91bGRQYXlEZXNjICs9IHQub3JkZXJEaXNjb3VudCA/ICfmnKzmrKHnu5PnrpfkvJjmg6A6JyArIHQub3JkZXJEaXNjb3VudCAvXG4gICAgICAgICAgICAxMDAuMCArICflhYMgJyA6ICcnO1xuICAgICAgICAgIHNob3VsZFBheURlc2MgKz0gdC5wb2NrZXRNb25leUZlZSA/ICfkvIHkuJrpm7boirHpkrE6JyArIHQucG9ja2V0TW9uZXlGZWUgL1xuICAgICAgICAgICAgMTAwLjAgKyAn5YWDJyA6ICcnO1xuICAgICAgICAgIHNob3VsZFBheURlc2MgKz0gJyknO1xuICAgICAgICB9XG4gICAgICAgIHQuc2hvdWxkUGF5RGVzYyA9IHNob3VsZFBheURlc2M7XG4gICAgICAgIHJldHVybiB0O1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICog5ouj6LSn5L+h5oGv5Y+C6ICD5pWw5o2u6L2s5o2iXG4gICAgICAgKiBcbiAgICAgICAqL1xuICAgICAgdGhpcy5fcGFyc2VEZWxpdmVyeVJlY29tbSA9IGZ1bmN0aW9uKGRhdGEsIHByb2R1Y3RJZHNJblNoZWxmKSB7XG4gICAgICAgIHZhciB0ZW1wID0ge307XG4gICAgICAgIF8uZWFjaChfLmtleXMoZGF0YSksIGZ1bmN0aW9uKGtleSwgaSkge1xuICAgICAgICAgIHZhciB0ZW1wTGlzdCA9IFtdO1xuICAgICAgICAgIF8uZWFjaChkYXRhW2tleV0sIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciB0ID0gaXRlbTtcbiAgICAgICAgICAgIHZhciBwcm9kdWN0S2V5ID0gJyc7XG4gICAgICAgICAgICBpZiAoa2V5ID09ICdyZXBsZW5pc2htZW50Jykge1xuICAgICAgICAgICAgICBwcm9kdWN0S2V5ID0gJ3Byb2R1Y3REZXRhaWwnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcHJvZHVjdEtleSA9ICdwcm9kdWN0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF8uZXh0ZW5kKHQsIGl0ZW1bcHJvZHVjdEtleV0uaGVhZGVyKTtcbiAgICAgICAgICAgIHQucHJvZHVjdElkID0gaXRlbVtwcm9kdWN0S2V5XS5oZWFkZXIuaWQ7XG4gICAgICAgICAgICB0LnBvc2l0aW9ucyA9IGl0ZW1bcHJvZHVjdEtleV0ucG9zaXRpb25zO1xuICAgICAgICAgICAgdC5jYXRlZ29yeSA9IGl0ZW1bcHJvZHVjdEtleV0uY2F0ZWdvcnk7XG4gICAgICAgICAgICB0LnJlYXNvbnMgPSBfLnVuaW9uKFtpdGVtLnJlYXNvbl0sIGl0ZW0ub3RoZXJSZWFzb25zKTtcbiAgICAgICAgICAgIGlmIChrZXkgPT0gJ3dpc2hsaXN0Jykge1xuICAgICAgICAgICAgICB0LnN1aXRlSWQgPSB0LnN1aXRlLmlkO1xuICAgICAgICAgICAgICB0Lmlzc3VlSWQgPSB0Lmlzc3VlLmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdC5mcm9tID0gW1BST0RVQ1RfRlJPTV9UWVBFLkZST01fUkVGRVJdO1xuICAgICAgICAgICAgaWYgKF8uY29udGFpbnMocHJvZHVjdElkc0luU2hlbGYsIHQucHJvZHVjdElkKSkge1xuICAgICAgICAgICAgICB0LmZyb20gPSBfLnVuaW9uKHQuZnJvbSwgW1BST0RVQ1RfRlJPTV9UWVBFLkZST01fU0hFTEZdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHQuZnJvbSA9IF8udW5pb24odC5mcm9tLCBbUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9ORVddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRlbXBMaXN0LnB1c2godCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGVtcFtrZXldID0gdGVtcExpc3Q7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGVtcDtcbiAgICAgIH07XG4gICAgICAvKuiOt+WPluWPguiAg+mhtemdouS/oeaBr1xuICAgICAgQFBhcmFtc1xuICAgICAgY29tcGFueUlkXG4gICAgICBzaGVsZklkICBcbiAgICAgICAqL1xuICAgICAgdGhpcy5xdWVyeURlbGl2ZXJ5UmVjb21tID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvcmVjb21tLycgKyBwYXJhbXMuY29tcGFueUlkICsgJy8nICtcbiAgICAgICAgICAgIHBhcmFtcy5zaGVsZklkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5qC55o2u5ZWG5ZOBaWRz6I635Y+W5ZWG5ZOB5pyA6L+RMTDmrKHmi6PotKflnYflgLxcbiAgICAgIEBQYXJhbXNcbiAgICAgIHByb2R1Y3RJZFxuICAgICAgICovXG4gICAgICB0aGlzLnF1ZXJ5TGF0ZXN0RGVsaXZlcnlDb3VudEF2Z3MgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvcmVjb21tL2xhdGVzdERlbGl2ZXJ5Q291bnRBdmdzJyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcy5wcm9kdWN0SWRzLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5Yib5bu65ouj6LSn5Y2VXG4gICAgICAgQFBhcmFtc1xuICAgICAgIHNoZWxmSWRcbiAgICAgICB1cmdlbnRcbiAgICAgICBpdGVtc3tcbiAgICAgICBwcmR1Y3RJZFxuICAgICAgIGl0ZW1OdW1cbiAgICAgICBpdGVtVHlwZVxuICAgICAgIHNoZWxmUHJvZHVjdElkXG4gICAgICAgfVxuICAgICAgICovXG4gICAgICB0aGlzLmNyZWF0ZURlbGl2ZXJ5T3JkZXIgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnknLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrkv67mlLnpgIHotKfljZVcbiAgICAgICBvcmRlcklkIEJcbiAgICAgICBtYW5hZ2VySWQgQlxuICAgICAgIG9yZGVyU3RhdGUgQlxuICAgICAgIHVyZ2VudCBCXG4gICAgICAgaXRlbXMgQlxuICAgICAgIGl0ZW1JZFxuICAgICAgIHByb2R1Y3RJZFxuICAgICAgIGl0ZW1OdW1cbiAgICAgICBkZWx0YURlc1xuICAgICAgIHNoZWxmUHJvZHVjdElkXG4gICAgICAgaXRlbVR5cGVcbiAgICAgICAqL1xuICAgICAgdGhpcy5tb2RpZnlEZWxpdmVyeU9yZGVyID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnknLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrmn6Xor6LpgIHotKfljZXliJfooahcbiAgICAgICAqb2Zmc2V0IFJcbiAgICAgICBsaW1pdCBSXG4gICAgICAgc3RhcnRUaW1lIEJcbiAgICAgICBlbmRUaW1lIEJcbiAgICAgICBjb21wYW55SWRcbiAgICAgICBzZXR0bGVtZW50SWRcbiAgICAgICBzaGVsZklkXG4gICAgICAgb3JkZXJTdGF0ZXMgQlxuICAgICAgICovXG4gICAgICB0aGlzLnF1ZXJ5RGVsaXZlcnlMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnkvZmluZExpc3QnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5p+l6K+i6YCB6LSn5Y2V5YiX6KGoXG4gICAgICAgKm9mZnNldCBSXG4gICAgICAgbGltaXQgUlxuICAgICAgIHN0YXJ0VGltZSBCXG4gICAgICAgZW5kVGltZSBCXG4gICAgICAgY29tcGFueUlkXG4gICAgICAgc2V0dGxlbWVudElkXG4gICAgICAgc2hlbGZJZFxuICAgICAgIG9yZGVyU3RhdGVzIEJcbiAgICAgICAqL1xuICAgICAgdGhpcy5xdWVyeVByb21vdGlvbkxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ2NvbXBhbnkvcHJvbW90aW9uL29yZGVyL3BhZ2UnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5p+l6K+i6YCB6LSn5Y2V6K+m57uG5L+h5oGv5YiX6KGoXG4gICAgICAgKkBQYXJhbXNcbiAgICAgICAqb3JkZXJJZHNcbiAgICAgICAqb3JkZXJTdGF0ZXNcbiAgICAgICAqL1xuXG4gICAgICB0aGlzLnF1ZXJ5RGVsaXZlcnlEZXRhaWxMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnkvZmluZERldGFpbExpc3QnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5L+u5pS56YCB6LSn5Y2V54q25oCBXG4gICAgICAgKm9yZGVySWQgUFxuICAgICAgICpvcmRlclN0YXRlIEJcbiAgICAgICAqb3B0UmVjb3JkIEJcbiAgICAgICAqL1xuICAgICAgdGhpcy5tb2RpZnlEZWxpdmVyeVN0YXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnkvJyArIHBhcmFtcy5vcmRlcklkICtcbiAgICAgICAgICAgICcvc3RhdGUnLFxuICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgb3JkZXJTdGF0ZTogcGFyYW1zLm9yZGVyU3RhdGUsXG4gICAgICAgICAgICBvcHRSZWNvcmQ6IHBhcmFtcy5vcHRSZWNvcmQsXG4gICAgICAgICAgICBjb21wYW55SWQ6IHBhcmFtcy5jb21wYW55SWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrmn6Xor6LpgIHotKfljZVcbiAgICAgICAqQFBhcmFtc1xuICAgICAgICpvcmRlcklkIFBcbiAgICAgICAqL1xuICAgICAgdGhpcy5xdWVyeURlbGl2ZXJ5RGV0YWlsID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvZGVsaXZlcnkvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5Yig6Zmk6YCB6LSn5Y2VXG4gICAgICAgKkBQYXJhbXNcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZGVsZXRlRGVsaXZlcnlPcmRlciA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuRGVsZXRlKHtcbiAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2RlbGl2ZXJ5LycgKyBwYXJhbXMub3JkZXJJZCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuWIhumhteafpeivoumAgei0p+WNleaooeadv1xuICAgICAgICovXG4gICAgICB0aGlzLnF1ZXJ5RGVsaXZlcnlUZW1wbGF0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2RlbGl2ZXJ5L3RlbXBsYXRlL2ZpbmRMaXN0JyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuafpeivouWNleaNruWIl+ihqCpcbiAgICAgICBAUGFyYW1zXG4gICAgICAgY29tcGFueU5hbWVcbiAgICAgICBvcmRlclR5cGVcbiAgICAgICBzdGFydERheVxuICAgICAgIGVuZERheVxuICAgICAgIHBhZ2VTaXplXG4gICAgICAgb2Zmc2V0XG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlPcmRlckxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdsb2dpc3RpY3Mvb3JkZXIvY2VudGVyJyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuafpeivouWNleaNruWIl+ihqCpcbiAgICAgICBAUGFyYW1zXG4gICAgICAgY29tcGFueU5hbWVcbiAgICAgICBvcmRlclR5cGVcbiAgICAgICBzdGFydERheVxuICAgICAgIGVuZERheVxuICAgICAgIHBhZ2VTaXplXG4gICAgICAgb2Zmc2V0XG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlUZWFMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6ICd0ZWEvb3JkZXInLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5p+l6K+i6YCA6LSn5Y2V6K+m5oOFXG4gICAgICAgQFBhcmFtc1xuICAgICAgIG9yZGVySWRcbiAgICAgICAqL1xuICAgICAgdGhpcy5xdWVyeVJlZnVuZERldGFpbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL3JldHVybi8nICsgcGFyYW1zLm9yZGVySWQsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrmn6Xor6Lnm5jngrnljZXor6bmg4VcbiAgICAgICBvcmRlcklkXG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlJbnZlbnRvcnlEZXRhaWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ2xvZ2lzdGljcy9vcmRlci9pbnZlbnRvcnkvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5p+l6K+i57uT566X5Y2V6K+m5oOFXG4gICAgICAgb3JkZXJJZFxuICAgICAgICovXG4gICAgICB0aGlzLnF1ZXJ5U2V0dGxlbWVudERldGFpbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL3NldHRsZW1lbnQvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSByZXM7XG4gICAgICAgICAgICBkYXRhLmNvbXBhbnlEaXNjb3VudCA9IHBhcnNlSW50KGRhdGEuY29tcGFueURpc2NvdW50KTtcbiAgICAgICAgICAgIGRhdGEuZGVsaXZlcnlGZWUgPSBwYXJzZUludChkYXRhLmRlbGl2ZXJ5RmVlKTtcbiAgICAgICAgICAgIGRhdGEuZnVsbEludm9pY2UgPSBwYXJzZUludChkYXRhLmZ1bGxJbnZvaWNlKTtcbiAgICAgICAgICAgIGRhdGEuaW52ZW50b3J5RmVlID0gcGFyc2VJbnQoZGF0YS5pbnZlbnRvcnlGZWUpO1xuICAgICAgICAgICAgZGF0YS5pc0ludm9pY2UgPSBwYXJzZUludChkYXRhLmlzSW52b2ljZSk7XG4gICAgICAgICAgICBkYXRhLm9yZGVyRGlzY291bnQgPSBwYXJzZUludChkYXRhLm9yZGVyRGlzY291bnQpO1xuICAgICAgICAgICAgZGF0YS5vcmRlckZlZSA9IHBhcnNlSW50KGRhdGEub3JkZXJGZWUpO1xuICAgICAgICAgICAgZGF0YS5wYWlkRmVlID0gcGFyc2VJbnQoZGF0YS5wYWlkRmVlKTtcbiAgICAgICAgICAgIGRhdGEucG9ja2V0TW9uZXlGZWUgPSBwYXJzZUludChkYXRhLnBvY2tldE1vbmV5RmVlKTtcbiAgICAgICAgICAgIGRhdGEucHJlSW52ZW50b3J5RmVlID0gcGFyc2VJbnQoZGF0YS5wcmVJbnZlbnRvcnlGZWUpO1xuICAgICAgICAgICAgZGF0YS5wcmVtaXVtRmVlID0gcGFyc2VJbnQoZGF0YS5wcmVtaXVtRmVlKTtcbiAgICAgICAgICAgIGRhdGEucmV0dXJuRmVlID0gcGFyc2VJbnQoZGF0YS5yZXR1cm5GZWUpO1xuICAgICAgICAgICAgZGF0YS50YXhGZWUgPSBwYXJzZUludChkYXRhLnRheEZlZSk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8vIOafpeivouS4i+WNiOiMtuiuouWNlVxuICAgICAgLy8gQFBhcmFtc1xuICAgICAgLy8gb3JkZXJJZHNcbiAgICAgIHRoaXMudGVhT3JkZXJEZXRhaWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ3RlYS9vcmRlci8nICsgcGFyYW1zLm9yZGVySWQsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrmibnph4/mm7TmlrDmi6PotKfljZXnirbmgIFcbiAgICAgICBAUGFyYW1zXG4gICAgICAgb3JkZXJJZHNcbiAgICAgICAqL1xuICAgICAgdGhpcy5iYXRjaFVwZGF0ZURlbGl2ZXJ5T3JkZXJTdGF0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2RlbGl2ZXJ5L2JhdGNoVXBkYXRlU3RhdGUnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5qC55o2u6YCB6LSn5Y2VaWTojrflj5bpgIHotKfljZXmqKHmnb9cbiAgICAgICAqb3JkZXJJZFxuICAgICAgICpzY29wZVxuICAgICAgICpzdWNjZXNzXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZ2V0Q29tcGlsZWREZWxpdmVyeU9yZGVyID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICB0aGlzLnF1ZXJ5RGVsaXZlcnlEZXRhaWwoeyAnb3JkZXJJZCc6IG9wdHMub3JkZXJJZCB9KS50aGVuKFxuICAgICAgICAgIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgdmFyIHNjb3BlID0gb3B0cy5zY29wZTtcbiAgICAgICAgICAgIHNjb3BlLmRlbGl2ZXJ5T3JkZXIgPSByZXM7XG4gICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLm5hbWUgPSAn6YCB6LSn5Y2VJyArICctJyArIHNjb3BlLmRlbGl2ZXJ5T3JkZXJcbiAgICAgICAgICAgICAgLmNvbXBhbnlOYW1lICsgJy0nICsgc2NvcGUuZGVsaXZlcnlPcmRlci5zaGVsZk5hbWUgK1xuICAgICAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoc2NvcGUuZGVsaXZlcnlPcmRlci5jcmVhdGVUaW1lLFxuICAgICAgICAgICAgICAgICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgc2NvcGUuZGVsaXZlcnlPcmRlci5wdXRTYWxlUHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgIHNjb3BlLmRlbGl2ZXJ5T3JkZXIuc3VwcGxlbWVudFByb2R1Y3RMaXN0ID0gW107XG4gICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5kZWxpdmVyeU9yZGVyLml0ZW1zLCBmdW5jdGlvbihpdGVtLFxuICAgICAgICAgICAgICBpKSB7XG4gICAgICAgICAgICAgIHN3aXRjaCAocGFyc2VJbnQoaXRlbS5pdGVtVHlwZSkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLnB1dFNhbGVQcm9kdWN0TGlzdC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBpdGVtKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgIHNjb3BlLmRlbGl2ZXJ5T3JkZXIuc3VwcGxlbWVudFByb2R1Y3RMaXN0LnB1c2goXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgc2NvcGUuZGVsaXZlcnlPcmRlci5wdWxsU2FsZVByb2R1Y3RMaXN0LnB1c2goXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHRlbXAgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+PC9kaXY+JykuYXBwZW5kKHNjb3BlLmNvbXBpbGVEZWxpdmVyeVRlbXBsYXRlKFxuICAgICAgICAgICAgICBzY29wZSkpO1xuICAgICAgICAgICAgb3B0cy5zdWNjZXNzICYmIG9wdHMuc3VjY2Vzcy5jYWxsKHRoaXMsIHRlbXApO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIC8q5om56YeP5omT5Y2w5Y2VXG4gICAgICAgKnNldHRsZW1lbnRPcmRlcklkc1xuICAgICAgICppbnZlbnRvcnlPcmRlcklkc1xuICAgICAgICpkZWxpdmVyeU9yZGVySWRzXG4gICAgICAgKnJldHVybk9yZGVySWRzXG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlPcmRlckRldGFpbHMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ2xvZ2lzdGljcy9vcmRlci9pbnZlbnRvcnkvYmF0Y2hQcmludCcsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuS4i+WNiOiMtuaJuemHj+aJk+WNsOWNlVxuICAgICAgICpzZXR0bGVtZW50T3JkZXJJZHNcbiAgICAgICAqaW52ZW50b3J5T3JkZXJJZHNcbiAgICAgICAqZGVsaXZlcnlPcmRlcklkc1xuICAgICAgICpyZXR1cm5PcmRlcklkc1xuICAgICAgICovXG4gICAgICB0aGlzLnRlYU9yZGVyRGV0YWlscyA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgICAgcGF0aDogJ3RlYS9vcmRlci9maW5kQnlJZHMnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrkuIvljYjojLbmiZPljbDmqKHmnb/njq/looPmlbDmja5cbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMudGVhT3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS50ZWFEZXRhaWwgPSBkYXRhO1xuICAgICAgICBzY29wZS50ZWFEZXRhaWwubmFtZSA9ICfkuIvljYjojLborqLljZXor6bmg4UnICsgJy0nICtcbiAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoc2NvcGUudGVhRGV0YWlsLm9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAneXl5eU1NZGRoaG1tJykgKyAnKSc7XG4gICAgICAgIHNjb3BlLm9yZGVyVGl0bGUgPSBzY29wZS50ZWFEZXRhaWwubmFtZTtcbiAgICAgICAgcmV0dXJuIHNjb3BlO1xuICAgICAgfTtcbiAgICAgIC8qXG4gICAgICAgKiDoioLlgYfml6XmiZPljbDmqKHmnb/njq/looPmlbDmja5cbiAgICAgICAqL1xuICAgICAgdGhpcy5ob2xpZGF5T3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS5ob2xpZGF5RGV0YWlsID0gZGF0YTtcbiAgICAgICAgc2NvcGUuaG9saWRheURldGFpbC5uYW1lID0gJ+iKguWBh+aXpeiuouWNleivpuaDhScgKyAnLScgK1xuICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5ob2xpZGF5RGV0YWlsLm9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAneXl5eU1NZGRoaG1tJykgKyAnKSc7XG4gICAgICAgIHNjb3BlLm9yZGVyVGl0bGUgPSBzY29wZS5ob2xpZGF5RGV0YWlsLm5hbWU7XG4gICAgICAgIHJldHVybiBzY29wZTtcbiAgICAgIH07XG4gICAgICAvKuaJk+WNsOaooeadv+eOr+Wig+aVsOaNrlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgdGhpcy5wYXJzZVByaW50T3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuT1JERVJfU1RBVFVTID0gQ09OU1RBTlRTLk9SREVSX1NUQVRVUztcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS5CVVlfVFlQRSA9IENPTlNUQU5UUy5CVVlfVFlQRTtcbiAgICAgICAgc2NvcGUuSVNTVUVfQUNUSVZFID0gQ09OU1RBTlRTLklTU1VFX0FDVElWRTtcbiAgICAgICAgc2NvcGUuREVMSVZFUllfU1RBVEUgPSBDT05TVEFOVFMuREVMSVZFUllfU1RBVEU7XG5cbiAgICAgICAgc3dpdGNoIChvcmRlclR5cGUpIHtcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6XG4gICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyID0gZGF0YTtcbiAgICAgICAgICAgIHNjb3BlLmRlbGl2ZXJ5T3JkZXIubmFtZSA9ICfpgIHotKfljZUnICsgJy0nICsgc2NvcGUuZGVsaXZlcnlPcmRlclxuICAgICAgICAgICAgICAuY29tcGFueU5hbWUgK1xuICAgICAgICAgICAgICAnLScgKyBzY29wZS5kZWxpdmVyeU9yZGVyLnNoZWxmTmFtZSArXG4gICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5kZWxpdmVyeU9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICBzY29wZS5vcmRlclRpdGxlID0gc2NvcGUuZGVsaXZlcnlPcmRlci5uYW1lO1xuICAgICAgICAgICAgc2NvcGUuZGVsaXZlcnlPcmRlci5wdXRTYWxlUHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgIHNjb3BlLmRlbGl2ZXJ5T3JkZXIuc3VwcGxlbWVudFByb2R1Y3RMaXN0ID0gW107XG4gICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5kZWxpdmVyeU9yZGVyLml0ZW1zLCBmdW5jdGlvbihpdGVtLCBpKSB7XG4gICAgICAgICAgICAgIHN3aXRjaCAocGFyc2VJbnQoaXRlbS5pdGVtVHlwZSkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLnB1dFNhbGVQcm9kdWN0TGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgc2NvcGUuZGVsaXZlcnlPcmRlci5zdXBwbGVtZW50UHJvZHVjdExpc3QucHVzaChcbiAgICAgICAgICAgICAgICAgICAgaXRlbSk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICBzY29wZS5kZWxpdmVyeU9yZGVyLnB1bGxTYWxlUHJvZHVjdExpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5SRUZVTkQ6XG4gICAgICAgICAgICBzY29wZS5yZWZ1bmRPcmRlciA9IGRhdGE7XG4gICAgICAgICAgICBzY29wZS5yZWZ1bmRPcmRlci5uYW1lID0gJ+mAgOi0p+WNlScgKyAnLScgKyBzY29wZS5yZWZ1bmRPcmRlci5jb21wYW55TmFtZSArXG4gICAgICAgICAgICAgICctJyArIHNjb3BlLnJlZnVuZE9yZGVyLnNoZWxmTmFtZSArXG4gICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5yZWZ1bmRPcmRlci5jcmVhdGVUaW1lLFxuICAgICAgICAgICAgICAgICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgc2NvcGUub3JkZXJUaXRsZSA9IHNjb3BlLnJlZnVuZE9yZGVyLm5hbWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSU5WRU5UT1JZOlxuICAgICAgICAgICAgc2NvcGUuaW52ZW50b3J5T3JkZXIgPSBkYXRhO1xuICAgICAgICAgICAgc2NvcGUuaW52ZW50b3J5T3JkZXIubmFtZSA9ICfnm5jngrnljZUnICsgJy0nICsgc2NvcGUuaW52ZW50b3J5T3JkZXJcbiAgICAgICAgICAgICAgLmNvbXBhbnlOYW1lICtcbiAgICAgICAgICAgICAgJy0nICsgc2NvcGUuaW52ZW50b3J5T3JkZXIuc2hlbGZOYW1lICtcbiAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKHNjb3BlLmludmVudG9yeU9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICBzY29wZS5vcmRlclRpdGxlID0gc2NvcGUuaW52ZW50b3J5T3JkZXIubmFtZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5TRVRUTEVNRU5UOlxuICAgICAgICAgICAgc2NvcGUuc2V0dGxlbWVudE9yZGVyID0gbWUuX3BhcnNlU2V0dGxlbWVudERldGFpbERhdGEoZGF0YSk7XG4gICAgICAgICAgICBzY29wZS5zZXR0bGVtZW50T3JkZXIubmFtZSA9ICfnu5PnrpfljZUnICsgJy0nICsgc2NvcGUuc2V0dGxlbWVudE9yZGVyXG4gICAgICAgICAgICAgIC5jb21wYW55TmFtZSArXG4gICAgICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5zZXR0bGVtZW50T3JkZXIuY3JlYXRlVGltZSxcbiAgICAgICAgICAgICAgICAneXl5eU1NZGRoaG1tc3MnKSArICcpJztcbiAgICAgICAgICAgIHNjb3BlLm9yZGVyVGl0bGUgPSBzY29wZS5zZXR0bGVtZW50T3JkZXIubmFtZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5IT0xJREFZOlxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBzY29wZS5vcmRlciA9IGRhdGE7XG4gICAgICAgICAgICAvLyBzY29wZS5zZXR0bGVtZW50T3JkZXIgPSBtZS5fcGFyc2VTZXR0bGVtZW50RGV0YWlsRGF0YShkYXRhKTtcbiAgICAgICAgICAgIC8vIHNjb3BlLnNldHRsZW1lbnRPcmRlci5uYW1lID0gJ+e7k+eul+WNlScgKyAnLScgKyBzY29wZS5zZXR0bGVtZW50T3JkZXIuY29tcGFueU5hbWUgK1xuICAgICAgICAgICAgLy8gICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5zZXR0bGVtZW50T3JkZXIuY3JlYXRlVGltZSwgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICAvLyBzY29wZS5vcmRlclRpdGxlID0gc2NvcGUuc2V0dGxlbWVudE9yZGVyLm5hbWU7XG4gICAgICAgICAgICAvLyBzY29wZS5zZXRIb2xpZGF5T3JkZXIgPSBkYXRhO1xuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSVNTVUVEWU5BTUlDOlxuICAgICAgICAgICAgLypjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHNjb3BlLmlzc3VlT3JkZXIgPSBkYXRhOyovXG4gICAgICAgICAgICBzY29wZS5pc3N1ZURldGFpbCA9IGRhdGE7XG4gICAgICAgICAgICBzY29wZS5pc3N1ZURldGFpbC5uYW1lID0gJ+acn+WPtycgKyAnLScgKyBzY29wZS5pc3N1ZURldGFpbC5jb21wYW55TmFtZSArXG4gICAgICAgICAgICAgICctJyArIHNjb3BlLmlzc3VlRGV0YWlsLmlkICtcbiAgICAgICAgICAgICAgJygnICsgdXRpbFNlcnZpY2UucGFyc2VUaW1lQnlMb25nKHNjb3BlLmlzc3VlRGV0YWlsLmlzc3VlU3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgICd5eXl5TU1kZGhobW1zcycpICsgJyknO1xuICAgICAgICAgICAgc2NvcGUub3JkZXJUaXRsZSA9IHNjb3BlLmlzc3VlRGV0YWlsLm5hbWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuU1VJVEVEWU5BTUlDOlxuICAgICAgICAgICAgLypjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHNjb3BlLnN1aXRlT3JkZXIgPSBkYXRhO1xuICAgICAgICAgICAgYnJlYWs7Ki9cblxuICAgICAgICAgICAgc2NvcGUuc09yZGVyID0gc3VpdGVTZXJ2aWNlLnBhcnNlU3VpdGVEYXRhKGRhdGEpO1xuXG4gICAgICAgICAgICBzY29wZS5zT3JkZXIubmFtZSA9ICflpZfppJAnICsgJy0nICsgc2NvcGUuc09yZGVyLmNvbXBhbnlOYW1lICtcbiAgICAgICAgICAgICAgJy0nICsgc2NvcGUuc09yZGVyLnN1aXRlSWQgK1xuICAgICAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoc2NvcGUuc09yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgJ3l5eXlNTWRkaGhtbXNzJykgKyAnKSc7XG4gICAgICAgICAgICBzY29wZS5vcmRlclRpdGxlID0gc2NvcGUuc09yZGVyLm5hbWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgICB9O1xuICAgICAgLyrokKXplIDorqLljZXljbDmqKHmnb/njq/looPmlbDmja5cbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMucHJvbW90aW9uT3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS5QUk9NT1RJT05fT1JERVJfU1RBVFVTID0gQ09OU1RBTlRTLlBST01PVElPTl9PUkRFUl9TVEFUVVM7XG4gICAgICAgIHNjb3BlLnByb21vdGlvbkRldGFpbCA9IGRhdGE7XG4gICAgICAgIHNjb3BlLnByb21vdGlvbkRldGFpbC5vcmRlci5kZWxpdmVyeVRpbWUgPSBzY29wZS5wcm9tb3Rpb25EZXRhaWxcbiAgICAgICAgICAub3JkZXIuZGVsaXZlcnlUaW1lID9cbiAgICAgICAgICBuZXcgRGF0ZShwYXJzZUludChzY29wZS5wcm9tb3Rpb25EZXRhaWwub3JkZXIuZGVsaXZlcnlUaW1lKSkgOlxuICAgICAgICAgIHNjb3BlLnByb21vdGlvbkRldGFpbFxuICAgICAgICAgIC5vcmRlci5kZWxpdmVyeVRpbWUgPSBzY29wZS5wcm9tb3Rpb25EZXRhaWwub3JkZXIuZGVsaXZlcnlUaW1lO1xuXG4gICAgICAgIGlmIChzY29wZS5wcm9tb3Rpb25EZXRhaWwub3JkZXIuYWN0dWFsUHJpY2UpIHtcbiAgICAgICAgICBzY29wZS5wcm9tb3Rpb25EZXRhaWwub3JkZXIuYWN0dWFsUHJpY2UgPSBwYXJzZUZsb2F0KHNjb3BlLnByb21vdGlvbkRldGFpbFxuICAgICAgICAgICAgLm9yZGVyLmFjdHVhbFByaWNlIC8gMTAwLCAyKTtcbiAgICAgICAgfVxuICAgICAgICBzY29wZS5wcm9tb3Rpb25EZXRhaWwubmFtZSA9ICfokKXplIDorqLljZXor6bmg4UnICsgJy0nICtcbiAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoc2NvcGUucHJvbW90aW9uRGV0YWlsLm9yZGVyXG4gICAgICAgICAgICAuY3JlYXRlVGltZSxcbiAgICAgICAgICAgICd5eXl5TU1kZGhobW0nKSArICcpJztcbiAgICAgICAgc2NvcGUub3JkZXJUaXRsZSA9IHNjb3BlLnByb21vdGlvbkRldGFpbC5uYW1lO1xuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgICB9O1xuICAgICAgLyrojrflj5bljZXmja7or6bmg4VcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlPcmRlckRldGFpbCA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgb3JkZXJJZCwgc2NvcGUpIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgdmFyIHByb21pc2U7XG4gICAgICAgIHN3aXRjaCAob3JkZXJUeXBlKSB7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLkRFTElWRVJZOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnF1ZXJ5RGVsaXZlcnlEZXRhaWwoe1xuICAgICAgICAgICAgICBvcmRlcklkOiBvcmRlcklkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICBzY29wZSA9IG1lLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgcmVzLCBzY29wZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5SRUZVTkQ6XG4gICAgICAgICAgICBwcm9taXNlID0gbWUucXVlcnlSZWZ1bmREZXRhaWwoe1xuICAgICAgICAgICAgICBvcmRlcklkOiBvcmRlcklkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICBzY29wZSA9IG1lLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgcmVzLCBzY29wZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JTlZFTlRPUlk6XG4gICAgICAgICAgICBwcm9taXNlID0gbWUucXVlcnlJbnZlbnRvcnlEZXRhaWwoe1xuICAgICAgICAgICAgICBvcmRlcklkOiBvcmRlcklkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICBzY29wZSA9IG1lLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgcmVzLCBzY29wZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5TRVRUTEVNRU5UOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnF1ZXJ5U2V0dGxlbWVudERldGFpbCh7XG4gICAgICAgICAgICAgIG9yZGVySWQ6IG9yZGVySWRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgIHNjb3BlID0gbWUucGFyc2VQcmludE9yZGVyU2NvcGUob3JkZXJUeXBlLCByZXMsIHNjb3BlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlRFQU9SREVSOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnRlYU9yZGVyRGV0YWlsKHtcbiAgICAgICAgICAgICAgb3JkZXJJZDogb3JkZXJJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgc2NvcGUgPSBtZS50ZWFPcmRlclNjb3BlKG9yZGVyVHlwZSwgcmVzLCBzY29wZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuUFJPTU9USU9OOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnF1ZXJ5UHJvbW90aW9uTGlzdCh7XG4gICAgICAgICAgICAgIGlkczogb3JkZXJJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgcmVzID0gcmVzLmNvbnRlbnRbMF07XG4gICAgICAgICAgICAgIHNjb3BlID0gbWUucHJvbW90aW9uT3JkZXJTY29wZShvcmRlclR5cGUsIHJlcywgc2NvcGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSVNTVUVEWU5BTUlDOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnF1ZXJ5UHJvbW90aW9uTGlzdCh7XG4gICAgICAgICAgICAgIGlkczogb3JkZXJJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgcmVzID0gcmVzLmNvbnRlbnRbMF07XG4gICAgICAgICAgICAgIHNjb3BlID0gbWUucHJvbW90aW9uT3JkZXJTY29wZShvcmRlclR5cGUsIHJlcywgc2NvcGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuU1VJVEVEWU5BTUlDOlxuICAgICAgICAgICAgcHJvbWlzZSA9IG1lLnF1ZXJ5UHJvbW90aW9uTGlzdCh7XG4gICAgICAgICAgICAgIGlkczogb3JkZXJJZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgcmVzID0gcmVzLmNvbnRlbnRbMF07XG4gICAgICAgICAgICAgIHNjb3BlID0gbWUucHJvbW90aW9uT3JkZXJTY29wZShvcmRlclR5cGUsIHJlcywgc2NvcGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuafpeeci+WNleaNruivpuaDhVxuICAgICAgICpQUzrosIPnlKjmlLnmlrnms5Xlv4Xpobvkv53or4Fyb2905Lit5pyJb3JkZXLmoLflvI9cbiAgICAgICAqL1xuICAgICAgdGhpcy5jaGVja09yZGVyRGV0YWlsID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBvcmRlcklkLCBzY29wZSxcbiAgICAgICAgaXNVcGRhdGUsXG4gICAgICAgIGNvbXBhbnlOYW1lKSB7IC8vVFlQRT01IOS4uuS4i+WNiOiMtuiuouWNlVxuICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSBtZS5nZXRUZW1wbGF0ZVBhdGgob3JkZXJUeXBlKTtcbiAgICAgICAgdmFyIHZhcmkgPSAnJztcbiAgICAgICAgc3dpdGNoIChvcmRlclR5cGUpIHtcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6IC8v6YCB6LSnXG4gICAgICAgICAgICB2YXJpID0gJ2RlbGl2ZXJ5T3JkZXJNb2RhbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuUkVGVU5EOiAvL+mAgOi0p1xuICAgICAgICAgICAgdmFyaSA9ICdyZWZ1bmRPcmRlck1vZGFsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JTlZFTlRPUlk6IC8v55uY54K5XG4gICAgICAgICAgICB2YXJpID0gJ2ludmVudG9yeU9yZGVyTW9kYWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlNFVFRMRU1FTlQ6IC8v57uT566XXG4gICAgICAgICAgICB2YXJpID0gJ3NldHRsZW1lbnRPcmRlck1vZGFsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5URUFPUkRFUjogLy/kuIvljYjojLZcbiAgICAgICAgICAgIHZhcmkgPSAndGVhT3JkZXJNb2RhbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSE9MSURBWTogLy/oioLlgYfml6VcbiAgICAgICAgICAgIHZhcmkgPSAnaG9saWRheU1vZGFsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5QUk9NT1RJT046IC8v6JCl6ZSA6LSm5Y2VXG4gICAgICAgICAgICB2YXJpID0gJ3Byb21vdGlvbic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSVNTVUVEWU5BTUlDOiAvL+acn+WPt1xuICAgICAgICAgICAgdmFyaSA9ICdpc3N1ZU1vZGFsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5TVUlURURZTkFNSUM6IC8v5aWX6aSQXG4gICAgICAgICAgICB2YXJpID0gJ3N1aXRlTW9kYWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lLnF1ZXJ5T3JkZXJEZXRhaWwob3JkZXJUeXBlLCBvcmRlcklkLCBzY29wZSkudGhlbihcbiAgICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNjb3BlLmV4cG9ydEV4Y2VsT25EZXRhaWwgPSBtZS5leHBvcnRFeGNlbE9uRGV0YWlsO1xuICAgICAgICAgICAgaWYgKGNvbXBhbnlOYW1lKSB7XG4gICAgICAgICAgICAgIHNjb3BlLnRlYURldGFpbC5vcmRlci5jb21wYW55TmFtZSA9IGNvbXBhbnlOYW1lO1xuICAgICAgICAgICAgICBzY29wZS5hZGRUZWFUeXBlKHNjb3BlLnRlYURldGFpbC5vcmRlcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNVcGRhdGUpIHtcbiAgICAgICAgICAgICAgc2NvcGVbdmFyaV0gPSBtb2RhbFNlcnZpY2UuaW5pdE1vZGFsKHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUbzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAgICAgICAnb3JkZXItY2VudGVyJykpLFxuICAgICAgICAgICAgICAgIHNjb3BlOiBzY29wZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogdGVtcGxhdGVVcmxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICAvKuiOt+WPluaooeadv+WcsOWdgFxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgLy8gdGhpcy5rZXlyZW1hcms9ZnVuY3Rpb24oZSxyZW1hcmssaWQpe1xuICAgICAgLy8gICAgdmFyIHByb21pc2U7XG4gICAgICAvLyAgICBtZT10aGlzO1xuICAgICAgLy8gICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHsgLy/lm57ovabplK5cbiAgICAgIC8vICAgICAgICAgIG1lLm1vZGlmeVJlbWFyayh7XG4gICAgICAvLyAgICAgICAgICAgICAgICBvcmRlcklkOiBpZCxcbiAgICAgIC8vICAgICAgICAgICAgICAgIHJlbWFyazpyZW1hcmtcbiAgICAgIC8vICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcblxuICAgICAgLy8gICAgICAgICAgICB9KTsgICAgXG4gICAgICAvLyAgICAgICAgICAgIH1cblxuICAgICAgLyrkuIvljYjojLbmiZPljbDmqKHmnb/njq/looPmlbDmja5cbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMudGVhT3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS50ZWFEZXRhaWwgPSBkYXRhO1xuICAgICAgICBzY29wZS50ZWFEZXRhaWwubmFtZSA9ICfkuIvljYjojLborqLljZXor6bmg4UnICsgJy0nICtcbiAgICAgICAgICAnKCcgKyB1dGlsU2VydmljZS5wYXJzZVRpbWVCeUxvbmcoc2NvcGUudGVhRGV0YWlsLm9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAneXl5eU1NZGRoaG1tJykgKyAnKSc7XG4gICAgICAgIHNjb3BlLm9yZGVyVGl0bGUgPSBzY29wZS50ZWFEZXRhaWwubmFtZTtcbiAgICAgICAgcmV0dXJuIHNjb3BlO1xuICAgICAgfTtcbiAgICAgIC8qXG4gICAgICAgKiDoioLlgYfml6XmiZPljbDmqKHmnb/njq/looPmlbDmja5cbiAgICAgICAqL1xuICAgICAgdGhpcy5ob2xpZGF5T3JkZXJTY29wZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgZGF0YSwgc2NvcGUpIHtcbiAgICAgICAgc2NvcGUudXRpbFNlcnZpY2UgPSB1dGlsU2VydmljZTtcbiAgICAgICAgc2NvcGUuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuICAgICAgICBzY29wZS5PUkRFUl9UWVBFID0gQ09OU1RBTlRTLk9SREVSX1RZUEU7XG4gICAgICAgIHNjb3BlLkRFTElWRVJZX1VSR0VOQ1kgPSBDT05TVEFOVFMuREVMSVZFUllfVVJHRU5DWTtcbiAgICAgICAgc2NvcGUuQ09NUEFOWV9UWVBFID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRTtcbiAgICAgICAgc2NvcGUuU0VUVExFTUVOVF9TVEFURSA9IENPTlNUQU5UUy5TRVRUTEVNRU5UX1NUQVRFO1xuICAgICAgICBzY29wZS5ob2xpZGF5RGV0YWlsID0gZGF0YTtcbiAgICAgICAgc2NvcGUuaG9saWRheURldGFpbC5uYW1lID0gJ+iKguWBh+aXpeiuouWNleivpuaDhScgKyAnLScgK1xuICAgICAgICAgICcoJyArIHV0aWxTZXJ2aWNlLnBhcnNlVGltZUJ5TG9uZyhzY29wZS5ob2xpZGF5RGV0YWlsLm9yZGVyLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAneXl5eU1NZGRoaG1tJykgKyAnKSc7XG4gICAgICAgIHNjb3BlLm9yZGVyVGl0bGUgPSBzY29wZS5ob2xpZGF5RGV0YWlsLm5hbWU7XG4gICAgICAgIHJldHVybiBzY29wZTtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMubW9kaWZ5UmVtYXJrID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6ICd0ZWEvb3JkZXIvcmVtYXJrJyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8vIOWPlua2iOS4i+WNiOiMtlxuICAgICAgdGhpcy5jYW5jZWxUZWEgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgcGF0aDogJ3RlYS9vcmRlci9jYW5jZWwnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLy8g56Gu6K6k5o6l5pS25LiL5Y2I6Iy2XG4gICAgICB0aGlzLmFjY2VwdFRlYSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiAndGVhL29yZGVyL2FjY2VwdCcsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICB0aGlzLmdldFRlbXBsYXRlUGF0aCA9IGZ1bmN0aW9uKG9yZGVyVHlwZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhvcmRlclR5cGUpXG4gICAgICAgIHN3aXRjaCAob3JkZXJUeXBlKSB7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLkRFTElWRVJZOlxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlVXJsID0gJ29yZGVyL2RlbGl2ZXJ5T3JkZXJUZW1wbGF0ZS5odG1sJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5SRUZVTkQ6XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSAnb3JkZXIvcmVmdW5kT3JkZXJUZW1wbGF0ZS5odG1sJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JTlZFTlRPUlk6XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSAnb3JkZXIvaW52ZW50b3J5T3JkZXJUZW1wbGF0ZS5odG1sJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5TRVRUTEVNRU5UOlxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlVXJsID0gJ29yZGVyL3NldHRsZW1lbnRPcmRlclRlbXBsYXRlLmh0bWwnO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSE9MSURBWTpcbiAgICAgICAgICAgIC8vIGFsZXJ0KFwiYWFhXCIpXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPVxuICAgICAgICAgICAgICAnb3JkZXIvaG9saWRheVdlbGZhcmVQYXJ0aWN1bGFyc1RlbXBsYXRlLmh0bWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlRFQU9SREVSOlxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlVXJsID0gJ29yZGVyL3RlYU9yZGVyVGVtcGxhdGUuaHRtbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuUFJPTU9USU9OOlxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlVXJsID0gJ29yZGVyL3Byb21vdGlvbk9yZGVyVGVtcGxhdGUuaHRtbCc7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JU1NVRURZTkFNSUM6XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSAnc3VpdGUvaXNzdWVEeW5hbWljVGVtcGxhdGUuaHRtbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuU1VJVEVEWU5BTUlDOlxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlVXJsID1cbiAgICAgICAgICAgICAgJ3N1aXRlL3N1aXRlRGlzdHJpYnV0aW9uRHluYW1pY1RlbXBsYXRlLmh0bWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlVXJsO1xuICAgICAgfTtcbiAgICAgIC8q6I635Y+W5qih5p2/6IqC54K5XG4gICAgICAgKlxuICAgICAgICovXG4gICAgICB0aGlzLmdldFRlbXBsYXRlRG9tQnlUeXBlID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBzY29wZSkge1xuICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICBjb25zb2xlLmxvZyhzY29wZSk7XG4gICAgICAgIHJldHVybiAkY29tcGlsZSgkdGVtcGxhdGVDYWNoZS5nZXQobWUuZ2V0VGVtcGxhdGVQYXRoKG9yZGVyVHlwZSkpKVxuICAgICAgICAgIChzY29wZSk7XG4gICAgICB9O1xuICAgICAgLypcbiAgICAgICAqICovXG4gICAgICB0aGlzLnByaW50T3JkZXJEb21zID0gZnVuY3Rpb24ob3JkZXJEZXRhaWxzLCBvcmRlclR5cGUsIHNjb3BlKSB7XG4gICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgIHZhciBkb21zID0gW107XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcmRlckRldGFpbHMsIGZ1bmN0aW9uKGRldGFpbCkge1xuICAgICAgICAgIHZhciBuZXdzY29wZSA9IG1lLnBhcnNlUHJpbnRPcmRlclNjb3BlKG9yZGVyVHlwZSwgZGV0YWlsLFxuICAgICAgICAgICAgc2NvcGUuJG5ldyh0cnVlKSk7XG4gICAgICAgICAgbmV3c2NvcGUuaXNQcmludCA9IHRydWU7XG4gICAgICAgICAgY29uc29sZS5sb2cobmV3c2NvcGUpO1xuICAgICAgICAgIGRvbXMucHVzaChhbmd1bGFyLmVsZW1lbnQoJzxkaXY+PC9kaXY+JykuYXBwZW5kKG1lLmdldFRlbXBsYXRlRG9tQnlUeXBlKFxuICAgICAgICAgICAgb3JkZXJUeXBlLCBuZXdzY29wZSkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkb21zO1xuICAgICAgfTtcblxuICAgICAgLyrojrflj5bljZXmja7or6bmg4Vtb2R1bGXnmoRJRFxuICAgICAgICovXG4gICAgICB0aGlzLmdldENvbnRhaW50ZXJJZCA9IGZ1bmN0aW9uKG9yZGVyVHlwZSkge1xuICAgICAgICB2YXIgY29udGFpbmVySWQgPSAnJztcbiAgICAgICAgc3dpdGNoIChvcmRlclR5cGUpIHtcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuREVMSVZFUlk6XG4gICAgICAgICAgICBjb250YWluZXJJZCA9ICdkZWxpdmVyeS1vcmRlci10YWJsZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuUkVGVU5EOlxuICAgICAgICAgICAgY29udGFpbmVySWQgPSAncmVmdW5kLW9yZGVyLXRhYmxlJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5JTlZFTlRPUlk6XG4gICAgICAgICAgICBjb250YWluZXJJZCA9ICdpbnZlbnRvcnktb3JkZXItdGFibGUnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlNFVFRMRU1FTlQ6XG4gICAgICAgICAgICBjb250YWluZXJJZCA9ICdzZXR0bGVtZW50LW9yZGVyLXRhYmxlJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgT1JERVJfVFlQRS5IT0xJREFZOlxuICAgICAgICAgICAgY29udGFpbmVySWQgPSAnaG9saWRheS13ZWxmYXJlLW9yZGVyLWRldGFpbC10YWJsZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuVEVBT1JERVI6XG4gICAgICAgICAgICBjb250YWluZXJJZCA9ICd0ZWEtb3JkZXItdGFibGUnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBPUkRFUl9UWVBFLlBST01PVElPTjpcbiAgICAgICAgICAgIGNvbnRhaW5lcklkID0gJ3Byb21vdGlvbi1vcmRlci10YWJsZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuSVNTVUVEWU5BTUlDOlxuICAgICAgICAgICAgY29udGFpbmVySWQgPSAnaXNzdWUtZHluYW1pYy10ZW1wbGF0ZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIE9SREVSX1RZUEUuU1VJVEVEWU5BTUlDOlxuICAgICAgICAgICAgY29udGFpbmVySWQgPSAnc3VpdGUtZHluYW1pYy10YWJsZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFpbmVySWQ7XG4gICAgICB9O1xuICAgICAgdGhpcy5mb3JtRXhjZWwgPSBmdW5jdGlvbihjb250YWluZXJJZCwgdGl0bGUpIHtcbiAgICAgICAgdmFyIGRvbSA9IGFuZ3VsYXIuZWxlbWVudCgnPGE+PC9hPicpO1xuICAgICAgICBkb21bMF0uaHJlZiA9ICQoJyMnICsgY29udGFpbmVySWQpLmV4Y2VsZXhwb3J0anMoe1xuICAgICAgICAgIGNvbnRhaW5lcmlkOiBjb250YWluZXJJZCxcbiAgICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgICByZXR1cm5Vcmk6ICd0cnVlJ1xuICAgICAgICB9KTtcbiAgICAgICAgZG9tWzBdLmRvd25sb2FkID0gdGl0bGUgKyAnLnhscyc7XG4gICAgICAgIGRvbVswXS5jbGljaygpO1xuICAgICAgfTtcbiAgICAgIC8q5LuO6KGo5qC85a+85Ye6ZXhjZWxcbiAgICAgICAqIFBTOuiwg+eUqOaUueaWueazleW/hemhu+S/neivgeacieaooeadv+S4reaciTxkaXYgaWQ9XCJleHBvcnRFeGNlbFdyYXBcIiBjbGFzcz1cImhpZGRlblwiPjwvZGl2PuWFg+e0oFxuICAgICAgICovXG4gICAgICB0aGlzLmV4cG9ydEV4Y2VsID0gZnVuY3Rpb24ob3JkZXJUeXBlLCBvcmRlcklkLCBzY29wZSkge1xuICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICB2YXIgY29udGFpbmVySWQgPSBtZS5nZXRDb250YWludGVySWQob3JkZXJUeXBlKTtcbiAgICAgICAgaWYgKG9yZGVySWQpIHtcbiAgICAgICAgICB2YXIgZXhjZWxUZW1wbGF0ZSA9IG1lLmdldFRlbXBsYXRlRG9tQnlUeXBlKG9yZGVyVHlwZSwgc2NvcGUpO1xuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0RXhjZWxXcmFwJykpLmFwcGVuZChcbiAgICAgICAgICAgIGV4Y2VsVGVtcGxhdGUpO1xuICAgICAgICAgIG1lLnF1ZXJ5T3JkZXJEZXRhaWwob3JkZXJUeXBlLCBvcmRlcklkLCBzY29wZSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNjb3BlLiRhcHBseUFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB2YXIgZG9tID0gYW5ndWxhci5lbGVtZW50KCc8YT48L2E+Jyk7XG4gICAgICAgICAgICAgIGRvbVswXS5ocmVmID0gJCgnIycgKyBjb250YWluZXJJZCkuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyaWQ6IGNvbnRhaW5lcklkLFxuICAgICAgICAgICAgICAgIGRhdGF0eXBlOiAndGFibGUnLFxuICAgICAgICAgICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBkb21bMF0uZG93bmxvYWQgPSBzY29wZS5vcmRlclRpdGxlICsgJy54bHMnO1xuICAgICAgICAgICAgICBkb21bMF0uY2xpY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjb3BlLnVyaSA9ICQoXCIjXCIgKyBjb250YWluZXJJZCkuZXhjZWxleHBvcnRqcyh7XG4gICAgICAgICAgICBjb250YWluZXJpZDogY29udGFpbmVySWQsXG4gICAgICAgICAgICBkYXRhdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgICAgIHJldHVyblVyaTogJ3RydWUnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICAvKuS7jm1vZGVs5Lit5a+85Ye6ZXhjZWxcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZXhwb3J0RXhjZWxPbkRldGFpbCA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgc2NvcGUpIHtcbiAgICAgICAgbWUuZXhwb3J0RXhjZWwob3JkZXJUeXBlLCAnJywgc2NvcGUpO1xuICAgICAgfTtcbiAgICAgIC8q5LuObW9kZWzkuK3miZPljbBcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZ2V0UHJpbnRIdG1sSW5PcmRlck1vZHVsZSA9IGZ1bmN0aW9uKG9yZGVyVHlwZSwgc2NvcGUpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lcklkID0gdGhpcy5nZXRDb250YWludGVySWQob3JkZXJUeXBlKTtcbiAgICAgICAgcmV0dXJuICQoXCIjXCIgKyBjb250YWluZXJJZCkuaHRtbCgpO1xuICAgICAgfTtcbiAgICB9XG4gIF0pO1xufSIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ3Bvc2l0aW9uU2VydmljZScsIFsneGhyU2VydmljZScsICckcScsIGZ1bmN0aW9uKHhoclNlcnZpY2UsICRxKSB7XG4gICAgICAgIC8q5paw5aKe5LuT5L2NXG4gICAgICAgIEBQYXJhbXNcbiAgICAgICAgcm93XG4gICAgICAgIGxheWVyXG4gICAgICAgIGxvY2F0aW9uXG4gICAgICAgICovXG4gICAgICAgIHRoaXMuY3JlYXRlUG9zaXRpb24gPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdwcm9kdWN0L3Bvc2l0aW9uJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKuS/ruaUueS7k+S9jVxuICAgICAgICBAUGFyYW1zXG4gICAgICAgIGlkXG4gICAgICAgIHJvd1xuICAgICAgICBsYXllclxuICAgICAgICBsb2NhdGlvblxuICAgICAgICAqL1xuICAgICAgICB0aGlzLm1vZGlmeVBvc2l0aW9uID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdwcm9kdWN0L3Bvc2l0aW9uJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKuWIhumhteiOt+WPluS7k+S9jVxuICAgICAgICBAUGFyYW1zXG4gICAgICAgIG5hbWVcbiAgICAgICAgc29ydFR5cGVcbiAgICAgICAgb2Zmc2V0XG4gICAgICAgIGxpbWl0XG4gICAgICAgICovXG4gICAgICAgIHRoaXMucXVlcnlQb3NpdGlvbnNCeVBhZ2UgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ3Byb2R1Y3QvcG9zaXRpb24vX3F1ZXJ5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKumdnuWIhumhteiOt+WPluS7k+S9jVxuICAgICAgICBAUGFyYW1zXG4gICAgICAgIG5hbWVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXVlcnlBbGxQb3NpdGlvbnMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ3Byb2R1Y3QvcG9zaXRpb24vX3F1ZXJ5QWxsJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgIH1dKTtcbn07IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGxpamlubG9uZ1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIGFwcC5zZXJ2aWNlKCdwcmludFNlcnZpY2UnLCBmdW5jdGlvbigkbWREaWFsb2cpIHtcbiAgICAgICAgdmFyIExPRE9QO1xuICAgICAgICB0aGlzLmFkZEh0bWwgPSBmdW5jdGlvbihodG1sKSB7XG4gICAgICAgICAgICBMT0RPUCA9IHdpbmRvdy5nZXRMb2RvcCgpO1xuICAgICAgICAgICAgTE9ET1AuU0VUX1BSSU5UX01PREUoXCJQT1NfQkFTRU9OX1BBUEVSXCIsIHRydWUpO1xuICAgICAgICAgICAgTE9ET1AuU0VUX1BSSU5UX0NPUElFUygxKTtcbiAgICAgICAgICAgIExPRE9QLlNFVF9QUklOVF9TVFlMRUEoMCwgXCJIb3JpZW50XCIsIDApO1xuICAgICAgICAgICAgTE9ET1AuUFJJTlRfSU5JVChcIlwiKTtcbiAgICAgICAgICAgIExPRE9QLkFERF9QUklOVF9IVE0oMCwgMCwgXCIxMDAlXCIsIFwiQm90dG9tTWFyZ2luOjEwcHhcIiwgaHRtbCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJldmlldyA9IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkSHRtbChodG1sKVxuICAgICAgICAgICAgTE9ET1AuUFJFVklFVygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNlbGVjdEFzRGVmYXVsdFByaW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIExPRE9QID0gd2luZG93LmdldExvZG9wKCk7XG4gICAgICAgICAgICBMT0RPUC5TRUxFQ1RfUFJJTlRFUigpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByaW50ID0gZnVuY3Rpb24oaHRtbCkge1xuICAgICAgICAgICAgdGhpcy5hZGRIdG1sKGh0bWwpO1xuICAgICAgICAgICAgTE9ET1AuUFJJTlQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcmludEh0bWxzID0gZnVuY3Rpb24oaHRtbHMpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoXy5pc0FycmF5KGh0bWxzKSkge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChodG1scywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBtZS5wcmludChpdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWUucHJpbnQoaHRtbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByaW50QnlEZWZhdWx0UHJpbnRlciA9IGZ1bmN0aW9uKGh0bWxzLCBuZWVkQ29uZmlybSkge1xuICAgICAgICAgICAgbmVlZENvbmZpcm0gPSB0eXBlb2YgbmVlZENvbmZpcm0gPT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDogbmVlZENvbmZpcm07XG4gICAgICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKG5lZWRDb25maXJtKSB7XG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coJG1kRGlhbG9nLmNvbmZpcm0oe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+aPkOekuicsXG4gICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50OiAn6K+354K55Ye756Gu6K6k5oyJ6ZKu5omT5Y2w77yBJyxcbiAgICAgICAgICAgICAgICAgICAgb2s6ICfnoa7orqQnLFxuICAgICAgICAgICAgICAgICAgICBjYW5jZWw6ICflj5bmtognXG4gICAgICAgICAgICAgICAgfSkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLnByaW50SHRtbHMoaHRtbHMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZS5wcmludEh0bWxzKGh0bWxzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuICAgIH0pO1xufTtcbiIsIi8vcHJvZHVjdFNlcnZpY2Vcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5zZXJ2aWNlKCdwcm9kdWN0U2VydmljZScsIFsneGhyU2VydmljZScsICckcScsICckZmlsdGVyJywgJ0NPTlNUQU5UUycsXG4gICAgZnVuY3Rpb24oXG4gICAgICB4aHJTZXJ2aWNlLCAkcSwgJGZpbHRlciwgQ09OU1RBTlRTKSB7XG4gICAgICB0aGlzLmluZGV4RGF0YSA9IGZ1bmN0aW9uKGRhdGEsIG9mZnNldCkge1xuICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgICBpdGVtLmluZGV4ID0gaW5kZXggKyBvZmZzZXQ7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAg6L2s5o2i5ZWG5ZOB5YiX6KGoXG4gICAgICAqL1xuICAgICAgdGhpcy5fcGFyc2VQcm9kdWN0TGlzdERhdGEgPSBmdW5jdGlvbihkYXRhLCBsYWJlbExpc3QpIHtcbiAgICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGQsIGksIGEpIHtcbiAgICAgICAgICB2YXIgb2JqID0gZC5oZWFkZXI7XG4gICAgICAgICAgb2JqLmNhdGVnb3J5ID0gZC5jYXRlZ29yeTtcbiAgICAgICAgICBvYmoucG9zaXRpb25zID0gZC5wb3NpdGlvbnM7XG4gICAgICAgICAgdmFyIGxhYmVsTmFtZXMgPSBbXTtcbiAgICAgICAgICBfLmVhY2gobGFiZWxMaXN0LCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICB2YXIgdCA9IF8uZmluZChkLmxhYmVsRHRvcywgZnVuY3Rpb24obGFiZWwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGxhYmVsLnR5cGVJZCA9PSBpdGVtLmlkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgbGFiZWxOYW1lcy5wdXNoKHQubmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBsYWJlbE5hbWVzLnB1c2goJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIG9iai5sYWJlbE5hbWVzID0gbGFiZWxOYW1lcztcbiAgICAgICAgICB2YXIgdCA9ICcnO1xuICAgICAgICAgIF8uZWFjaChvYmoucHJvZHVjdFRhZ3MsIGZ1bmN0aW9uKHRhZ0lkLCBpbmRleCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9IDApIHtcbiAgICAgICAgICAgICAgdCArPSAnLCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ICs9IENPTlNUQU5UUy5QUk9EVUNUX1RBRy5ERVNDW3RhZ0lkXTtcbiAgICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIG9iai5wcm9kdWN0VGFnc1ByZWZpeCA9IHQ7XG4gICAgICAgICAgdGVtcC5wdXNoKG9iaik7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGVtcDtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAg6L2s5o2i5ZWG5ZOB6K+m5oOFXG4gICAgICAqL1xuICAgICAgdGhpcy5fcGFyc2VQcm9kdWN0RGF0YSA9IGZ1bmN0aW9uKHJlcywgbGFiZWxMaXN0KSB7XG4gICAgICAgIHZhciB0ZW1wID0gcmVzLmhlYWRlcjtcbiAgICAgICAgdGVtcC5jYXRlZ29yeU5hbWUgPSByZXMuY2F0ZWdvcnkuY2F0ZWdvcnlOYW1lO1xuICAgICAgICB0ZW1wLm9yaWdpblByaWNlID0gdGVtcC5vcmlnaW5QcmljZSAvIDEwMC4wO1xuICAgICAgICB0ZW1wLnByaWNlID0gdGVtcC5wcmljZSAvIDEwMC4wO1xuICAgICAgICB0ZW1wLnBvc2l0aW9uSWRzID0gcmVzLnBvc2l0aW9ucztcbiAgICAgICAgdGVtcC5sYWJlbER0b3MgPSBbXTtcbiAgICAgICAgdGVtcC5zaG93TGFiZWxJZExpc3QgPSBbXTtcbiAgICAgICAgXy5lYWNoKGxhYmVsTGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHZhciB0ID0gXy5maW5kKHJlcy5sYWJlbER0b3MsIGZ1bmN0aW9uKGxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbGFiZWwudHlwZUlkID09IGl0ZW0uaWQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0ICE9ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0ZW1wLmxhYmVsRHRvcy5wdXNoKHQpO1xuICAgICAgICAgICAgdGVtcC5zaG93TGFiZWxJZExpc3QucHVzaCh0LmlkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGVtcC5zaG93TGFiZWxJZExpc3QucHVzaCgnJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGVtcC5sYWJlbElkTGlzdCA9IF8ucGx1Y2sodGVtcC5sYWJlbER0b3MsICdpZCcpO1xuICAgICAgICB0ZW1wLmNhdGVnb3J5SWQgPSByZXMuY2F0ZWdvcnkuaWQ7XG4gICAgICAgIHJldHVybiB0ZW1wO1xuICAgICAgfTtcbiAgICAgIC8q5oyJ57G75Z6L6I635Y+W5ZWG5ZOB5pWw5o2u5a2X5YW4XG4gICAgICBAUGFyYW1zIFxuICAgICAgdHlwZVxuICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlQcm9kdWN0RGljdGlvbmFyeSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC9kaWN0L2xpc3RCeVR5cGUnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8v5o6l5Y+jXG4gICAgICB0aGlzLnF1ZXJ5UHJvZHVjdEJ5S2V5ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIC8vIGRlYnVnZ2VyXG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC9fcXVlcnknLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q6I635Y+W5ZOB57G75YiX6KGoXG4gICAgICBAUGFyYW1zXG4gICAgICBjYXRlZ29yeUlkXG4gICAgICAqL1xuICAgICAgdGhpcy5xdWVyeVByb2R1Y3RDYXRlZ29yeUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgcGFyYW1zID0gdHlwZW9mIHBhcmFtcyAhPSAndW5kZWZpbmVkJyA/IHBhcmFtcyA6IHsgcGFyZW50Q2F0ZWdvcnlJZDogMCB9O1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC9jYXRlZ29yeS9zaG93X2xpc3QvJyArIHBhcmFtcy5wYXJlbnRDYXRlZ29yeUlkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5Yib5bu65ZOB57G7XG4gICAgICBAUGFyYW1zXG4gICAgICBpZFxuICAgICAgY2F0ZWdvcnlOYW1lXG4gICAgICBjYXRlZ29yeUxldmVsXG4gICAgICAqL1xuICAgICAgdGhpcy5jcmVhdGVQcm9kdWN0Q2F0ZWdvcnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdwcm9kdWN0L2NhdGVnb3J5JyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuWIoOmZpOWTgeexu1xuICAgICAgQFBhcmFtc1xuICAgICAgY2F0ZWdvcnlJZFxuICAgICAgICovXG4gICAgICB0aGlzLmRlbGV0ZVByb2R1Y3RDYXRlZ29yeSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuRGVsZXRlKHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC9jYXRlZ29yeS8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5L+u5pS55ZOB57G7XG4gICAgICBAUGFyYW1zXG4gICAgICBpZFxuICAgICAgY2F0ZWdvcnlOYW1lXG4gICAgICBjYXRlZ29yeUxldmVsXG4gICAgICAqL1xuICAgICAgdGhpcy5tb2RpZnlQcm9kdWN0Q2F0ZWdvcnkgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgcGF0aDogJ3Byb2R1Y3QvY2F0ZWdvcnkvbW9kaWZ5JyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvL+afpeeci+WVhuWTgeivpuaDhVxuICAgICAgdGhpcy5nZXRQcm9kdWN0QnlJZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgkZmlsdGVyKCdpbnQnKShyZXMsIFsnaGVhZGVyLnN0b2NrJ10pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvL+S/ruaUueWVhuWTgVxuICAgICAgdGhpcy5lZGl0UHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8v5bCG5ZWG5ZOB5pS+5YWl5oyH5a6a5ZOB57G7XG4gICAgICB0aGlzLmFkZFByb2R1Y3RUb0NhdGVnb3J5ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC9jYXRlZ29yeS8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIC8vIHBhdGg6ICdjb21wYW55L3NoZWxmX3Byb2R1Y3QvY3JlYXRlQ2F0ZWdvcnknLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLnByb2R1Y3RJZHMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLy/kv53lrZjmlrDlu7rllYblk4FcbiAgICAgIHRoaXMuc2F2ZU5ld1Byb2R1Y3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdwcm9kdWN0JyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvL+S/neWtmOW3suacieWVhuWTgVxuICAgICAgdGhpcy5zYXZlT2xkUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8v5Yig6Zmk5ZWG5ZOBXG4gICAgICB0aGlzLmRlbGV0ZVByb2R1Y3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkRlbGV0ZSh7XG4gICAgICAgICAgcGF0aDogJ3Byb2R1Y3QvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvL+iOt+WPluS7k+S9jeWIl+ihqFxuICAgICAgdGhpcy5nZXRQb3NpdGlvbkxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ3Byb2R1Y3QvcG9zaXRpb24nLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8v5ZWG5ZOB5bqT5a2Y5L+u5pS56K6w5b2VXG4gICAgICB0aGlzLmdldFByb2R1Y3RTdG9ja0NoYW5nZUxvZyA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICBwYXRoOiAncHJvZHVjdC8nICsgcGFyYW1zLmlkICsgJy9zdG9ja2NoYW5nZXMnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLy/lop7liqDljZXlk4HmjqjojZDmnJ/pl7TlsZXnpLrmrKHmlbBcbiAgICAgIHRoaXMuaW5jclByb2R1Y3RSZWNvbW1lbmQgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6ICdwcm9kdWN0L3JlY29tbWVuZC9pbmNyVmlldycsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgfVxuICBdKTtcbn07IiwiIHZhciBiYXNlUGF0aCA9ICdjb21wYW55L3Byb21vdGlvbi8nO1xuIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5zZXJ2aWNlKCdwcm9tb3Rpb25TZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJ3V0aWxTZXJ2aWNlJywgJyRxJyxcbiAgICBmdW5jdGlvbih4aHJTZXJ2aWNlLCB1dGlsU2VydmljZSxcbiAgICAgICRxKSB7XG4gICAgICAvKuWIm+W7uuiQpemUgOWVhuWTgVxuICAgICAgICovXG4gICAgICB0aGlzLmNyZWF0ZVByb21vdGlvblByb2R1Y3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3Byb2R1Y3QnLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5L+u5pS56JCl6ZSA5ZWG5ZOBXG4gICAgICAgKi9cbiAgICAgIHRoaXMubW9kaWZ5UHJvbW90aW9uUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiBiYXNlUGF0aCArICdwcm9kdWN0LycgKyBwYXJhbXMuaWQsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLypcbiAgICAgIOafpeivouiQpemUgOWVhuWTgeWIl+ihqFxuICAgICAgICovXG4gICAgICB0aGlzLnF1ZXJ5UHJvbW90aW9uUHJvZHVjdExpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogYmFzZVBhdGggKyAncHJvZHVjdC9wYWdlJyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAg5p+l6K+i6JCl6ZSA5ZWG5ZOB6K+m5oOFXG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlQcm9tb3Rpb25Qcm9kdWN0RGV0YWlsID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3Byb2R1Y3QvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAg5LiK5p626JCl6ZSA5ZWG5ZOBXG4gICAgICAgKi9cbiAgICAgIHRoaXMub25saW5lUHJvbW90aW9uUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiBiYXNlUGF0aCArICdwcm9kdWN0L29ubGluZS8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8qXG4gICAgICDkuIvmnrbokKXplIDllYblk4FcbiAgICAgICAqL1xuICAgICAgdGhpcy5vZmZsaW5lUHJvbW90aW9uUHJvZHVjdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiBiYXNlUGF0aCArICdwcm9kdWN0L29mZmxpbmUvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKlxuICAgICAg6I635Y+W6JCl6ZSA5ZWG5ZOBSFRNTOmTvuaOpVxuICAgICAgICovXG4gICAgICB0aGlzLmdldFByb21vdGlvblByb2R1Y3RMaW5rID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3Byb2R1Y3QvbGluay8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICog5Yib5bu66JCl6ZSA5aWX6aSQXG4gICAgICAgKi9cbiAgICAgIHRoaXMuY3JlYXRlUHJvbW90aW9uU3VpdGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3N1aXRlJyxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIOS/ruaUueiQpemUgOWVhuWTgeWll+mkkFxuICAgICAgICovXG4gICAgICB0aGlzLm1vZGlmeVByb21vdGlvblN1aXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3N1aXRlLycgKyBwYXJhbXMuaWQsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiDliKDpmaTokKXplIDllYblk4HlpZfppJBcbiAgICAgICAqL1xuICAgICAgdGhpcy5kZWxldGVQcm9tb3Rpb25TdWl0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuRGVsZXRlKHtcbiAgICAgICAgICBwYXRoOiBiYXNlUGF0aCArICdzdWl0ZS8nICsgcGFyYW1zLmlkLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICog5p+l6K+i6JCl6ZSA5ZWG5ZOB5aWX6aSQ5YiX6KGoXG4gICAgICAgKi9cbiAgICAgIHRoaXMucXVlcnlQcm9tb3Rpb25TdWl0ZUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogYmFzZVBhdGggKyAnc3VpdGUvcGFnZScsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiDmn6Xor6LokKXplIDllYblk4HlpZfppJDor6bnu4ZcbiAgICAgICAqL1xuICAgICAgdGhpcy5xdWVyeVByb21vdGlvblN1aXRlRGV0YWlsID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3N1aXRlLycgKyBwYXJhbXMuaWQsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiDojrflj5bokKXplIDllYblk4FIVE1M6ZO+5o6lXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZ2V0UHJvbW90aW9uU3VpdGVMaW5rID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ3N1aXRlL2xpbmsvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIOi9rOaNouiQpemUgOWVhuWTgeivpue7hlxuICAgICAgICovXG4gICAgICB0aGlzLl9wYXJzZVByb21vdGlvblByb2R1Y3REZXRhaWwgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciB0ZW1wID0gYW5ndWxhci5jb3B5KGRhdGEpO1xuICAgICAgICB0ZW1wLnByaWNlID0gdGVtcC5wcmljZSAvIDEwMDtcbiAgICAgICAgdGVtcC5vcmlnaW5hbFByaWNlID0gdGVtcC5vcmlnaW5hbFByaWNlIC8gMTAwO1xuICAgICAgICB0ZW1wLmFjdGl2ZSA9IHBhcnNlSW50KHRlbXAuYWN0aXZlKTtcbiAgICAgICAgdGVtcC5pbWdEZXRhaWxzID0gXy5tYXAoZGF0YS5pbWFnZXMsIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgICB2YXIgdCA9IGl0ZW0ubWF0Y2goL19cXGQrXy8pWzBdO1xuICAgICAgICAgIHZhciBzaXplID0gdC5zdWJzdHIoMSwgdC5sZW5ndGggLSAyKTtcbiAgICAgICAgICB2YXIgd2ggPSBpdGVtLm1hdGNoKC9cXGQrWFxcZCsvKVswXS5zcGxpdCgnWCcpO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpbmRleDogaSArIDEsXG4gICAgICAgICAgICBwYXRoOiBpdGVtLFxuICAgICAgICAgICAgaW1hZ2Vfd2lkdGg6IHdoWzBdLFxuICAgICAgICAgICAgaW1hZ2VfaGVpZ2h0OiB3aFsxXSxcbiAgICAgICAgICAgIGZpbGVfc2l6ZTogc2l6ZVxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICB0ZW1wLmRlc0ltZ0RldGFpbHMgPSBfLm1hcChkYXRhLmRlc0ltYWdlcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgIHZhciB0ID0gaXRlbS5tYXRjaCgvX1xcZCtfLylbMF07XG4gICAgICAgICAgdmFyIHNpemUgPSB0LnN1YnN0cigxLCB0Lmxlbmd0aCAtIDIpO1xuICAgICAgICAgIHZhciB3aCA9IGl0ZW0ubWF0Y2goL1xcZCtYXFxkKy8pWzBdLnNwbGl0KCdYJyk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGluZGV4OiBpICsgMSxcbiAgICAgICAgICAgIHBhdGg6IGl0ZW0sXG4gICAgICAgICAgICBpbWFnZV93aWR0aDogd2hbMF0sXG4gICAgICAgICAgICBpbWFnZV9oZWlnaHQ6IHdoWzFdLFxuICAgICAgICAgICAgZmlsZV9zaXplOiBzaXplXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0ZW1wO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICog6L2s5o2i6JCl6ZSA5ZWG5ZOB5YiX6KGo5pWw5o2uXG4gICAgICAgKi9cbiAgICAgIHRoaXMuX3BhcnNlUHJvbW90aW9uUHJvZHVjdExpc3QgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciB0ZW1wID0gW107XG4gICAgICAgIF8uZWFjaChkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgaXRlbS5hY3RpdmUgPSBwYXJzZUludChpdGVtLmFjdGl2ZSk7XG4gICAgICAgICAgdGVtcC5wdXNoKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRlbXA7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiDovazmjaLokKXplIDlpZfppJDor6bnu4ZcbiAgICAgICAqL1xuICAgICAgdGhpcy5fcGFyc2VQcm9tb3Rpb25TdWl0ZURldGFpbCA9IGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICog6L2s5o2i6JCl6ZSA5aWX6aSQ5YiX6KGo5pWw5o2uXG4gICAgICAgKi9cbiAgICAgIHRoaXMuX3BhcnNlUHJvbW90aW9uU3VpdGVMaXN0ID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB2YXIgdGVtcCA9IFtdO1xuICAgICAgICBfLmVhY2goZGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHZhciBwcm9kdWN0TmFtZXNTdHIgPSAnJztcbiAgICAgICAgICBfLmVhY2goaXRlbS5wcm9kdWN0TmFtZXMsIGZ1bmN0aW9uKG5hbWUsIGkpIHtcbiAgICAgICAgICAgIHByb2R1Y3ROYW1lc1N0ciArPSBuYW1lO1xuICAgICAgICAgICAgaWYgKGkgPCBpdGVtLnByb2R1Y3ROYW1lcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgIHByb2R1Y3ROYW1lc1N0ciArPSAnLCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaXRlbS5wcm9kdWN0TmFtZXNTdHIgPSBwcm9kdWN0TmFtZXNTdHI7XG4gICAgICAgICAgdGVtcC5wdXNoKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRlbXA7XG4gICAgICB9O1xuICAgICAgLyrpgIDotKdcbiAgICAgICAqXG4gICAgICAgKiBvcmRlcklkXG4gICAgICAgKi9cbiAgICAgIHRoaXMucmVmdW5kUHJvbW90aW9uT3JkZXIgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgcGF0aDogYmFzZVBhdGggKyAnb3JkZXIvcmVmdW5kLycgKyBwYXJhbXMub3JkZXJJZCxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5pS26LSnXG4gICAgICAgKlxuICAgICAgICogb3JkZXJJZFxuICAgICAgICovXG4gICAgICB0aGlzLnJlY2VpdmVQcm9tb3Rpb25PcmRlciA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICBwYXRoOiBiYXNlUGF0aCArICdvcmRlci9yZWNlaXZlLycgKyBwYXJhbXMub3JkZXJJZCxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcbiAgICAgIC8q5pSv5LuY5YWo6aKdXG4gICAgICAgKm9yZGVySWRcbiAgICAgICAqL1xuICAgICAgdGhpcy5wYXlGdWxsUHJvbW90aW9uT3JkZXIgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgcGF0aDogYmFzZVBhdGggKyAnb3JkZXIvcGF5L2Z1bGwvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrnoa7orqTmlK/ku5jlrprph5FcbiAgICAgICAqb3JkZXJJZFxuICAgICAgICovXG4gICAgICB0aGlzLmNvbmZpcm1EZXBvc2l0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ29yZGVyL2RlcG9zaXQvY29uZmlybS8nICsgcGFyYW1zLm9yZGVySWQsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuiuouWNleWPkei0p1xuICAgICAgICpvcmRlcklkXG4gICAgICAgKiBcbiAgICAgICAqL1xuICAgICAgdGhpcy5kZWxpdmVyeVByb21vdGlvbk9yZGVyID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ29yZGVyL2RlbGl2ZXIvJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrnoa7orqTorqLljZVcbiAgICAgICAqb3JkZXJJZFxuICAgICAgICovXG4gICAgICB0aGlzLmNvbmZpcm1PcmRlciA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIHZhciBvcmRlck9iaiA9IHt9O1xuICAgICAgICBhbmd1bGFyLmZvckVhY2gocGFyYW1zLm9yZGVyLCBmdW5jdGlvbih2LCBrZXkpIHtcbiAgICAgICAgICBpZiAodiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgb3JkZXJPYmpba2V5XSA9IHY7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKHBhcmFtcy5vcmRlckl0ZW1zLGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgIGl0ZW0ucHJvZHVjdElkPWl0ZW0uaWQ7XG4gICAgICAgICAgaXRlbS5wcm9kdWN0U3VidGl0bGU9aXRlbS5zdWJ0aXRsZTtcbiAgICAgICAgICBpdGVtLnByb2R1Y3RUaXRsZT1pdGVtLnRpdGxlO1xuICAgICAgICAgIGl0ZW0ucHJvZHVjdENvdmVyPWl0ZW0uY292ZXI7XG4gICAgICAgICAgaXRlbS5wcm9kdWN0U2t1PWl0ZW0uc2t1O1xuXG4gICAgICAgIH0pO1xuICAgICAgICBwYXJhbXMub3JkZXIgPSBvcmRlck9iajtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ29yZGVyL2NvbmZpcm0vJyArIHBhcmFtcy5vcmRlcklkLFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgICAgLyrlj5bmtojmnKrmlK/ku5jorqLljZVcbiAgICAgICAqb3JkZXJJZFxuICAgICAgICovXG4gICAgICB0aGlzLmNhbmNlbE5vUGF5bWVudE9yZGVyID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ29yZGVyL2NhbmNlbC8nICsgcGFyYW1zLm9yZGVySWQsXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH07XG4gICAgICAvKuWPlua2iOiuouWNlVxuICAgICAgICpvcmRlcklkXG4gICAgICAgKi9cbiAgICAgIHRoaXMuY2FuY2VsUGF5bWVudE9yZGVyID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6IGJhc2VQYXRoICsgJ29yZGVyL2NhbmNlbC9wYXltZW50LycgKyBwYXJhbXMub3JkZXJJZCxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfTtcblxuICAgIH1cbiAgXSk7XG4gfVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ3JvbGVTZXJ2aWNlJywgZnVuY3Rpb24oJHEsIHhoclNlcnZpY2UpIHtcbiAgICAvKipcbiAgICAgKiDojrflj5bmiYDmnInop5LoibJcbiAgICAgKi9cbiAgICB0aGlzLmdldFJvbGVzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ3JvbGUnLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOa3u+WKoOinkuiJslxuICAgICAqL1xuICAgIHRoaXMuYWRkUm9sZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgICBwYXRoOiAncm9sZScsXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBwYXJlbnRJZDogcGFyYW1zLnBhcmVudElkLFxuICAgICAgICAgICAgbmFtZTogcGFyYW1zLm5hbWUsXG4gICAgICAgICAgICBwZXJtaXNzaW9uczogcGFyYW1zLnBlcm1pc3Npb25JZHNcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOe8lui+keinkuiJslxuICAgICAqL1xuICAgIHRoaXMuZWRpdFJvbGUgPSBmdW5jdGlvbihyb2xlSWQsIHBhcmFtcykge1xuICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICAgIHBhdGg6ICdyb2xlLycgKyByb2xlSWQsXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBuYW1lOiBwYXJhbXMubmFtZSxcbiAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwYXJhbXMucGVybWlzc2lvbklkc1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICog5Yig6Zmk6KeS6ImyXG4gICAgICovXG4gICAgdGhpcy5yZW1vdmVSb2xlID0gZnVuY3Rpb24ocm9sZUlkKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkRlbGV0ZSh7XG4gICAgICAgICAgcGF0aDogJ3JvbGUvJyArIHJvbGVJZCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiDojrflj5bmiYDmnInmma7pgJrmnYPpmZBcbiAgICAgKi9cbiAgICB0aGlzLmdldE5vcm1hbFBlcm1pc3Npb25zID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ3Blcm1pc3Npb24vMicsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICog6I635Y+W5omA5pyJ54m55q6K5p2D6ZmQXG4gICAgICovXG4gICAgdGhpcy5nZXRDcml0aWNhbFBlcm1pc3Npb25zID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgcGF0aDogJ3Blcm1pc3Npb24vMycsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xufTtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSB6aG91d2FuIG9uIDIwMTcvMS8xMy5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXBwKSB7XG4gIGFwcC5zZXJ2aWNlKFwic2FsZXNTZXJ2aWNlXCIsIFsneGhyU2VydmljZScsICckcScsIGZ1bmN0aW9uICh4aHJTZXJ2aWNlLCAkcSkge1xuICAgIHRoaXMuZ2V0UXVlcnlTYWxlc0xpc3QgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgcGF0aDogXCJwcm9kdWN0L3N0YXRpc3RpY3MvX3F1ZXJ5XCIsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgdGhpcy5nZXRTdGFydFRpbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAncHJvZHVjdC9zdGF0aXN0aWNzL3N0YXJ0VGltZScsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvL+a7numUgOW6k1xuICAgIHRoaXMuYWRkVW5zYWxhYmxlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6IFwicHJvZHVjdC91bnNhbGFibGUvYWRkXCIsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvL+aWsOWTgeaOqOiNkOW6k1xuICAgIHRoaXMuYWRkQ29tbWVuZCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiBcInByb2R1Y3QvcmVjb21tZW5kL2FkZFwiLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8v5Yig6Zmk5paw5ZOB5o6o6I2QXG4gICAgdGhpcy5kZWxSZWNvbW1lbmQgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICBwYXRoOiAncHJvZHVjdC9yZWNvbW1lbmQvZGVsLycgKyBwYXJhbXMuaWQsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvL+WIoOmZpOa7numUgOWVhuWTgVxuICAgIHRoaXMuZGVsVW5zYWxhYmxlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuRGVsZXRlKHtcbiAgICAgICAgcGF0aDogJ3Byb2R1Y3QvdW5zYWxhYmxlL2RlbC8nICsgcGFyYW1zLmlkLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cblxuICB9XSk7XG5cbn0iLCIvKlxuICpzaGVsZlNlcnZpY2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ3NoZWxmU2VydmljZScsIFsneGhyU2VydmljZScsICdDT05TVEFOVFMnLCAnJHEnLCBmdW5jdGlvbihcbiAgICB4aHJTZXJ2aWNlLCBDT05TVEFOVFMsICRxKSB7XG4gICAgdmFyIHNoZWx2ZXMgPSBbXTtcbiAgICAvL+WNleWIqeaVsOaNruWtmOWCqFxuICAgIHRoaXMuZ2V0U2hlbHZlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNoZWx2ZXM7XG4gICAgfTtcbiAgICAvL+acjeWKoVxuICAgIC8q6LSn5p625pWw5o2u6L2s5o2iXG4gICAgICpcbiAgICAgKi9cbiAgICB0aGlzLl9wYXJzZVNoZWxmRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIC8v5ou36LSd5LiA5Lu977yM5L+d5oyB5pWw5o2u5rqQ5LiN5Y+YXG4gICAgICB2YXIgdGVtcCA9IFtdO1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIHZhciB0ID0gYW5ndWxhci5jb3B5KGl0ZW0pO1xuICAgICAgICB0LmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHQuY29tcGFueV90eXBlID0gQ09OU1RBTlRTLkNPTVBBTllfVFlQRS5ERVNDW3QuY29tcGFueV90eXBlXTtcbiAgICAgICAgdC5hbGxfcHJvZHVjdF9wZXIgPSB0LmFsbF9wcm9kdWN0X3BlciAmJiB0LmFsbF9wcm9kdWN0X3BlclxuICAgICAgICAgIC5zcGxpdCgnLCcpLmpvaW4oJyB8ICcpO1xuICAgICAgICB0Lmxhc3RfdXBkYXRlX2ludGVydmFsID0gdC5sYXN0X3VwZGF0ZV9pbnRlcnZhbCAmJiB0Lmxhc3RfdXBkYXRlX2ludGVydmFsXG4gICAgICAgICAgLnNwbGl0KCcsJykuam9pbignIHwgJyk7XG4gICAgICAgIHQudmFsaWRfc2hlbGRfY291bnRWU3NoZWxmX2NvdW50ID0gdC52YWxpZF9zaGVsZF9jb3VudCArXG4gICAgICAgICAgJy8nICsgdC5zaGVsZl9jb3VudDtcbiAgICAgICAgdGVtcC5wdXNoKHQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGVtcDtcbiAgICB9O1xuICAgIC8qXG4gICAgICrpmaTlvZPliY3otKfmnrbkuIrnmoTlhbbku5bllYblk4FcbiAgICAgKi9cbiAgICB0aGlzLl9wYXJzZU90aGVyU2hlbGZQcm9kdWN0cyA9IGZ1bmN0aW9uKGRhdGEsIHNlbGVjdGVkSWRMaXN0KSB7XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtLCBpKSB7XG4gICAgICAgIHZhciB0ID0gYW5ndWxhci5jb3B5KGl0ZW0uaGVhZGVyKTtcbiAgICAgICAgdC5wb3NpdGlvbnMgPSBpdGVtLnBvc2l0aW9ucztcbiAgICAgICAgdC5wcm9kdWN0SWQgPSBpdGVtLmhlYWRlci5pZDtcbiAgICAgICAgaWYgKF8uY29udGFpbnMoc2VsZWN0ZWRJZExpc3QsIHQucHJvZHVjdElkKSkge1xuICAgICAgICAgIHQuc2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0LmNhdGVnb3J5TmFtZSA9IGl0ZW0uY2F0ZWdvcnkuY2F0ZWdvcnlOYW1lO1xuICAgICAgICB0LmNhdGVnb3J5ID0gaXRlbS5jYXRlZ29yeTtcbiAgICAgICAgdGVtcC5wdXNoKHQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGVtcDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOi9rOaNouaLo+i0p+WNleS4reeahOi0p+aetuWVhuWTgeaVsOaNrlxuICAgICAqL1xuICAgIHRoaXMuX3BhcnNlU2hlbGZQcm9kdWN0c0luRGVsaXZlcnlFZGl0ID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIHRlbXAgPSBbXTtcbiAgICAgIF8uZWFjaChkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciBzaGVsZlByb2R1Y3QgPSBpdGVtLnByb2R1Y3RIZWFkZXIgfHwge307XG4gICAgICAgIHNoZWxmUHJvZHVjdC5zaGVsZlByb2R1Y3RIZWFkZXIgPSBpdGVtLmhlYWRlcjtcbiAgICAgICAgc2hlbGZQcm9kdWN0LmNhdGVnb3J5ID0gaXRlbS5wcm9kdWN0Q2F0ZWdvcnk7XG4gICAgICAgIHNoZWxmUHJvZHVjdC5wb3NpdGlvbnMgPSBpdGVtLnBvc2l0aW9uRHRvTGlzdDtcbiAgICAgICAgc2hlbGZQcm9kdWN0LnNoZWxmU3RvY2sgPSBpdGVtLmhlYWRlci5zdG9jaztcbiAgICAgICAgc2hlbGZQcm9kdWN0LnNoZWxmUHJvZHVjdElkID0gaXRlbS5oZWFkZXIuaWQ7XG4gICAgICAgIHNoZWxmUHJvZHVjdC5wcm9kdWN0SWQgPSBpdGVtLnByb2R1Y3RIZWFkZXIuaWQ7XG4gICAgICAgIHRlbXAucHVzaChzaGVsZlByb2R1Y3QpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGVtcDtcbiAgICB9O1xuICAgIC8q6LSn5p626K+m57uG5pWw5o2u6L2s5o2iXG4gICAgICpcbiAgICAgKi9cbiAgICB0aGlzLl9wYXJzZVNoZWxmRGV0YWlsRGF0YSA9IGZ1bmN0aW9uKHRhYmxlcykge1xuICAgICAgdmFyIHQgPSBbXTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0YWJsZXMsIGZ1bmN0aW9uKHRhYmxlKSB7XG4gICAgICAgIHZhciB0ZW1wID0gW107XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0YWJsZS5wcm9kdWN0RGV0YWlscywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHZhciBoZWFkZXIgPSBpdGVtLmhlYWRlcjtcbiAgICAgICAgICB2YXIgcm93ID0gcGFyc2VJbnQoaGVhZGVyLnJvdyk7XG4gICAgICAgICAgdmFyIGNvbCA9IHBhcnNlSW50KGhlYWRlci5jb2wpO1xuICAgICAgICAgIHZhciByb3dudW0gPSByb3cgLSAxO1xuICAgICAgICAgIHZhciBjb2xudW0gPSBjb2wgLSAxO1xuICAgICAgICAgIHZhciB1bml0ID0gdGVtcFtyb3dudW1dO1xuICAgICAgICAgIGlmICghcm93ICYmICFjb2wpIHtcbiAgICAgICAgICAgIHRlbXBbNF0gPSBbXTtcbiAgICAgICAgICAgIHRlbXBbNF1bMF0gPSBpdGVtO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodW5pdCAmJiB1bml0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICB0ZW1wW3Jvd251bV1bY29sbnVtXSA9IGl0ZW07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0ZW1wW3Jvd251bV0gPSBbXTtcbiAgICAgICAgICAgICAgdGVtcFtyb3dudW1dW2NvbG51bV0gPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRhYmxlLnBhcnNlZFByb2R1Y3RzID0gdGVtcDtcbiAgICAgICAgdC5wdXNoKHRhYmxlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICAvKui0p+aetuWVhuWTgeaVsOaNrui9rOaNolxuICAgICAqL1xuICAgIHRoaXMuX3BhcnNlU2hlbGZQcm9kdWN0c0RhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICB2YXIgdDEgPSBbXTtcbiAgICAgIHQxID0gXy5maWx0ZXIoZGF0YSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5oZWFkZXIucm93ICE9IDA7XG4gICAgICB9KTtcbiAgICAgIHZhciB0MiA9IFtdO1xuICAgICAgdDIgPSBfLmZpbHRlcihkYXRhLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtLmhlYWRlci5yb3cgPT0gMDtcbiAgICAgIH0pO1xuICAgICAgdDIgPSBfLm1hcCh0MiwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBpdGVtLmhlYWRlci5yb3cgPSA1O1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH0pO1xuICAgICAgdmFyIHQgPSB0MS5jb25jYXQodDIpO1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcblxuICAgIC8v5o6l5Y+jXG5cbiAgICAvKuiOt+WPluWFrOWPuOWIl+ihqFxuICAgICpAUGFyYW1zXG4gICAgKiBzaGVsZl9zdG9ja19wZXJjZW50XG4gICAgICBzaGVsZl93YXJuX2NvdW50XG4gICAgICBjb21wYW55X25hbWVcbiAgICAgIHNoZWxmX3R5cGVcbiAgICAgIGxhc3RfdXBkYXRlX2ludGVydmFsXG4gICAgKi9cbiAgICB0aGlzLnF1ZXJ5U2hlbGZMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgdmFyIHBhcmFtc19zdHIgPSAkLnBhcmFtKHBhcmFtcyk7XG4gICAgICBwYXJhbXMgJiYgKHBhcmFtcy51cmxXaXRoUGFyYW0gPSAnYXBpL3Rhc2svc2hlbGZfbW9uaXRvcicgKyAoXG4gICAgICAgIHBhcmFtc19zdHIgPyAnPycgKyBwYXJhbXNfc3RyIDogJycpKTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdkYXRhL3JlbW90ZScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBzaGVsdmVzID0gcmVzO1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyrmoLnmja7lhazlj7jojrflj5botKfmnrbliJfooahcbiAgICAgKkBQYXJhbXNcbiAgICAgKmNvbXBhbnlJZFxuICAgICAqL1xuICAgIHRoaXMucXVlcnlTaGVsZkxpc3RCeUNvbXBhbnlJZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvc2hlbGYnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKuagueaNrui0p+aetuiOt+WPlui0p+aetuS4i+eahOWVhuWTgeWIl+ihqFxuICAgICAqQFBhcmFtc1xuICAgICAqc2hlbGZJZFxuICAgICAqL1xuICAgIHRoaXMucXVlcnlTaGVsZlByb2R1Y3N0c0J5U2hlbGZJZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2NvbXBhbnkvc2hlbGYvcHJvZHVjdC9zZWxlY3RfYnlfc2hlbGZfaWQnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKuWIhumhteafpeivoumZpOW9k+WJjei0p+aetuS4iueahOWFtuS7luWVhuWTgVxuICAgICpAUGFyYW1zXG4gICAgc2hlbGZJZFxuICAgIHByb2R1Y3ROYW1lXG4gICAgY2F0ZWdvcnlJZFxuICAgIHByb2ZpdExldmVsXG4gICAgcGFnZU5vXG4gICAgcGFnZVNpemVcbiAgICAqL1xuICAgIHRoaXMucXVlcnlPdGhlclNoZWxmUHJvZHVjdHMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zaGVsZi9wcm9kdWN0L290aGVyX3NoZWxmX3Byb2R1Y3RzJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyrotKfmnrbllYblk4HplIDph4/mm7Lnur/lm75cbiAgICAqQFBhcmFtc1xuICAgIHNoZWxmUHJvZHVjdElkXG4gICAgZGF5c1xuICAgICAqL1xuICAgIHRoaXMucXVlcnlTaGVsZlByb2R1Y3RUcmVuZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdkYXRhL3JlbW90ZScsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICd1cmxXaXRoUGFyYW0nOiAnYXBpL3Rhc2svc2hlbGZfc2FsZV90cmVuZD9zaGVsZlByb2R1Y3RJZD0nICtcbiAgICAgICAgICAgIHBhcmFtcy5zaGVsZlByb2R1Y3RJZCArICcmZGF5cz0nICsgcGFyYW1zLmRheXNcbiAgICAgICAgfSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyrojrflj5botKfmnrbkuIrnmoTllYblk4Hov4fljrvkuIDlkajnmoTml6XlnYfplIDllK7ph49cbiAgICAqQFBhcmFtc1xuICAgIHNoZWxmSWRcbiAgICAqL1xuICAgIHRoaXMucXVlcnlTaGVsZkF2Z1NhbGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zaGVsZi9wcm9kdWN0L3NoZWxmU2FsZUF2ZXJhZ2UnLFxuICAgICAgICBwYXJhbXM6IHsgJ3NoZWxmSWQnOiBwYXJhbXMuc2hlbGZJZCB9LFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8q5Yib5bu66LSn5p62XG4gICAgICpAUGFyYW1zXG4gICAgIGNvbXBhbnlJZCBcbiAgICAgc2hlbGZOYW1lXG4gICAgICovXG4gICAgdGhpcy5jcmVhdGVTaGVsZiA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUG9zdCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L3NoZWxmJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8q5pu05paw6LSn5p625ZCN56ewXG4gICAgKkBQYXJhbXNcbiAgICBzaGVsZklkXG4gICAgc2hlbGZOYW1lXG4gICAgKi9cbiAgICB0aGlzLm1vZGlmeVNoZWxmID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zaGVsZicsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvKuagueaNruWFrOWPuElE6I635Y+W6LSn5p626K+m5oOFXG4gICAgICpAUGFyYW1zXG4gICAgICpjb21wYW55SWRcbiAgICAgKi9cbiAgICB0aGlzLnF1ZXJ5U2hlbGZEZXRhaWxCeUNvbXBhbnlJZCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdjb21wYW55L3N1cnZleS9xdWVyeV9hbGwnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvKui0p+aetuWVhuWTgeivpue7huS/oeaBr+afpeivolxuICAgICpAUGFyYW1zXG4gICAgc2hlbGZQcm9kdWN0SWRcbiAgICAqL1xuICAgIHRoaXMucXVlcnlTaGVsZlByb2R1Y3REZXRhaWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnY29tcGFueS9zaGVsZi9wcm9kdWN0JyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICB9XSk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ3N0YWZmU2VydmljZScsIGZ1bmN0aW9uKCRxLCB4aHJTZXJ2aWNlKSB7XG4gICAgICAgIC8q5YiX6KGo5a+56LGh5p+l6K+iXG4gICAgICAgICAqcXVlcnlQYXJhbVxuICAgICAgICAgKmNvbXBhbnlJZFxuICAgICAgICAgKm9mZnNldFxuICAgICAgICAgKmxpbWl0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1ZXJ5U3RhZmZMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICdjb21wYW55L3N0YWZmL2ZpbmRfbGlzdCcsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKumbtuiKsemSseWvueixoeivpuaDheafpeeci1xuICAgICAgICAgKnN0YWZmSWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXVlcnlTdGFmZkRldGFpbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9zdGFmZi8nICsgcGFyYW1zLnN0YWZmSWQsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKumbtuiKsemSseWvueixoea3u+WKoFxuICAgICAgICAgKm1vYmlsZVxuICAgICAgICAgKmFsaWFzXG4gICAgICAgICAqcmVtYXJrXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFkZFN0YWZmID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9zdGFmZicsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKumbtuiKsemSseWvueixoeS/ruaUuVxuICAgICAgICAgKmlkXG4gICAgICAgICAqbW9iaWxlXG4gICAgICAgICAqYWxpYXNcbiAgICAgICAgICpyZW1hcmtcbiAgICAgICAgICphdmF0YXIgIFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5lZGl0U3RhZmYgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLlB1dCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2NvbXBhbnkvc3RhZmYnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIC8q6Zu26Iqx6ZKx5a+56LGh5Yig6ZmkXG4gICAgICAgICAqc3RhZmZJZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWxldGVTdGFmZiA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuRGVsZXRlKHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9zdGFmZi8nICsgcGFyYW1zLnN0YWZmSWQsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrpm7boirHpkrHlr7nosaEgLSBleGNlbOagoemqjFxuICAgICAgICAgKlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5leGFtaW5FeGNlbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgcGFyYW1zLmZpbGUpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdjb21wYW55SWQnLCBwYXJhbXMuY29tcGFueUlkKTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuVXBsb2FkKHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9zdGFmZi9leGNlbF9jaGVjaycsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKumbtuiKsemSseWvueixoeWvvOWFpVxuICAgICAgICAgKmZpbGVQYXRoXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmltcG9ydFN0YWZmRXhjZWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHBhcmFtcy5maWxlKTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY29tcGFueUlkJywgcGFyYW1zLmNvbXBhbnlJZCk7XG5cbiAgICAgICAgICAgIHhoclNlcnZpY2UuVXBsb2FkKHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnY29tcGFueS9zdGFmZi9leGNlbF9pbXBvcnQnLFxuICAgICAgICAgICAgICAgIHBhcmFtczogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgIH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gIGFwcC5zZXJ2aWNlKCdzdWl0ZVNlcnZpY2UnLCBbJ3hoclNlcnZpY2UnLCAnJHEnLCAnQ09OU1RBTlRTJywgZnVuY3Rpb24oXG4gICAgeGhyU2VydmljZSwgJHEsIENPTlNUQU5UUykge1xuICAgIHZhciBQUk9EVUNUX0ZST01fVFlQRSA9IENPTlNUQU5UUy5QSUNLX1BST0RVQ1RfRlJPTV9UWVBFO1xuICAgIHZhciBQSUNLX1BST0RVQ1RfUkVBU09OID0gQ09OU1RBTlRTLlBJQ0tfUFJPRFVDVF9SRUFTT047XG4gICAgLy/ovazmjaLliJvlu7rlpZfppJAgLS0+IOS4iuS8oOWbvueJhyBpbWFnZXNcbiAgICB0aGlzLl9nZXRJbWFnZURldGFpbHMgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICB2YXIgdGVtcCA9IGFuZ3VsYXIuY29weShkYXRhKTtcbiAgICAgIGNvbnNvbGUubG9nKHRlbXApO1xuICAgICAgdmFyIGltYWdlRGV0YWlscyA9IF8ubWFwKHRlbXAsIGZ1bmN0aW9uKGl0ZW0sIGkpIHtcbiAgICAgICAgdmFyIHQgPSBpdGVtLm1hdGNoKC9fXFxkK18vKVswXTtcbiAgICAgICAgdmFyIHNpemUgPSB0LnN1YnN0cigxLCB0Lmxlbmd0aCAtIDIpO1xuICAgICAgICB2YXIgd2ggPSBpdGVtLm1hdGNoKC9cXGQrWFxcZCsvKVswXS5zcGxpdCgnWCcpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGluZGV4OiBpICsgMSxcbiAgICAgICAgICBwYXRoOiBpdGVtLFxuICAgICAgICAgIGltYWdlX3dpZHRoOiB3aFswXSxcbiAgICAgICAgICBpbWFnZV9oZWlnaHQ6IHdoWzFdLFxuICAgICAgICAgIGZpbGVfc2l6ZTogc2l6ZVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gaW1hZ2VEZXRhaWxzO1xuICAgIH07XG4gICAgLypcbiAgICAg5p+l6K+i5pys5pyf5aWX6aSQXG4gICAgICovXG4gICAgdGhpcy5xdWVyeU9ubGluZVN1aXRlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2lzc3VlL29ubGluZScsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICog5aWX6aSQ6YWN6YCB5Yqo5oCBIC0tPiDmmI7nu4bvvIjlpZfppJBTS1XmlbDph4/jgIHllYblk4HlkI3np7DjgIHllYblk4HmlbDph4/vvInmlbDmja7ovazmjaJcbiAgICAgKi9cbiAgICB0aGlzLnBhcnNlU3VpdGVEYXRhID0gZnVuY3Rpb24ocmVzKSB7XG4gICAgICB2YXIgaXRlbXMgPSBfLmZpbHRlcihyZXMuaXRlbXMsIGZ1bmN0aW9uKF9pdGVtcykge1xuICAgICAgICByZXR1cm4gX2l0ZW1zLml0ZW1OdW0gIT0gXCItMVwiO1xuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZyhpdGVtcyk7XG4gICAgICAvLyB2YXIgaXRlbXMgPSByZXMuaXRlbXM7XG4gICAgICB2YXIgc3VpdGVOYW1lc0FycmF5ID0gW107XG4gICAgICB2YXIgb2JqID0ge307XG4gICAgICAvLyDpgY3ljoZpdGVtcyAg5YiG57uEXG4gICAgICBfLmVhY2goaXRlbXMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5zdWl0ZU5hbWUgPSBpdGVtLnN1aXRlTmFtZSAhPSBudWxsID8gaXRlbS5zdWl0ZU5hbWUgOlxuICAgICAgICAgICflpb3lk4HmjqjojZAnO1xuICAgICAgICBpZiAob2JqW2l0ZW0uc3VpdGVOYW1lXSkge1xuICAgICAgICAgIG9ialtpdGVtLnN1aXRlTmFtZV0ucHJvZHVjdHMucHVzaChpdGVtKTtcbiAgICAgICAgICBvYmpbaXRlbS5zdWl0ZU5hbWVdLml0ZW1OdW0gKz0gcGFyc2VJbnQoaXRlbS5pdGVtTnVtKTtcbiAgICAgICAgICBvYmpbaXRlbS5zdWl0ZU5hbWVdLnN1aXRlTmFtZSA9IGl0ZW0uc3VpdGVOYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9ialtpdGVtLnN1aXRlTmFtZV0gPSB7XG4gICAgICAgICAgICBzdWl0ZU5hbWU6IGl0ZW0uc3VpdGVOYW1lLFxuICAgICAgICAgICAgcHJvZHVjdHM6IFtpdGVtXSxcbiAgICAgICAgICAgIGl0ZW1OdW06IHBhcnNlSW50KFxuICAgICAgICAgICAgICBpdGVtLml0ZW1OdW0pXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBhbmd1bGFyLmZvckVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIHN1aXRlTmFtZXNBcnJheS5wdXNoKHZhbHVlKTtcbiAgICAgIH0pO1xuICAgICAgcmVzLnN1aXRlTmFtZXNBcnJheSA9IHN1aXRlTmFtZXNBcnJheTtcbiAgICAgIHJlcy5zdWl0ZSA9IG9iajtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiDovazmjaLmnKzmnJ/lpZfppJDmlbDmja4o5ouj6LSn5Y2V57yW6L6RKVxuICAgICAqL1xuICAgIHRoaXMuX3BhcnNlT25saW5lU3VpdGVzSW5EZWxpdmVyeUVkaXQgPSBmdW5jdGlvbihkYXRhLFxuICAgICAgcHJvZHVjdElkc0luU2hlbGYpIHtcbiAgICAgIHZhciB0ZW1wID0gYW5ndWxhci5jb3B5KGRhdGEpO1xuICAgICAgdmFyIHN1aXRlcyA9IF8ubWFwKHRlbXAuc3VpdGVzLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciBzdWl0ZVByb2R1Y3RzID0gXy5tYXAoaXRlbS5wcm9kdWN0cywgZnVuY3Rpb24ocHJvZHVjdCkge1xuICAgICAgICAgIHZhciBzdWl0ZVByb2R1Y3QgPSBwcm9kdWN0LmhlYWRlciB8fCB7fTtcbiAgICAgICAgICBzdWl0ZVByb2R1Y3QucG9zaXRpb25zID0gcHJvZHVjdC5wb3NpdGlvbnM7XG4gICAgICAgICAgc3VpdGVQcm9kdWN0LnByb2R1Y3RJZCA9IHByb2R1Y3QuaGVhZGVyLmlkO1xuICAgICAgICAgIHN1aXRlUHJvZHVjdC5zdWl0ZUlkID0gaXRlbS5zdWl0ZS5pZDtcbiAgICAgICAgICBzdWl0ZVByb2R1Y3QuaXNzdWVJZCA9IHRlbXAuaXNzdWUuaWQ7XG4gICAgICAgICAgc3VpdGVQcm9kdWN0LmZyb20gPSBbUFJPRFVDVF9GUk9NX1RZUEUuRlJPTV9TVUlURV07XG4gICAgICAgICAgc3VpdGVQcm9kdWN0LnJlYXNvbnMgPSBbUElDS19QUk9EVUNUX1JFQVNPTi5XSVNITElTVF07XG4gICAgICAgICAgc3VpdGVQcm9kdWN0LmNhdGVnb3J5ID0gcHJvZHVjdC5jYXRlZ29yeTtcbiAgICAgICAgICBpZiAoXy5jb250YWlucyhwcm9kdWN0SWRzSW5TaGVsZiwgc3VpdGVQcm9kdWN0LnByb2R1Y3RJZCkpIHtcbiAgICAgICAgICAgIHN1aXRlUHJvZHVjdC5mcm9tID0gXy51bmlvbihzdWl0ZVByb2R1Y3QuZnJvbSwgW1xuICAgICAgICAgICAgICBQUk9EVUNUX0ZST01fVFlQRS5GUk9NX1NIRUxGXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VpdGVQcm9kdWN0LmZyb20gPSBfLnVuaW9uKHN1aXRlUHJvZHVjdC5mcm9tLCBbXG4gICAgICAgICAgICAgIFBST0RVQ1RfRlJPTV9UWVBFLkZST01fTkVXXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHN1aXRlUHJvZHVjdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgc3VpdGVUaXRsZTogaXRlbS5zdWl0ZS50aXRsZSxcbiAgICAgICAgICBzdWl0ZTogaXRlbS5zdWl0ZSxcbiAgICAgICAgICBwcm9kdWN0czogc3VpdGVQcm9kdWN0c1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfSk7XG4gICAgICB0ZW1wLnN1aXRlcyA9IHN1aXRlcztcbiAgICAgIHJldHVybiB0ZW1wO1xuXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOiOt+WPlumFjemAgeWNleWIl+ihqOaOpeWPo++8mlxuICAgICAqIGxvZ2lzdGljcy9vcmRlci9kZWxpdmVyeS9maW5kTGlzdFxuICAgICAqL1xuICAgIHRoaXMuZ2V0U3VpdGVEaXN0cmlidXRpb25EeW5hbWljTGlzdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIC8qaWYocGFyYW1zLnR5cGUpey8v6I635Y+W6buY6K6kXG4gICAgICAgcGFyYW1zLmVuZFRpbWUgPSAgJGZpbHRlcignZGF0ZScpKHBhcmFtcy5lbmRUaW1lLCAneXl5eS1NTS1kZCBISDptbTpzcycpO1xuICAgICAgIHBhcmFtcy5zdGFydFRpbWUgPSAkZmlsdGVyKCdkYXRlJykocGFyYW1zLnN0YXJ0VGltZSwgJ3l5eXktTU0tZGQgSEg6bW06c3MnKTtcbiAgICAgICBkZWxldGUgcGFyYW1zLnR5cGU7XG4gICAgICAgfSBlbHNle1xuICAgICAgIH0qL1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAvLyBwYXRoOiAnbG9naXN0aWNzL29yZGVyL2RlbGl2ZXJ5L2ZpbmRMaXN0JyxcbiAgICAgICAgcGF0aDogJ2xvZ2lzdGljcy9vcmRlci9kZWxpdmVyeS9maW5kU3VpdGVMaXN0JyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICog5pyf5Y+3XG4gICAgICogSXNzdWVTdWl0ZTpcbiAgICAgKiAgc3VpdGVJZFxuICAgICAqICBhY3RpdmU6IGJvb2xlYW5cblxuICAgICAqIElzc3VlOlxuICAgICAqICBpZFxuICAgICAqICBzdGFydFRpbWVcbiAgICAgKiAgZW5kVGltZVxuICAgICAqICBzdGF0dXM6IDA65b6F5LiK57q/77ybMTrlt7LkuIrnur/vvIwyOuW3suS4i+e6v1xuICAgICAqICBzdWl0ZXM6IElzc3VlU3VpdGVbXVxuXG4gICAgICogQ3JlYXRlT3JVcGRhdGVJc3N1ZVJlcXVlc3Q6XG4gICAgICogIHN0YXJ0VGltZVxuICAgICAqICBlbmRUaW1lXG4gICAgICogIHN1aXRlczogSXNzdWVTdWl0ZVtdXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiDliJvlu7rmnJ/lj7dcbiAgICAgKiBQT1NUXG4gICAgICogL2JhY2tlbmQvaXNzdWU/cHVibGlzaEltbWVkaWF0ZWx5PWZhbHNlXG4gICAgICogc3RhcnRUaW1lXG4gICAgICplbmRUaW1lXG4gICAgICpzdWl0ZXM6IElzc3VlU3VpdGVbXVxuICAgICAqL1xuICAgIHRoaXMuY3JlYXRlSXNzdWUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICBwYXJhbXMuaXNEZWxldGVkID0gMDtcbiAgICAgIHZhciBwYXRoID0gJ2lzc3VlJ1xuICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgcGF0aDogJ2lzc3VlP3B1Ymxpc2hJbW1lZGlhdGVseT0nICsgcGFyYW1zLnB1Ymxpc2hJbW1lZGlhdGVseSB8fFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOabtOaWsOacn+WPt1xuICAgICAqIFBVVFxuICAgICAqICAvYmFja2VuZC9pc3N1ZS97aWR9XG4gICAgICovXG4gICAgdGhpcy51cGRhdGVJc3N1ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgcGF0aDogJ2lzc3VlLycgKyBwYXJhbXMuaWQsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIOiOt+WPluacn+WPt1xuICAgICAqIEdFVFxuICAgICAqIC9iYWNrZW5kL2lzc3VlL3tpZH1cbiAgICAgKi9cbiAgICB0aGlzLmdldElzc3VlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICBwYXRoOiAnaXNzdWUvJyArIHBhcmFtcy5pZCxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKuiOt+WPluacn+WPt+WIl+ihqFxuICAgICAqIEdFVFxuICAgICAqIGJhY2tlbmQvaXNzdWU/b2Zmc2V0PTAmbGltaXQ9MjAmc3RhdHVzPTAmZnJvbT0xNDgwNTIxNjAwMDAwJnRvPTE0ODEzMjgwMDAwMDBcbiAgICAgKi9cbiAgICB0aGlzLmdldEFsbElzc3VlTGlzdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJ2lzc3VlJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiDlpZfppJBcbiAgICAgKiBTdWl0ZTpcbiAgICAgKiAgaWQ6IFN0cmluZ1xuICAgICAqICB0eXBlOiBpbnQgLSDnibnoibIw77yb5qCH5YeGMe+8m1xuICAgICAqICBzdGF0dXM6aW50IC0g5pyq5Y+R5biDMO+8m+W3suWPkeW4gzHvvJtcbiAgICAgKiAgYmFubmVyOiBTdHJpbmdcbiAgICAgKiAgdGl0bGU6IFN0cmluZ1xuICAgICAqICBkZXM6IFN0cmluZ1xuICAgICAqICBwcm9kdWN0SWRzOiBTdHJpbmdbXVxuXG4gICAgICogU3VpdGVXaXRoUHJvZHVjdHM6XG4gICAgICogIHN1aXRlXG4gICAgICogIHByb2R1Y3RzXG5cbiAgICAgKiBTdWl0ZVdpdGhTdGF0aXN0aWNzOlxuICAgICAqICBzdWl0ZVxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICog5Yib5bu65aWX6aSQXG4gICAgICogUE9TVFxuICAgICAqIC9iYWNrZW5kL3N1aXRlXG4gICAgICovXG4gICAgdGhpcy5jcmVhdGVTdWl0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHBhcmFtcy5pc0RlbGV0ZWQgPSAwO1xuICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgcGF0aDogJ3N1aXRlJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiDnvJbovpHlpZfppJBcbiAgICAgKiBQVVRcbiAgICAgKiAvYmFja2VuZC9zdWl0ZS97aWR9XG4gICAgICovXG4gICAgdGhpcy5lZGl0b3JTdWl0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgcGF0aDogJ3N1aXRlLycgKyBwYXJhbXMuaWQsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICog5Yig6Zmk5aWX6aSQXG4gICAgICogREVMRVRFXG4gICAgICogL2JhY2tlbmQvc3VpdGUve2lkfVxuICAgICAqL1xuICAgIHRoaXMuZGVsZXRlU3VpdGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkRlbGV0ZSh7XG4gICAgICAgIHBhdGg6ICdzdWl0ZS8nICsgcGFyYW1zLmlkLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOWPkeW4g+Wll+mkkFxuICAgICAqIFBVVFxuICAgICAqIC9iYWNrZW5kL3N1aXRlL3tpZH0vcHVibGlzaFxuICAgICAqL1xuICAgIHRoaXMucHVibGlzaFN1aXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5QdXQoe1xuICAgICAgICBwYXRoOiAnc3VpdGUvJyArIHBhcmFtcy5pZCArICcvcHVibGlzaCcsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICog5qC55o2uaWTojrflj5blpZfppJAoU3VpdGVXaXRoUHJvZHVjdHMpXG4gICAgICogR0VUXG4gICAgICogL2JhY2tlbmQvc3VpdGUve2lkfVxuICAgICAqL1xuICAgIHRoaXMuZ2V0U3VpdGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdzdWl0ZS8nICsgcGFyYW1zLmlkLFxuICAgICAgICAvLyBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOiOt+WPluWll+mkkOWIl+ihqChTdWl0ZVdpdGhTdGF0aXN0aWNzW10pXG4gICAgICogR0VUXG4gICAgICogL2JhY2tlbmQvc3VpdGU/b2Zmc2V0PTAmbGltaXQ9MjAmdHlwZT0wJnN0YXR1cz0wJmlkPXtpZH1cbiAgICAgKiBbRmlsdGVyIFBhcmFtczogdHlwZShOT05FLDAsMSksIHN0YXR1cyhOT05FLDAsMSksIGlkKE5PTkUse2lkfSldXG4gICAgICovXG4gICAgdGhpcy5nZXRBbGxTdWl0ZUxpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICdzdWl0ZScsXG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICog5pyf5Y+35a6e5pe25Yqo5oCBXG4gICAgICog5YiG6aG15p+l6K+i5pyf5Y+35a6e5pe25Yqo5oCB5pWw5o2uXG4gICAgICog5o6l5Y+j5ZCNIC9zaGVsZi9zdWl0ZS9zdGF0aXN0aWNhbC9wYWdlYWJsZVxuICAgICAqIOivt+axguaWueazlSBQT1NUXG4gICAgICog6K+35rGC5Y+C5pWwOiBpc3N1ZUlkLCBjb21wYW55TmFtZSwgaXNzdWVTdGFydFRpbWUsIGlzc3VlRW5kVGltZVxuICAgICAqL1xuICAgIHRoaXMucXVlcnlJc3N1ZUR5bmFtaWMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnc2hlbGYvc3VpdGUvc3RhdGlzdGljYWwvcGFnZWFibGUnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiDmn6Xor6LmnJ/lj7flj5jliqjmmI7nu4ZcbiAgICAgKiDmjqXlj6PlkI0gL3NoZWxmL3N1aXRlL3N0YXRpc3RpY2FsL+acn2lkL+S8geS4mmlkXG4gICAgICog6K+35rGC5pa55rOVIEdFVFxuICAgICAqIOivt+axguWPguaVsDogaXNzdWVJZCwgY29tcGFueUlkXG4gICAgICovXG4gICAgdGhpcy5xdWVyeUlzc3VlQ2hhbmdlcyA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIHhoclNlcnZpY2UuR2V0KHtcbiAgICAgICAgcGF0aDogJy9zaGVsZi9zdWl0ZS9zdGF0aXN0aWNhbC8nICsgcGFyYW1zLmlzc3VlSWQgKyAnLycgK1xuICAgICAgICAgIHBhcmFtcy5jb21wYW55SWQsXG4gICAgICAgIC8vIHBhcmFtczogcGFyYW1zLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICog5Yib5bu66K+E6K665oiW5Zue5aSNXG4gICAgICog5o6l5Y+j5ZCNIGNybS9zdWl0ZS9jb21tZW50XG4gICAgICog6K+35rGC5pa55rOVIFBPU1RcbiAgICAgKiDor7fmsYLlj4LmlbAgc3VpdGVJZCwgY29tcGFueUlkLCBjb250ZW50LCBwYXJlbnRJZFxuICAgICAqL1xuICAgIHRoaXMuX2NyZWF0ZUNvbW1lbnQgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY3JtL3N1aXRlL2NvbW1lbnQnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOWIhumhteafpeivouivhOiuulxuICAgICAqIOaOpeWPo+WQjSBjcm0vc3VpdGUvY29tbWVudC9wYWdlYWJsZVxuICAgICAqIOivt+axguaWueazlSBQT1NUXG4gICAgICog6K+35rGC5Y+C5pWwIHN1aXRlSWQsIGN1c3RvbWVyTmFtZSwgY29udGVudCwgY3JlYXRlVGltZVN0YXJ0LCBjcmVhdGVUaW1lRW5kXG4gICAgICovXG4gICAgdGhpcy5xdWVyeUNvbW1lbnQgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLlBvc3Qoe1xuICAgICAgICBwYXRoOiAnY3JtL3N1aXRlL2NvbW1lbnQvcGFnZWFibGUnLFxuICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIOWIoOmZpOivhOiuulxuICAgICAqIOaOpeWPo+WQjSBjcm0vc3VpdGUvY29tbWVudC/ov5nph4znm7TmjqXkvKBzdWl0ZUNvbW1lbnRJZFxuICAgICAqIOivt+axguaWueazlSBERUxFVEVcbiAgICAgKiDor7fmsYLlj4LmlbAgc3VpdGVDb21tZW50SWRcbiAgICAgKi9cbiAgICB0aGlzLl9kZWxldGVDb21tZW50ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5EZWxldGUoe1xuICAgICAgICBwYXRoOiAnY3JtL3N1aXRlL2NvbW1lbnQvJyArIHBhcmFtcy5zdWl0ZUNvbW1lbnRJZCxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAg5p+l6K+i5raI5oGv5Lit5b+D5YiX6KGoXG4gICAgICogIOaOpeWPo+WQjSAvbm90aWZpY2F0aW9uL2NlbnRlclxuICAgICAqICDor7fmsYLmlrnms5UgR0VUXG4gICAgICogIOivt+axguWPguaVsCDml6BcbiAgICAgKi9cbiAgICB0aGlzLmdldE1lc3NhZ2VDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgIHBhdGg6ICcvbm90aWZpY2F0aW9uL2NlbnRlJyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIOacn+WPt+WunuaXtuWKqOaAgSDmibnph4/miZPljbBcbiAgICAgKiBzaGVsZi9zdWl0ZS9zdGF0aXN0aWNhbC9wcmludFxuICAgICAqIHBvc3RcbiAgICAgKi9cbiAgICB0aGlzLmlzc3VlRHluYW1pY1ByaW50ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgeGhyU2VydmljZS5Qb3N0KHtcbiAgICAgICAgcGF0aDogJ3NoZWxmL3N1aXRlL3N0YXRpc3RpY2FsL3ByaW50JyxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gIH1dKTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICBhcHAuc2VydmljZSgndGVtcGxhdGVTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgJ2NhY2hlU2VydmljZScsIGZ1bmN0aW9uKFxuICAgICAgICB4aHJTZXJ2aWNlLCAkcSwgY2FjaGVTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICAgIHRoaXMucXVlcnkgPSBmdW5jdGlvbihwYXRoLCB0eXBlLCBwYXJhbXMsIG5lZWRBbGwpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xuICAgICAgICAgICAgeGhyU2VydmljZVt0eXBlXS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcywgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzLCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIC8q6I635Y+W5qih54mI5YiX6KGoXG4gICAgICAgICAqZGVzdF9pZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xdWVyeVRlbXBsYXRlTGlzdCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgcmV0dXJuIG1lLnF1ZXJ5KCd0ZW1wbGF0ZS9oZWxwZXIvcGFnZWFibGUnLCAnUG9zdCcsIHBhcmFtcyk7XG4gICAgICAgIH07XG4gICAgICAgIC8q5re75Yqg5qih5p2/XG4gICAgICAgICAqbmFtZVxuICAgICAgICAgKnZlcnNpb25cbiAgICAgICAgICpkZXN0X2lkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFkZFRlbXBsYXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gbWUucXVlcnkoJ3RlbXBsYXRlL2FkZCcsICdQb3N0JywgcGFyYW1zKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrliJvlu7rmqKHmnb9cbiAgICAgICAgXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNyZWF0ZVRlbXBsYXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gbWUucXVlcnkoJ3RlbXBsYXRlL2hlbHBlcicsICdQb3N0JywgcGFyYW1zKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrkv67mlLnmqKHmnb9cbiAgICAgICAgICppZFxuICAgICAgICAgKnR5cGVcbiAgICAgICAgICpuYW1lXG4gICAgICAgICAqc3RhdHVzICAgXG4gICAgICAgICAqbW9kdWxlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVkaXRUZW1wbGF0ZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgLy8gcGFyYW1zLm1vZHVsZSA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcy5tb2R1bGUpO1xuICAgICAgICAgICAgcmV0dXJuIG1lLnF1ZXJ5KCd0ZW1wbGF0ZS9oZWxwZXInLCAnUHV0JywgcGFyYW1zKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKuWIoOmZpOaooeadv1xuICAgICAgICAgKmlkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlbGV0ZVRlbXBsYXRlID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gbWUucXVlcnkoJ3RlbXBsYXRlL2hlbHBlci8xLycrcGFyYW1zLmlkLCAnRGVsZXRlJywgcGFyYW1zKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyrojrflj5bmqKHmnb/or6bmg4VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXVlcnlUZW1wbGF0ZURldGFpbCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgcmV0dXJuIG1lLnF1ZXJ5KCd0ZW1wbGF0ZS9oZWxwZXIvJyArIHBhcmFtcy5pZCwgJ0dldCcsIHBhcmFtcyk7XG4gICAgICAgIH07XG4gICAgICAgIC8q5qih5p2/5Y+R5biDXG4gICAgICAgIHR5cGVcbiAgICAgICAgaWRcbiAgICAgICAgc3RhdHVzXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnB1Ymxpc2hUZW1wbGF0ZT1mdW5jdGlvbihwYXJhbXMpe1xuICAgICAgICAgICAgcmV0dXJuIG1lLnF1ZXJ5KCd0ZW1wbGF0ZS9oZWxwZXIvbW9kaWZ5X3N0YXR1cycsICdQdXQnLCBwYXJhbXMpO1xuICAgICAgICB9XG5cblxuICAgIH1dKTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICBhcHAuc2VydmljZSgndXBsb2FkU2VydmljZScsIFsneGhyU2VydmljZScsICd1dGlsU2VydmljZScsICckcScsIGZ1bmN0aW9uKFxuICAgIHhoclNlcnZpY2UsIHV0aWxTZXJ2aWNlLCAkcSkge1xuICAgIHZhciBwaWNGb3JtQXBpU2VjcmV0ID0gd2luZG93LmNmZy5waWNTZWNyZXQ7XG4gICAgLy/lu7rnq4vkuIDlgIvlj6/lrZjlj5bliLDoqbJmaWxl55qEdXJsXG4gICAgdGhpcy5nZXRPYmplY3RVUkwgPSBmdW5jdGlvbihmaWxlKSB7XG4gICAgICB2YXIgdXJsID0gbnVsbDtcbiAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkgeyAvLyBiYXNpY1xuICAgICAgICB1cmwgPSB3aW5kb3cuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkgeyAvLyBtb3ppbGxhKGZpcmVmb3gpXG4gICAgICAgIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkgeyAvLyB3ZWJraXQgb3IgY2hyb21lXG4gICAgICAgIHVybCA9IHdpbmRvdy53ZWJraXRVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVybDtcbiAgICB9O1xuICAgIHRoaXMuZ2V0R3VpZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGd1aWQgPSBcIlwiO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gMzI7IGkrKykge1xuICAgICAgICB2YXIgbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2LjApLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgZ3VpZCArPSBuO1xuICAgICAgICBpZiAoKGkgPT0gOCkgfHwgKGkgPT0gMTIpIHx8IChpID09IDE2KSB8fCAoaSA9PSAyMCkpXG4gICAgICAgICAgZ3VpZCArPSBcIlwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGd1aWQ7XG4gICAgfTtcbiAgICB0aGlzLnVwbG9hZCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHZhciBmaWxlX2RvbSA9IG9wdHMuZmlsZV9kb20sXG4gICAgICAgIGZvbGRlciA9IG9wdHMuZm9sZGVyLFxuICAgICAgICBzdHJfZG9tID0gb3B0cy5zdHJfZG9tLFxuICAgICAgICBzaXplX2xpbWl0ID0gb3B0cy5zaXplX2xpbWl0IHx8IHt9LFxuICAgICAgICBpc191cGxvYWRfdXB5dW4gPSB0eXBlb2Ygb3B0cy5pc191cGxvYWRfdXB5dW4gIT0gJ3VuZGVmaW5lZCcgP1xuICAgICAgICBvcHRzLmlzX3VwbG9hZF91cHl1biA6IHRydWU7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgIHZhciBmaWxlID0gZmlsZV9kb20uZmlsZXNbMF07XG5cbiAgICAgIHZhciBteURhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgaW1nLnNyYyA9IG1lLmdldE9iamVjdFVSTChmaWxlKTtcbiAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IHNpemVfbGltaXQuc2l6ZSAmJiBzaXplX2xpbWl0LnNpemUpIHtcbiAgICAgICAgICB1dGlsU2VydmljZS5hbGVydEVycm9yKCfor6Xlm77niYflt7LotoXov4cnICsgdXRpbFNlcnZpY2UucGFyc2VLQnlCeXRlcyhcbiAgICAgICAgICAgICAgc2l6ZV9saW1pdC5zaXplKSArXG4gICAgICAgICAgICAna+eahOmZkOWIticpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1nLndpZHRoID4gc2l6ZV9saW1pdC53aWR0aCAmJiBzaXplX2xpbWl0LndpZHRoKSB7XG4gICAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcign6K+l5Zu+54mH5a695bey6LaF6L+HJyArIHNpemVfbGltaXQud2lkdGggK1xuICAgICAgICAgICAgJ+eahOmZkOWIticpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1nLmhlaWdodCA+IHNpemVfbGltaXQuaGVpZ2h0ICYmIHNpemVfbGltaXQuaGVpZ2h0KSB7XG4gICAgICAgICAgdXRpbFNlcnZpY2UuYWxlcnRFcnJvcign6K+l5Zu+54mH6auY5bey6LaF6L+HJyArIHNpemVfbGltaXQuaGVpZ2h0ICtcbiAgICAgICAgICAgICfnmoTpmZDliLYnKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzX3VwbG9hZF91cHl1biA9PSAndHJ1ZScpIHsgLy/pnIDopoHkuIrkvKDlj4jmi43kupFcbiAgICAgICAgICB2YXIgZXh0ID0gJy4nICsgZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCk7XG4gICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGJ1Y2tldDogd2luZG93LmNmZy5waWNCdWNrZXQsXG4gICAgICAgICAgICBleHBpcmF0aW9uOiBwYXJzZUludCgobmV3IERhdGUoKS5nZXRUaW1lKCkgKyAzNjAwMDAwKSAvXG4gICAgICAgICAgICAgIDEwMDApLFxuICAgICAgICAgICAgLy8g5bC96YeP5LiN6KaB5L2/55So55u05o6l5Lyg6KGo5Y2VIEFQSSDnmoTmlrnlvI/vvIzku6XpmLLms4TpnLLpgKDmiJDlronlhajpmpDmgqNcbiAgICAgICAgICAgIGZvcm1fYXBpX3NlY3JldDogcGljRm9ybUFwaVNlY3JldFxuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIGluc3RhbmNlID0gbmV3IFNhbmQoY29uZmlnKTtcbiAgICAgICAgICB2YXIgcGF0aCA9ICcvJyArIGZvbGRlciArICcvJyArIG15RGF0ZS5nZXRGdWxsWWVhcigpICtcbiAgICAgICAgICAgICcvJyArXG4gICAgICAgICAgICBteURhdGUuZ2V0TW9udGgoKSArICcvJyArIG1lLmdldEd1aWQoKSArICdfJyArIGZpbGUuc2l6ZSArXG4gICAgICAgICAgICAnXycgKyBpbWcud2lkdGggK1xuICAgICAgICAgICAgJ1gnICsgaW1nLmhlaWdodCArIGV4dDtcbiAgICAgICAgICBpbnN0YW5jZS51cGxvYWQocGF0aCwgZmlsZV9kb20sIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgaWYgKCFzdHJfZG9tKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChzdHJfZG9tKS52YWwocmVzLnBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgeyAvL+S4jemcgOS4iuS8oOWPiOaLjeS6kVxuICAgICAgICAgIHZhciByZXMgPSB7XG4gICAgICAgICAgICBmaWxlX3NpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgIGltYWdlX3dpZHRoOiBpbWcud2lkdGgsXG4gICAgICAgICAgICBpbWFnZV9oZWlnaHQ6IGltZy5oZWlnaHQsXG4gICAgICAgICAgICBwYXRoOiBpbWcuc3JjXG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfTtcbiAgICB0aGlzLnVwbG9hZEZpbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICB2YXIgaW5wdXQgPSBhbmd1bGFyLmVsZW1lbnQoJzxpbnB1dCB0eXBlPVwiZmlsZVwiLz4nKTtcbiAgICAgIGlucHV0LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBlLmN1cnJlbnRUYXJnZXQuZmlsZXNbMF07XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoZmlsZSk7XG4gICAgICB9KTtcbiAgICAgIGlucHV0WzBdLmNsaWNrKCk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9O1xuICB9XSk7XG59OyIsIi8qXG4gKnNoZWxmU2VydmljZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuXG4gIGFwcC5zZXJ2aWNlKCd1dGlsU2VydmljZScsIGZ1bmN0aW9uKCRzY2UsIENPTlNUQU5UUywgJG1kRGlhbG9nLCAkZmlsdGVyKSB7XG4gICAgLypcbiAgICAgKuagvOW8j+WMluihqOagvOWktFxuICAgICAqL1xuICAgIHRoaXMudHJhbnNmb3JtSGVhZCA9IGZ1bmN0aW9uKGhlYWRzLCBjb25maWcpIHtcbiAgICAgIHZhciB0ZW1wID0gW107XG4gICAgICBhbmd1bGFyLmZvckVhY2goaGVhZHMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKCFpdGVtLmdldFZhbHVlKSB7XG4gICAgICAgICAgaXRlbS5nZXRWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlLCByZWNvcmQsIGluZGV4LCBzY29wZSkge1xuICAgICAgICAgICAgdmFyIHYgPSAnPHNwYW4+JyArIHJlY29yZFtpdGVtLmZpZWxkXSArICc8L3NwYW4+JztcbiAgICAgICAgICAgIGlmICghKGNvbmZpZyAmJiBjb25maWcubmVlZENvbXBpbGUpKSB7IC8v5LiN6ZyA6KaB57yW6K+RXG4gICAgICAgICAgICAgIHYgPSAkc2NlLnRydXN0QXNIdG1sKHYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0ZW1wLnB1c2goaXRlbSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0ZW1wO1xuICAgIH07XG4gICAgdGhpcy5wYXJzZURhdGVCeVRpbWVTdGFtcCA9IGZ1bmN0aW9uKHQsIHBhdHRlcm4pIHtcbiAgICAgIHJldHVybiAkZmlsdGVyKCdkYXRlJykodCwgJ3l5eXktTU0tZGQgSEg6bW06c3MnKTtcbiAgICB9O1xuICAgIC8qXG4gICAgKuagvOW8j+WMluaXtumXtFxuICAgIGQ6ZGF0Zeexu+Wei1xuICAgIGZtdFxuICAgICovXG4gICAgdGhpcy5wYXJzZVRpbWVCeURhdGUgPSBmdW5jdGlvbihkLCBmbXQpIHtcbiAgICAgIHZhciBmID0gZm10IHx8ICd5eXl5LU1NLWRkIGhoOm1tOnNzJyxcbiAgICAgICAgbyA9IHtcbiAgICAgICAgICBcIk0rXCI6IGQuZ2V0TW9udGgoKSArIDEsIC8v5pyI5Lu9XG4gICAgICAgICAgXCJkK1wiOiBkLmdldERhdGUoKSwgLy/ml6VcbiAgICAgICAgICBcImgrXCI6IGQuZ2V0SG91cnMoKSwgLy/lsI/ml7ZcbiAgICAgICAgICBcIm0rXCI6IGQuZ2V0TWludXRlcygpLCAvL+WIhlxuICAgICAgICAgIFwicytcIjogZC5nZXRTZWNvbmRzKCksIC8v56eSXG4gICAgICAgICAgXCJxK1wiOiBNYXRoLmZsb29yKChkLmdldE1vbnRoKCkgKyAzKSAvIDMpLCAvL+Wto+W6plxuICAgICAgICAgIFwiU1wiOiBkLmdldE1pbGxpc2Vjb25kcygpIC8v5q+r56eSXG4gICAgICAgIH07XG4gICAgICBpZiAoLyh5KykvLnRlc3QoZikpIHtcbiAgICAgICAgZiA9IGYucmVwbGFjZShSZWdFeHAuJDEsIChkLmdldEZ1bGxZZWFyKCkgKyBcIlwiKS5zdWJzdHIoNCAtXG4gICAgICAgICAgUmVnRXhwLiQxLmxlbmd0aCkpO1xuICAgICAgfVxuICAgICAgZm9yICh2YXIgayBpbiBvKSB7XG4gICAgICAgIGlmIChuZXcgUmVnRXhwKFwiKFwiICsgayArIFwiKVwiKS50ZXN0KGYpKSB7XG4gICAgICAgICAgZiA9IGYucmVwbGFjZShSZWdFeHAuJDEsIChSZWdFeHAuJDEubGVuZ3RoID09IDEpID8gKG9ba10pIDogKFxuICAgICAgICAgICAgKFwiMDBcIiArIG9ba10pLnN1YnN0cigoXCJcIiArIG9ba10pLmxlbmd0aCkpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGY7XG4gICAgfTtcbiAgICAvKlxuICAgICrmoLzlvI/ljJbml7bpl7RcbiAgICAqbDpsb25n57G75Z6LXG4gICAgZm10XG4gICAgKi9cbiAgICB0aGlzLnBhcnNlVGltZUJ5TG9uZyA9IGZ1bmN0aW9uKGwsIGZtdCkge1xuICAgICAgdmFyIGQgPSBuZXcgRGF0ZShwYXJzZUludChsKSk7XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZVRpbWVCeURhdGUoZCwgZm10KTtcbiAgICB9O1xuICAgIHRoaXMucGFyc2VUaW1lQnlEYXRlRGlzID0gZnVuY3Rpb24oZCwgZGlzLCBmbXQpIHtcbiAgICAgIHZhciBmID0gZm10IHx8ICd5eXl5LU1NLWRkIGhoOm1tOnNzJztcbiAgICAgIHZhciBiZWdpblRpbWUgPSBkLmdldFRpbWUoKTtcbiAgICAgIHZhciBlbmRUaW1lID0gZC5nZXRUaW1lKCkgKyBkaXMgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuICAgICAgZC5zZXRUaW1lKGVuZFRpbWUpO1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VUaW1lQnlEYXRlKG5ldyBEYXRlKGQpLCBmbXQpO1xuICAgIH07XG4gICAgdGhpcy5wYXJzZUxvbmdUaW1lQnlEYXRlRGlzID0gZnVuY3Rpb24oZCwgZGlzKSB7XG4gICAgICB2YXIgYmVnaW5UaW1lID0gZC5nZXRUaW1lKCk7XG4gICAgICB2YXIgZW5kVGltZSA9IGQuZ2V0VGltZSgpICsgZGlzICogMjQgKiA2MCAqIDYwICogMTAwMDtcbiAgICAgIHJldHVybiBlbmRUaW1lO1xuICAgIH07XG4gICAgdGhpcy5nZXRDb25zdGFudEpzb25WYWx1ZSA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHZhbHVlcyA9IENPTlNUQU5UUy5TSEVMRl9TVEFURS5ERVNDO1xuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgYW5ndWxhci5mb3JFYWNoKHZhbHVlcywgZnVuY3Rpb24odiwgaykge1xuICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgdmFsdWU6IGssXG4gICAgICAgICAgZGVzYzogdlxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICB0aGlzLmluZGV4QXJyYXkgPSBmdW5jdGlvbihkYXRhLCBvZmZzZXQsIGtleW5hbWUpIHtcbiAgICAgIGlmICgha2V5bmFtZSkge1xuICAgICAgICBrZXluYW1lID0gJ2luZGV4JztcbiAgICAgIH1cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpdGVtW2tleW5hbWVdID0gaW5kZXggKyBvZmZzZXQ7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG4gICAgLy/ojrflj5bmn6Xor6Lor7fmsYLnmoTlj4LmlbBcbiAgICB0aGlzLmdldFNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uKHBhcmFtcywgdmFsdWUsIGtleSkge1xuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHBhcmFtc1trZXldID0gdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH07XG4gICAgLy/ph43nva7liIbpobXlj4LmlbBcbiAgICB0aGlzLnJlc2V0UGFnaW5hdGlvbiA9IGZ1bmN0aW9uKHNjb3BlLCBvZmZzZXQsIGxpbWl0KSB7XG4gICAgICBzY29wZS5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICBzY29wZS5saW1pdCA9IGxpbWl0O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb2Zmc2V0OiBzY29wZS5vZmZzZXQsXG4gICAgICAgIGxpbWl0OiBzY29wZS5saW1pdFxuICAgICAgfTtcbiAgICB9O1xuICAgIC8v5by55Ye66ZSZ6K+v6K2m5ZGKXG4gICAgdGhpcy5hbGVydEVycm9yID0gZnVuY3Rpb24oZXJyb3JNZXNzYWdlKSB7XG4gICAgICAkbWREaWFsb2cuc2hvdygkbWREaWFsb2cuYWxlcnQoe1xuICAgICAgICB0aXRsZTogJ+Wksei0pScsXG4gICAgICAgIHRleHRDb250ZW50OiBlcnJvck1lc3NhZ2UsXG4gICAgICAgIG9rOiAn5YWz6ZetJyxcbiAgICAgICAgekluZGV4OiA5OTk5OTk5OTk5OTk5OVxuICAgICAgfSkuY2xpY2tPdXRzaWRlVG9DbG9zZSh0cnVlKSk7XG4gICAgfTtcbiAgICAvL+W8ueWHuuaIkOWKn+aPkOekulxuICAgIHRoaXMuYWxlcnRTdWNjZXNzID0gZnVuY3Rpb24obXNnKSB7XG4gICAgICAkbWREaWFsb2cuc2hvdygkbWREaWFsb2cuYWxlcnQoe1xuICAgICAgICB0aXRsZTogJ+aIkOWKnycsXG4gICAgICAgIHRleHRDb250ZW50OiBtc2csXG4gICAgICAgIG9rOiAn5YWz6ZetJyxcbiAgICAgICAgekluZGV4OiA5OTk5OTk5OTk5OTk5OVxuICAgICAgfSkuY2xpY2tPdXRzaWRlVG9DbG9zZSh0cnVlKSk7XG4gICAgfTtcbiAgICAvL+WwhuWtl+iKgui9rOaNouS4uktcbiAgICB0aGlzLnBhcnNlS0J5Qnl0ZXMgPSBmdW5jdGlvbihieXRlcykge1xuICAgICAgcmV0dXJuIE1hdGgucm91bmQoKGJ5dGVzIC9cbiAgICAgICAgMTAyNCAqIDEwMCkgLyAxMDApO1xuICAgIH07XG4gICAgLy/ojrflj5bkurrmsJHluIFcbiAgICB0aGlzLmdldFJNQlN0ciA9IGZ1bmN0aW9uKGFtdCkge1xuXG4gICAgICByZXR1cm4gYW10ID8gKHBhcnNlSW50KGFtdCAvIDEwMCkgKyAnLicgKyBwYXJzZUludCgoYW10IC8gMTApICVcbiAgICAgICAgMTApICsgcGFyc2VJbnQoYW10ICUgMTApKSA6ICcwJztcbiAgICB9O1xuICAgIC8v6I635Y+W5YiGXG4gICAgdGhpcy5nZXRQb2ludEludCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gcGFyc2VJbnQoKHZhbHVlICogMTAwKS50b0ZpeGVkKDApKTtcbiAgICB9O1xuICAgIHRoaXMuZ2V0UG9pbnREb3VibGUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuICh2YWx1ZSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICB9O1xuICB9KTtcbn07IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHRhb3hpYW9mZW5nIG9uIDE2LzYvMjcuXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ3dlbGZhcmVTZXJ2aWNlJywgWyd4aHJTZXJ2aWNlJywgJyRxJywgZnVuY3Rpb24oeGhyU2VydmljZSwgJHEpIHtcbiAgICAgICAgLyrpm7boirHpkrHlt6XljZXliJfooajliIbpobXmn6Xor6JcbiAgICAgICAgICpjb21wYW55SWRcbiAgICAgICAgICpvZmZzZXRcbiAgICAgICAgICpsaW1pdFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xdWVyeVdlbGZhcmVMaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICd3ZWxmYXJlL3BvY2tldG1vbmV5L3BhZ2VhYmxlJyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIC8q5p+l6K+i6Zu26ZKx5Y+R5pS+5YiX6KGoXG4gICAgICAgICAqb3JkZXJJZFxuICAgICAgICAgKm9mZnNldFxuICAgICAgICAgKmxpbWl0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1ZXJ5V2VsZmFyZU9iamVjdExpc3QgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB4aHJTZXJ2aWNlLkdldCh7XG4gICAgICAgICAgICAgICAgcGF0aDogJ3dlbGZhcmUvcG9ja2V0bW9uZXkvb3JkZXIvJyArIHBhcmFtcy5vcmRlcklkICsgJy9pdGVtcycsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKumbtumSseWuoeaguFxuICAgICAgICAgKm9yZGVySWRcbiAgICAgICAgICpvcmRlclN0YXRlXG4gICAgICAgICAqb3B0UmVjb3JkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1ZGl0V2VsZmFyZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIHhoclNlcnZpY2UuUHV0KHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnd2VsZmFyZS9wb2NrZXRtb25leS9vcmRlci9zdGF0ZScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAvKuWPkeaUvumbtumSsVxuICAgICAgICAqXG4gICAgICAgICovXG4gICAgfV0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYXBwKSB7XG4gICAgYXBwLnNlcnZpY2UoJ3dpc2hsaXN0U2VydmljZScsIFsneGhyU2VydmljZScsICckcScsIGZ1bmN0aW9uKHhoclNlcnZpY2UsICRxKSB7XG4gICAgICAgIHRoaXMuX3BhcnNlV2lzaGxpc3QgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IFtdO1xuICAgICAgICAgICAgdmFyIHNoZWxmQ291bnQgPSBkYXRhLnNoZWxmQ291bnQ7XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YS5pdGVtcywgZnVuY3Rpb24oaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIHZhciB0ID0gYW5ndWxhci5jb3B5KGl0ZW0pO1xuICAgICAgICAgICAgICAgIHQuZXhjZXNzID0gaSArIDEgPiAyMCAqIHNoZWxmQ291bnQ7Ly/lpKfkuo4yMCrotKfmnrbmlbDmlpzkvZPmmL7npLpcbiAgICAgICAgICAgICAgICB0ZW1wLnB1c2godCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0ZW1wO1xuICAgICAgICB9O1xuICAgICAgICAvKuafpeivouS8geS4muW/g+aEv+WVhuWTgeWIl+ihqFxuICAgICAgICAgKmNvbXBhbnlJZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xdWVyeVdpc2hsaXN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgeGhyU2VydmljZS5HZXQoe1xuICAgICAgICAgICAgICAgIHBhdGg6ICd3aXNobGlzdC9jb21wYW55LycgKyBwYXJhbXMuY29tcGFueUlkICsgJy9yZWFjaGVkJyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgfV0pO1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgYXBwLnNlcnZpY2UoJ3hoclNlcnZpY2UnLCBbJyRodHRwJywgJ2NhY2hlU2VydmljZScsICckbWREaWFsb2cnLCAnJG1kVG9hc3QnLFxuICAgICdsb2FkZGluZ1NlcnZpY2UnLFxuICAgIGZ1bmN0aW9uKCRodHRwLCBjYWNoZVNlcnZpY2UsICRtZERpYWxvZywgJG1kVG9hc3QsIGxvYWRkaW5nU2VydmljZSkge1xuICAgICAgdmFyIF9yZXF1ZXN0ID0gZnVuY3Rpb24ocGF0aCwgdHlwZSwgb3B0cykge1xuICAgICAgICB2YXIgY29uZmlnID0geyByZXNwb25zZVR5cGU6IG9wdHMucmVzcG9uc2VUeXBlIH07XG4gICAgICAgIGNvbmZpZy51cmwgPSAocGF0aCA/IHdpbmRvdy5jZmdbcGF0aF0gOiB3aW5kb3cuY2ZnLmJpeikgKyBvcHRzLnBhdGg7XG4gICAgICAgIGNvbmZpZy5tZXRob2QgPSB0eXBlO1xuICAgICAgICBjb25maWcuZGF0YSA9IHt9O1xuICAgICAgICBjb25maWcudGltZW91dCA9IDMwMDAwO1xuICAgICAgICBjb25maWcuaGVhZGVycyA9IGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZy5oZWFkZXJzIHx8IHt9LCBvcHRzLmhlYWRlcnMpO1xuICAgICAgICB2YXIgcGFnZUNvbmZpZyA9IHt9O1xuICAgICAgICBpZiAodHlwZSAhPT0gJ0dFVCcgJiYgb3B0cy5wYXJhbXMgJiYgb3B0cy5wYXJhbXMub2Zmc2V0ICE9PVxuICAgICAgICAgIHVuZGVmaW5lZCAmJiBvcHRzLnBhcmFtcy5saW1pdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcGFnZUNvbmZpZy5vZmZzZXQgPSBvcHRzLnBhcmFtcy5vZmZzZXQ7XG4gICAgICAgICAgcGFnZUNvbmZpZy5saW1pdCA9IG9wdHMucGFyYW1zLmxpbWl0O1xuICAgICAgICAgIG9wdHMucGFyYW1zID0gXy5vbWl0KG9wdHMucGFyYW1zLCAnb2Zmc2V0Jyk7XG4gICAgICAgICAgb3B0cy5wYXJhbXMgPSBfLm9taXQob3B0cy5wYXJhbXMsICdsaW1pdCcpO1xuXG4gICAgICAgICAgaWYgKGNvbmZpZy51cmwuaW5kZXhPZignPycpID09IC0xKSB7XG4gICAgICAgICAgICBjb25maWcudXJsID0gY29uZmlnLnVybCArICc/JztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uZmlnLnVybCA9IGNvbmZpZy51cmwgKyAnJic7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbmZpZy51cmwgPSBjb25maWcudXJsICsgJ29mZnNldD0nICsgcGFnZUNvbmZpZy5vZmZzZXQgK1xuICAgICAgICAgICAgJyZsaW1pdD0nICsgcGFnZUNvbmZpZy5saW1pdDtcbiAgICAgICAgfVxuICAgICAgICB0eXBlID09ICdHRVQnID8gY29uZmlnLnBhcmFtcyA9IG9wdHMucGFyYW1zIDogY29uZmlnLmRhdGEgPVxuICAgICAgICAgIG9wdHMucGFyYW1zO1xuICAgICAgICB2YXIgZGF0YVR5cGUgPSBvcHRzLmRhdGFUeXBlID8gb3B0cy5kYXRhVHlwZSA6ICd0ZXh0JztcbiAgICAgICAgdmFyIGF1dGhvcml6YXRpb24gPSBjYWNoZVNlcnZpY2UuZ2V0U2Vzc2lvbigpO1xuICAgICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2UgPSBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICBpZiAoZGF0YVR5cGUgPT0gJ3RleHQnICYmIHJlcykge1xuICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1xcXCI6KFxcZHsxNix9KS9nLCBcIlxcXCI6XFxcIiQxXFxcIlwiKTsgLy9sb25n5Z6L6L2sc3RyaW5nXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICByZXMgPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIHJlcyA9IHJlcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9O1xuICAgICAgICBjb25maWcuaGVhZGVycyA9IGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZy5oZWFkZXJzIHx8IHt9LCB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRob3JpemF0aW9uLFxuICAgICAgICAgICdYLVJlcXVlc3QtV2l0aCc6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChhdXRob3JpemF0aW9uKSB7XG4gICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBhbmd1bGFyLmV4dGVuZChjb25maWcuaGVhZGVycyB8fCB7fSwge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRob3JpemF0aW9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9sb2FkZGluZyBzdGFydFxuICAgICAgICBsb2FkZGluZ1NlcnZpY2Uuc2hvdygpO1xuXG4gICAgICAgICRodHRwKGNvbmZpZykuc3VjY2VzcyhmdW5jdGlvbihyZXMsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgLy9sb2FkZGluZyBlbmRcbiAgICAgICAgICBsb2FkZGluZ1NlcnZpY2UuaGlkZSgpO1xuICAgICAgICAgIG9wdHMuc3VjY2Vzcy5jYWxsKHRoaXMsIHJlcy5kYXRhIHx8IHJlcywgc3RhdHVzLCBoZWFkZXJzLFxuICAgICAgICAgICAgY29uZmlnKTtcblxuICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihyZXMsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgLy9sb2FkZGluZyBlbmRcbiAgICAgICAgICBsb2FkZGluZ1NlcnZpY2UuaGlkZSgpO1xuICAgICAgICAgIHZhciBlcnJvciA9IG9wdHMuZXJyb3I7XG4gICAgICAgICAgaWYgKHN0YXR1cyA9PSA0MDMpIHtcbiAgICAgICAgICAgIGNhY2hlU2VydmljZS5zZXRTZXNzaW9uKCcnKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyMvaG9tZSc7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSByZXMgJiYgKHJlcy5tZXNzYWdlIHx8IHJlcy5tc2cgfHwgcmVzLmVycm9yKTtcbiAgICAgICAgICBpZiAob3B0cy50b2FzdEVycm9yKSB7XG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KCRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgIC50ZXh0Q29udGVudChcIuWksei0pTogXCIgKyBlcnJvck1lc3NhZ2UpXG4gICAgICAgICAgICAgIC5wb3NpdGlvbignYm90dG9tIHJpZ2h0JylcbiAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KCRtZERpYWxvZy5hbGVydCh7XG4gICAgICAgICAgICAgIHRpdGxlOiAn5aSx6LSlJyxcbiAgICAgICAgICAgICAgdGV4dENvbnRlbnQ6IGVycm9yTWVzc2FnZSxcbiAgICAgICAgICAgICAgb2s6ICflhbPpl60nLFxuICAgICAgICAgICAgICB6SW5kZXg6IDk5OTk5OTk5OTk5OTk5XG4gICAgICAgICAgICB9KS5jbGlja091dHNpZGVUb0Nsb3NlKHRydWUpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy9yZXMgJiYgd2luZG93LmFsZXJ0KHJlcy5tZXNzYWdlKTtcbiAgICAgICAgICBlcnJvciAmJiBlcnJvci5jYWxsKHRoaXMsIHJlcyk7XG5cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdGhpcy5HZXQgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIF9yZXF1ZXN0KG9wdHMuaG9zdCB8fCAnYml6JywgJ0dFVCcsIG9wdHMpO1xuICAgICAgfTtcbiAgICAgIHRoaXMuUG9zdCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgX3JlcXVlc3Qob3B0cy5ob3N0IHx8ICdiaXonLCAnUE9TVCcsIG9wdHMpO1xuICAgICAgfTtcbiAgICAgIHRoaXMuUHV0ID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBfcmVxdWVzdChvcHRzLmhvc3QgfHwgJ2JpeicsICdQVVQnLCBvcHRzKTtcbiAgICAgIH07XG4gICAgICB0aGlzLkRlbGV0ZSA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgX3JlcXVlc3Qob3B0cy5ob3N0IHx8ICdiaXonLCAnREVMRVRFJywgb3B0cyk7XG4gICAgICB9O1xuICAgICAgdGhpcy5VcGxvYWQgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIG9wdHMuaGVhZGVycyA9IGFuZ3VsYXIuZXh0ZW5kKHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkXG4gICAgICAgIH0sIG9wdHMuaGVhZGVycyB8fCB7fSk7XG4gICAgICAgIG9wdHMudHJhbnNmb3JtUmVxdWVzdCA9IGFuZ3VsYXIuaWRlbnRpdHk7XG4gICAgICAgIF9yZXF1ZXN0KG9wdHMuaG9zdCB8fCAnYml6JywgJ1BPU1QnLCBvcHRzKTtcbiAgICAgIH07XG4gICAgfVxuICBdKTtcbn07IiwibW9kdWxlLmV4cG9ydHM9W3JlcXVpcmUoXCIuL3NlcnZpY2UvYWNjb3VudFNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9hdXRoU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL2NhY2hlU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL2NvbXBhbnlTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvY29uZmlndXJhdGlvbkluZm9ybWF0aW9uU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL2RlYWRTdG9ja1NlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9kaWFsb2dTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvZmluYW5jZVNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9nb29kc0Nob29zZVNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9ob2xpZGF5V2VsZmFyZVNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9pblN0b3JhZ2VTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvbGFiZWxzTWFuYWdlbWVudHNTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvbG9hZGRpbmdTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvbW9kYWxTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UvbmV3UHJvZHVjdFNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9vcmRlclNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9wb3NpdGlvblNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9wcmludFNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9wcm9kdWN0U2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3Byb21vdGlvblNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS9yb2xlU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3NhbGVzU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3NoZWxmU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3N0YWZmU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3N1aXRlU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3RlbXBsYXRlU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3VwbG9hZFNlcnZpY2UuanNcIikscmVxdWlyZShcIi4vc2VydmljZS91dGlsU2VydmljZS5qc1wiKSxyZXF1aXJlKFwiLi9zZXJ2aWNlL3dlbGZhcmVTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2Uvd2lzaGxpc3RTZXJ2aWNlLmpzXCIpLHJlcXVpcmUoXCIuL3NlcnZpY2UveGhyU2VydmljZS5qc1wiKV0iXX0=
