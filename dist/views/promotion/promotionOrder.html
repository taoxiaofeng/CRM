<div ng-controller=promotionOrderCtrl class="order container-fluid promotion"><div class="header-wrap col-md-12"><promotion-searcher search=searchTea(queryParams) is-update-time-choices=isUpdateTimeChoices search-choices=SearchChoices></promotion-searcher><div class=btn-wrap><button class="btn btn-primary search-btn" ng-click=bathMultiPrint()>批量打印</button></div></div><table ng-table=orderTable class="table table-condensed table-bordered table-hover ngtable table-orders"><thead><th><input type=checkbox ng-model=checkAllCfg.flag id=checkbox_all class=chk_1 ng-click=selectAllOrder($event,$data)> <label for=checkbox_all></label></th><th>序号</th><th>下单时间</th><th>预约送货时间</th><th>下单企业</th><th>联系人</th><th>下单手机号</th><th>下单金额</th><th>是否退款</th><th><drop-down list={{orderTypeList}} desc-field=desc default-item={{orderTypeList[0]}} btn-style=btn-link select=selectOrderType(item)></drop-down></th><th>编辑</th></thead><tr ng-repeat="order in $data"><td><input type=checkbox ng-model=order.checked id="{{'checkbox_'+order.order.id}}" class=chk_1 ng-click=updateSelection($event,order)> <label for="{{'checkbox_'+order.order.id}}"></label></td><td>{{order.index}}</td><td>{{utilService.parseTimeByLong(order.order.createTime)}}</td><td align=center>{{order.order.deliveryTime?(order.order.deliveryTime|date : 'yyyy-MM-dd'):'--'}}</td><td align=center>{{order.order.companyName?order.order.companyName:"--"}}</td><td>{{order.order.contactName}}</td><td>{{order.address.contactPhone}}</td><td>{{order.order.price?(order.order.price|rmb):"--"}}</td><td>{{order.order.refund}}</td><td>{{order.order.status|desc:'PROMOTION_ORDER_STATUS'}}</td><td data-title="'导出Excel'"><button class="btn btn-default btn-sm" ng-click=showDetail(order)><span class="glyphicon glyphicon-list-alt"></span></button> <button class="btn btn-default btn-sm" ng-click=printOrder(order)><span class="glyphicon glyphicon-print"></span></button></td></tr></table><div id=exportExcelWrap class=hidden></div><script type=text/ng-template id=modalRecord><form class="modal-record-reason" ng-submit="confirmRecord(recordParams)"> <div class="modal-header"> <button type="button" class="close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">你是否确认该笔尾单{{11.52}}元已到账</h4> </div> <div class="modal-body form-inline"> <textarea ng-model="recordParams.optRecord" placeholder="添加选填跟踪信息"></textarea> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button> <button type="submit" class="btn btn-primary">确定</button> </div> </form></script><script title=确认收款 type=text/ng-template panel instance=payFullDialog><form name="payFullForm" novalidate class="payfull-form" style="width:300px"> <div class="row"> <h5 style="text-align: center;">您是否确认该笔订单尾款{{payFullCount|rmb}}元已到账</h5> <div class="form-group col-sm-12"> <label>添加跟踪备注</label> <input type="text" name="note" ng-model="payFullParams.note" class="form-control" /> </div> </div> </form> <div layout="row" class="demo-dialog-button"> <md-button md-autofocus flex class="md-raised md-primary " ng-disabled="payFullForm.$invalid" ng-click="confirmPayFull()"> 确定 </md-button> </div></script><script title=发货 type=text/ng-template panel instance=sendDialog><form name="sendForm" novalidate class="send-form" style="width:300px"> <div class="row"> <div class="form-group col-sm-12"> <label>快递公司</label> <input type="text" name="expressName" ng-model="sendParams.expressName" class="form-control" /> </div> </div> <div class="row"> <div class="form-group col-sm-12 {{sendForm.expressNumber.$invalid&&sendForm.expressNumber.$dirty?'has-error':''}}"> <label>快递单号</label> <input type="text" name="expressNumber" ng-pattern="/^\d+(\.\d{1,2})?$/" placeholder="请输数字" uib-tooltip="请输数字" ng-model="sendParams.expressNumber" class="form-control" tooltip-enable="sendParams.expressNumber.$invalid"> </div> </div> </form> <div layout="row" class="demo-dialog-button"> <md-button md-autofocus flex class="md-raised md-primary " ng-disabled="sendForm.$invalid" ng-click="confirmSend()"> 确定 </md-button> </div></script><script title=确认退款 type=text/ng-template panel instance=refundDialog><form name="refundForm" novalidate class="refund-form" style="width:300px"> <div class="row"> <h5 style="text-align: center;">请确定该订单已退款</h5> </div> </form> <div layout="row" class="demo-dialog-button"> <md-button md-autofocus flex class="md-raised md-primary " ng-disabled="payFullForm.$invalid" ng-click="confirmRefund()"> 确定 </md-button> </div></script></div><script type=text/ng-template id=modal-promotionEdit><form name="promotionEditForm" novalidate class="modal-edit"> <div class="modal-header"> <button type="button" class="close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">确认订单</h4> </div> <div class="modal-body promotionEdit"> <div class="left"> <h4>营销商品库</h4> <input type="text" class='form-control' placeholder='请输入商品名称' ng-model="editData.search"> <button type="submit" class=" btn btn-primary search" ng-click='getPromotionProduct()'>查询</button> <div class="list"> <li ng-repeat="list in products"> <a href="javascript:void(0)" class="{{list.isSelect?'active': ''}}" ng-click='promotionSelect(list)' ng-dblclick='dblAdd(list)'>{{list.title}}</a> <!-- <count num="list.itemNum" on-change="changeTotal"></count> --> </li> </div> </div> <div class="middle"> <a href="javascript:void(0)" ng-click='itemAdd()'>添加&nbsp;>></a> <a href="javascript:void(0)" ng-click='itemDelect()'> <<&nbsp;删除</a> </div> <div class="right"> <div class="title"> <div class="form-group {{promotionEditForm.actualPrice.$invalid&&promotionEditForm.actualPrice.$dirty?'has-error':''}}"> <input type="text" class="totalPrice form-control" required name="actualPrice" ng-model="editData.order.actualPrice">订单合计:￥{{editData.order.price|rmb}}&nbsp; 实收金额: </div> 已选商品 </div> <div class="list"> <li ng-repeat="item in selectedProduct"> <a href="javascript:void(0)" ng-click='promotiondelect(item)' ng-dblclick='dblDelect(item)' class="{{item.isSelect?'active': ''}}"> {{item.title}}<span>&nbsp;&nbsp;</span>{{item.price|rmb}} <count num="item.itemNum" on-change="changeTotal"></count> </a> </li> </div> </div> <div class="time"> 预约送货时间： <div class="form-group {{promotionEditForm.deliveryTime.$invalid&&promotionEditForm.deliveryTime.$dirty?'has-error':''}}"> <input type="date" name="deliveryTime" required ng-model="editData.order.deliveryTime"> </div> </div> <div class="crmNote"> <textarea name="" id="" cols="30" rows="4" placeholder='管理员订单备注' ng-model='editData.order.crmNotes' style="width:700px;"></textarea> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button> <button type="submit" class="btn btn-primary" ng-click="confirmEdit()">确定</button> </div> </form></script>