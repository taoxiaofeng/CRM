<div ng-controller="pickOrderCtrl" class="container-fluid pick-order">
    <uib-tabset active="activeJustified" justified="true">
        <uib-tab index="0" heading="运营" select="tabActive(0)">
            <div class="header-wrap">
                <company-searcher select-company="searchOperateOrders(company)" empty-callback="emptyCompanySearchInOperate()"></company-searcher>
                <div class="right-wrap">
                    <a href="#deliveryEdit/0">
                        <button class="btn btn-primary btn-create-delivery">创建拣货单</button>
                    </a>
                </div>
            </div>
            <table ng-table="operateOrdersTableParams" class="table table-condensed table-bordered table-hover ngtable table-orders">
                <tr ng-repeat="order in $data">
                    <td data-title="'序号'">{{$index+1}}</td>
                    <td data-title="'生成时间'">{{utilService.parseTimeByLong(order.createTime,'yyyy-MM-dd hh:mm')}}</td>
                    <td data-title="'更新时间'">{{utilService.parseTimeByLong(order.updateTime,'yyyy-MM-dd hh:mm')}}</td>
                    <td data-title="'客户名称'">{{order.companyName}}</td>
                    <td data-title="'货架名称'">{{order.shelfName}}</td>
                    <td data-title="'创建人'">{{order.creatorName}}</td>
                    <td data-title="'状态'">{{DELIVERY_STATE.DESC[order.orderState]}}</td>
                    <td data-title="'编辑'">
                        <a href="#deliveryEdit/{{order.orderId}}">
                            <button class="btn btn-default btn-sm"><span class="glyphicon glyphicon-pencil"></span>
                            </button>
                        </a>
                    </td>
                    <td data-title="'导出Excel'">
                        <button class="btn btn-default btn-sm" ng-click="exportExcelNeedLoadDetail(order.orderId,$event)"><span class="glyphicon glyphicon-save"></span></button>
                    </td>
                    <td data-title="'删除'">
                        <button class="btn btn-danger btn-sm" ng-click="deleteDeliveryOrder(order.orderId)"><span class="glyphicon glyphicon-trash"></span></button>
                    </td>
                </tr>
            </table>
        </uib-tab>
        <uib-tab index="1" heading="仓库" select="tabActive(1)">
            <div class="header-wrap">
                <company-searcher select-company="searchWarehouseOrders(company)" empty-callback="emptyCompanySearchInWarehouse()"></company-searcher>
                <div class=" right-wrap ">
                    <button class="btn btn-primary btn-batch-print " ng-click="batchModifyState(this) ">
                        批量切换状态({{selectOrders.length}})
                    </button>
                    <button class="btn btn-primary btn-batch-print " ng-click="batchPrint(this) ">
                        批量纯打印({{selectOrders.length}})
                    </button>
                </div>
            </div>
            <div class="one-table">
                <table ng-table="warehouseOrdertableParams " class="table table-condensed table-bordered ngtable table-orders-warehouse">
                    <thead>
                        <th>选择</th>
                        <th>序号</th>
                        <th>生成时间</th>
                        <th>更新时间</th>
                        <th>客户名称</th>
                        <th>货架名称</th>
                        <th>创建人</th>
                        <th>
                            <drop-down list={{warehouseOrderStates}} default-item={{curOrderState}} btn-style="btn-link " select="selectWarehouseOrderState(item) "></drop-down>
                        </th>
                        <th>查看明细</th>
                        <th>操作</th>
                    </thead>
                    <tbody>
                        <tr ng-repeat="order in $data " class="{{shouldRowHighlight(order)? 'tr-highlight ': ''}}" ng-click="selectPickOrder(order) ">
                            <td>
                                <input type="checkbox" ng-model="order.selected" ng-click="selectPickOrder(order)" />
                            </td>
                            <td>{{$index+1}}</td>
                            <td>{{utilService.parseTimeByLong(order.createTime,'yyyy-MM-dd hh:mm')}}</td>
                            <td>{{utilService.parseTimeByLong(order.updateTime,'yyyy-MM-dd hh:mm')}}</td>
                            <td>{{order.companyName}}</td>
                            <td>{{order.shelfName}}</td>
                            <td>{{order.creatorName}}</td>
                            <td>{{DELIVERY_STATE.DESC[order.orderState]+(order.returnTimes?'('+order.returnTimes+')':'')}}
                            </td>
                            <td>
                                <button class="btn btn-default btn-sm " ng-click="openPickOrderModal(order.orderId,$event) "><span class="glyphicon glyphicon-list-alt "></span></button>
                            </td>
                            <td>
                                <button class="btn btn-default btn-sm " ng-click="exportExcelNeedLoadDetail(order.orderId,$event) "><span class="glyphicon glyphicon-save "></span></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </uib-tab>
    </uib-tabset>
    <div id="exportExcelWrap" hidden></div>
    <!-- 退回原因 -->
    <script type="text/ng-template " id="modalReturnReason ">
        <form class="modal-return-reason " ng-submit="confirmReturn(returnParams) ">
            <div class="modal-header ">
                <button type="button " class="close " ng-click="cancel() "><span aria-hidden="true ">&times;</span>
                </button>
                <h4 class="modal-title " id="myModalLabel ">返回原因</h4>
            </div>
            <div class="modal-body form-inline ">
                <textarea ng-model="returnParams.optRecord " required></textarea>
            </div>
            <div class="modal-footer ">
                <button type="button " class="btn btn-default " ng-click="cancel() ">取消</button>
                <button type="submit " class="btn btn-primary ">确定</button>
            </div>
        </form>
    </script>
</div>